!function(t,n,e){"use strict";function i(){this.handlers=[],this.strHandlers={}}function o(){var t={},e={},i=0;this.on=function(n,o){n in t||(t[n]=new Array);var r=i++;return t[n].push(o),e[r]=o,r},this.emit=function(n){if(n in t){var e=Array.prototype.slice.call(arguments,1);t[n].forEach(function(t){t.apply(null,e)})}},this.unbind=function(i){var o=0;if(i in e){var r=e[i+""];n(t).each(function(t,n){var e=[];for(var i in t)t[i]===r&&(e.push(i),o++);e.reverse().forEach(function(n){t.splice(n,1)})})}return delete e[i],o}}function r(){return new Proxy({},{get:function(t,n){return"string"==typeof n?"toString"===n?g:r():t[n]}})}function s(t,n){this.getLogin=n,this.events=new o,this.$POST=v.bind(this),this.options={endPoint:t},this.on=this.events.on.bind(this)}function a(){var t=!1;this.touch=function(){t=!0},this.touched=function(){var n=t;return t=!1,n}}function c(t,e,i){if(!e)var e=[];var o=[];this.ask=function(i,r){n(e).contains(i)||(o.push(i),r||e.push(i),t.touch())},this.getAskedIndex=function(){return e},this.missings=function(){return n(o.splice(0,o.length)).unique().toArray()}}function u(t,e,i,o,r){var s=new a,u={},l={},d={},p={},h={};this.mainIndex=u,this.foreignKeys=l,this.m2m=d,this.m2mIndex=p,this.permissions=h,t.on("model-definition",function(t){var e=r.getIndexFor(t.name,"id");u[t.name]=new c(s,e,"mainIndex."+t.name),h[t.name]=new c(s,null,"permissions."+t.name),n(t.references).each(function(n){var e=t.name+"_"+n.id;l[e]=new c(s,r.getIndexFor(n.to,"id"),n.to+".id foreignKeys."+e)}),n(t.referencedBy).each(function(t){var n=t.by+"."+t.id;l[n]=new c(s,r.getIndexFor(t.by,t.id),t.by+"."+t.id+" foreignKeys."+n)}),n(t.manyToMany).each(function(t){t.indexName in d||(d[t.indexName]=[new c(s,null,"m2m."+t.indexName+"[0]"),new c(s,null,"m2m."+t.indexName+"[1]")]),t.indexName in p||(p[t.indexName]=new f(t,d[t.indexName]))})});var m=function(t,n,i,r){o.$post((n?y.reverse("/",t):t)+"s/list",{collection:i},function(n){o.gotData(n,r),delete e[t]})},g=function(t,i,o,r){n(i).each(d[t][o].ask.bind(d[t][o])),i=d[t][o].missings(),i.length?(e[t]=1,m(t,o,i,r)):r&&r()};this.getM2M=g;var v=function(){if(s.touched()){if(n(e).values().sum())return void s.touch();var t=!1;n(d).each(function(e,i){n(e).each(function(e,r){var s=e.missings();if(s=n(s).filter(Boolean).map(function(t){return parseInt(t)}).toArray(),s.length){var a=p[i],c=a["get"+(1-r)].bind(a);t=!0,m(i,r,s,function(t){var e=s.map(c);if(e.length){var a=i.split("/")[1-r];o.describe(a,function(){n(e).flatten().unique().each(function(t){u[a].ask(t,!0)})})}})}})}),n(u).each(function(e,r){var s=e.missings();if(s.length){t=!0;r in i?i[r].keys():n();o.fetch(r,{id:s},null,y.noop)}}),n(l).map(function(t,n){return[n,t.missings()]}).filter(function(t){return t[1].length}).each(function(n){t=!0;var e=n[1],i=n[0],r=i.split("."),s=r[0],a=r[1],c={};c[a]=e,o.fetch(s,c)}),n(n(h).map(function(t,n){return[n,t.missings()]}).filter(function(t){return t[1].length}).toObject()).each(function(i,r){t=!0,i.length&&(e[r]=1,o.$post(r+"/my_perms",{ids:n(i).unique().toArray()},function(t){o.gotPermissions(t.PERMISSIONS),delete e[r]}))})}};setInterval(v,50)}function l(){var t={},e={},i={},o=function(t,e,i){var o=[];if(i)for(var r in t)for(var s in e)o.push(n([t[r],e[s]]).flatten().toArray());else for(var r in t)for(var s in e)o.push([t[r],e[s]]);return o},r=function(t){for(var n=!1,e=t[0],i=1;i<t.length;++i)e=o(e,t[i],n),n=!0;return e},s=function(t){var e=r(n(t).values().toArray()),i=n(t).keys().toArray();return e.map(function(t){var n={};return i.forEach(function(e,i){n[e]=t[i]}),n})},a=function(t,e,i){var o=t.modelName,r=this.getIndexFor,s=(n(e).map(function(t,n){return[n,o+"."+n]}).toObject(),n(e).keys().map(function(t){return[t,r(o,t)]}).toObject());for(var a in e){var c=n(e[a]).difference(s[a]).toArray();if(c.length){var u=n([[a,c]]).toObject();return i||Array.prototype.push.apply(s[a],c),u}return null}},c=function(t,e){t.name in i||(i[t.name]=[]);var o=i[t.name],r=n(e).size();o.filter(y.makeFilter(t,e," && ",!0)).filter(function(t){n(t).size()>r})};this.filter=function(o,r){var u=o.modelName,l=n(r).size();switch(l){case 0:var f=t[u];return t[u]=!0,u in e&&delete e[u],u in i&&delete i[u],f?null:{};case 1:var d=a.call(this,o,r);return c.call(this,o,r),d}var p=this,h=n(r).keys().some(function(t){var n={};return n[t]=r[t],null==a.call(p,o,n,!0)});if(h)return null;u in i||(i[u]=[]);var m=s(r),g=i[u].filter(y.makeFilter(o,r," || ",!0));if(g.length){var v=[];for(var w in g)v.push.apply(v,m.filter(y.makeFilter(o,g[w]," && ",!0)));var b=n(m).difference(v).toArray()}else var b=m;if(b.length){i[u].push.apply(i[u],b);var b=n(r).keys().map(function(t){var e=n(b).pluck(t).unique().toArray();return[t,e.length?e:r[t]]}).toObject();return c(o,b),b}return null},this.getIndexFor=function(t,n){var i=t+"."+n;return i in e||(e[i]=[]),e[i]}}function f(t,e){var i=[];this.add=i.push.bind(i),this.add=function(t){console.log("adding "+t),n(i).find(t)||i.push(t)},this.get0=function(t){return e[1].ask(t),n(i).filter(function(n){return n[0]===t}).pluck("1").toArray()},this.get1=function(t){return e[0].ask(t),n(i).filter(function(n){return n[1]===t}).pluck("0").toArray()},this["get"+y.capitalize(t.indexName.split("/")[1])]=this.get1,this["get"+y.capitalize(t.indexName.split("/")[0])]=this.get0,this.del=function(t){for(var n=i.length,e=null,o=0;o<n;o++)if(i[o][0]===t[0]&&i[o][1]===t[1]){e=o;break}e&&i.splice(o,1),console.log("deleting ",t)}}function d(t,e,i,o){var r=Array.prototype.slice.call(arguments,4),s={};n(r).each(function(n){t.orm.on(n,function(){s={}})});var a={get:function(){return this.id in s||(s[this.id]=i.call(this)),s[this.id]}};o&&(a.set=function(t){t!==s[this.id]&&(o.call(this,t),this.id in s&&delete s[this.id])}),Object.defineProperty(t,e,a)}function p(t){this.resource=t._resource,this.formIdx=t.formIdx,this.fields=t.errors}function h(t,n){this.$orm=new w(new y.reWheelConnection(t,n),this),this.on=this.$orm.on.bind(this.$orm),this.emit=this.$orm.emit.bind(this.$orm),this.unbind=this.$orm.unbind.bind(this.$orm),this.addModelHandler=this.$orm.addModelHandler.bind(this.$orm),this.addPersistentAttributes=this.$orm.addPersistentAttributes.bind(this.$orm),this.utils=y}i.prototype.addHandler=function(t){var n=y.hash(t.toString());n in this.strHandlers||(this.strHandlers[n]=t,this.handlers.push(t))},i.prototype.handle=function(){var t=Array.prototype.slice.call(arguments,0);this.handlers.forEach(function(n){n.apply(null,t)})},i.prototype.handleBy=function(){var t=Array.prototype.slice.call(arguments,1),n=arguments[0];this.handlers.forEach(function(e){e.apply(n,t)})};var m=0,g=function(){return""},v=function(t,n,e,i,o){var r={accepts:"application/json",url:t,data:JSON.stringify(n),dataType:"json",success:e,error:i,method:"POST",contentType:"application/json"};return o&&(r.headers=o,r.crossDomain=!0),$.ajax(r)};s.prototype.status=function(t,n){if("lastRWTStatus"in localStorage&&!n){try{var e=JSON.parse(localStorage.lastRWTStatus);for(var i in e)this.options[i]=e[i]}catch(n){return this.status(t,!0)}return t&&t(e)}if(this._status_calling){var o=this;return setTimeout(function(){o.status(t)},50)}if(!this.options||!this.options.timestamp){this._status_calling=!0;var o=this;return this.$post("api/status",null,function(n){localStorage.lastRWTStatus=JSON.stringify(n),o._status_calling=!1;for(var e in n)o.options[e]=n[e];if(!n.user_id&&o.getLogin){var i=o.getLogin();i.constructor===Object&&o.login(i.username,i.password).then(function(n){for(var e in n)o.options[e]=n[e];localStorage.lastRWTStatus=JSON.stringify(n),t&&t(n)})}else t&&t(o.options)})}t&&t(this.options)},s.prototype.$post=function(t,n,e){var i=this;if(this.options&&this.options.token&&(n||(n={})),this.options.token){({token:this.options.token,application:this.options.application})}else;var o=new Promise(function(o,r){y.xdr(i.options.endPoint+t,n,i.options.application,i.options.token).then(function(r){i.events.emit("http-response",r.responseText,r.status,t,n),i.events.emit("http-response-"+r.status,r.responseText,t,n),r.responseData&&i.events.emit("http-response-"+r.status+"-json",r.responseData,t,n),e&&e(r.responseData||r.responseText),o(r.responseData||r.responseText)},function(e){e.responseData?(i.events.emit("error-json",e.responseData,e.status,t,n,e),i.events.emit("error-json-"+e.status,e.responseData,t,n,e)):(i.events.emit("error-http",e.responseText,e.status,t,n,e),i.events.emit("error-http-"+e.status,e.responseText,t,n,e)),r(e.responseData||e.responseText)})});return o},s.prototype.login=function(t,n){var e=this.options.endPoint+"api/login",i=this;return new Promise(function(o,r){y.xdr(e,{username:t,password:n},null,i.options.token,!0).then(function(t){var n=t.responseData;for(var e in n)i.options[e]=n[e];o(n)},function(t){r(t.responseData||responseText)})})},s.prototype.connect=function(t){var n=this,e=function(t){t.wsConnection=new y.wsConnect(t.options),t.wsConnection.onConnect(function(){t.events.emit("ws-connected",t.wsConnection)}),t.wsConnection.onDisconnect(function(){setTimeout(function(){e(t)},1e3)})};return this.status(function(i){"token"in n.options?t&&t(i):(console.log("connecting to "+n.options.endPoint),n.options.username&&n.options.password&&n.login(n.options.username,n.options.password,function(n){t&&t(n),console.log("renewing connection")})),i.token&&i.realtimeEndPoint&&!n.wsConnection&&e(n)})};var y={renameFunction:function(t,n){return new Function("return function (call) { return function "+t+" () { return call(this, arguments) }; };")()(Function.apply.bind(n))},cached:function(t,n){function e(){return this[n]||(this[n]=t.call(this,[arguments])),this[n]}return n||(n="_"+m++),e},$POST:v,reWheelConnection:s,log:function(){console.log(arguments)},xdr:function(t,e,i,o,r){return new Promise(function(i,s){var a;e||(e={}),XMLHttpRequest?(a=new XMLHttpRequest,a.onreadystatechange=function(){if(4===a.readyState){try{var t=JSON.parse(a.responseText)}catch(t){var t=null}var n={responseData:t,responseText:a.responseText,status:a.statusText,request:a};a.status>=200&&a.status<400?i(n):s(n)}}):XDomainRequest?(a=new XDomainRequest,a.onload=function(){i(a.responseText,a.statusText,a)}):s(new Error("CORS not supported")),a.open("POST",t,!0),a.onerror=s,a.setRequestHeader("Accept","application/json"),o&&(e.__token__=o),r?(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e=n(e).map(function(t,n){return n+"="+encodeURI(t.toString())}).toArray().join("&")):(a.setRequestHeader("Content-Type","text/plain"),e=n(e).size()?JSON.stringify(e):""),a.send(e)})},capitalize:function(t){return t[0].toUpperCase()+t.slice(1).toLowerCase()},hash:function(t){t=t.toString();for(var n=1,e=0;e<t.length;e++)n*=1+t.charCodeAt(e);return(n%34958374957).toString()},makeFilter:function(t,e,i,o){if(i||(i=" && "),0===n(e).size())return function(t){return!0};var r=n(e).map(function(e,i){return e||(e=[null]),Array.isArray(e)||(e=[e]),o||"reference"!==t.fields[i].type?"string"===t.fields[i].type&&(e=e.map(JSON.stringify)):(i="_"+i,e=n(e).map(function(t){return t&&t.constructor!==Number?t.id:t}).toArray()),"("+n(e).map(function(t){return"(x."+i+" === "+t+")"}).join(" || ")+")"}).toArray().join(i);return new Function("x","return "+r)},sameAs:function(t,n){for(var e in t)if(n[e]!=t[e])return!1;return!0},wsConnect:function(t){if(t){var n=this;this.handlers={wizard:new i,onConnection:new i,onDisconnection:new i,onMessageJson:new i,onMessageText:new i},this.onWizard=this.handlers.wizard.addHandler.bind(this.handlers.wizard),this.onConnect=this.handlers.onConnection.addHandler.bind(this.handlers.onConnection),this.onDisconnect=this.handlers.onDisconnection.addHandler.bind(this.handlers.onDisconnection),this.onMessageJson=this.handlers.onMessageJson.addHandler.bind(this.handlers.onMessageJson),this.onMessageText=this.handlers.onMessageText.addHandler.bind(this.handlers.onMessageText),this.options=t;var o=new e(t.realtimeEndPoint);o.onopen=function(t){console.log("open : "+t),o.tenant(),n.handlers.onConnection.handle(t)},o.onmessage=function(t){if("message"==t.type)try{n.handlers.onMessageJson.handle(JSON.parse(t.data))}catch(e){n.handlers.onMessageText.handle(t.data)}else console.log(t)},o.onclose=function(){setTimeout(y.wsConnect,1e3),n.handlers.onDisconnection.handle()},o.tenant=function(){o.send("TENANT:"+n.options.application+":"+n.options.token)}}},pluralize:function(t,n){return t+"s"},beforeCall:function(t,n){var e=function(){n().then(t)};return e},cleanStorage:function(){n(localStorage).keys().each(function(t){delete localStorage[t]})},reverse:function(t,n){return n.split(t).reverse().join(t)},permutations:function(t){for(var n=[],e=t.length-1;e>=0;e--)for(var i=t.length-1;i>=0;i--)e!==i&&n.push([t[e],t[i]]);return n},bool:Boolean,noop:function(){},tzOffset:6e4*(new Date).getTimezoneOffset(),transFieldType:{date:function(t){return new Date(1e3*t+y.tzOffset)},datetime:function(t){return new Date(1e3*t+y.tzOffset)},string:function(t){return t.toString()},text:function(t){return t.toString()},integer:function(t){return parseInt(t)},float:function(t){return parseFloat(t)}},mock:r},w=function(t,e){function o(t,n,e){this.klass=n,this.permissions=[],this.id=t;for(var i in e)this.push.apply(this,[i,e[i]])}if(t.constructor===String)var r=new s(t);else if(t.constructor===y.reWheelConnection)var r=t;this.connection=r,r.on("connected",function(){this.connected=!0});var a=r.events;this.on=a.on.bind(this),this.emit=a.emit.bind(this),this.unbind=a.unbind.bind(this),this.$post=r.$post.bind(r),a.on("ws-connected",function(t){console.info("Websocket connected"),t.onMessageJson(c.gotData.bind(c)),t.onMessageText(function(t){console.info("WS message : "+t)})}),a.on("ws-disconnected",function(t){console.error("Websocket disconnected")}),a.on("error-json-404",function(t,n,e,i){console.error("JSON error ",JSON.stringify(t)),delete N[n.split("/")[0]]});var c=this,f={auth_group:n({})},h={},m={},g={},v={},w={},b={},N={},A=new l(n),x=new u(a,N,f,this,A);this.validationEvent=a.on("error-json-513",function(t,n,e,i){currentContext.savingErrorHanlder&&currentContext.savingErrorHanlder(new p(t))});var S=function(t){return t in f?f[t]:(f[t]=n({}),f[t])},O=function(t){return t in UNLINKED?UNLINKED[t]:(UNLINKED[t]={},UNLINKED[t])};o.prototype.save=function(t){var e={permissions:n(this.permissions).map(function(t){return[t[0].id,t[1]]}).toObject()};e.id=this.id;this.klass.modelName;c.$post(this.klass.modelName+"/set_permissions",e,function(n,e,i,o){t(n)})},o.prototype.push=function(t,e){var i=n(e),o=n(this.klass.allPermissions).map(function(t){return[t,i.contains(t)]}).toObject(),r=n(this.permissions).map(function(t){return t[0].id});r.contains(t)?this.permissions[r.indexOf(t)][1]=o:this.permissions.push([f.auth_group.get(t),o])};var T=function(t){var i=n(t.fields);t.privateArgs&&(i=i.merge(t.privateArgs)),c.emit("model-definition",t);var r="if (!row) { row = {}};\n";r+=t.references.map(function(t){return"this._"+t.id+" = row."+t.id+";"}).join(";\n"),r+=i.map(function(t,n){return"date"==t.type||"datetime"==t.type?"this."+n+" = row."+n+"?new Date(row."+n+" * 1000 - "+y.tzOffset+"):null;\n":"boolean"==t.type?"this."+n+" = (row."+n+' === "T") || (row.'+n+" === true);\n":"this."+n+" = row."+n+";\n"}).toString("\n"),r+="if (permissions) {this._permissions = permissions && Lazy(permissions).map(function (x) { return [x, true] }).toObject();}";var s=new Function("row","permissions",r);s.prototype.orm=e,s.ref_translations={},s.modelName=t.name,s.references=n(t.references).pluck("id").toArray(),s.inverse_references=t.referencedBy.map(function(t){return t.by+"_"+t.id+"_set"}),s.referents=t.referencedBy.map(function(t){return[t.by,t.id]}),s.fieldsOrder=t.fieldOrder,s.allPermissions=t.permissions,n(t.representation).size()&&(s.prototype.toString=new Function("return this."+n(t.representation).toString(' + " " + this.'))),s.prototype.toUpperCase=function(){return this.toString().toUpperCase()},s.prototype.toLowerCase=function(){return this.toString().toLowerCase()},s.prototype.delete=function(){return e.delete(this.constructor.modelName,[this.id])},Object.defineProperty(s.prototype,"permissions",{get:function(){return this._permissions?this._permissions:void x.permissions[this.constructor.modelName].ask(this.id)}}),s.prototype.all_perms=function(t){var e=this.id;c.$post(this.constructor.modelName+"/all_perms",{id:this.id},function(i){var r=i,a={},u=n(r).pluck("group_id").unique().map(function(t){return""+t}).difference(f.auth_group.keys()).toArray();n(r).groupBy(function(t){return t.group_id}).each(function(t,e){a[e]=n(t).pluck("name").toArray()});var l=function(n){t(new o(e,s,a))};u.length?c.get("auth_group",u,l):l()})},s.prototype.save=function(t){var e=this.asRaw(),i=s.fields,o=this.id,r=this.constructor.modelName;if(t)for(var a in t)e[a]=t[a];n(s.fieldsOrder).filter(function(t){return!i[t].writable}).each(function(t){t in e&&delete e[t]});var u=c.$post(r+(o?"/post":"/put"),e);return t&&t.constructor===Function&&(u.context.savingErrorHanlder=t),u},s.prototype.copy=function(){var t=new this.constructor(this.asRaw());return t._permissions=this._permissions,t};var u="return {\n"+n(t.references).map(function(t){return t.id+" : this._"+t.id}).concat(i.map(function(t,n){return"date"==t.type||"datetime"==t.type?n+" : (this."+n+"?(Math.round(this."+n+".getTime() - this."+n+".getTimezoneOffset() * 60000) / 1000):null)":"boolean"==t.type?n+" : this."+n+'?"T":"F"':n+" : this."+n})).toString(",\n")+"};";s.prototype.asRaw=new Function(u),s.saveMulti=function(t,e,i){var o=[],r=n(s.fields).filter(function(t){return!t.writable}).pluck("id").toArray();n(t).map(function(t){return t.asRaw()}).each(function(t){n(r).each(function(n){delete t[n]}),o.push(t)}),c.$post(s.modelName,"put",{multiple:o,formIdx:c.formIdx++},function(t){c.gotData(t);var i=f[s.modelName],o=n(t[s.modelName].results).pluck("id").map(function(t){return i.get(t)}).toArray();e&&e(o)},i)},"extra_verbs"in t&&n(t.extra_verbs).each(function(t){var e=t[0],i=t[1],o="data = {id : this.id";i.length&&(o+=", "+n(i).map(function(t){return t+" : "+t}).join(",")),o+="};",i.push("cb"),s.prototype[e]=new Function(i,o+'W2S.W2P_POST(this.constructor.modelName,"'+e+'", data,function(data,status,headers,x){try{\n   if (!headers("nomodel")) {window.W2S.gotData(data,cb);}\n   else {if (cb) {cb(data)}}\n} catch(e){\nif (cb) {cb(data);}\n}\n});\n')}),"privateArgs"in t&&(s.privateArgs=n(t.privateArgs).keys().map(function(t){return[t,!0]}).toObject(),s.prototype.savePA=function(t){var e=this,i={id:this.id},o=this.constructor.privateArgs,r=this.constructor.fields,s=(new this.constructor(t).asRaw(),n(o).keys().map(function(t){return[t,r[t]]}).toObject());n(t).each(function(t,n){n in o&&s[n].writable&&(i[n]=t)}),c.$post(this.constructor.modelName+"/savePA",i,function(){n(i).each(function(t,n){e[n]=t})})}),w[s.modelName]=s;for(var l in t.fields)t.fields[l].id=l;return s.fields=n(t.fields).concat(n(t.privateArgs)).concat(n(t.references).tap(function(t){t.type=t.type||"reference"})).indexBy("id").toObject(),n(s.fields).each(function(t){t.widget||("reference"===t.type?t.widget="choices":t.widget=t.type)}),n(t.references).each(function(t){var n=t.to,i="_"+t.id;d(s.prototype,t.id,function(){if(!(n in f)){var t=this;c.describe(n,function(e){x.mainIndex[n].ask(t[i],!0)})}var e=n in f&&this[i]&&f[n].get(this[i]);return!e&&n in x.mainIndex?(x.mainIndex[n].ask(this[i],!0),y.mock()):e},function(e){if(e&&e.constructor.modelName!=n)throw new TypeError("You can assign only "+n+" to "+t.id);this[i]=e.id},"new-"+n,"deleted-"+n,"updated-"+n,"new-model-"+n),s.prototype["get"+y.capitalize(t.id)]=function(){return e.get(n,this[i])}}),n(t.referencedBy).each(function(t){var n=t.by+"."+t.id,i=t.by+"_"+y.pluralize(t.id),o=t.by;s.prototype.hasOwnProperty(i)?$log.error("Tryed to redefine property "+i+"s for "+s.modelName):d(s.prototype,i,function(){var t=o in f?h[n].get(this.id+""):null;return x.foreignKeys[n].ask(this.id,!0),t},null,"new-"+o,"updated-"+o,"deleted-"+o),s.prototype["get"+y.capitalize(y.pluralize(t.by))]=function(){var n={};return n[t.id]=[this.id],e.query(t.by,n)}}),t.manyToMany&&(n(t.manyToMany).each(function(t){var e=t.indexName,i=t.first?0:1,o=t.model,r=x.m2mIndex[e]["get"+(1-i)];d(s.prototype,t.model+"s",function(){var t=this,e=[],i=r(t.id),s=null;return i.length&&(s=S(o).get.bind(f[o])),i&&s&&(e=n(i).map(s).filter(y.bool).toArray()),e},null,"received-m2m-"+e,"received-"+o),s.prototype["get"+y.capitalize(y.pluralize(o))]=function(){var t=this;return new Promise(function(s,a){try{x.getM2M(e,[t.id],i,function(e){var i=r(t.id);i.length?c.fetch(o,{id:i},null,function(){var t=f[o].get.bind(f[o]);s(n(i).map(t).filter(y.bool).toArray())}):s([])})}catch(t){console.error(t),a(t)}})},s.fields[y.capitalize(o)]={id:y.capitalize(o),name:y.capitalize(o),writable:!0,readable:!0,type:"M2M",validators:[]}}),s.prototype.unlinkReference=function(t){var e=!1,i=this.id,o=[];"Array"==t.constructor.name&&(e=!0,o=t,t=o[0]);var r=t.constructor.modelName;if(e)var a=n(o).pluck("id").map(function(t){return[i,t]}).toArray();else var a=[[i,t.id]];c.$post(s.modelName+"/"+r+"s/delete",{collection:a})},s.prototype.linkReference=function(t){var e=!1,i=this.id,o=[];"Array"==t.constructor.name&&(e=!0,o=t,t=o[0]);var r=t.constructor.modelName,a=s.modelName+"/"+r;if(e){var u=[];if(a in INDEX_M2M&&(u=n(o).pluck("id").difference(n(INDEX_M2M[a][0].get(this.id))).toArray()),a=r+"/"+s.modelName,a in INDEX_M2M&&(u=n(o).pluck("id").difference(n(INDEX_M2M[a][0].get(this.id))).toArray()),u.length){var l=n(u).map(function(t){return[i,t]}).toArray();W2P_POST(s.modelName,r+"s/put",{collection:l},function(t){})}}else{if(a in x.m2mIndex&&n(x.m2mIndex[a]["get"+y.capitalize(r)](t.id)).find(this))return;c.$post(s.modelName+"/"+r+"s/put",{collection:[[this.id,t.id]]})}}),a.emit("new-model",s),a.emit("new-model-"+s.modelName),s};this.gotData=function(t,e){if(console.info("gotData"),"string"!=typeof t){"_extra"in t&&delete t._extra;var i=t.TOONE,o=t.TOMANY,r=t.MANYTOMANY,s=t.PERMISSIONS,u=t.PA;if(delete t.TOONE,delete t.TOMANY,delete t.MANYTOMANY,delete t.PERMISSIONS,delete t.PA,u||(u={}),t=n(t).filter(function(t,n){return!("deleted"in t)||n in w}).toObject(),"m2m"in t){var l=t.m2m;delete t.m2m}n(t).each(function(t,e){c.describe(e,function(i){var o=i;t.results&&t.results.length>0&&t.results[0].constructor==Array&&(t.results=n(t.results).map(function(t){return n(o.fieldsOrder).zip(t).toObject()}).toArray());var r=n(t.results),s=t.deleted;if(e in u){var c=u[e];n(r).each(function(t){t.id in c&&n(c[t.id]).each(function(n,e){t[e]=n})})}var l=S(e),d=l.source;s&&s.forEach(function(t){delete d[t]});var p=r.indexBy("id"),m=p.keys(),g=m.difference(l.keys().map(function(t){return parseInt(t)})),v=m.difference(g);v=v.filter(function(t){return!y.sameAs(p.get(t),l.get(t).asRaw())});var b=n(t.permissions?t.permissions:{}),N=g.map(function(t){return new o(p.get(t),b.get(t))}),A=[];v.each(function(t){var e=l.get(t),r=e.copy(),s=new o(p.get(t));n(i.fields).keys().each(function(t){e[t]=s[t]}),A.push([e,r])}),A.length&&a.emit("updated-"+e,A);var x=N.toArray();n(x).each(function(t){d[t.id]=t}),n(w[e].references).each(function(t){h[e+"."+t]=f[e].groupBy("_"+t)}),x.length&&a.emit("new-"+e,n(x),t.totalResults),s&&a.emit("deleted-"+e,s),a.emit("received-"+e)})}),i&&(console.error("TOONE"),n(i).each(function(t,n){console.log(n);O(n)})),o&&(console.error("TOMANY"),n(o).each(function(t,e){e in ASKED_UNLINKED||(ASKED_UNLINKED[e]=n([])),n(t).each(function(t){ASKED_UNLINKED[e].source.push(t)})})),r&&(console.error("MANYTOMANY"),n(r).each(function(t,e){var i=parseInt(e.split("|")[1]);e=e.split("|")[0],e in ASKED_M2M||(ASKED_M2M[e]=[{},{}]);var o=ASKED_M2M[e][i];n(t).each(function(t){o[t+""]=!0,o[t]=!0})})),l&&c.gotM2M(l),s&&c.gotPermissions(s),e&&e(t),a.emit("got-data")}else if(console.log("data "+t+" refused from gotData()"),e)return e(t)},this.gotPermissions=function(t){n(t).each(function(t,e){n(t[0]).each(function(t,i){e in f&&i in f[e].source&&(f[e].get(i)._permissions=n(t).map(function(t){return[t,!0]}).toObject())}),n(t[0]).size()&&c.emit("update-permissions-"+e,n(t[0]).keys().toArray())}),this.emit("update-permissions")},this.gotM2M=function(t){n(t).each(function(t,e){var i=x.m2mIndex[e];n(t).each(function(t){n(t).each(function(t,n){i[n](t)})}),a.emit("received-m2m"),a.emit("received-m2m-"+e)})},this.fetch=function(t,n,e,i){t in N?setTimeout(function(){c.fetch(t,n,e,i)},500):c.describe(t,function(e){return c.connection.options.realtimeEndPoint?(n=A.filter(e,n),n?(N[t]=!0,c.$post(t+"/list",{filter:n},function(n){c.gotData(n,i),delete N[t]},function(){delete N[t]})):i&&i(),n):void this.$post(t+"/list",sendData,function(e){n||GOT_ALL.source.push(t),c.gotData(e,i)})})},this.get=function(t,n,e){n.constructor!==Array&&(n=[n]),c.fetch(t,{id:n},null,function(){var i=[],o=f[t];for(var r in n)i.push(o.source[n[r]]);e(i)})},this.gotModel=function(t){for(var e in t){var i=t[e];localStorage["description:"+e]=JSON.stringify(t),w[e]=T(i),e in f||(f[e]=n({}))}},this.describe=function(t,n){var e=w[t];if(e)n&&n(e);else if(t in N)setTimeout(function(){c.describe(t,n)},500);else{if(t in b)return;var i="description:"+t;i in localStorage?(this.gotModel(JSON.parse(localStorage[i])),n&&n(w[t])):(N[t]=!0,this.$post(t+"/describe",null,function(e){c.gotModel(e),n&&n(w[t]),delete N[t]},function(n){this.events.modelNotFound.handle(t),b[t]=!0}))}},this.addModelHandler=function(t,n){var e=y.hash(n);t in m||(m[t]=new i),t in g||(g[t]={}),e in g[t]||(g[t][e]=!0,t in w?n(w[t]):m[t].addHandler(n))},this.addPersistentAttributes=function(t,e){var i=function(t,n){n.forEach(function(n){var e="pA:"+t.modelName+":"+n,i="__"+n;Object.defineProperty(t.prototype,n,{get:function(){if(!(i in this)){var t=localStorage[e+this.id];this[i]=t?JSON.parse(t):null}return this[i]},set:function(t){this[i]=t,localStorage[e+this.id]=JSON.stringify(t)}})})};t in v||(v[t]=[]);var o=v[t];if(e)var r=n(e).difference(o).toArray();else var r=o;r.length&&(t in w&&i(w[t],r),e&&Array.prototype.push.apply(o,r))},this.on("new-model",function(t){t.modelName in m&&m[t.modelName].handle(w[t.modelName]),t.modelName in v&&c.addPersistentAttributes(t.modelName)}),this.connect=function(t){this.isConnected?t(this.connection.options):this.connection.connect(function(n){c.isConnected=!0,t(n)})},this.query=function(t,e,i,o){var r=this;this.describe(t,function(s){e=n(e).map(function(t,n){return[n,Array.isArray(t)?t:[t]]}).toObject();var a=y.makeFilter(s,e),c=S(t);r.fetch(t,e,i,function(t){o(c.filter(a).values().toArray())})})},this.delete=function(t,n,e){return this.$post(t+"/delete",{id:n},e)}};h.prototype.getModel=function(t){var n=this;return new Promise(function(e,i){try{n.$orm.connect(function(){n.$orm.describe(t,e)})}catch(t){i(t)}})},h.prototype.get=function(t,n){var e=this,i=!1,o=t;return n.constructor!==Array&&(i=!0,n=[n]),new Promise(function(t,r){try{e.$orm.connect(function(){i?e.$orm.get(o,n,function(n){t(n[0])}):e.$orm.get(o,n,t)})}catch(t){r(t)}})},h.prototype.query=function(t,n,e){var i=this;return new Promise(function(o,r){var s=null;e&&e.constructor===Array&&e.length?s=e:e&&e.constructor===String&&e.length&&(s=e.split(","));try{i.$orm.isConnected?i.$orm.query(t,n,s,o):i.$orm.connect(function(){i.$orm.query(t,n,s,o)})}catch(t){r(t)}})},h.prototype.delete=function(t,n){var e=this;return new Promise(function(i,o){try{e.$orm.connected?e.$orm.delete(t,n,i):e.$orm.connect(function(){e.$orm.delete(t,n,i)})}catch(t){o(t)}})},h.prototype.$sendToEndpoint=function(t,n){return this.$orm.$post(t,n)},t.rwt=h}(window,Lazy,SockJS);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhbmRsZXJzLmpzIiwidXRpbHMuanMiLCJ0b3VjaGVyLmpzIiwidmFjdXVtY2FjaGVyLmpzIiwiYXV0b2xpbmtlci5qcyIsImxpc3RjYWNoZXIuanMiLCJtYW55dG9tYW55LmpzIiwiY2FjaGVyLmpzIiwib3JtLmpzIl0sIm5hbWVzIjpbIkhhbmRsZXIiLCJ0aGlzIiwiaGFuZGxlcnMiLCJzdHJIYW5kbGVycyIsIk5hbWVkRXZlbnRNYW5hZ2VyIiwiZXZlbnRzIiwiaGFuZGxlcklkIiwiaWR4SWQiLCJvbiIsIm5hbWUiLCJmdW5jIiwiQXJyYXkiLCJpZCIsInB1c2giLCJlbWl0IiwiYXJncyIsInByb3RvdHlwZSIsInNsaWNlIiwiY2FsbCIsImFyZ3VtZW50cyIsImZvckVhY2giLCJldmVudCIsImFwcGx5IiwidW5iaW5kIiwiaGFuZGxlciIsImNvdW50IiwiTGF6eSIsImVhY2giLCJ2IiwiayIsImlkeCIsIm4iLCJyZXZlcnNlIiwieCIsInNwbGljZSIsIm1vY2tPYmplY3QiLCJQcm94eSIsImdldCIsInRhcmdldCIsIm51bGxTdHJpbmciLCJyZVdoZWVsQ29ubmVjdGlvbiIsImVuZFBvaW50IiwiZ2V0TG9naW4iLCIkUE9TVCIsImJpbmQiLCJvcHRpb25zIiwiVG91Y2hlciIsInRvdWNoZWQiLCJ0b3VjaCIsInQiLCJWYWN1dW1DYWNoZXIiLCJhc2tlZCIsIm1pc3NpbmciLCJhc2siLCJsYXp5IiwiY29udGFpbnMiLCJnZXRBc2tlZEluZGV4IiwibWlzc2luZ3MiLCJsZW5ndGgiLCJ1bmlxdWUiLCJ0b0FycmF5IiwiQXV0b0xpbmtlciIsImFjdGl2ZXMiLCJJREIiLCJXMlBSRVNPVVJDRSIsImxpc3RDYWNoZSIsIm1haW5JbmRleCIsImZvcmVpZ25LZXlzIiwibTJtIiwibTJtSW5kZXgiLCJwZXJtaXNzaW9ucyIsIm1vZGVsIiwicGtJbmRleCIsImdldEluZGV4Rm9yIiwicmVmZXJlbmNlcyIsInJlZmVyZW5jZSIsImluZGV4TmFtZSIsInRvIiwicmVmZXJlbmNlZEJ5IiwiZmllbGQiLCJieSIsIm1hbnlUb01hbnkiLCJyZWxhdGlvbiIsIk1hbnlUb01hbnlSZWxhdGlvbiIsIm0ybUdldCIsImNvbGxlY3Rpb24iLCJjYWxsQmFjayIsIiRwb3N0IiwidXRpbHMiLCJkYXRhIiwiZ290RGF0YSIsImdldE0yTSIsImxpbmtVbmxpbmtlZCIsInZhbHVlcyIsInN1bSIsImNoYW5nZWQiLCJpbmRleGVzIiwiaW5kZXgiLCJmaWx0ZXIiLCJCb29sZWFuIiwibWFwIiwicGFyc2VJbnQiLCJJTkRFWCIsImdldHRlciIsImlkcyIsIm90aGVySW5kZXgiLCJzcGxpdCIsImRlc2NyaWJlIiwiZmxhdHRlbiIsIm1vZGVsTmFtZSIsImtleXMiLCJmZXRjaCIsIm5vb3AiLCJtYWluUmVzb3VyY2UiLCJmaWVsZE5hbWUiLCJ0b09iamVjdCIsInJlc291cmNlTmFtZSIsImdvdFBlcm1pc3Npb25zIiwiUEVSTUlTU0lPTlMiLCJzZXRJbnRlcnZhbCIsIkxpc3RDYWNoZXIiLCJnb3RBbGwiLCJjb21wb3NpdGVBc2tlZCIsImNhcnRlc2lhblByb2R1Y3QxIiwieSIsImlzQXJyYXkiLCJyZXQiLCJhIiwiYiIsImNhcnRlc2lhblByb2R1Y3QiLCJhcnIiLCJleHBsb2RlRmlsdGVyIiwicHJvZHVjdCIsInIiLCJmaWx0ZXJTaW5nbGUiLCJ0ZXN0T25seSIsImtleSIsImRpZmZlcmVuY2UiLCJjbGVhbkNvbXBvc2l0ZXMiLCJmaWx0ZXJMZW4iLCJzaXplIiwibWFrZUZpbHRlciIsIml0ZW0iLCJnb3QiLCJ0aHMiLCJzaW5nbGUiLCJzb21lIiwiZiIsImV4cGxvZGVkIiwicGFydGlhbHMiLCJiYWQiLCJwbHVjayIsIml0ZW1zIiwiYWRkIiwiY29uc29sZSIsImxvZyIsImZpbmQiLCJnZXQwIiwiZ2V0MSIsImNhcGl0YWxpemUiLCJkZWwiLCJsIiwiY2FjaGVkUHJvcGVydHlCeUV2ZW50cyIsInByb3RvIiwicHJvcGVydHlOYW1lIiwic2V0dGVyIiwicmVzdWx0Iiwib3JtIiwicHJvcGVydHlEZWYiLCJ2YWx1ZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiVmFsaWRhdGlvbkVycm9yIiwicmVzb3VyY2UiLCJfcmVzb3VyY2UiLCJmb3JtSWR4IiwiZmllbGRzIiwiZXJyb3JzIiwicmVXaGVlbE9STSIsImxvZ2luRnVuYyIsIiRvcm0iLCJiYXNlT1JNIiwiYWRkTW9kZWxIYW5kbGVyIiwiYWRkUGVyc2lzdGVudEF0dHJpYnV0ZXMiLCJhZGRIYW5kbGVyIiwic3RySGFuZGxlciIsImhhc2giLCJ0b1N0cmluZyIsImhhbmRsZSIsImhhbmRsZUJ5IiwiY2FjaGVkS2V5SWR4IiwidXJsIiwiZXJyb3JCYWNrIiwiaGVhZGVycyIsIm9wdHMiLCJhY2NlcHRzIiwiSlNPTiIsInN0cmluZ2lmeSIsImRhdGFUeXBlIiwic3VjY2VzcyIsImVycm9yIiwibWV0aG9kIiwiY29udGVudFR5cGUiLCJjcm9zc0RvbWFpbiIsIiQiLCJhamF4Iiwic3RhdHVzIiwiZm9yY2UiLCJsb2NhbFN0b3JhZ2UiLCJwYXJzZSIsImxhc3RSV1RTdGF0dXMiLCJlIiwiX3N0YXR1c19jYWxsaW5nIiwic2VsZiIsInNldFRpbWVvdXQiLCJ0aW1lc3RhbXAiLCJ1c2VyX2lkIiwibG9nSW5mbyIsImNvbnN0cnVjdG9yIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidGhlbiIsInRva2VuIiwiYXBwbGljYXRpb24iLCJwcm9taXNlIiwiUHJvbWlzZSIsImFjY2VwdCIsInJlamVjdCIsInhkciIsInhociIsInJlc3BvbnNlVGV4dCIsInJlc3BvbnNlRGF0YSIsImNvbm5lY3Rpb24iLCJjb25uZWN0Iiwid3Njb25uZWN0Iiwid3NDb25uZWN0aW9uIiwid3NDb25uZWN0Iiwib25Db25uZWN0Iiwib25EaXNjb25uZWN0IiwicmVhbHRpbWVFbmRQb2ludCIsInJlbmFtZUZ1bmN0aW9uIiwiZm4iLCJGdW5jdGlvbiIsImNhY2hlZCIsIndyYXBwZXIiLCJmb3JtRW5jb2RlIiwicmVxIiwiWE1MSHR0cFJlcXVlc3QiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwicmVzcG9uc2UiLCJzdGF0dXNUZXh0IiwicmVxdWVzdCIsIlhEb21haW5SZXF1ZXN0Iiwib25sb2FkIiwiRXJyb3IiLCJvcGVuIiwib25lcnJvciIsInNldFJlcXVlc3RIZWFkZXIiLCJfX3Rva2VuX18iLCJlbmNvZGVVUkkiLCJqb2luIiwic2VuZCIsInMiLCJ0b1VwcGVyQ2FzZSIsInRvTG93ZXJDYXNlIiwic3RyIiwiY2hhckNvZGVBdCIsInVuaWZpZXIiLCJkb250VHJhbnNsYXRlRmlsdGVyIiwic291cmNlIiwidmFscyIsInR5cGUiLCJOdW1iZXIiLCJzYW1lQXMiLCJ3aXphcmQiLCJvbkNvbm5lY3Rpb24iLCJvbkRpc2Nvbm5lY3Rpb24iLCJvbk1lc3NhZ2VKc29uIiwib25NZXNzYWdlVGV4dCIsIm9uV2l6YXJkIiwiU29ja0pTIiwib25vcGVuIiwidGVuYW50Iiwib25tZXNzYWdlIiwib25jbG9zZSIsInBsdXJhbGl6ZSIsImJlZm9yZUNhbGwiLCJiZWZvcmUiLCJkZWNvcmF0b3IiLCJjbGVhblN0b3JhZ2UiLCJjaHIiLCJwZXJtdXRhdGlvbnMiLCJib29sIiwidHpPZmZzZXQiLCJEYXRlIiwiZ2V0VGltZXpvbmVPZmZzZXQiLCJ0cmFuc0ZpZWxkVHlwZSIsImRhdGUiLCJkYXRldGltZSIsInN0cmluZyIsInRleHQiLCJpbnRlZ2VyIiwiZmxvYXQiLCJwYXJzZUZsb2F0IiwibW9jayIsImV4dE9STSIsIlBlcm1pc3Npb25UYWJsZSIsImtsYXNzIiwiU3RyaW5nIiwiY29ubmVjdGVkIiwid3MiLCJpbmZvIiwibWVzc2FnZSIsInNlbnREYXRhIiwid2FpdGluZ0Nvbm5lY3Rpb25zIiwiYXV0aF9ncm91cCIsIlJFVklEWCIsImJ1aWxkZXJIYW5kbGVycyIsImJ1aWxkZXJIYW5kbGVyVXNlZCIsInBlcnNpc3RlbnRBdHRyaWJ1dGVzIiwibW9kZWxDYWNoZSIsImZhaWxlZE1vZGVscyIsImxpbmtlciIsInZhbGlkYXRpb25FdmVudCIsImN1cnJlbnRDb250ZXh0Iiwic2F2aW5nRXJyb3JIYW5sZGVyIiwiZ2V0SW5kZXgiLCJnZXRVbmxpbmtlZCIsIlVOTElOS0VEIiwic2F2ZSIsImNiIiwibXlQZXJtcyIsImdyb3VwX2lkIiwicGVybWlzc2lvbkxpc3QiLCJwIiwicGVybXMiLCJhbGxQZXJtaXNzaW9ucyIsImluZGV4T2YiLCJtYWtlTW9kZWxDbGFzcyIsInByaXZhdGVBcmdzIiwibWVyZ2UiLCJmdW5jU3RyaW5nIiwiS2xhc3MiLCJyZWZfdHJhbnNsYXRpb25zIiwiaW52ZXJzZV9yZWZlcmVuY2VzIiwicmVmZXJlbnRzIiwiZmllbGRzT3JkZXIiLCJmaWVsZE9yZGVyIiwicmVwcmVzZW50YXRpb24iLCJkZWxldGUiLCJfcGVybWlzc2lvbnMiLCJhbGxfcGVybXMiLCJvYmplY3RfaWQiLCJncm91cGVkIiwidW5rbm93bl9ncm91cHMiLCJncm91cEJ5IiwibyIsImFzUmF3IiwiSUQiLCJhcmciLCJ3cml0YWJsZSIsImNvbnRleHQiLCJjb3B5Iiwib2JqIiwiYXNyIiwiY29uY2F0Iiwic2F2ZU11bHRpIiwib2JqZWN0cyIsInNjb3BlIiwicmF3IiwiZGVsZXRhYmxlIiwibXVsdGlwbGUiLCJlbGVtcyIsInRhYiIsIm9ianMiLCJyZXN1bHRzIiwiZXh0cmFfdmVyYnMiLCJmdW5jTmFtZSIsImRkYXRhIiwic2F2ZVBBIiwiVCIsIm9vIiwiUEEiLCJGcyIsImZpZWxkSWR4IiwidGFwIiwiaW5kZXhCeSIsIndpZGdldCIsInJlZiIsImV4dF9yZWYiLCJsb2NhbF9yZWYiLCJUeXBlRXJyb3IiLCJyZXZJbmRleCIsImhhc093blByb3BlcnR5IiwiJGxvZyIsInF1ZXJ5IiwiZmlyc3QiLCJvbW9kZWxOYW1lIiwicmVhZGFibGUiLCJ2YWxpZGF0b3JzIiwidW5saW5rUmVmZXJlbmNlIiwiaW5zdGFuY2UiLCJpbnN0YW5jZXMiLCJvbW9kZWwiLCJsaW5rUmVmZXJlbmNlIiwicmVmcyIsIklOREVYX00yTSIsIlcyUF9QT1NUIiwiX2V4dHJhIiwiVE9PTkUiLCJUT01BTlkiLCJNQU5ZVE9NQU5ZIiwibW9kZWxDbGFzcyIsInppcCIsImRlbGV0ZWQiLCJNUEEiLCJyZWNvcmQiLCJpdGFiIiwidGFibGUiLCJpayIsIm5uZXciLCJ1cGRhdGVkIiwibmV3T2JqZWN0cyIsIm9sZEl0ZW0iLCJvbGRDb3B5IiwibmV3SXRlbSIsIm5vIiwidG90YWxSZXN1bHRzIiwiQVNLRURfVU5MSU5LRUQiLCJBU0tFRF9NMk0iLCJNSURYIiwiZ290TTJNIiwicm93IiwibSIsInZlcmIiLCJ0b2dldGhlciIsInNlbmREYXRhIiwiR09UX0FMTCIsImdvdE1vZGVsIiwiY2FjaGVLZXkiLCJtb2RlbE5vdEZvdW5kIiwiYXR0cmlidXRlcyIsImFkZFByb3BlcnR5IiwidmFsIiwia2F0dHIiLCJzZXQiLCJhdHRycyIsIm5ld0F0dHJzIiwiaXNDb25uZWN0ZWQiLCJmaWx0ZXJGdW5jdGlvbiIsImdldE1vZGVsIiwibW9kTmFtZSIsInJlbGF0ZWQiLCIkc2VuZFRvRW5kcG9pbnQiXSwibWFwcGluZ3MiOiI2QkFFQSxTQUFBQSxLQUNBQyxLQUFBQyxZQUNBRCxLQUFBRSxlQXlCQSxRQUFBQyxLQUNBLEdBQUFDLE1BQ0FDLEtBQ0FDLEVBQUEsQ0FDQU4sTUFBQU8sR0FBQSxTQUFBQyxFQUFBQyxHQUNBRCxJQUFBSixLQUNBQSxFQUFBSSxHQUFBLEdBQUFFLE9BRUEsSUFBQUMsR0FBQUwsR0FHQSxPQUZBRixHQUFBSSxHQUFBSSxLQUFBSCxHQUNBSixFQUFBTSxHQUFBRixFQUNBRSxHQUVBWCxLQUFBYSxLQUFBLFNBQUFMLEdBQ0EsR0FBQUEsSUFBQUosR0FBQSxDQUNBLEdBQUFVLEdBQUFKLE1BQUFLLFVBQUFDLE1BQUFDLEtBQUFDLFVBQUEsRUFDQWQsR0FBQUksR0FBQVcsUUFBQSxTQUFBQyxHQUNBQSxFQUFBQyxNQUFBLEtBQUFQLE9BSUFkLEtBQUFzQixPQUFBLFNBQUFDLEdBQ0EsR0FBQUMsR0FBQSxDQUNBLElBQUFELElBQUFsQixHQUFBLENBQ0EsR0FBQUksR0FBQUosRUFBQWtCLEVBQUEs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QUFBaEIsR0FDQWlCLEVBQUFqQixPQUtBakMsRUFBQWxLLFVBQUF1YixnQkFBQSxTQUFBeFEsRUFBQXRHLEdBQ0EsTUFBQXhGLE1BQUFtTCxLQUFBN0YsTUFBQXdHLEVBQUF0RyIsImZpbGUiOiJyd3QubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBIYW5kbGVyKCl7XG4gICAgdGhpcy5oYW5kbGVycyA9IFtdO1xuICAgIHRoaXMuc3RySGFuZGxlcnMgPSB7fTtcbn07XG5cbkhhbmRsZXIucHJvdG90eXBlLmFkZEhhbmRsZXIgPSBmdW5jdGlvbiAoaGFuZGxlcil7XG4gICAgdmFyIHN0ckhhbmRsZXIgPSB1dGlscy5oYXNoKGhhbmRsZXIudG9TdHJpbmcoKSk7XG4gICAgaWYgKCEoc3RySGFuZGxlciBpbiB0aGlzLnN0ckhhbmRsZXJzKSl7XG4gICAgICAgIHRoaXMuc3RySGFuZGxlcnNbc3RySGFuZGxlcl0gPSBoYW5kbGVyO1xuICAgICAgICB0aGlzLmhhbmRsZXJzLnB1c2goaGFuZGxlcik7XG4gICAgfVxufTtcbkhhbmRsZXIucHJvdG90eXBlLmhhbmRsZSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCk7XG4gICAgdGhpcy5oYW5kbGVycy5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmMpe1xuICAgICAgICBmdW5jLmFwcGx5KG51bGwsYXJncyk7XG4gICAgfSlcbn07XG5IYW5kbGVyLnByb3RvdHlwZS5oYW5kbGVCeSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7XG4gICAgdmFyIHRocyA9IGFyZ3VtZW50c1swXTtcbiAgICB0aGlzLmhhbmRsZXJzLmZvckVhY2goZnVuY3Rpb24oZnVuYyl7XG4gICAgICAgIGZ1bmMuYXBwbHkodGhzLGFyZ3MpO1xuICAgIH0pXG59O1xuXG5cbmZ1bmN0aW9uIE5hbWVkRXZlbnRNYW5hZ2VyICgpe1xuICAgIHZhciBldmVudHMgPSB7fTtcbiAgICB2YXIgaGFuZGxlcklkID0ge307XG4gICAgdmFyIGlkeElkID0gMDtcbiAgICB0aGlzLm9uID0gZnVuY3Rpb24obmFtZSwgZnVuYyl7XG4gICAgICAgIGlmICghKG5hbWUgaW4gZXZlbnRzKSl7XG4gICAgICAgICAgICBldmVudHNbbmFtZV0gPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaWQgPSBpZHhJZCArKztcbiAgICAgICAgZXZlbnRzW25hbWVdLnB1c2goZnVuYyk7XG4gICAgICAgIGhhbmRsZXJJZFtpZF0gPSBmdW5jO1xuICAgICAgICByZXR1cm4gaWQ7XG4gICAgfTtcbiAgICB0aGlzLmVtaXQgPSBmdW5jdGlvbihuYW1lKXtcbiAgICAgICAgaWYgKG5hbWUgaW4gZXZlbnRzKXtcbiAgICAgICAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO1xuICAgICAgICAgICAgZXZlbnRzW25hbWVdLmZvckVhY2goZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgICAgICAgICAgIGV2ZW50LmFwcGx5KG51bGwsYXJncyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy51bmJpbmQgPSBmdW5jdGlvbihoYW5kbGVyKXtcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgaWYgKGhhbmRsZXIgaW4gaGFuZGxlcklkKXtcbiAgICAgICAgICAgIHZhciBmdW5jID0gaGFuZGxlcklkW2hhbmRsZXIgKyAnJ107XG4gICAgICAgICAgICBMYXp5KGV2ZW50cykuZWFjaChmdW5jdGlvbih2LGspe1xuICAgICAgICAgICAgICAgIHZhciBpZHggPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBuIGluIHYpe1xuICAgICAgICAgICAgICAgICAgICBpZiAodltuXSA9PT0gZnVuYyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZHgucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWR4LnJldmVyc2UoKS5mb3JFYWNoKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICB2LnNwbGljZSh4LDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlIGhhbmRsZXJJZFtoYW5kbGVyXTtcbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH07XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBjYWNoZWRLZXlJZHggPSAwO1xuXG52YXIgbnVsbFN0cmluZyA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gJyd9O1xuXG5mdW5jdGlvbiBtb2NrT2JqZWN0KCl7XG4gICAgcmV0dXJuIG5ldyBQcm94eSh7fSwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKHRhcmdldCwgbmFtZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBuYW1lICA9PT0gJ3N0cmluZycpe1xuICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAndG9TdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsU3RyaW5nO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2NrT2JqZWN0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0W25hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbn1cblxudmFyICRQT1NUID0gZnVuY3Rpb24odXJsLCBkYXRhLCBjYWxsQmFjaywgZXJyb3JCYWNrLGhlYWRlcnMpe1xuICAgIHZhciBvcHRzID0ge1xuICAgICAgICBhY2NlcHRzIDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB1cmwgOiB1cmwsXG4gICAgICAgIGRhdGEgOiBKU09OLnN0cmluZ2lmeShkYXRhKSxcbiAgICAgICAgZGF0YVR5cGUgOiAnanNvbicsXG4gICAgICAgIHN1Y2Nlc3MgOiBjYWxsQmFjayxcbiAgICAgICAgZXJyb3IgOiBlcnJvckJhY2ssXG4gICAgICAgIG1ldGhvZCA6ICdQT1NUJyxcbiAgICAgICAgY29udGVudFR5cGUgOiAnYXBwbGljYXRpb24vanNvbidcbiAgICB9O1xuICAgIGlmIChoZWFkZXJzKXtcbiAgICAgICAgb3B0cy5oZWFkZXJzID0gaGVhZGVycztcbiAgICAgICAgb3B0cy5jcm9zc0RvbWFpbiA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiAkLmFqYXgob3B0cyk7XG59XG5cbmZ1bmN0aW9uIHJlV2hlZWxDb25uZWN0aW9uKGVuZFBvaW50LCBnZXRMb2dpbil7XG4gICAgLy8gbWFpbiBcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5nZXRMb2dpbiA9IGdldExvZ2luO1xuICAgIHRoaXMuZXZlbnRzID0gbmV3IE5hbWVkRXZlbnRNYW5hZ2VyKClcbiAgICB0aGlzLiRQT1NUID0gJFBPU1QuYmluZCh0aGlzKTtcbiAgICB0aGlzLm9wdGlvbnMgPSB7ZW5kUG9pbnQgOiBlbmRQb2ludH07XG4gICAgdGhpcy5vbiA9IHRoaXMuZXZlbnRzLm9uLmJpbmQodGhpcyk7XG59O1xucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLnN0YXR1cyA9IGZ1bmN0aW9uKGNhbGxCYWNrLCBmb3JjZSl7XG4gICAgaWYgKCgnbGFzdFJXVFN0YXR1cycgaW4gbG9jYWxTdG9yYWdlKSAmJiAhZm9yY2UpIHtcbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgdmFyIHN0YXR1cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmxhc3RSV1RTdGF0dXMpO1xuICAgICAgICAgICAgZm9yICh2YXIgeCBpbiBzdGF0dXMpeyB0aGlzLm9wdGlvbnNbeF0gPSBzdGF0dXNbeF07IH1cbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdGF0dXMoY2FsbEJhY2ssIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYWxsQmFjayAmJiBjYWxsQmFjayhzdGF0dXMpO1xuICAgIH1cbiAgICBpZiAodGhpcy5fc3RhdHVzX2NhbGxpbmcpe1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzZWxmLnN0YXR1cyhjYWxsQmFjayk7XG4gICAgICAgIH0sNTApO1xuICAgIH1cbiAgICBpZiAodGhpcy5vcHRpb25zICYmIHRoaXMub3B0aW9ucy50aW1lc3RhbXApe1xuICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayh0aGlzLm9wdGlvbnMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3N0YXR1c19jYWxsaW5nID0gdHJ1ZTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdGhpcy4kcG9zdCgnYXBpL3N0YXR1cycsbnVsbCxmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmxhc3RSV1RTdGF0dXMgPSBKU09OLnN0cmluZ2lmeShzdGF0dXMpO1xuICAgICAgICAgICAgc2VsZi5fc3RhdHVzX2NhbGxpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAodmFyIHggaW4gc3RhdHVzKXsgc2VsZi5vcHRpb25zW3hdID0gc3RhdHVzW3hdOyB9XG4gICAgICAgICAgICBpZiAoIXN0YXR1cy51c2VyX2lkICYmIHNlbGYuZ2V0TG9naW4pe1xuICAgICAgICAgICAgICAgIHZhciBsb2dJbmZvID0gc2VsZi5nZXRMb2dpbigpO1xuICAgICAgICAgICAgICAgIGlmIChsb2dJbmZvLmNvbnN0cnVjdG9yID09PSBPYmplY3Qpe1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ2luKGxvZ0luZm8udXNlcm5hbWUsIGxvZ0luZm8ucGFzc3dvcmQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHN0YXR1cyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4IGluIHN0YXR1cyl7IHNlbGYub3B0aW9uc1t4XSA9IHN0YXR1c1t4XTsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmxhc3RSV1RTdGF0dXMgPSBKU09OLnN0cmluZ2lmeShzdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2soc3RhdHVzKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2soc2VsZi5vcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7ICAgICAgICBcbiAgICB9XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuJHBvc3QgPSBmdW5jdGlvbih1cmwsIGRhdGEsY2FsbEJhY2spe1xuICAgIHZhciB0aHMgPSB0aGlzO1xuICAgIGlmICh0aGlzLm9wdGlvbnMgJiYgdGhpcy5vcHRpb25zLnRva2VuKXtcbiAgICAgICAgaWYgKCFkYXRhKXtcbiAgICAgICAgICAgIGRhdGEgPSB7fTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAodGhpcy5vcHRpb25zLnRva2VuKXtcbiAgICAgICAgdmFyIGhlYWRlcnMgPSB7IFxuICAgICAgICAgICAgdG9rZW4gOiB0aGlzLm9wdGlvbnMudG9rZW4sXG4gICAgICAgICAgICBhcHBsaWNhdGlvbiA6IHRoaXMub3B0aW9ucy5hcHBsaWNhdGlvblxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBoZWFkZXJzID0gbnVsbDtcbiAgICB9XG5cbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCxyZWplY3Qpe1xuICAgICAgICB1dGlscy54ZHIodGhzLm9wdGlvbnMuZW5kUG9pbnQgKyB1cmwsIGRhdGEsIHRocy5vcHRpb25zLmFwcGxpY2F0aW9uLCB0aHMub3B0aW9ucy50b2tlbilcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdodHRwLXJlc3BvbnNlJywgeGhyLnJlc3BvbnNlVGV4dCwgeGhyLnN0YXR1cywgdXJsLCBkYXRhKTtcbiAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2h0dHAtcmVzcG9uc2UtJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZVRleHQsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZURhdGEpe1xuICAgICAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2h0dHAtcmVzcG9uc2UtJyArIHhoci5zdGF0dXMgKyAnLWpzb24nLCB4aHIucmVzcG9uc2VEYXRhLCB1cmwsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY2FsbEJhY2spIHsgY2FsbEJhY2soIHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCApfTtcbiAgICAgICAgICAgICAgICBhY2NlcHQoeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHhocikge1xuICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VEYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1qc29uJywgeGhyLnJlc3BvbnNlRGF0YSwgeGhyLnN0YXR1cywgdXJsLCBkYXRhLCB4aHIpO1xuICAgICAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2Vycm9yLWpzb24tJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZURhdGEsdXJsLCBkYXRhLCB4aHIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2Vycm9yLWh0dHAnLHhoci5yZXNwb25zZVRleHQsIHhoci5zdGF0dXMsdXJsLGRhdGEseGhyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1odHRwLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VUZXh0LHVybCxkYXRhLHhocik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlamVjdCh4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIHJldHVybiBwcm9taXNlO1xufTtcbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCl7XG4gICAgdmFyIHVybCA9IHRoaXMub3B0aW9ucy5lbmRQb2ludCArICdhcGkvbG9naW4nO1xuICAgIHZhciBjb25uZWN0aW9uID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LHJlamVjdCl7XG4gICAgICAgIHV0aWxzLnhkcih1cmwseyB1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkIDogcGFzc3dvcmR9LCBudWxsLGNvbm5lY3Rpb24ub3B0aW9ucy50b2tlbiwgdHJ1ZSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9IHhoci5yZXNwb25zZURhdGE7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgeCBpbiBzdGF0dXMpeyBjb25uZWN0aW9uLm9wdGlvbnNbeF0gPSBzdGF0dXNbeF07IH1cbiAgICAgICAgICAgICAgICBhY2NlcHQoc3RhdHVzKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgcmVqZWN0KHhoci5yZXNwb25zZURhdGEgfHwgcmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0pO1xuLyogICAgICAgICQuYWpheCh7XG4vLyAgICAgICAgICAgIGhlYWRlcnMgOiBoZWFkZXJzLFxuICAgICAgICAgICAgdXJsIDogdXJsLFxuICAgICAgICAgICAgZGF0YSA6IHsgdXNlcm5hbWU6IHVzZXJuYW1lLCBwYXNzd29yZCA6IHBhc3N3b3JkfSxcbiAgICAgICAgICAgIGRhdGFUeXBlIDogJ2pzb24nLFxuICAgICAgICAgICAgbWV0aG9kIDogJ1BPU1QnLFxuLy8gICAgICAgICAgICBjb250ZW50VHlwZSA6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIG1pbWVUeXBlIDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgY3Jvc3NEb21haW4gOiB0cnVlLFxuICAgICAgICAgICAgc3VjY2VzcyA6IGZ1bmN0aW9uKHN0YXR1cyl7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgeCBpbiBzdGF0dXMpeyBjb25uZWN0aW9uLm9wdGlvbnNbeF0gPSBzdGF0dXNbeF07IH1cbiAgICAgICAgICAgICAgICBhY2NlcHQoc3RhdHVzKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvciA6IGZ1bmN0aW9uKHhocixkYXRhLCBzdGF0dXMpe1xuICAgICAgICAgICAgICAgIHJlamVjdCh4aHIucmVzcG9uc2VKU09OKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9KVxuKi9cbiAgICB9KTtcbn07XG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uKGNhbGxCYWNrKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHdzY29ubmVjdCA9IGZ1bmN0aW9uKHNlbGYpe1xuICAgICAgICBzZWxmLndzQ29ubmVjdGlvbiA9IG5ldyB1dGlscy53c0Nvbm5lY3Qoc2VsZi5vcHRpb25zKTtcbiAgICAgICAgc2VsZi53c0Nvbm5lY3Rpb24ub25Db25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzZWxmLmV2ZW50cy5lbWl0KCd3cy1jb25uZWN0ZWQnLCBzZWxmLndzQ29ubmVjdGlvbik7XG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLndzQ29ubmVjdGlvbi5vbkRpc2Nvbm5lY3QoZnVuY3Rpb24oKXsgXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgd3Njb25uZWN0KHNlbGYpOyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0sMTAwMCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnN0YXR1cyhmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICBpZiAoJ3Rva2VuJyBpbiBzZWxmLm9wdGlvbnMpe1xuICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2soc3RhdHVzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb25uZWN0aW5nIHRvICcgKyBzZWxmLm9wdGlvbnMuZW5kUG9pbnQpO1xuICAgICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy51c2VybmFtZSAmJiBzZWxmLm9wdGlvbnMucGFzc3dvcmQpe1xuICAgICAgICAgICAgICAgIHNlbGYubG9naW4oXG4gICAgICAgICAgICAgICAgICAgIHNlbGYub3B0aW9ucy51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5vcHRpb25zLnBhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlbmV3aW5nIGNvbm5lY3Rpb24nKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzdGF0dXMudG9rZW4gJiYgc3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQgJiYgKCFzZWxmLndzQ29ubmVjdGlvbikpe1xuICAgICAgICAgICAgd3Njb25uZWN0KHNlbGYpO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuXG52YXIgdXRpbHMgPSB7XG4gICAgcmVuYW1lRnVuY3Rpb24gOiBmdW5jdGlvbiAobmFtZSwgZm4pIHtcbiAgICAgICAgcmV0dXJuIChuZXcgRnVuY3Rpb24oXCJyZXR1cm4gZnVuY3Rpb24gKGNhbGwpIHsgcmV0dXJuIGZ1bmN0aW9uIFwiICsgbmFtZSArXG4gICAgICAgICAgICBcIiAoKSB7IHJldHVybiBjYWxsKHRoaXMsIGFyZ3VtZW50cykgfTsgfTtcIikoKSkoRnVuY3Rpb24uYXBwbHkuYmluZChmbikpO1xuICAgIH0sXG4gICAgY2FjaGVkIDogZnVuY3Rpb24oZnVuYywga2V5KXtcbiAgICAgICAgaWYgKCFrZXkpeyAgICBcbiAgICAgICAgICAgIGtleSA9ICdfJyArIGNhY2hlZEtleUlkeCsrO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHdyYXBwZXIoKXtcbiAgICAgICAgICAgIGlmICghdGhpc1trZXldKXtcbiAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSBmdW5jLmNhbGwodGhpcyxbYXJndW1lbnRzXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpc1trZXldO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gd3JhcHBlcjtcbiAgICB9LFxuICAgICRQT1NUIDogJFBPU1QsXG4gICAgcmVXaGVlbENvbm5lY3Rpb246IHJlV2hlZWxDb25uZWN0aW9uLFxuICAgIGxvZzogZnVuY3Rpb24oKXsgXG4gICAgICAgIGNvbnNvbGUubG9nKGFyZ3VtZW50cyk7XG4gICAgfSxcblxuICAgIHhkcjogZnVuY3Rpb24gKHVybCwgZGF0YSwgYXBwbGljYXRpb24sdG9rZW4sIGZvcm1FbmNvZGUpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2UgYW4gSFRUUCBSZXF1ZXN0IGFuZCByZXR1cm4gaXRzIHByb21pc2UuXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciByZXE7XG4gICAgICAgICAgICBpZiAoIWRhdGEpIHsgZGF0YSA9IHt9O31cblxuICAgICAgICAgICAgaWYoWE1MSHR0cFJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICByZXEgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICByZXEub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXEucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBKU09OLnBhcnNlKHJlcS5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoYSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlRGF0YSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSB7cmVzcG9uc2VEYXRhOiByZXNwb25zZURhdGEsIHJlc3BvbnNlVGV4dDogcmVxLnJlc3BvbnNlVGV4dCxzdGF0dXM6IHJlcS5zdGF0dXNUZXh0LCByZXF1ZXN0OiByZXF9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcS5zdGF0dXMgPj0gMjAwICYmIHJlcS5zdGF0dXMgPCA0MDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZihYRG9tYWluUmVxdWVzdCl7XG4gICAgICAgICAgICAgICAgcmVxID0gbmV3IFhEb21haW5SZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgcmVxLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBhY2NlcHQocmVxLnJlc3BvbnNlVGV4dCxyZXEuc3RhdHVzVGV4dCwgcmVxKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdDT1JTIG5vdCBzdXBwb3J0ZWQnKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlcS5vcGVuKCdQT1NUJywgdXJsLCB0cnVlKTtcbiAgICAgICAgICAgIHJlcS5vbmVycm9yID0gcmVqZWN0O1xuICAgICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICAgICAgICAgIGlmICh0b2tlbikgeyBkYXRhLl9fdG9rZW5fXyA9IHRva2VuIH1cbiAgICAgICAgICAgIGlmICghZm9ybUVuY29kZSl7XG4gICAgICAgICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsJ3RleHQvcGxhaW4nKTtcbiAgICAgICAgICAgICAgICBkYXRhID0gTGF6eShkYXRhKS5zaXplKCk/SlNPTi5zdHJpbmdpZnkoZGF0YSk6Jyc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTtcbiAgICAgICAgICAgICAgICBkYXRhID0gTGF6eShkYXRhKS5tYXAoZnVuY3Rpb24odixrKXtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBrICsgJz0nICsgZW5jb2RlVVJJKHYudG9TdHJpbmcoKSk7ICBcbiAgICAgICAgICAgICAgICB9KS50b0FycmF5KCkuam9pbignJicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVxLnNlbmQoZGF0YSk7XG4gICAgLy8gICAgICAgIHJlcS5zZW5kKG51bGwpO1xuICAgICAgICB9KVxuICAgIH0sXG4gICAgXG4gICAgY2FwaXRhbGl6ZSA6IGZ1bmN0aW9uIChzKSB7XG4gICAgICAgIHJldHVybiBzWzBdLnRvVXBwZXJDYXNlKCkgKyBzLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG4gICAgfSxcblxuICAgIGhhc2ggOiBmdW5jdGlvbihzdHIpe1xuICAgICAgICAvKipcbiAgICAgICAgICogSGFzaGVkIGZ1bmN0aW9uXG4gICAgICAgICAqL1xuICAgICAgICBzdHIgPSBzdHIudG9TdHJpbmcoKTtcbiAgICAgICAgdmFyIHJldCA9IDE7XG4gICAgICAgIGZvciAodmFyIHggPSAwO3g8c3RyLmxlbmd0aDt4Kyspe1xuICAgICAgICAgICAgcmV0ICo9ICgxICsgc3RyLmNoYXJDb2RlQXQoeCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAocmV0ICUgMzQ5NTgzNzQ5NTcpLnRvU3RyaW5nKCk7XG4gICAgfSxcblxuICAgIG1ha2VGaWx0ZXIgOiBmdW5jdGlvbiAobW9kZWwsIGZpbHRlciwgdW5pZmllciwgZG9udFRyYW5zbGF0ZUZpbHRlcikge1xuICAgICAgICAvKipcbiAgICAgICAgICogTWFrZSBmaWx0ZXIgZm9yIEFycmF5LmZpbHRlciBmdW5jdGlvbiBhcyBhbiBhbmQgb2Ygb3JcbiAgICAgICAgICovXG4gICAgICAgIGlmICghdW5pZmllcikgeyB1bmlmaWVyID0gJyAmJiAnO31cbiAgICAgICAgaWYgKExhenkoZmlsdGVyKS5zaXplKCkgPT09IDApe1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHgpeyByZXR1cm4gdHJ1ZSB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBzb3VyY2UgPSBMYXp5KGZpbHRlcikubWFwKGZ1bmN0aW9uKHZhbHMsIGZpZWxkKXtcbiAgICAgICAgICAgIGlmICghdmFscykgeyB2YWxzID0gW251bGxdfVxuICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHMpKXtcbiAgICAgICAgICAgICAgICB2YWxzID0gW3ZhbHNdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFkb250VHJhbnNsYXRlRmlsdGVyICYmIChtb2RlbC5maWVsZHNbZmllbGRdLnR5cGUgPT09ICdyZWZlcmVuY2UnKSkge1xuICAgICAgICAgICAgICAgIGZpZWxkID0gJ18nICsgZmllbGQ7XG4gICAgICAgICAgICAgICAgdmFscyA9IExhenkodmFscykubWFwKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICBpZiAoeCAmJiAoeC5jb25zdHJ1Y3RvciAhPT0gTnVtYmVyKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geC5pZDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHg7XG4gICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChtb2RlbC5maWVsZHNbZmllbGRdLnR5cGUgPT09ICdzdHJpbmcnKXtcbiAgICAgICAgICAgICAgICB2YWxzID0gdmFscy5tYXAoSlNPTi5zdHJpbmdpZnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICcoJyArICBMYXp5KHZhbHMpLm1hcChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICByZXR1cm4gJyh4LicgKyBmaWVsZCArICcgPT09ICcgKyB4ICsgJyknO1xuICAgICAgICAgICAgfSkuam9pbignIHx8ICcpICArJyknO1xuICAgICAgICB9KS50b0FycmF5KCkuam9pbih1bmlmaWVyKTtcbiAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcInhcIiwgXCJyZXR1cm4gXCIgKyBzb3VyY2UpO1xuICAgIH0sXG5cbiAgICBzYW1lQXMgOiBmdW5jdGlvbiAoeCwgeSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogRGVlcCBlcXVhbFxuICAgICAgICAgKi9cbiAgICAgICAgZm9yICh2YXIgayBpbiB4KSB7XG4gICAgICAgICAgICBpZiAoeVtrXSAhPSB4W2tdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG5cblxuICAgIHdzQ29ubmVjdCA6IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25uZWN0cyBhIHdlYnNvY2tldCB3aXRoIHJlV2hlZWwgY29ubmVjdGlvblxuICAgICAgICAgKi9cbiAgICAgICAgaWYoIW9wdGlvbnMpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgXG4gICAgICAgIC8vIHJlZ2lzdGVyaW5nIGFsbCBldmVudCBoYW5kbGVyc1xuXG4gICAgICAgIHRoaXMuaGFuZGxlcnMgPSB7XG4gICAgICAgICAgICB3aXphcmQgOiBuZXcgSGFuZGxlcigpLFxuICAgICAgICAgICAgb25Db25uZWN0aW9uIDogbmV3IEhhbmRsZXIoKSxcbiAgICAgICAgICAgIG9uRGlzY29ubmVjdGlvbiA6IG5ldyBIYW5kbGVyKCksXG4gICAgICAgICAgICBvbk1lc3NhZ2VKc29uIDogbmV3IEhhbmRsZXIoKSxcbiAgICAgICAgICAgIG9uTWVzc2FnZVRleHQgOiBuZXcgSGFuZGxlcigpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vbldpemFyZCA9IHRoaXMuaGFuZGxlcnMud2l6YXJkLmFkZEhhbmRsZXIuYmluZCh0aGlzLmhhbmRsZXJzLndpemFyZCk7XG4gICAgICAgIHRoaXMub25Db25uZWN0ID0gdGhpcy5oYW5kbGVycy5vbkNvbm5lY3Rpb24uYWRkSGFuZGxlci5iaW5kKHRoaXMuaGFuZGxlcnMub25Db25uZWN0aW9uKTtcbiAgICAgICAgdGhpcy5vbkRpc2Nvbm5lY3QgPSB0aGlzLmhhbmRsZXJzLm9uRGlzY29ubmVjdGlvbi5hZGRIYW5kbGVyLmJpbmQodGhpcy5oYW5kbGVycy5vbkRpc2Nvbm5lY3Rpb24pO1xuICAgICAgICB0aGlzLm9uTWVzc2FnZUpzb24gPSB0aGlzLmhhbmRsZXJzLm9uTWVzc2FnZUpzb24uYWRkSGFuZGxlci5iaW5kKHRoaXMuaGFuZGxlcnMub25NZXNzYWdlSnNvbik7XG4gICAgICAgIHRoaXMub25NZXNzYWdlVGV4dCA9IHRoaXMuaGFuZGxlcnMub25NZXNzYWdlVGV4dC5hZGRIYW5kbGVyLmJpbmQodGhpcy5oYW5kbGVycy5vbk1lc3NhZ2VUZXh0KTtcblxuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zXG5cbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBuZXcgU29ja0pTKG9wdGlvbnMucmVhbHRpbWVFbmRQb2ludCk7XG4gICAgICAgIGNvbm5lY3Rpb24ub25vcGVuID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvcGVuIDogJyArIHgpO1xuICAgICAgICAgICAgY29ubmVjdGlvbi50ZW5hbnQoKTtcbiAgICAgICAgICAgIHNlbGYuaGFuZGxlcnMub25Db25uZWN0aW9uLmhhbmRsZSh4KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgaWYgKHgudHlwZSA9PSAnbWVzc2FnZScpIHtcbiAgICAgICAgICAgICAgICAvLyQubm90aWZ5KHguZGF0YSk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy9UT0RPIHNldCBmcm9tUmVhbHRpbWVcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYW5kbGVycy5vbk1lc3NhZ2VKc29uLmhhbmRsZShKU09OLnBhcnNlKHguZGF0YSkpO1xuICAgICAgICAgICAgICAgICAgICAvL1RPRE8gdW5zZXQgZnJvbVJlYWx0aW1lXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaGFuZGxlcnMub25NZXNzYWdlVGV4dC5oYW5kbGUoeC5kYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25uZWN0aW9uLm9uY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHV0aWxzLndzQ29ubmVjdCwxMDAwKTtcbiAgICAgICAgICAgIHNlbGYuaGFuZGxlcnMub25EaXNjb25uZWN0aW9uLmhhbmRsZSgpO1xuICAgICAgICB9O1xuICAgICAgICBjb25uZWN0aW9uLnRlbmFudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbm5lY3Rpb24uc2VuZCgnVEVOQU5UOicgKyBzZWxmLm9wdGlvbnMuYXBwbGljYXRpb24gKyAnOicgKyBzZWxmLm9wdGlvbnMudG9rZW4pO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHBsdXJhbGl6ZSA6IGZ1bmN0aW9uKHN0ciwgbW9kZWwpe1xuICAgICAgICAvKipcbiAgICAgICAgICogTGV4aWNhbGx5IHJldHVybnMgZW5nbGlzaCBwbHVyYWwgZm9ybVxuICAgICAgICAgKi9cbiAgICAgICAgcmV0dXJuIHN0ciArICdzJztcbiAgICB9LFxuXG4gICAgYmVmb3JlQ2FsbCA6IGZ1bmN0aW9uKGZ1bmMsIGJlZm9yZSl7XG4gICAgICAgIHZhciBkZWNvcmF0b3IgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgYmVmb3JlKCkudGhlbihmdW5jKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZGVjb3JhdG9yO1xuICAgIH0sXG5cbiAgICBjbGVhblN0b3JhZ2UgOiBmdW5jdGlvbigpe1xuICAgICAgICAvKipcbiAgICAgICAgICogQ2xlYW4gbG9jYWxTdG9yYWdlIG9iamVjdFxuICAgICAgICAgKi9cbiAgICAgICAgTGF6eShsb2NhbFN0b3JhZ2UpLmtleXMoKS5lYWNoKGZ1bmN0aW9uKGspe1xuICAgICAgICAgICAgZGVsZXRlIGxvY2FsU3RvcmFnZVtrXTtcbiAgICAgICAgfSlcbiAgICB9LFxuICAgIFxuICAgIHJldmVyc2UgOiBmdW5jdGlvbiAoY2hyLCBzdHIpIHtcbiAgICAgICAgcmV0dXJuIHN0ci5zcGxpdChjaHIpLnJldmVyc2UoKS5qb2luKGNocik7XG4gICAgfSxcbiAgICBwZXJtdXRhdGlvbnM6IGZ1bmN0aW9uKGFycil7XG4gICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgeCA9IGFyci5sZW5ndGgtMTsgeCA+PSAwO3gtLSl7XG4gICAgICAgICAgICBmb3IgKHZhciB5ID0gYXJyLmxlbmd0aC0xOyB5ID49IDA7IHktLSl7XG4gICAgICAgICAgICAgICAgaWYgKHggIT09IHkpXG4gICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKFthcnJbeF0sIGFyclt5XV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfSxcblxuICAgIGJvb2w6IEJvb2xlYW4sXG5cbiAgICBub29wIDogZnVuY3Rpb24oKXt9LFxuXG4gICAgdHpPZmZzZXQ6IG5ldyBEYXRlKCkuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwMDAwLFxuXG4gICAgdHJhbnNGaWVsZFR5cGU6IHtcbiAgICAgICAgZGF0ZTogZnVuY3Rpb24oeCkgeyByZXR1cm4gbmV3IERhdGUoeCAqIDEwMDAgKyB1dGlscy50ek9mZnNldCApIH0sXG4gICAgICAgIGRhdGV0aW1lOiBmdW5jdGlvbih4KSB7IHJldHVybiBuZXcgRGF0ZSh4ICogMTAwMCArIHV0aWxzLnR6T2Zmc2V0ICkgfSxcbiAgICAgICAgc3RyaW5nOiBmdW5jdGlvbih4KSB7IHJldHVybiB4LnRvU3RyaW5nKCk7IH0sXG4gICAgICAgIHRleHQ6IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHgudG9TdHJpbmcoKTsgfSxcbiAgICAgICAgaW50ZWdlcjogZnVuY3Rpb24oeCkgeyByZXR1cm4gcGFyc2VJbnQoeCk7IH0sXG4gICAgICAgIGZsb2F0OiBmdW5jdGlvbih4KSB7IHJldHVybiBwYXJzZUZsb2F0KHgpOyB9XG4gICAgfSwgXG4gICAgbW9jayA6IG1vY2tPYmplY3Rcbn07XG5cblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBUb3VjaGVyKCl7XG4gICAgdmFyIHRvdWNoZWQgPSBmYWxzZVxuICAgIHRoaXMudG91Y2ggPSBmdW5jdGlvbigpe1xuICAgICAgICB0b3VjaGVkID0gdHJ1ZTtcbiAgICB9O1xuICAgIHRoaXMudG91Y2hlZCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciB0ID0gdG91Y2hlZDtcbiAgICAgICAgdG91Y2hlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG59XG4iLCIndXNlIHN0cmljdCc7XG5cblxuZnVuY3Rpb24gVmFjdXVtQ2FjaGVyKHRvdWNoLCBhc2tlZCwgbmFtZSl7XG4vKlxuICAgIGlmIChuYW1lKXtcbiAgICAgICAgY29uc29sZS5pbmZvKCdjcmVhdGVkIFZhY3V1bUNhY2hlciBhcyAnICsgbmFtZSk7XG4gICAgfVxuKi9cbiAgICBpZiAoIWFza2VkKXtcbiAgICAgICAgdmFyIGFza2VkID0gW107XG4gICAgfVxuICAgIHZhciBtaXNzaW5nID0gW107XG4gICAgXG4gICAgdGhpcy5hc2sgPSBmdW5jdGlvbiAoaWQsbGF6eSl7XG4gICAgICAgIGlmICghTGF6eShhc2tlZCkuY29udGFpbnMoaWQpKXtcbi8vICAgICAgICAgICAgY29uc29sZS5pbmZvKCdhc2tpbmcgKCcgKyBpZCArICcpIGZyb20gJyArIG5hbWUpO1xuICAgICAgICAgICAgbWlzc2luZy5wdXNoKGlkKTtcbiAgICAgICAgICAgIGlmICghbGF6eSlcbiAgICAgICAgICAgICAgICBhc2tlZC5wdXNoKGlkKTtcbiAgICAgICAgICAgIHRvdWNoLnRvdWNoKCk7XG4gICAgICAgIH0gXG4vLyAgICAgICAgZWxzZSBjb25zb2xlLndhcm4oJygnICsgaWQgKyAnKSB3YXMganVzdCBhc2tlZCBvbiAnICsgbmFtZSk7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0QXNrZWRJbmRleCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBhc2tlZDtcbiAgICB9XG5cbiAgICB0aGlzLm1pc3NpbmdzID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIExhenkobWlzc2luZy5zcGxpY2UoMCxtaXNzaW5nLmxlbmd0aCkpLnVuaXF1ZSgpLnRvQXJyYXkoKTtcbiAgICB9XG59XG4iLCJmdW5jdGlvbiBBdXRvTGlua2VyKGV2ZW50cywgYWN0aXZlcywgSURCLCBXMlBSRVNPVVJDRSwgbGlzdENhY2hlKXtcbiAgICB2YXIgdG91Y2ggPSBuZXcgVG91Y2hlcigpO1xuICAgIHZhciBtYWluSW5kZXggPSB7fTtcbiAgICB2YXIgZm9yZWlnbktleXMgPSB7fTtcbiAgICB2YXIgbTJtID0ge307XG4gICAgdmFyIG0ybUluZGV4ID0ge307XG4gICAgdmFyIHBlcm1pc3Npb25zID0ge307XG4gICAgdGhpcy5tYWluSW5kZXggPSBtYWluSW5kZXg7XG4gICAgdGhpcy5mb3JlaWduS2V5cyA9IGZvcmVpZ25LZXlzO1xuICAgIHRoaXMubTJtID0gbTJtO1xuICAgIHRoaXMubTJtSW5kZXggPSBtMm1JbmRleDtcbiAgICB0aGlzLnBlcm1pc3Npb25zID0gcGVybWlzc2lvbnM7XG5cbiAgICBldmVudHMub24oJ21vZGVsLWRlZmluaXRpb24nLGZ1bmN0aW9uKG1vZGVsKXtcbiAgICAgICAgLy8gZGVmaW5pbmcgYWxsIGluZGV4ZXMgZm9yIHByaW1hcnkga2V5XG4gICAgICAgIHZhciBwa0luZGV4ID0gbGlzdENhY2hlLmdldEluZGV4Rm9yKG1vZGVsLm5hbWUsICdpZCcpO1xuICAgICAgICBtYWluSW5kZXhbbW9kZWwubmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLCBwa0luZGV4LCAnbWFpbkluZGV4LicgKyBtb2RlbC5uYW1lKTtcbiAgICAgICAgXG4gICAgICAgIC8vIGNyZWF0aW5nIHBlcm1pc3Npb24gaW5kZXhlc1xuICAgICAgICBwZXJtaXNzaW9uc1ttb2RlbC5uYW1lXSA9IG5ldyBWYWN1dW1DYWNoZXIodG91Y2gsbnVsbCwgJ3Blcm1pc3Npb25zLicgKyBtb2RlbC5uYW1lKTtcblxuICAgICAgICAvLyBjcmVhdGluZyBpbmRleGVzIGZvciBmb3JlaWduIGtleXNcbiAgICAgICAgTGF6eShtb2RlbC5yZWZlcmVuY2VzKS5lYWNoKGZ1bmN0aW9uKHJlZmVyZW5jZSl7XG4gICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gbW9kZWwubmFtZSArICdfJyArIHJlZmVyZW5jZS5pZDtcbiAgICAgICAgICAgIGZvcmVpZ25LZXlzW2luZGV4TmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLCBsaXN0Q2FjaGUuZ2V0SW5kZXhGb3IocmVmZXJlbmNlLnRvLCAnaWQnKSwgcmVmZXJlbmNlLnRvICsgJy5pZCBmb3JlaWduS2V5cy4nICsgaW5kZXhOYW1lKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGNyZWF0aW5nIHJldmVyc2UgZm9yZWlnbiBrZXlzXG4gICAgICAgIExhenkobW9kZWwucmVmZXJlbmNlZEJ5KS5lYWNoKGZ1bmN0aW9uKGZpZWxkKXtcbiAgICAgICAgICAgIHZhciBpbmRleE5hbWUgPSBmaWVsZC5ieSArICcuJyArIGZpZWxkLmlkO1xuICAgICAgICAgICAgZm9yZWlnbktleXNbaW5kZXhOYW1lXSA9IG5ldyBWYWN1dW1DYWNoZXIodG91Y2gsIGxpc3RDYWNoZS5nZXRJbmRleEZvcihmaWVsZC5ieSxmaWVsZC5pZCksIGZpZWxkLmJ5ICsgJy4nICsgZmllbGQuaWQgKyAnIGZvcmVpZ25LZXlzLicgKyBpbmRleE5hbWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgTGF6eShtb2RlbC5tYW55VG9NYW55KS5lYWNoKGZ1bmN0aW9uKHJlbGF0aW9uKXtcbiAgICAgICAgICAgIGlmICghKHJlbGF0aW9uLmluZGV4TmFtZSBpbiBtMm0pKVxuICAgICAgICAgICAgICAgIG0ybVtyZWxhdGlvbi5pbmRleE5hbWVdID0gW25ldyBWYWN1dW1DYWNoZXIodG91Y2gsbnVsbCwnbTJtLicgKyByZWxhdGlvbi5pbmRleE5hbWUgKyAnWzBdJyksIG5ldyBWYWN1dW1DYWNoZXIodG91Y2gsbnVsbCwnbTJtLicgKyByZWxhdGlvbi5pbmRleE5hbWUrJ1sxXScpXTtcbiAgICAgICAgICAgIGlmICghKHJlbGF0aW9uLmluZGV4TmFtZSBpbiBtMm1JbmRleCkpXG4gICAgICAgICAgICAgICAgbTJtSW5kZXhbcmVsYXRpb24uaW5kZXhOYW1lXSA9IG5ldyBNYW55VG9NYW55UmVsYXRpb24ocmVsYXRpb24sbTJtW3JlbGF0aW9uLmluZGV4TmFtZV0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICB2YXIgbTJtR2V0ID0gZnVuY3Rpb24oaW5kZXhOYW1lLCBuLCBjb2xsZWN0aW9uLCBjYWxsQmFjayl7XG4gICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KChuID8gdXRpbHMucmV2ZXJzZSgnLycsIGluZGV4TmFtZSkgOiBpbmRleE5hbWUpICsgJ3MnICsgJy9saXN0Jywge2NvbGxlY3Rpb246IGNvbGxlY3Rpb259LCBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdERhdGEoZGF0YSwgY2FsbEJhY2spO1xuICAgICAgICAgICAgZGVsZXRlIGFjdGl2ZXNbaW5kZXhOYW1lXVxuICAgICAgICB9KTsgICAgICAgIFxuICAgIH07XG5cbiAgICB2YXIgZ2V0TTJNID0gZnVuY3Rpb24oaW5kZXhOYW1lLCBjb2xsZWN0aW9uLCBuLCBjYWxsQmFjayl7XG4gICAgICAgIC8vIGFzayBhbGwgaXRlbXMgaW4gY29sbGVjdGlvbiB0byBtMm0gaW5kZXhcbiAgICAgICAgTGF6eShjb2xsZWN0aW9uKS5lYWNoKG0ybVtpbmRleE5hbWVdW25dLmFzay5iaW5kKG0ybVtpbmRleE5hbWVdW25dKSk7XG4gICAgICAgIC8vIHJlbmV3aW5nIGNvbGxlY3Rpb24gd2l0aG91dCBhc2tlZFxuICAgICAgICBjb2xsZWN0aW9uID0gbTJtW2luZGV4TmFtZV1bbl0ubWlzc2luZ3MoKTtcbiAgICAgICAgLy8gY2FsbGluZyByZW1vdGUgZm9yIG0ybSBjb2xsZWN0aW9uIGlmIGFueVxuICAgICAgICBpZiAoY29sbGVjdGlvbi5sZW5ndGgpe1xuICAgICAgICAgICAgYWN0aXZlc1tpbmRleE5hbWVdID0gMTtcbiAgICAgICAgICAgIG0ybUdldChpbmRleE5hbWUsIG4sIGNvbGxlY3Rpb24sIGNhbGxCYWNrKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuZ2V0TTJNID0gZ2V0TTJNO1xuXG4gICAgdmFyIGxpbmtVbmxpbmtlZCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIHBlcmZvcm0gYSBEYXRhQmFzZSBzeW5jaHJvbml6YXRpb24gd2l0aCBzZXJ2ZXIgbG9va2luZyBmb3IgdW5rbm93biBkYXRhXG4gICAgICAgIGlmICghdG91Y2gudG91Y2hlZCgpKSByZXR1cm47XG4gICAgICAgIGlmIChMYXp5KGFjdGl2ZXMpLnZhbHVlcygpLnN1bSgpKSB7XG4gICAgICAgICAgICB0b3VjaC50b3VjaCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgIExhenkobTJtKS5lYWNoKGZ1bmN0aW9uKGluZGV4ZXMsIGluZGV4TmFtZSl7XG4gICAgICAgICAgICBMYXp5KGluZGV4ZXMpLmVhY2goZnVuY3Rpb24gKGluZGV4LG4pIHtcbiAgICAgICAgICAgICAgICB2YXIgY29sbGVjdGlvbiA9IGluZGV4Lm1pc3NpbmdzKCk7XG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbiA9IExhenkoY29sbGVjdGlvbikuZmlsdGVyKEJvb2xlYW4pLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoeClcbiAgICAgICAgICAgICAgICB9KS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbGxlY3Rpb24ubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIElOREVYID0gbTJtSW5kZXhbaW5kZXhOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdldHRlciA9IElOREVYWydnZXQnICsgKDEgLSBuKV0uYmluZChJTkRFWCk7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBtMm1HZXQoaW5kZXhOYW1lLCBuLCBjb2xsZWN0aW9uLCBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHMgPSBjb2xsZWN0aW9uLm1hcChnZXR0ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkcy5sZW5ndGgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdGhlckluZGV4ID0gaW5kZXhOYW1lLnNwbGl0KCcvJylbMSAtIG5dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmRlc2NyaWJlKG90aGVySW5kZXgsZnVuY3Rpb24oKXtcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMYXp5KGlkcykuZmxhdHRlbigpLnVuaXF1ZSgpLmVhY2gobWFpbkluZGV4W290aGVySW5kZXhdLmFzayk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExhenkoaWRzKS5mbGF0dGVuKCkudW5pcXVlKCkuZWFjaChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1haW5JbmRleFtvdGhlckluZGV4XS5hc2soeCx0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgTGF6eShtYWluSW5kZXgpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBtb2RlbE5hbWUpIHtcbiAgICAgICAgICAgIHZhciBpZHMgPSBpbmRleC5taXNzaW5ncygpO1xuICAgICAgICAgICAgaWYgKGlkcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgaWRiID0gbW9kZWxOYW1lIGluIElEQiA/IElEQlttb2RlbE5hbWVdLmtleXMoKSA6IExhenkoKTtcbiAgICAgICAgICAgICAgICAvL2xvZygnbGlua2luZy4nICsgbW9kZWxOYW1lICsgJyA9ICcgKyBXMlBSRVNPVVJDRS5saW5raW5nLnNvdXJjZVttb2RlbE5hbWVdKTtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5mZXRjaChtb2RlbE5hbWUsIHtpZDogaWRzfSxudWxsLHV0aWxzLm5vb3ApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gRm9yZWlnbiBrZXlzXG4gICAgICAgIExhenkoZm9yZWlnbktleXMpXG4gICAgICAgIC5tYXAoZnVuY3Rpb24odixrKXtcbiAgICAgICAgICAgIHJldHVybiBbaywgdi5taXNzaW5ncygpXVxuICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24odil7XG4gICAgICAgICAgICByZXR1cm4gdlsxXS5sZW5ndGhcbiAgICAgICAgfSkuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgaWRzID0geFsxXTtcbiAgICAgICAgICAgIHZhciBpbmRleE5hbWUgPSB4WzBdO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gaW5kZXhOYW1lLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICB2YXIgbWFpblJlc291cmNlID0gaW5kZXhbMF07XG4gICAgICAgICAgICB2YXIgZmllbGROYW1lID0gaW5kZXhbMV07XG4gICAgICAgICAgICB2YXIgZmlsdGVyID0ge307XG4gICAgICAgICAgICBmaWx0ZXJbZmllbGROYW1lXSA9IGlkcztcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmZldGNoKG1haW5SZXNvdXJjZSwgZmlsdGVyKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBMYXp5KExhenkocGVybWlzc2lvbnMpLm1hcChmdW5jdGlvbih2LGspe1xuICAgICAgICAgICAgcmV0dXJuIFtrLCB2Lm1pc3NpbmdzKCldXG4gICAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgcmV0dXJuIHZbMV0ubGVuZ3RoXG4gICAgICAgIH0pLnRvT2JqZWN0KCkpLmVhY2goZnVuY3Rpb24gKGlkcywgcmVzb3VyY2VOYW1lKSB7XG4gICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICBhY3RpdmVzW3Jlc291cmNlTmFtZV0gPSAxO1xuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KHJlc291cmNlTmFtZSArICcvbXlfcGVybXMnLCB7aWRzOiBMYXp5KGlkcykudW5pcXVlKCkudG9BcnJheSgpfSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290UGVybWlzc2lvbnMoZGF0YS5QRVJNSVNTSU9OUyk7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBhY3RpdmVzW3Jlc291cmNlTmFtZV1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNldEludGVydmFsKGxpbmtVbmxpbmtlZCw1MCk7XG59O1xuXG5cbiIsIlwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBMaXN0Q2FjaGVyKCl7XG4gICAgdmFyIGdvdEFsbCA9IHt9O1xuICAgIHZhciBhc2tlZCA9IHt9OyAvLyBtYXAgb2YgYXJyYXlcbiAgICB2YXIgY29tcG9zaXRlQXNrZWQgPSB7fTtcbiAgICB2YXIgY2FydGVzaWFuUHJvZHVjdDEgPSBmdW5jdGlvbih4LHksaXNBcnJheSl7XG4gICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgaWYgKGlzQXJyYXkpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGEgaW4geCl7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYiBpbiB5KXtcbiAgICAgICAgICAgICAgICAgICAgcmV0LnB1c2goTGF6eShbeFthXSx5W2JdXSkuZmxhdHRlbigpLnRvQXJyYXkoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9yICh2YXIgYSBpbiB4KXtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBiIGluIHkpe1xuICAgICAgICAgICAgICAgICAgICByZXQucHVzaChbeFthXSx5W2JdXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfTtcbiAgICB2YXIgY2FydGVzaWFuUHJvZHVjdCA9IGZ1bmN0aW9uKGFycil7XG4gICAgICAgIHZhciBpc0FycmF5ID0gZmFsc2U7XG4gICAgICAgIHZhciByZXQgPSBhcnJbMF07IFxuICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IGFyci5sZW5ndGg7ICsreCl7XG4gICAgICAgICAgICByZXQgPSBjYXJ0ZXNpYW5Qcm9kdWN0MShyZXQsIGFyclt4XSwgaXNBcnJheSk7XG4gICAgICAgICAgICBpc0FycmF5ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cbiAgICB2YXIgZXhwbG9kZUZpbHRlciA9IGZ1bmN0aW9uKGZpbHRlcikge1xuICAgICAgICB2YXIgcHJvZHVjdCA9IGNhcnRlc2lhblByb2R1Y3QoTGF6eShmaWx0ZXIpLnZhbHVlcygpLnRvQXJyYXkoKSk7XG4gICAgICAgIHZhciBrZXlzID0gTGF6eShmaWx0ZXIpLmtleXMoKS50b0FycmF5KCk7XG4gICAgICAgIHJldHVybiBwcm9kdWN0Lm1hcChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgIHZhciByID0ge307XG4gICAgICAgICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24oYSxuKXtcbiAgICAgICAgICAgICAgICByW2FdID0geFtuXTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgIH07XG4gICAgdmFyIGZpbHRlclNpbmdsZSA9IGZ1bmN0aW9uKG1vZGVsLCBmaWx0ZXIsIHRlc3RPbmx5KXtcbiAgICAgICAgLy8gTGF6eSBhdXRvIGNyZWF0ZSBpbmRleGVzXG4gICAgICAgIHZhciBtb2RlbE5hbWUgPSBtb2RlbC5tb2RlbE5hbWU7XG4gICAgICAgIHZhciBnZXRJbmRleEZvciA9IHRoaXMuZ2V0SW5kZXhGb3I7XG4gICAgICAgIHZhciBrZXlzID0gTGF6eShmaWx0ZXIpLm1hcChmdW5jdGlvbih2LGtleSl7IHJldHVybiBba2V5LCBtb2RlbE5hbWUgKyAnLicgKyBrZXldOyB9KS50b09iamVjdCgpO1xuICAgICAgICB2YXIgaW5kZXhlcyA9IExhenkoZmlsdGVyKS5rZXlzKCkubWFwKGZ1bmN0aW9uKGtleSl7IHJldHVybiBba2V5LCBnZXRJbmRleEZvcihtb2RlbE5hbWUsIGtleSldfSkudG9PYmplY3QoKTsgXG4gICAgICAgIC8vIGZha2UgZm9yIChpdCB3aWxsIGN5Y2xlIG9uY2UpXG4gICAgICAgIGZvciAodmFyIHggaW4gZmlsdGVyKXtcbiAgICAgICAgICAgIC8vIGdldCBhc2tlZCBpbmRleCBhbmQgY2hlY2sgcHJlc2VuY2VcbiAgICAgICAgICAgIHZhciBkaWZmZXJlbmNlID0gTGF6eShmaWx0ZXJbeF0pLmRpZmZlcmVuY2UoaW5kZXhlc1t4XSkudG9BcnJheSgpO1xuICAgICAgICAgICAgaWYgKGRpZmZlcmVuY2UubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAvLyBnZW5lcmF0ZSBuZXcgZmlsdGVyXG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IExhenkoW1t4LCBkaWZmZXJlbmNlXV0pLnRvT2JqZWN0KCk7XG4gICAgICAgICAgICAgICAgLy8gcmVtZW1iZXIgYXNrZWRcbiAgICAgICAgICAgICAgICBpZiAoIXRlc3RPbmx5KVxuICAgICAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShpbmRleGVzW3hdLCBkaWZmZXJlbmNlKTtcbi8vICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzaW5nbGUgZmlsdGVyIDogJyArIEpTT04uc3RyaW5naWZ5KGZpbHRlcikgKyAnXFxuT3V0IDonICsgSlNPTi5zdHJpbmdpZnkocmV0KSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlIGZpbHRlciA6ICcgKyBKU09OLnN0cmluZ2lmeShmaWx0ZXIpICsgJ1xcbk91dCA6IG51bGwnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgY2xlYW5Db21wb3NpdGVzID0gZnVuY3Rpb24obW9kZWwsZmlsdGVyKXtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNsZWFuIGNvbXBvc2l0ZUFza2VkXG4gICAgICAgICAqL1xuICAgICAgICAvLyBsYXp5IGNyZWF0ZSBjb25kaXRpb25hbCBhc2tlZCBpbmRleFxuICAgICAgICBpZiAoIShtb2RlbC5uYW1lIGluIGNvbXBvc2l0ZUFza2VkKSkgeyBjb21wb3NpdGVBc2tlZFttb2RlbC5uYW1lXSA9IFtdIH07XG4gICAgICAgIHZhciBpbmRleCA9IGNvbXBvc2l0ZUFza2VkW21vZGVsLm5hbWVdO1xuICAgICAgICAvLyBzZWFyY2ggZm9yIGFsbCBlbGVtZW50cyB3aG8gaGF2ZSBzYW1lIHBhcnRpYWxcbiAgICAgICAgdmFyIGZpbHRlckxlbiA9IExhenkoZmlsdGVyKS5zaXplKCk7XG4gICAgICAgIHZhciBpdGVtcyA9IGluZGV4LmZpbHRlcih1dGlscy5tYWtlRmlsdGVyKG1vZGVsLCBmaWx0ZXIsICcgJiYgJyx0cnVlKSkuZmlsdGVyKGZ1bmN0aW9uKGl0ZW0peyBMYXp5KGl0ZW0pLnNpemUoKSA+IGZpbHRlckxlbiB9KTtcbi8vICAgICAgICBjb25zb2xlLmxvZygnZGVsZXRpbmcgOicgKyBKU09OLnN0cmluZ2lmeShpdGVtcykpO1xuICAgIH07XG5cbiAgICB0aGlzLmZpbHRlciA9IGZ1bmN0aW9uKG1vZGVsLCBmaWx0ZXIpe1xuLy8gICAgICAgIGNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0tLS1cXG5maWx0ZXIgOiAnICsgSlNPTi5zdHJpbmdpZnkoZmlsdGVyKSk7XG4gICAgICAgIHZhciBtb2RlbE5hbWUgPSBtb2RlbC5tb2RlbE5hbWU7XG5cbiAgICAgICAgLy8gaWYgeW91IGZldGNoIGFsbCBvYmplY3RzIGZyb20gc2VydmVyLCB0aGlzIG1vZGVsIGhhcyB0byBiZSBtYXJrZWQgYXMgZ290IGFsbDtcbiAgICAgICAgdmFyIGZpbHRlckxlbiAgPSBMYXp5KGZpbHRlcikuc2l6ZSgpO1xuICAgICAgICBzd2l0Y2ggKGZpbHRlckxlbikge1xuICAgICAgICAgICAgY2FzZSAwIDoge1xuICAgICAgICAgICAgICAgIC8vIHJldHVybiBudWxsIG9yIGFsbFxuICAgICAgICAgICAgICAgIHZhciBnb3QgPSBnb3RBbGxbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICBnb3RBbGxbbW9kZWxOYW1lXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBhc2tlZCl7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBhc2tlZFttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvdXQgOiBudWxsIChnb3QgYWxsKScpO1xuICAgICAgICAgICAgICAgIC8vIGNvbmRpdGlvbmFsIGNsZWFuXG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBjb21wb3NpdGVBc2tlZCl7IFxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY29tcG9zaXRlQXNrZWRbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdvdClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSAxIDoge1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSBmaWx0ZXJTaW5nbGUuY2FsbCh0aGlzLCBtb2RlbCwgZmlsdGVyKTtcbiAgICAgICAgICAgICAgICBjbGVhbkNvbXBvc2l0ZXMuY2FsbCh0aGlzLCBtb2RlbCwgZmlsdGVyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICB2YXIgc2luZ2xlID0gTGF6eShmaWx0ZXIpLmtleXMoKS5zb21lKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgdmFyIGYgPSB7fTtcbiAgICAgICAgICAgIGZba2V5XSA9IGZpbHRlcltrZXldO1xuICAgICAgICAgICAgcmV0dXJuIGZpbHRlclNpbmdsZS5jYWxsKHRocywgbW9kZWwsIGYsIHRydWUpID09IG51bGw7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoc2luZ2xlKSB7IHJldHVybiBudWxsIH1cbiAgICAgICAgLy8gbGF6eSBjcmVhdGUgY29tcG9zaXRlQXNrZWRcbiAgICAgICAgaWYgKCEobW9kZWxOYW1lIGluIGNvbXBvc2l0ZUFza2VkKSl7IGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV0gPSBbXTsgfVxuICAgICAgICAvLyBleHBsb2RlIGZpbHRlclxuICAgICAgICB2YXIgZXhwbG9kZWQgPSBleHBsb2RlRmlsdGVyKGZpbHRlcik7XG4gICAgICAgIC8vIGNvbGxlY3QgcGFydGlhbHNcbiAgICAgICAgdmFyIHBhcnRpYWxzID0gY29tcG9zaXRlQXNrZWRbbW9kZWxOYW1lXS5maWx0ZXIodXRpbHMubWFrZUZpbHRlcihtb2RlbCwgZmlsdGVyLCAnIHx8ICcsdHJ1ZSkpO1xuICAgICAgICAvLyBjb2xsZWN0IG1pc3NpbmdzIChleHBsb2RlZCAtIHBhcnRpYWxzKVxuICAgICAgICBpZiAocGFydGlhbHMubGVuZ3RoKXtcbiAgICAgICAgICAgIHZhciBiYWQgID0gW107XG4gICAgICAgICAgICAvLyBwYXJ0aWFsIGRpZmZlcmVuY2VcbiAgICAgICAgICAgIGZvciAodmFyIHggaW4gcGFydGlhbHMpe1xuICAgICAgICAgICAgICAgIGJhZC5wdXNoLmFwcGx5KGJhZCxleHBsb2RlZC5maWx0ZXIodXRpbHMubWFrZUZpbHRlcihtb2RlbCwgcGFydGlhbHNbeF0sJyAmJiAnLCB0cnVlKSkpO1xuICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICBjb25zb2xlLmxvZygnZXhwbG9kZWQgLSBwYXJ0aWFsIDogJyArIEpTT04uc3RyaW5naWZ5KGJhZCkpO1xuICAgICAgICAgICAgdmFyIG1pc3NpbmdzID0gTGF6eShleHBsb2RlZCkuZGlmZmVyZW5jZShiYWQpLnRvQXJyYXkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBtaXNzaW5ncyA9IGV4cGxvZGVkO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZmlsdGVyIHBhcnRpYWxzXG4gICAgICAgIGlmIChtaXNzaW5ncy5sZW5ndGgpe1xuICAgICAgICAgICAgY29tcG9zaXRlQXNrZWRbbW9kZWxOYW1lXS5wdXNoLmFwcGx5KGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV0sbWlzc2luZ3MpO1xuICAgICAgICAgICAgLy8gYWdncmVnYXRlIG1pc3NpbmdzXG4gICAgICAgICAgICB2YXIgbWlzc2luZ3MgPSBMYXp5KGZpbHRlcikua2V5cygpLm1hcChmdW5jdGlvbihrZXkpe1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSBMYXp5KG1pc3NpbmdzKS5wbHVjayhrZXkpLnVuaXF1ZSgpLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gW2tleSwgcmV0Lmxlbmd0aD9yZXQ6ZmlsdGVyW2tleV1dO1xuICAgICAgICAgICAgfSkudG9PYmplY3QoKTtcbi8vICAgICAgICAgICAgY29uc29sZS5sb2coJ291dCA6ICcgKyBKU09OLnN0cmluZ2lmeShtaXNzaW5ncykpO1xuICAgICAgICAgICAgLy8gY2xlYW4gY29uZGl0aW9uYWxcbiAgICAgICAgICAgIGNsZWFuQ29tcG9zaXRlcyhtb2RlbCwgbWlzc2luZ3MpO1xuICAgICAgICAgICAgcmV0dXJuIG1pc3NpbmdzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG5cbiAgICB0aGlzLmdldEluZGV4Rm9yID0gZnVuY3Rpb24obW9kZWxOYW1lLCBmaWVsZE5hbWUpe1xuICAgICAgICB2YXIgaW5kZXhOYW1lID0gbW9kZWxOYW1lICsgJy4nICsgZmllbGROYW1lO1xuICAgICAgICBpZiAoIShpbmRleE5hbWUgaW4gYXNrZWQpKXtcbiAgICAgICAgICAgIGFza2VkW2luZGV4TmFtZV0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXNrZWRbaW5kZXhOYW1lXTtcbiAgICB9XG59OyIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gTWFueVRvTWFueVJlbGF0aW9uKHJlbGF0aW9uLG0ybSl7XG4gICAgdmFyIGl0ZW1zID0gW107XG4gICAgdGhpcy5hZGQgPSBpdGVtcy5wdXNoLmJpbmQoaXRlbXMpO1xuICAgIHRoaXMuYWRkID0gZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgIGNvbnNvbGUubG9nKCdhZGRpbmcgJyArIGl0ZW0pO1xuICAgICAgICBpZiAoIShMYXp5KGl0ZW1zKS5maW5kKGl0ZW0pKSl7XG4gICAgICAgICAgICBpdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5nZXQwID0gZnVuY3Rpb24oaWQpe1xuICAgICAgICBtMm1bMV0uYXNrKGlkKTtcbiAgICAgICAgcmV0dXJuIExhenkoaXRlbXMpLmZpbHRlcihmdW5jdGlvbih4KXtcbiAgICAgICAgICAgIHJldHVybiB4WzBdID09PSBpZDtcbiAgICAgICAgfSkucGx1Y2soXCIxXCIpLnRvQXJyYXkoKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXQxID0gZnVuY3Rpb24oaWQpe1xuICAgICAgICBtMm1bMF0uYXNrKGlkKTtcbiAgICAgICAgcmV0dXJuIExhenkoaXRlbXMpLmZpbHRlcihmdW5jdGlvbih4KXtcbiAgICAgICAgICAgIHJldHVybiB4WzFdID09PSBpZDtcbiAgICAgICAgfSkucGx1Y2soXCIwXCIpLnRvQXJyYXkoKTtcbiAgICB9O1xuICAgIHRoaXNbJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKHJlbGF0aW9uLmluZGV4TmFtZS5zcGxpdCgnLycpWzFdKV0gPSB0aGlzLmdldDE7XG4gICAgdGhpc1snZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUocmVsYXRpb24uaW5kZXhOYW1lLnNwbGl0KCcvJylbMF0pXSA9IHRoaXMuZ2V0MDtcblxuICAgIHRoaXMuZGVsID0gZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgIHZhciBsID0gaXRlbXMubGVuZ3RoO1xuICAgICAgICB2YXIgaWR4ID0gbnVsbDtcbiAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCBsOyBhKyspeyBcbiAgICAgICAgICAgIGlmICgoaXRlbXNbYV1bMF0gPT09IGl0ZW1bMF0pICYmIChpdGVtc1thXVsxXSA9PT0gaXRlbVsxXSkpe1xuICAgICAgICAgICAgICAgIGlkeCA9IGE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlkeCl7XG4gICAgICAgICAgICBpdGVtcy5zcGxpY2UoYSwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0aW5nICcsIGl0ZW0pO1xuICAgIH07XG59IiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBjYWNoZWRQcm9wZXJ0eUJ5RXZlbnRzKHByb3RvLCBwcm9wZXJ0eU5hbWUsZ2V0dGVyLCBzZXR0ZXIpe1xuICAgIHZhciBldmVudHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNCk7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIFxuICAgIExhenkoZXZlbnRzKS5lYWNoKGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgcHJvdG8ub3JtLm9uKGV2ZW50LGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICByZXN1bHQgPSB7fTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgdmFyIHByb3BlcnR5RGVmID0ge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGNhY2hlZCgpe1xuICAgICAgICAgICAgaWYgKCEodGhpcy5pZCBpbiByZXN1bHQpKXtcbiAgICAgICAgICAgICAgICByZXN1bHRbdGhpcy5pZF0gPSBnZXR0ZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHRbdGhpcy5pZF07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGlmIChzZXR0ZXIpe1xuICAgICAgICBwcm9wZXJ0eURlZlsnc2V0J10gPSBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgICAgICBpZiAodmFsdWUgIT09IHJlc3VsdFt0aGlzLmlkXSl7XG4gICAgICAgICAgICAgICAgc2V0dGVyLmNhbGwodGhpcyx2YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaWQgaW4gcmVzdWx0KXtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHJlc3VsdFt0aGlzLmlkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvLCBwcm9wZXJ0eU5hbWUscHJvcGVydHlEZWYpO1xufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBWYWxpZGF0aW9uRXJyb3IoZGF0YSl7XG4gICAgdGhpcy5yZXNvdXJjZSA9IGRhdGEuX3Jlc291cmNlO1xuICAgIHRoaXMuZm9ybUlkeCA9IGRhdGEuZm9ybUlkeDtcbiAgICB0aGlzLmZpZWxkcyA9IGRhdGEuZXJyb3JzO1xufVxudmFyIGJhc2VPUk0gPSBmdW5jdGlvbihvcHRpb25zLCBleHRPUk0pe1xuICAgIFxuICAgIC8vIGNyZWF0aW5nIHJld2hlZWwgY29ubmVjdGlvblxuICAgIGlmIChvcHRpb25zLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpe1xuICAgICAgICB2YXIgY29ubmVjdGlvbiA9IG5ldyByZVdoZWVsQ29ubmVjdGlvbihvcHRpb25zKTtcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMuY29uc3RydWN0b3IgPT09IHV0aWxzLnJlV2hlZWxDb25uZWN0aW9uKXtcbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBvcHRpb25zO1xuICAgIH1cbiAgICB0aGlzLmNvbm5lY3Rpb24gPSBjb25uZWN0aW9uO1xuICAgIGNvbm5lY3Rpb24ub24oJ2Nvbm5lY3RlZCcsIGZ1bmN0aW9uKCl7IFxuICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IHRydWU7XG4gICAgfSk7XG4gICAgdmFyIGV2ZW50cyA9IGNvbm5lY3Rpb24uZXZlbnRzO1xuICAgIHRoaXMub24gPSBldmVudHMub24uYmluZCh0aGlzKTtcbiAgICB0aGlzLmVtaXQgPSBldmVudHMuZW1pdC5iaW5kKHRoaXMpO1xuICAgIHRoaXMudW5iaW5kID0gZXZlbnRzLnVuYmluZC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuJHBvc3QgPSBjb25uZWN0aW9uLiRwb3N0LmJpbmQoY29ubmVjdGlvbik7XG5cbiAgICAvLyBoYW5kbGluZyB3ZWJzb2NrZXQgZXZlbnRzXG4gICAgZXZlbnRzLm9uKCd3cy1jb25uZWN0ZWQnLGZ1bmN0aW9uKHdzKXtcbiAgICAgICAgY29uc29sZS5pbmZvKCdXZWJzb2NrZXQgY29ubmVjdGVkJyk7XG4gICAgICAgIC8vIGFsbCBqc29uIGRhdGEgaGFzIHRvIGJlIHBhcnNlZCBieSBnb3REYXRhXG4gICAgICAgIHdzLm9uTWVzc2FnZUpzb24oVzJQUkVTT1VSQ0UuZ290RGF0YS5iaW5kKFcyUFJFU09VUkNFKSk7XG4gICAgICAgIC8vXG4gICAgICAgIHdzLm9uTWVzc2FnZVRleHQoZnVuY3Rpb24obWVzc2FnZSl7XG4gICAgICAgICAgICBjb25zb2xlLmluZm8oJ1dTIG1lc3NhZ2UgOiAnICsgbWVzc2FnZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgZXZlbnRzLm9uKCd3cy1kaXNjb25uZWN0ZWQnLCBmdW5jdGlvbih3cyl7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dlYnNvY2tldCBkaXNjb25uZWN0ZWQnKVxuICAgIH0pO1xuICAgIGV2ZW50cy5vbignZXJyb3ItanNvbi00MDQnLGZ1bmN0aW9uKGVycm9yLHVybCwgc2VudERhdGEsIHhocil7IFxuICAgICAgICBjb25zb2xlLmVycm9yKCdKU09OIGVycm9yICcsIEpTT04uc3RyaW5naWZ5KGVycm9yKSk7XG4gICAgICAgIGRlbGV0ZSB3YWl0aW5nQ29ubmVjdGlvbnNbdXJsLnNwbGl0KCcvJylbMF1dO1xuICAgIH0pXG5cbiAgICAvLyBpbml0aWFsaXphdGlvblxuICAgIHZhciBXMlBSRVNPVVJDRSA9IHRoaXM7XG4gICAgdmFyIElEQiA9IHthdXRoX2dyb3VwIDogTGF6eSh7fSl9OyAvLyB0YWJsZU5hbWUgLT4gZGF0YSBhcyBBcnJheVxuICAgIHZhciBJRFggPSB7fTsgLy8gdGFibGVOYW1lIC0+IExhenkoaW5kZXhCeSgnaWQnKSkgLT4gSURCW2RhdGFdXG4gICAgdmFyIFJFVklEWCA9IHt9OyAvLyB0YWJsZU5hbWUgLT4gZmllbGROYW1lIC0+IExhenkuZ3JvdXBCeSgpIC0+IElEQltEQVRBXVxuICAgIHZhciBidWlsZGVySGFuZGxlcnMgPSB7fTtcbiAgICB2YXIgYnVpbGRlckhhbmRsZXJVc2VkID0ge307XG4gICAgdmFyIHBlcnNpc3RlbnRBdHRyaWJ1dGVzID0ge307XG4gICAgdmFyIGV2ZW50SGFuZGxlcnMgPSB7fTtcbiAgICB2YXIgcGVybWlzc2lvbldhaXRpbmcgPSB7fTtcbiAgICB2YXIgbW9kZWxDYWNoZSA9IHt9O1xuICAgIHZhciBmYWlsZWRNb2RlbHMgPSB7fTtcbiAgICB2YXIgd2FpdGluZ0Nvbm5lY3Rpb25zID0ge30gLy8gYWN0dWFsIGNvbm5lY3Rpb24gd2hvIGknbSB3YWl0aW5nIGZvclxuICAgIHZhciBsaXN0Q2FjaGUgPSBuZXcgTGlzdENhY2hlcihMYXp5KTtcbiAgICB2YXIgbGlua2VyID0gbmV3IEF1dG9MaW5rZXIoZXZlbnRzLHdhaXRpbmdDb25uZWN0aW9ucyxJREIsIHRoaXMsIGxpc3RDYWNoZSk7XG4vKiAgICB3aW5kb3cubGwgPSBsaW5rZXI7XG4gICAgd2luZG93LmxjID0gbGlzdENhY2hlO1xuKi9cbiAgICB0aGlzLnZhbGlkYXRpb25FdmVudCA9IGV2ZW50cy5vbignZXJyb3ItanNvbi01MTMnLCBmdW5jdGlvbihkYXRhLCB1cmwsIHNlbnREYXRhLCB4aHIpe1xuICAgICAgICBpZiAoY3VycmVudENvbnRleHQuc2F2aW5nRXJyb3JIYW5sZGVyKXtcbiAgICAgICAgICAgIGN1cnJlbnRDb250ZXh0LnNhdmluZ0Vycm9ySGFubGRlcihuZXcgVmFsaWRhdGlvbkVycm9yKGRhdGEpKTtcbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICB2YXIgZ2V0SW5kZXggPSBmdW5jdGlvbiAoaW5kZXhOYW1lKSB7XG4gICAgICAgIGlmIChpbmRleE5hbWUgaW4gSURCKVxuICAgICAgICAgICAgcmV0dXJuIElEQltpbmRleE5hbWVdO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIElEQltpbmRleE5hbWVdID0gTGF6eSh7fSk7XG4gICAgICAgICAgICByZXR1cm4gSURCW2luZGV4TmFtZV07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBnZXRVbmxpbmtlZCA9IGZ1bmN0aW9uIChpbmRleE5hbWUpIHtcbiAgICAgICAgaWYgKGluZGV4TmFtZSBpbiBVTkxJTktFRClcbiAgICAgICAgICAgIHJldHVybiBVTkxJTktFRFtpbmRleE5hbWVdO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIFVOTElOS0VEW2luZGV4TmFtZV0gPSB7fTtcbiAgICAgICAgICAgIHJldHVybiBVTkxJTktFRFtpbmRleE5hbWVdO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFBlcm1pc3Npb25UYWJsZShpZCwga2xhc3MsIHBlcm1pc3Npb25zKSB7XG4gICAgICAgIC8vIGNyZWF0ZSBQZXJtaXNzaW9uVGFibGUgY2xhc3NcbiAgICAgICAgdGhpcy5rbGFzcyA9IGtsYXNzO1xuICAgICAgICB0aGlzLnBlcm1pc3Npb25zID0gW107XG4gICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgZm9yICh2YXIgayBpbiBwZXJtaXNzaW9ucykge1xuICAgICAgICAgICAgdGhpcy5wdXNoLmFwcGx5KHRoaXMsIFtrLCBwZXJtaXNzaW9uc1trXV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIFBlcm1pc3Npb25UYWJsZS5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAvLyBzYXZlIE9iamVjdCB0byBzZXJ2ZXJcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBwZXJtaXNzaW9uczogTGF6eSh0aGlzLnBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW3hbMF0uaWQsIHhbMV1dXG4gICAgICAgICAgICB9KS50b09iamVjdCgpXG4gICAgICAgIH07XG4gICAgICAgIGRhdGEuaWQgPSB0aGlzLmlkO1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gdGhpcy5rbGFzcy5tb2RlbE5hbWU7XG4gICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KHRoaXMua2xhc3MubW9kZWxOYW1lICsgJy9zZXRfcGVybWlzc2lvbnMnLCBkYXRhLCBmdW5jdGlvbiAobXlQZXJtcywgYSwgYiwgcmVxKSB7XG4gICAgICAgICAgICBjYihteVBlcm1zKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBQZXJtaXNzaW9uVGFibGUucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAoZ3JvdXBfaWQsIHBlcm1pc3Npb25MaXN0KSB7XG4gICAgICAgIHZhciBwID0gTGF6eShwZXJtaXNzaW9uTGlzdCk7XG4gICAgICAgIHZhciBwZXJtcyA9IExhenkodGhpcy5rbGFzcy5hbGxQZXJtaXNzaW9ucykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4gW3gsIHAuY29udGFpbnMoeCldXG4gICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgIHZhciBsID0gTGF6eSh0aGlzLnBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHJldHVybiB4WzBdLmlkXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAobC5jb250YWlucyhncm91cF9pZCkpXG4gICAgICAgICAgICB0aGlzLnBlcm1pc3Npb25zW2wuaW5kZXhPZihncm91cF9pZCldWzFdID0gcGVybXM7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRoaXMucGVybWlzc2lvbnMucHVzaChbSURCLmF1dGhfZ3JvdXAuZ2V0KGdyb3VwX2lkKSwgcGVybXNdKTtcbiAgICB9O1xuXG4gICAgLy8gY3JlYXRlcyBkeW5hbWljYWwgbW9kZWxzXG4gICAgdmFyIG1ha2VNb2RlbENsYXNzID0gZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgICAgIHZhciBfbW9kZWwgPSBtb2RlbDtcbiAgICAgICAgdmFyIGZpZWxkcyA9IExhenkobW9kZWwuZmllbGRzKTtcbiAgICAgICAgaWYgKG1vZGVsLnByaXZhdGVBcmdzKSB7XG4gICAgICAgICAgICBmaWVsZHMgPSBmaWVsZHMubWVyZ2UobW9kZWwucHJpdmF0ZUFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ21vZGVsLWRlZmluaXRpb24nLCBtb2RlbCk7XG4gICAgICAgIC8vIGdldHRpbmcgZmllbGRzIG9mIHR5cGUgZGF0ZSBhbmQgZGF0ZXRpbWVcbi8qXG4gICAgICAgIHZhciBEQVRFRklFTERTID0gZmllbGRzLmZpbHRlcihmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuICh4LnR5cGUgPT0gJ2RhdGUnKSB8fCAoeC50eXBlID09ICdkYXRldGltZScpXG4gICAgICAgIH0pLm1hcChmdW5jdGlvbiAoeCwgdikge1xuICAgICAgICAgICAgcmV0dXJuIFt2LCB0cnVlXVxuICAgICAgICB9KS50b09iamVjdCgpO1xuXG4gICAgICAgIC8vIGdldHRpbmcgYm9vbGVhbiBmaWVsZHNcbiAgICAgICAgdmFyIEJPT0xGSUVMRFMgPSBmaWVsZHMuZmlsdGVyKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4gKHgudHlwZSA9PSAnYm9vbGVhbicpXG4gICAgICAgIH0pLm1hcChmdW5jdGlvbiAoeCwgdikge1xuICAgICAgICAgICAgcmV0dXJuIFt2LCB0cnVlXVxuICAgICAgICB9KS50b09iamVjdCgpO1xuXG4gICAgICAgIC8vIGJvb2xlYW5zIGFuZCBkYXRldGltZXMgc3RvcmFnZSBleHRlcm5hbCBcbiAgICAgICAgTU9ERUxfREFURUZJRUxEU1ttb2RlbC5uYW1lXSA9IERBVEVGSUVMRFM7XG4gICAgICAgIE1PREVMX0JPT0xGSUVMRFNbbW9kZWwubmFtZV0gPSBCT09MRklFTERTO1xuKi9cbiAgICAgICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICAgICAgdmFyIGZ1bmNTdHJpbmcgPSBcImlmICghcm93KSB7IHJvdyA9IHt9fTtcXG5cIjtcbiAgICAgICAgZnVuY1N0cmluZyArPSBtb2RlbC5yZWZlcmVuY2VzLm1hcChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICByZXR1cm4gJ3RoaXMuXycgKyBmaWVsZC5pZCArICcgPSByb3cuJyArIGZpZWxkLmlkICsgJzsnO1xuICAgICAgICB9KS5qb2luKCc7XFxuJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBkYXRlZmllbGQgY29udmVyc2lvblxuICAgICAgICBmdW5jU3RyaW5nICs9IGZpZWxkcy5tYXAoZnVuY3Rpb24gKHgsaykge1xuICAgICAgICAgICAgaWYgKCh4LnR5cGUgPT0gJ2RhdGUnKSB8fCAoeC50eXBlID09ICdkYXRldGltZScpKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ3RoaXMuJyArIGsgKyAnID0gcm93LicgKyBrICsgJz9uZXcgRGF0ZShyb3cuJyArIGsgKyAnICogMTAwMCAtICcgKyB1dGlscy50ek9mZnNldCArICcpOm51bGw7XFxuJzsgXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHgudHlwZSA9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ3RoaXMuJyArIGsgKyAnID0gKHJvdy4nICsgayArICcgPT09IFwiVFwiKSB8fCAocm93LicgKyBrICsgJyA9PT0gdHJ1ZSk7XFxuJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICd0aGlzLicgKyBrICsgJyA9IHJvdy4nICsgayArICc7XFxuJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkudG9TdHJpbmcoJ1xcbicpOyArICdcXG4nO1xuXG4gICAgICAgIGZ1bmNTdHJpbmcgKz0gXCJpZiAocGVybWlzc2lvbnMpIHt0aGlzLl9wZXJtaXNzaW9ucyA9IHBlcm1pc3Npb25zICYmIExhenkocGVybWlzc2lvbnMpLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gW3gsIHRydWVdIH0pLnRvT2JqZWN0KCk7fVwiXG5cbiAgICAgICAgXG4gICAgICAgIC8vIG1hc3RlciBjbGFzcyBmdW5jdGlvblxuICAgICAgICB2YXIgS2xhc3MgPSBuZXcgRnVuY3Rpb24oJ3JvdycsICdwZXJtaXNzaW9ucycsZnVuY1N0cmluZylcblxuICAgICAgICBLbGFzcy5wcm90b3R5cGUub3JtID0gZXh0T1JNO1xuICAgICAgICBLbGFzcy5yZWZfdHJhbnNsYXRpb25zID0ge307XG4gICAgICAgIEtsYXNzLm1vZGVsTmFtZSA9IG1vZGVsLm5hbWU7XG4gICAgICAgIEtsYXNzLnJlZmVyZW5jZXMgPSBMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLnBsdWNrKCdpZCcpLnRvQXJyYXkoKTtcblxuICAgICAgICBLbGFzcy5pbnZlcnNlX3JlZmVyZW5jZXMgPSBtb2RlbC5yZWZlcmVuY2VkQnkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAvLyBtYW5hZ2luZyByZWZlcmVuY2VzIHdoZXJlIFxuICAgICAgICAgICAgcmV0dXJuIHguYnkgKyAnXycgKyB4LmlkICsgJ19zZXQnXG4gICAgICAgIH0pO1xuICAgICAgICBLbGFzcy5yZWZlcmVudHMgPSBtb2RlbC5yZWZlcmVuY2VkQnkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4gW3guYnksIHguaWRdXG4gICAgICAgIH0pO1xuICAgICAgICBLbGFzcy5maWVsZHNPcmRlciA9IG1vZGVsLmZpZWxkT3JkZXI7XG4gICAgICAgIEtsYXNzLmFsbFBlcm1pc3Npb25zID0gbW9kZWwucGVybWlzc2lvbnM7XG5cbiAgICAgICAgLy8gcmVkZWZpbmluZyB0b1N0cmluZyBtZXRob2RcbiAgICAgICAgaWYgKExhenkobW9kZWwucmVwcmVzZW50YXRpb24pLnNpemUoKSl7XG4gICAgICAgICAgICBLbGFzcy5wcm90b3R5cGUudG9TdHJpbmcgPSBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzLicgKyBMYXp5KG1vZGVsLnJlcHJlc2VudGF0aW9uKS50b1N0cmluZygnICsgXCIgXCIgKyB0aGlzLicpKTtcbiAgICAgICAgfVxuICAgICAgICBLbGFzcy5wcm90b3R5cGUudG9VcHBlckNhc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyByZWRlZmluZSB0byBVcHBlckNhc2VcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKTtcbiAgICAgICAgfTtcbiAgICAgIFxuICAgICAgICBLbGFzcy5wcm90b3R5cGUudG9Mb3dlckNhc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICBLbGFzcy5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gZGVsZXRlIGluc3RhbmNlIGZyb20gc2VydmVyXG4gICAgICAgICAgICByZXR1cm4gZXh0T1JNLmRlbGV0ZSh0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZSwgW3RoaXMuaWRdKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwZXJtaXNzaW9uIGdldHRlciBwcm9wZXJ0eVxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoS2xhc3MucHJvdG90eXBlLCAncGVybWlzc2lvbnMnLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcGVybWlzc2lvbnMpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wZXJtaXNzaW9ucztcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGlua2VyLnBlcm1pc3Npb25zW3RoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lXS5hc2sodGhpcy5pZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gZ2V0dGluZyBmdWxsIHBlcm1pc3Npb24gdGFibGUgZm9yIGFuIG9iamVjdFxuICAgICAgICBLbGFzcy5wcm90b3R5cGUuYWxsX3Blcm1zID0gZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgICAgICB2YXIgb2JqZWN0X2lkID0gdGhpcy5pZDtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KHRoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lICsgJy9hbGxfcGVybXMnLCB7aWQ6IHRoaXMuaWR9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBwZXJtaXNzaW9ucyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwZWQgPSB7fTtcbiAgICAgICAgICAgICAgICB2YXIgdW5rbm93bl9ncm91cHMgPSBMYXp5KHBlcm1pc3Npb25zKS5wbHVjaygnZ3JvdXBfaWQnKS51bmlxdWUoKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnICsgeFxuICAgICAgICAgICAgICAgIH0pLmRpZmZlcmVuY2UoSURCLmF1dGhfZ3JvdXAua2V5cygpKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgTGF6eShwZXJtaXNzaW9ucykuZ3JvdXBCeShmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geC5ncm91cF9pZFxuICAgICAgICAgICAgICAgIH0pLmVhY2goZnVuY3Rpb24gKHYsIGspIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBlZFtrXSA9IExhenkodikucGx1Y2soJ25hbWUnKS50b0FycmF5KClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgY2FsbCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIGNiKG5ldyBQZXJtaXNzaW9uVGFibGUob2JqZWN0X2lkLCBLbGFzcywgZ3JvdXBlZCkpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHVua25vd25fZ3JvdXBzLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ2V0KCdhdXRoX2dyb3VwJyx1bmtub3duX2dyb3VwcyxjYWxsKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGNhbGwoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBvID0gdGhpcy5hc1JhdygpO1xuICAgICAgICAgICAgdmFyIGZpZWxkcyA9IEtsYXNzLmZpZWxkcztcbiAgICAgICAgICAgIHZhciBJRCA9IHRoaXMuaWQ7XG4gICAgICAgICAgICB2YXIgbW9kZWxOYW1lID0gdGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWU7XG4gICAgICAgICAgICBpZiAoYXJncykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGFyZyBpbiBhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIG9bYXJnXSA9IGFyZ3NbYXJnXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBlbGltaW5hdGUgdW53cml0YWJsZXNcbiAgICAgICAgICAgIExhenkoS2xhc3MuZmllbGRzT3JkZXIpLmZpbHRlcihmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICByZXR1cm4gIWZpZWxkc1t4XS53cml0YWJsZTtcbiAgICAgICAgICAgIH0pLmVhY2goZnVuY3Rpb24oZmllbGROYW1lKXtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGROYW1lIGluIG8pIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9bZmllbGROYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gVzJQUkVTT1VSQ0UuJHBvc3QobW9kZWxOYW1lICsgKElEID8gJy9wb3N0JyA6ICcvcHV0JyksIG8pO1xuICAgICAgICAgICAgaWYgKGFyZ3MgJiYgKGFyZ3MuY29uc3RydWN0b3IgPT09IEZ1bmN0aW9uKSl7XG4gICAgICAgICAgICAgICAgLy8gcGxhY2luZyBjYWxsYmFjayBpbiBhIGNvbW1vbiBwbGFjZVxuICAgICAgICAgICAgICAgIHByb21pc2UuY29udGV4dC5zYXZpbmdFcnJvckhhbmxkZXIgPSBhcmdzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHByb21pc2VcbiAgICAgICAgfTtcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb2JqID0gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5hc1JhdygpKTtcbiAgICAgICAgICAgIG9iai5fcGVybWlzc2lvbnMgPSB0aGlzLl9wZXJtaXNzaW9ucztcbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gYnVpbGRpbmcgc2VyaWFsaXphdGlvbiBmdW5jdGlvblxuICAgICAgICB2YXIgYXNyID0gJ3JldHVybiB7XFxuJyArIExhenkobW9kZWwucmVmZXJlbmNlcykubWFwKGZ1bmN0aW9uKGZpZWxkKXtcbiAgICAgICAgICAgIHJldHVybiBmaWVsZC5pZCArICcgOiB0aGlzLl8nICsgZmllbGQuaWQ7XG4gICAgICAgIH0pLmNvbmNhdChmaWVsZHMubWFwKGZ1bmN0aW9uICh4LGspIHtcbiAgICAgICAgICAgIGlmICgoeC50eXBlID09ICdkYXRlJykgfHwgKHgudHlwZSA9PSAnZGF0ZXRpbWUnKSl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGsgKyAnIDogKHRoaXMuJyArIGsgKyAnPyhNYXRoLnJvdW5kKHRoaXMuJyArIGsgKyAnLmdldFRpbWUoKSAtIHRoaXMuJyArIGsgKyAnLmdldFRpbWV6b25lT2Zmc2V0KCkgKiA2MDAwMCkgLyAxMDAwKTpudWxsKSc7IFxuICAgICAgICAgICAgfSBlbHNlIGlmICh4LnR5cGUgPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGsgKyAnIDogdGhpcy4nICsgayArICc/XCJUXCI6XCJGXCInO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gayArICcgOiB0aGlzLicgKyBrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSkudG9TdHJpbmcoJyxcXG4nKSArICd9Oyc7XG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS5hc1JhdyA9IG5ldyBGdW5jdGlvbihhc3IpO1xuXG4gICAgICAgIEtsYXNzLnNhdmVNdWx0aSA9IGZ1bmN0aW9uIChvYmplY3RzLCBjYiwgc2NvcGUpIHtcbiAgICAgICAgICAgIHZhciByYXcgPSBbXTtcbiAgICAgICAgICAgIHZhciBkZWxldGFibGUgPSBMYXp5KEtsYXNzLmZpZWxkcylcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAheC53cml0YWJsZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnBsdWNrKCdpZCcpXG4gICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIExhenkob2JqZWN0cylcbiAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4LmFzUmF3KClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIExhenkoZGVsZXRhYmxlKS5lYWNoKGZ1bmN0aW9uICh5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgeFt5XTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJhdy5wdXNoKHgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QoS2xhc3MubW9kZWxOYW1lLCAncHV0Jywge211bHRpcGxlOiByYXcsIGZvcm1JZHggOiBXMlBSRVNPVVJDRS5mb3JtSWR4Kyt9LCBmdW5jdGlvbiAoZWxlbXMpIHtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKGVsZW1zKTtcbiAgICAgICAgICAgICAgICB2YXIgdGFiID0gSURCW0tsYXNzLm1vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgdmFyIG9ianMgPSBMYXp5KGVsZW1zW0tsYXNzLm1vZGVsTmFtZV0ucmVzdWx0cykucGx1Y2soJ2lkJykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YWIuZ2V0KHgpXG4gICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIGlmIChjYikge1xuICAgICAgICAgICAgICAgICAgICBjYihvYmpzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBzY29wZSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmICgnZXh0cmFfdmVyYnMnIGluIG1vZGVsKVxuICAgICAgICAgICAgTGF6eShtb2RlbC5leHRyYV92ZXJicykuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgIHZhciBmdW5jTmFtZSA9IHhbMF07XG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSB4WzFdO1xuICAgICAgICAgICAgICAgIHZhciBkZGF0YSA9ICdkYXRhID0ge2lkIDogdGhpcy5pZCc7XG4gICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBkZGF0YSArPSAnLCAnICsgTGF6eShhcmdzKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geCArICcgOiAnICsgeDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmpvaW4oJywnKTtcbiAgICAgICAgICAgICAgICBkZGF0YSArPSAnfTsnO1xuICAgICAgICAgICAgICAgIGFyZ3MucHVzaCgnY2InKTtcbiAgICAgICAgICAgICAgICBLbGFzcy5wcm90b3R5cGVbZnVuY05hbWVdID0gbmV3IEZ1bmN0aW9uKGFyZ3MsIGRkYXRhICsgJ1cyUy5XMlBfUE9TVCh0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZSxcIicgKyBmdW5jTmFtZSArICdcIiwgZGF0YSxmdW5jdGlvbihkYXRhLHN0YXR1cyxoZWFkZXJzLHgpeycgK1xuICAgICAgICAgICAgICAgICAgICAndHJ5e1xcbicgK1xuICAgICAgICAgICAgICAgICAgICAnICAgaWYgKCFoZWFkZXJzKFwibm9tb2RlbFwiKSkge3dpbmRvdy5XMlMuZ290RGF0YShkYXRhLGNiKTt9XFxuJyArXG4gICAgICAgICAgICAgICAgICAgICcgICBlbHNlIHtpZiAoY2IpIHtjYihkYXRhKX19XFxuJyArXG4gICAgICAgICAgICAgICAgICAgICd9IGNhdGNoKGUpe1xcbicgK1xuICAgICAgICAgICAgICAgICAgICAnaWYgKGNiKSB7Y2IoZGF0YSk7fVxcbicgK1xuICAgICAgICAgICAgICAgICAgICAnfVxcbicgK1xuICAgICAgICAgICAgICAgICAgICAnfSk7XFxuJ1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgaWYgKCdwcml2YXRlQXJncycgaW4gbW9kZWwpIHtcbiAgICAgICAgICAgIEtsYXNzLnByaXZhdGVBcmdzID0gTGF6eShtb2RlbC5wcml2YXRlQXJncykua2V5cygpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbeCwgdHJ1ZV07XG4gICAgICAgICAgICB9KS50b09iamVjdCgpO1xuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlLnNhdmVQQSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgICAgICAgICAgdmFyIFQgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBvbyA9IHtpZDogdGhpcy5pZH07XG4gICAgICAgICAgICAgICAgdmFyIFBBID0gdGhpcy5jb25zdHJ1Y3Rvci5wcml2YXRlQXJncztcbiAgICAgICAgICAgICAgICB2YXIgRnMgPSB0aGlzLmNvbnN0cnVjdG9yLmZpZWxkcztcbiAgICAgICAgICAgICAgICB2YXIgdCA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKG8pLmFzUmF3KCk7XG4gICAgICAgICAgICAgICAgdmFyIGZpZWxkSWR4ID0gTGF6eShQQSkua2V5cygpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3gsIEZzW3hdXVxuICAgICAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgICAgICAgICAgTGF6eShvKS5lYWNoKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoayBpbiBQQSkgJiYgZmllbGRJZHhba10ud3JpdGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9vW2tdID0gdjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KHRoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lICsgJy9zYXZlUEEnLCBvbywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBMYXp5KG9vKS5lYWNoKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBUW2tdID0gdjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgbW9kZWxDYWNoZVtLbGFzcy5tb2RlbE5hbWVdID0gS2xhc3M7XG4gICAgICAgIC8vIGFkZGluZyBpZCB0byBmaWVsZHNcbiAgICAgICAgZm9yICh2YXIgZiBpbiBtb2RlbC5maWVsZHMpIHtcbiAgICAgICAgICAgIG1vZGVsLmZpZWxkc1tmXS5pZCA9IGY7XG4gICAgICAgIH1cbiAgICAgICAgS2xhc3MuZmllbGRzID0gTGF6eShtb2RlbC5maWVsZHMpLmNvbmNhdChMYXp5KG1vZGVsLnByaXZhdGVBcmdzKSkuY29uY2F0KExhenkobW9kZWwucmVmZXJlbmNlcykudGFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICB4LnR5cGUgPSB4LnR5cGUgfHwgJ3JlZmVyZW5jZSdcbiAgICAgICAgfSkpLmluZGV4QnkoJ2lkJykudG9PYmplY3QoKTtcbiAgICAgICAgLy8gc2V0dGluZyB3aWRnZXRzIGZvciBmaWVsZHNcbiAgICAgICAgTGF6eShLbGFzcy5maWVsZHMpLmVhY2goZnVuY3Rpb24oZmllbGQpe1xuICAgICAgICAgICAgaWYgKCFmaWVsZC53aWRnZXQpe1xuICAgICAgICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSAncmVmZXJlbmNlJyl7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLndpZGdldCA9ICdjaG9pY2VzJ1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLndpZGdldCA9IGZpZWxkLnR5cGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gYnVpbGRpbmcgcmVmZXJlbmNlcyB0byAobWFueSB0byBvbmUpIGZpZWxkc1xuICAgICAgICBMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLmVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgICAgICAgdmFyIGV4dF9yZWYgPSByZWYudG87XG4gICAgICAgICAgICB2YXIgbG9jYWxfcmVmID0gJ18nICsgcmVmLmlkO1xuICAgICAgICAgICAgY2FjaGVkUHJvcGVydHlCeUV2ZW50cyhLbGFzcy5wcm90b3R5cGUsIHJlZi5pZCxmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoZXh0X3JlZiBpbiBJREIpKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRocyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmRlc2NyaWJlKGV4dF9yZWYsZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5rZXIubWFpbkluZGV4W2V4dF9yZWZdLmFzayh0aHNbbG9jYWxfcmVmXSx0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSAoZXh0X3JlZiBpbiBJREIpICYmIHRoaXNbbG9jYWxfcmVmXSAmJiBJREJbZXh0X3JlZl0uZ2V0KHRoaXNbbG9jYWxfcmVmXSk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQgJiYgKGV4dF9yZWYgaW4gbGlua2VyLm1haW5JbmRleCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYXNraW5nIHRvIGxpbmtlclxuICAgICAgICAgICAgICAgICAgICBsaW5rZXIubWFpbkluZGV4W2V4dF9yZWZdLmFzayh0aGlzW2xvY2FsX3JlZl0sdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1dGlscy5tb2NrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLmNvbnN0cnVjdG9yLm1vZGVsTmFtZSAhPSBleHRfcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdZb3UgY2FuIGFzc2lnbiBvbmx5ICcgKyBleHRfcmVmICsgJyB0byAnICsgcmVmLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzW2xvY2FsX3JlZl0gPSB2YWx1ZS5pZDtcbiAgICAgICAgICAgIH0sICduZXctJyArIGV4dF9yZWYsICdkZWxldGVkLScgKyBleHRfcmVmLCd1cGRhdGVkLScgKyBleHRfcmVmLCAnbmV3LW1vZGVsLScgKyBleHRfcmVmKTtcblxuXG4gICAgICAgICAgICBLbGFzcy5wcm90b3R5cGVbJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKHJlZi5pZCldID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBleHRPUk0uZ2V0KGV4dF9yZWYsdGhpc1tsb2NhbF9yZWZdKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vYnVpbGRpbmcgcmVmZXJlbmNlcyB0byAob25lIHRvIG1hbnkpIGZpZWxkc1xuICAgICAgICBMYXp5KG1vZGVsLnJlZmVyZW5jZWRCeSkuZWFjaChmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gcmVmLmJ5ICsgJy4nICsgcmVmLmlkO1xuICAgICAgICAgICAgdmFyIHByb3BlcnR5TmFtZSA9IHJlZi5ieSArICdfJyArIHV0aWxzLnBsdXJhbGl6ZShyZWYuaWQpO1xuICAgICAgICAgICAgdmFyIHJldkluZGV4ID0gcmVmLmJ5O1xuICAgICAgICAgICAgaWYgKEtsYXNzLnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eU5hbWUpKSB7XG4gICAgICAgICAgICAgICAgJGxvZy5lcnJvcignVHJ5ZWQgdG8gcmVkZWZpbmUgcHJvcGVydHkgJyArIHByb3BlcnR5TmFtZSArICdzJyArICcgZm9yICcgKyBLbGFzcy5tb2RlbE5hbWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYWNoZWRQcm9wZXJ0eUJ5RXZlbnRzKEtsYXNzLnByb3RvdHlwZSwgcHJvcGVydHlOYW1lLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXQgPSAocmV2SW5kZXggaW4gSURCKSA/IFJFVklEWFtpbmRleE5hbWVdLmdldCh0aGlzLmlkICsgJycpOm51bGw7XG4gICAgICAgICAgICAgICAgICAgIGxpbmtlci5mb3JlaWduS2V5c1tpbmRleE5hbWVdLmFzayh0aGlzLmlkLHRydWUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgICAgIH0sIG51bGwsICduZXctJyArIHJldkluZGV4LCAndXBkYXRlZC0nICsgcmV2SW5kZXgsICdkZWxldGVkLScgKyByZXZJbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBLbGFzcy5wcm90b3R5cGVbJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKHV0aWxzLnBsdXJhbGl6ZShyZWYuYnkpKV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9wdHMgPSB7fTtcbiAgICAgICAgICAgICAgICBvcHRzW3JlZi5pZF0gPSBbdGhpcy5pZF07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4dE9STS5xdWVyeShyZWYuYnksb3B0cyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2J1aWxkaW5nIHJlZmVyZW5jZSB0byAobWFueSB0byBtYW55KSBmaWVsZHNcbiAgICAgICAgaWYgKG1vZGVsLm1hbnlUb01hbnkpIHtcbiAgICAgICAgICAgIExhenkobW9kZWwubWFueVRvTWFueSkuZWFjaChmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IHJlZi5pbmRleE5hbWU7XG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0ID0gcmVmLmZpcnN0PyAwIDogMTtcbiAgICAgICAgICAgICAgICB2YXIgb21vZGVsTmFtZSA9IHJlZi5tb2RlbDtcbi8vICAgICAgICAgICAgICAgIHZhciBvbW9kZWwgPSBnZXRJbmRleChvbW9kZWxOYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgZ2V0dGVyID0gbGlua2VyLm0ybUluZGV4W2luZGV4TmFtZV1bJ2dldCcgKyAoMSAtIGZpcnN0KV07XG5cbiAgICAgICAgICAgICAgICBjYWNoZWRQcm9wZXJ0eUJ5RXZlbnRzKEtsYXNzLnByb3RvdHlwZSwgcmVmLm1vZGVsICsgJ3MnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHMgPSBnZXR0ZXIodGhzLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnZXQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkcy5sZW5ndGgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vVzJQUkVTT1VSQ0UuZmV0Y2gob21vZGVsTmFtZSwge2lkIDogaWRzfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0ID0gZ2V0SW5kZXgob21vZGVsTmFtZSkuZ2V0LmJpbmQoSURCW29tb2RlbE5hbWVdKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkcyAmJiBnZXQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gTGF6eShpZHMpLm1hcChnZXQpLmZpbHRlcih1dGlscy5ib29sKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgICAgICAgICB9LCBudWxsLCAncmVjZWl2ZWQtbTJtLScgKyBpbmRleE5hbWUsICdyZWNlaXZlZC0nICsgb21vZGVsTmFtZSk7XG5cbiAgICAgICAgICAgICAgICBLbGFzcy5wcm90b3R5cGVbJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKHV0aWxzLnBsdXJhbGl6ZShvbW9kZWxOYW1lKSldID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua2VyLmdldE0yTShpbmRleE5hbWUsIFt0aHMuaWRdLCBmaXJzdCxmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkcyA9IGdldHRlcih0aHMuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5mZXRjaChvbW9kZWxOYW1lLCB7aWQgOiBpZHN9LG51bGwsZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0ID0gSURCW29tb2RlbE5hbWVdLmdldC5iaW5kKElEQltvbW9kZWxOYW1lXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0KExhenkoaWRzKS5tYXAoZ2V0KS5maWx0ZXIodXRpbHMuYm9vbCkudG9BcnJheSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0KFtdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgICAgIEtsYXNzLmZpZWxkc1t1dGlscy5jYXBpdGFsaXplKG9tb2RlbE5hbWUpXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHV0aWxzLmNhcGl0YWxpemUob21vZGVsTmFtZSksXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHV0aWxzLmNhcGl0YWxpemUob21vZGVsTmFtZSksXG4gICAgICAgICAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICByZWFkYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ00yTScsXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRvcnM6IFtdXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZS51bmxpbmtSZWZlcmVuY2UgPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbXVsdGlwbGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgSUQgPSB0aGlzLmlkO1xuICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2UuY29uc3RydWN0b3IubmFtZSA9PSAnQXJyYXknKSB7XG4gICAgICAgICAgICAgICAgICAgIG11bHRpcGxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VzID0gaW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlID0gaW5zdGFuY2VzWzBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgb21vZGVsID0gaW5zdGFuY2UuY29uc3RydWN0b3IubW9kZWxOYW1lO1xuICAgICAgICAgICAgICAgIGlmIChtdWx0aXBsZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sbGVjdGlvbiA9IExhenkoaW5zdGFuY2VzKS5wbHVjaygnaWQnKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbSUQsIHhdXG4gICAgICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sbGVjdGlvbiA9IFtbSUQsIGluc3RhbmNlLmlkXV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KEtsYXNzLm1vZGVsTmFtZSArICcvJyArIG9tb2RlbCArICdzL2RlbGV0ZScsIHtjb2xsZWN0aW9uOiBjb2xsZWN0aW9ufSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBLbGFzcy5wcm90b3R5cGUubGlua1JlZmVyZW5jZSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHZhciBtdWx0aXBsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBJRCA9IHRoaXMuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5jb25zdHJ1Y3Rvci5uYW1lID09ICdBcnJheScpIHtcbiAgICAgICAgICAgICAgICAgICAgbXVsdGlwbGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZXMgPSBpbnN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBpbnN0YW5jZXNbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBvbW9kZWwgPSBpbnN0YW5jZS5jb25zdHJ1Y3Rvci5tb2RlbE5hbWU7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IEtsYXNzLm1vZGVsTmFtZSArICcvJyArIG9tb2RlbDtcbiAgICAgICAgICAgICAgICBpZiAobXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4TmFtZSBpbiBJTkRFWF9NMk0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnMgPSBMYXp5KGluc3RhbmNlcykucGx1Y2soJ2lkJykuZGlmZmVyZW5jZShMYXp5KElOREVYX00yTVtpbmRleE5hbWVdWzBdLmdldCh0aGlzLmlkKSkpLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpbmRleE5hbWUgPSBvbW9kZWwgKyAnLycgKyBLbGFzcy5tb2RlbE5hbWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleE5hbWUgaW4gSU5ERVhfTTJNKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWZzID0gTGF6eShpbnN0YW5jZXMpLnBsdWNrKCdpZCcpLmRpZmZlcmVuY2UoTGF6eShJTkRFWF9NMk1baW5kZXhOYW1lXVswXS5nZXQodGhpcy5pZCkpKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlZnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sbGVjdGlvbiA9IExhenkocmVmcykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtJRCwgeF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFcyUF9QT1NUKEtsYXNzLm1vZGVsTmFtZSwgb21vZGVsICsgJ3MvcHV0Jywge2NvbGxlY3Rpb246IGNvbGxlY3Rpb259LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKGluZGV4TmFtZSBpbiBsaW5rZXIubTJtSW5kZXgpICYmIExhenkobGlua2VyLm0ybUluZGV4W2luZGV4TmFtZV1bJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKG9tb2RlbCldKGluc3RhbmNlLmlkKSkuZmluZCh0aGlzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KEtsYXNzLm1vZGVsTmFtZSArICcvJyArIG9tb2RlbCArICdzL3B1dCcsIHtjb2xsZWN0aW9uOiBbW3RoaXMuaWQsIGluc3RhbmNlLmlkXV19KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50cy5lbWl0KCduZXctbW9kZWwnLCBLbGFzcyk7XG4gICAgICAgIGV2ZW50cy5lbWl0KCduZXctbW9kZWwtJyArIEtsYXNzLm1vZGVsTmFtZSk7XG4gICAgICAgIHJldHVybiBLbGFzcztcbiAgICB9O1xuXG4gICAgdGhpcy5nb3REYXRhID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxCYWNrKSB7XG4gICAgICAgIC8vIHJlY2VpdmUgYWxsIGRhdGEgZnJvbSBldmVyeSBlbmQgcG9pbnRcbiAgICAgICAgY29uc29sZS5pbmZvKCdnb3REYXRhJyk7XG4gICAgICAgIGlmICh0eXBlb2YoZGF0YSkgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkYXRhICcgKyBkYXRhICsgJyByZWZ1c2VkIGZyb20gZ290RGF0YSgpJyk7XG4gICAgICAgICAgICBpZiAoY2FsbEJhY2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbEJhY2soZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gY2xlYW4gZGF0YSBmcm9tIHJlbGF0aW9ucyBhbmQgcGVybWlzc2lvbnMgZm9yIHVzaW5nIGl0IGFmdGVyIG1vZGVsIHBhcnNpbmdcbiAgICAgICAgaWYgKCdfZXh0cmEnIGluIGRhdGEpeyBkZWxldGUgZGF0YS5fZXh0cmEgfVxuICAgICAgICB2YXIgVE9PTkUgPSBkYXRhLlRPT05FO1xuICAgICAgICB2YXIgVE9NQU5ZID0gZGF0YS5UT01BTlk7XG4gICAgICAgIHZhciBNQU5ZVE9NQU5ZID0gZGF0YS5NQU5ZVE9NQU5ZO1xuICAgICAgICB2YXIgUEVSTUlTU0lPTlMgPSBkYXRhLlBFUk1JU1NJT05TO1xuICAgICAgICB2YXIgUEEgPSBkYXRhLlBBO1xuICAgICAgICBkZWxldGUgZGF0YS5UT09ORTtcbiAgICAgICAgZGVsZXRlIGRhdGEuVE9NQU5ZO1xuICAgICAgICBkZWxldGUgZGF0YS5NQU5ZVE9NQU5ZO1xuICAgICAgICBkZWxldGUgZGF0YS5QRVJNSVNTSU9OUztcbiAgICAgICAgZGVsZXRlIGRhdGEuUEE7XG4gICAgICAgIGlmICghUEEpIHsgUEEgPSB7fTsgfVxuXG4gICAgICAgIC8vIGNsZWFuaW5nIGZyb20gdXNlbGVzcyBkZWxldGVkIGRhdGFcbiAgICAgICAgZGF0YSA9IExhenkoZGF0YSkuZmlsdGVyKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICByZXR1cm4gKCEoJ2RlbGV0ZWQnIGluIHYpIHx8ICgoayBpbiBtb2RlbENhY2hlKSkpO1xuICAgICAgICB9KS50b09iamVjdCgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCdtMm0nIGluIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBtMm0gPSBkYXRhLm0ybTtcbiAgICAgICAgICAgIGRlbGV0ZSBkYXRhWydtMm0nXTtcbiAgICAgICAgfVxuICAgICAgICBMYXp5KGRhdGEpLmVhY2goZnVuY3Rpb24gKGRhdGEsIG1vZGVsTmFtZSkge1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUobW9kZWxOYW1lLCBmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWxDbGFzcyA9IG1vZGVsO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLnJlc3VsdHMgJiYgKGRhdGEucmVzdWx0cy5sZW5ndGggPiAwKSAmJiAoZGF0YS5yZXN1bHRzWzBdLmNvbnN0cnVjdG9yID09IEFycmF5KSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMgPSBMYXp5KGRhdGEucmVzdWx0cykubWFwKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIExhenkobW9kZWxDbGFzcy5maWVsZHNPcmRlcikuemlwKHgpLnRvT2JqZWN0KClcbiAgICAgICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IExhenkoZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICB2YXIgZGVsZXRlZCA9IGRhdGEuZGVsZXRlZDtcbiAgICAgICAgICAgICAgICBpZiAobW9kZWxOYW1lIGluIFBBKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBNUEEgPSBQQVttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICBMYXp5KHJlc3VsdHMpLmVhY2goZnVuY3Rpb24gKHJlY29yZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlY29yZC5pZCBpbiBNUEEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMYXp5KE1QQVtyZWNvcmQuaWRdKS5lYWNoKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY29yZFtrXSA9IHY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gaW5kZXhpbmcgcmVmZXJlbmNlcyBieSBpdHMgSURcbiAgICAgICAgICAgICAgICB2YXIgaXRhYiA9IGdldEluZGV4KG1vZGVsTmFtZSk7XG4gICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gaXRhYi5zb3VyY2U7XG5cbiAgICAgICAgICAgICAgICAvLyBvYmplY3QgZGVsZXRpb25cbiAgICAgICAgICAgICAgICBpZiAoZGVsZXRlZCl7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZWQuZm9yRWFjaChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YWJsZVt4XTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4vKlxuICAgICAgICAgICAgICAgIExhenkoZGVsZXRlZCkuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFibGVbeF07XG4gICAgICAgICAgICAgICAgfSk7XG4qL1xuICAgICAgICAgICAgICAgIHZhciBpZHggPSByZXN1bHRzLmluZGV4QnkoJ2lkJyk7XG4gICAgICAgICAgICAgICAgdmFyIGlrID0gaWR4LmtleXMoKTtcbiAgICAgICAgICAgICAgICB2YXIgbm5ldyA9IGlrLmRpZmZlcmVuY2UoaXRhYi5rZXlzKCkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh4KVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZCA9IGlrLmRpZmZlcmVuY2Uobm5ldyk7XG4gICAgICAgICAgICAgICAgLy8gcmVtb3Zpbmcgb2xkIGlkZW50aWNhbCB2YWx1ZXNcbiAgICAgICAgICAgICAgICB1cGRhdGVkID0gdXBkYXRlZC5maWx0ZXIoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICF1dGlscy5zYW1lQXMoaWR4LmdldCh4KSwgaXRhYi5nZXQoeCkuYXNSYXcoKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gY2xhc3NpZnkgcmVjb3Jkc1xuICAgICAgICAgICAgICAgIHZhciBwZXJtcyA9IGRhdGEucGVybWlzc2lvbnMgPyBMYXp5KGRhdGEucGVybWlzc2lvbnMpIDogTGF6eSh7fSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld09iamVjdHMgPSBubmV3Lm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IG1vZGVsQ2xhc3MoaWR4LmdldCh4KSwgcGVybXMuZ2V0KHgpKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8vLyBjbGFzc2lmeWluZyB1cGRhdGVkXG4gICAgICAgICAgICAgICAgLy92YXIgdXBkYXRlZE9iamVjdHMgPSB1cGRhdGVkLm1hcChmdW5jdGlvbih4KXtyZXR1cm4gbmV3IG1vZGVsQ2xhc3MoaWR4LmdldCh4KSxwZXJtcy5nZXQoeCkpfSk7XG4gICAgICAgICAgICAgICAgLy92YXIgdW8gPSB1cGRhdGVkT2JqZWN0cy50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgLy91cGRhdGVkT2JqZWN0cyA9IExhenkodW8pLm1hcChmdW5jdGlvbih4KXtyZXR1cm4gW3gsdGFibGVbeC5pZF1dfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIC8vIFVwZGF0aW5nIHNpbmdsZSBvYmplY3RzXG4gICAgICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBbXTtcbi8vICAgICAgICAgICAgICAgIHZhciBEQVRFRklFTERTID0gTU9ERUxfREFURUZJRUxEU1ttb2RlbE5hbWVdO1xuLy8gICAgICAgICAgICAgICAgdmFyIEJPT0xGSUVMRFMgPSBNT0RFTF9CT09MRklFTERTW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgdXBkYXRlZC5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRJdGVtID0gaXRhYi5nZXQoeCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRDb3B5ID0gb2xkSXRlbS5jb3B5KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtID0gbmV3IG1vZGVsQ2xhc3MoaWR4LmdldCh4KSk7XG4gICAgICAgICAgICAgICAgICAgIExhenkobW9kZWwuZmllbGRzKS5rZXlzKCkuZWFjaChmdW5jdGlvbihrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZEl0ZW1ba10gPSBuZXdJdGVtW2tdO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZC5wdXNoKFtvbGRJdGVtLCBvbGRDb3B5XSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLy8vIHNlbmRpbmcgc2lnbmFsIGZvciB1cGRhdGVkIHZhbHVlc1xuICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VkLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBldmVudHMuZW1pdCgndXBkYXRlZC0nICsgbW9kZWxOYW1lLCBjaGFuZ2VkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8qKioqKioqKiBVcGRhdGUgdW5pdmVyc2UgKioqKioqKipcbiAgICAgICAgICAgICAgICB2YXIgbm8gPSBuZXdPYmplY3RzLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICBMYXp5KG5vKS5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlW3guaWRdID0geFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIHJlYnVsZGluZyByZXZlcnNlIGluZGV4ZXNcbiAgICAgICAgICAgICAgICBMYXp5KG1vZGVsQ2FjaGVbbW9kZWxOYW1lXS5yZWZlcmVuY2VzKS5lYWNoKGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgUkVWSURYW21vZGVsTmFtZSArICcuJyArIHJlZl0gPSBJREJbbW9kZWxOYW1lXS5ncm91cEJ5KCdfJyArIHJlZik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gc2VuZGluZyBldmVudHMgZm9yIG5ldyB2YWx1ZXNcbiAgICAgICAgICAgICAgICBpZiAobm8ubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBldmVudHMuZW1pdCgnbmV3LScgKyBtb2RlbE5hbWUsIExhenkobm8pLCBkYXRhLnRvdGFsUmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgaWYgKGRlbGV0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRzLmVtaXQoJ2RlbGV0ZWQtJyArIG1vZGVsTmFtZSwgZGVsZXRlZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHNlbmRpbmcgZXZlbnRzIGZvciBkYXRhIGFycml2ZWRcbiAgICAgICAgICAgICAgICBldmVudHMuZW1pdCgncmVjZWl2ZWQtJyArIG1vZGVsTmFtZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChUT09ORSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignVE9PTkUnKTtcbiAgICAgICAgICAgIExhenkoVE9PTkUpLmVhY2goZnVuY3Rpb24gKHZhbHMsIG1vZGVsTmFtZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1vZGVsTmFtZSk7XG4gICAgICAgICAgICAgICAgdmFyIHVkeCA9IGdldFVubGlua2VkKG1vZGVsTmFtZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVE9NQU5ZKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdUT01BTlknKTtcbiAgICAgICAgICAgIExhenkoVE9NQU5ZKS5lYWNoKGZ1bmN0aW9uICh2YWxzLCBpbmRleE5hbWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShpbmRleE5hbWUgaW4gQVNLRURfVU5MSU5LRUQpKSB7XG4gICAgICAgICAgICAgICAgICAgIEFTS0VEX1VOTElOS0VEW2luZGV4TmFtZV0gPSBMYXp5KFtdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgTGF6eSh2YWxzKS5lYWNoKGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgICAgICAgICBBU0tFRF9VTkxJTktFRFtpbmRleE5hbWVdLnNvdXJjZS5wdXNoKGlkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChNQU5ZVE9NQU5ZKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdNQU5ZVE9NQU5ZJyk7XG4gICAgICAgICAgICBMYXp5KE1BTllUT01BTlkpLmVhY2goZnVuY3Rpb24gKHZhbHMsIGluZGV4TmFtZSkge1xuICAgICAgICAgICAgICAgIHZhciBmaXJzdCA9IHBhcnNlSW50KGluZGV4TmFtZS5zcGxpdCgnfCcpWzFdKTtcbiAgICAgICAgICAgICAgICBpbmRleE5hbWUgPSBpbmRleE5hbWUuc3BsaXQoJ3wnKVswXTtcbiAgICAgICAgICAgICAgICBpZiAoIShpbmRleE5hbWUgaW4gQVNLRURfTTJNKSkge1xuICAgICAgICAgICAgICAgICAgICBBU0tFRF9NMk1baW5kZXhOYW1lXSA9IFt7fSwge31dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgTUlEWCA9IEFTS0VEX00yTVtpbmRleE5hbWVdW2ZpcnN0XTtcbiAgICAgICAgICAgICAgICBMYXp5KHZhbHMpLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgTUlEWFt4ICsgJyddID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgTUlEWFt4XSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobTJtKSB7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3RNMk0obTJtKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoUEVSTUlTU0lPTlMpIHtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdFBlcm1pc3Npb25zKFBFUk1JU1NJT05TKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjYWxsQmFjaykge1xuICAgICAgICAgICAgY2FsbEJhY2soZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgZXZlbnRzLmVtaXQoJ2dvdC1kYXRhJyk7XG4gICAgfTtcbiAgICB0aGlzLmdvdFBlcm1pc3Npb25zID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgTGF6eShkYXRhKS5lYWNoKGZ1bmN0aW9uICh2LCByZXNvdXJjZU5hbWUpIHtcbiAgICAgICAgICAgIExhenkodlswXSkuZWFjaChmdW5jdGlvbiAocm93LCBpZCkge1xuICAgICAgICAgICAgICAgIGlmICgocmVzb3VyY2VOYW1lIGluIElEQikgJiYgKGlkIGluIElEQltyZXNvdXJjZU5hbWVdLnNvdXJjZSkpe1xuICAgICAgICAgICAgICAgICAgICBJREJbcmVzb3VyY2VOYW1lXS5nZXQoaWQpLl9wZXJtaXNzaW9ucyA9IExhenkocm93KS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbeCwgdHJ1ZV1cbiAgICAgICAgICAgICAgICAgICAgfSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChMYXp5KHZbMF0pLnNpemUoKSl7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgndXBkYXRlLXBlcm1pc3Npb25zLScgKyByZXNvdXJjZU5hbWUsIExhenkodlswXSkua2V5cygpLnRvQXJyYXkoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmVtaXQoJ3VwZGF0ZS1wZXJtaXNzaW9ucycpO1xuICAgIH07XG5cblxuICAgIHRoaXMuZ290TTJNID0gZnVuY3Rpb24obTJtKXtcbiAgICAgICAgTGF6eShtMm0pLmVhY2goZnVuY3Rpb24oZGF0YSwgaW5kZXhOYW1lKXtcbiAgICAgICAgICAgIHZhciBtMm1JbmRleCA9IGxpbmtlci5tMm1JbmRleFtpbmRleE5hbWVdO1xuICAgICAgICAgICAgTGF6eShkYXRhKS5lYWNoKGZ1bmN0aW9uKG0pe1xuICAgICAgICAgICAgICAgIExhenkobSkuZWFjaChmdW5jdGlvbihkYXRhLHZlcmIpe1xuICAgICAgICAgICAgICAgICAgICBtMm1JbmRleFt2ZXJiXShkYXRhKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZXZlbnRzLmVtaXQoJ3JlY2VpdmVkLW0ybScpO1xuICAgICAgICAgICAgZXZlbnRzLmVtaXQoJ3JlY2VpdmVkLW0ybS0nICsgaW5kZXhOYW1lKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5mZXRjaCA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIGZpbHRlciwgdG9nZXRoZXIsIGNhbGxCYWNrKSB7ICAvL1xuICAgICAgICAvLyBpZiBhIGNvbm5lY3Rpb24gaXMgY3VycmVudGx5IHJ1bm5pbmcsIHdhaXQgZm9yIGNvbm5lY3Rpb24uXG4gICAgICAgIGlmIChtb2RlbE5hbWUgaW4gd2FpdGluZ0Nvbm5lY3Rpb25zKXtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5mZXRjaChtb2RlbE5hbWUsIGZpbHRlciwgdG9nZXRoZXIsIGNhbGxCYWNrKTtcbiAgICAgICAgICAgIH0sNTAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGZldGNoaW5nIGFzeW5jaHJvbW91cyBtb2RlbCBmcm9tIHNlcnZlclxuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUobW9kZWxOYW1lLCBmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgICAgICAgICAgLy8gaWYgZGF0YSBjYW1lcyBmcm9tIHJlYWx0aW1lIGNvbm5lY3Rpb25cbiAgICAgICAgICAgICAgICBpZiAoVzJQUkVTT1VSQ0UuY29ubmVjdGlvbi5vcHRpb25zLnJlYWx0aW1lRW5kUG9pbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0dGluZyBmaWx0ZXIgZmlsdGVyZWQgYnkgY2FjaGluZyBzeXN0ZW1cbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyID0gbGlzdENhY2hlLmZpbHRlcihtb2RlbCxmaWx0ZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHNvbXRoaW5nIGlzIG1pc3Npbmcgb24gbXkgbG9jYWwgREIgXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXNrIGZvciBtaXNzaW5ncyBhbmQgcGFyc2Ugc2VydmVyIHJlc3BvbnNlIGluIG9yZGVyIHRvIGVucmljaCBteSBsb2NhbCBEQi5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBsYWNpbmcgbG9jayBmb3IgdGhpcyBtb2RlbFxuICAgICAgICAgICAgICAgICAgICAgICAgd2FpdGluZ0Nvbm5lY3Rpb25zW21vZGVsTmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QobW9kZWxOYW1lICsgJy9saXN0Jywge2ZpbHRlciA6IGZpbHRlcn0sZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShkYXRhLGNhbGxCYWNrKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVsZWFzZSBsb2NrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHdhaXRpbmdDb25uZWN0aW9uc1ttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZWxlYXNlIGxvY2tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2FpdGluZ0Nvbm5lY3Rpb25zW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlcjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRwb3N0KG1vZGVsTmFtZSArICcvbGlzdCcsIHNlbmREYXRhLGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWx0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR09UX0FMTC5zb3VyY2UucHVzaChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKGRhdGEsIGNhbGxCYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24obW9kZWxOYW1lLCBpZHMsIGNhbGxCYWNrKXtcbiAgICAgICAgLy8gc2VhcmNoIG9iamVjdHMgZnJvbSBJREIuIElmIHNvbWUgaWQgaXMgbWlzc2luZywgaXQgcmVzb2x2ZSBpdCBieSB0aGUgc2VydmVyXG4gICAgICAgIC8vIGlmIGEgcmVxdWVzdCB0byB0aGUgc2FtZSBtb2RlbCBpcyBwZW5kaW5nLCB3YWl0IGZvciBpdHMgY29tcGxldGlvblxuICAgICAgICBcbiAgICAgICAgaWYgKGlkcy5jb25zdHJ1Y3RvciAhPT0gQXJyYXkpe1xuICAgICAgICAgICAgaWRzID0gW2lkc107XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWYgc29tZSBlbnRpdHkgaXMgbWlzc2luZyBcbiAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gobW9kZWxOYW1lICwge2lkOiBpZHN9LCBudWxsLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgICAgICB2YXIgaXRhYiA9IElEQlttb2RlbE5hbWVdXG4gICAgICAgICAgICBmb3IgKHZhciBpZCBpbiBpZHMpe1xuICAgICAgICAgICAgICAgIHJldC5wdXNoKGl0YWIuc291cmNlW2lkc1tpZF1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhbGxCYWNrKHJldCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0aGlzLmdvdE1vZGVsID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgZm9yICh2YXIgbW9kZWxOYW1lIGluIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBtb2RlbCA9IGRhdGFbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZVsnZGVzY3JpcHRpb246JyArIG1vZGVsTmFtZV0gPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgICAgICAgIG1vZGVsQ2FjaGVbbW9kZWxOYW1lXSA9IG1ha2VNb2RlbENsYXNzKG1vZGVsKTtcbiAgICAgICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBJREIpKSB7XG4gICAgICAgICAgICAgICAgSURCW21vZGVsTmFtZV0gPSBMYXp5KHt9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmRlc2NyaWJlID0gZnVuY3Rpb24obW9kZWxOYW1lLCBjYWxsQmFjayl7XG4gICAgICAgIHZhciByZXQgPSBtb2RlbENhY2hlW21vZGVsTmFtZV07XG4gICAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHJldCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gd2FpdGluZ0Nvbm5lY3Rpb25zKSl7XG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBmYWlsZWRNb2RlbHMpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNhY2hlS2V5ID0gJ2Rlc2NyaXB0aW9uOicgKyBtb2RlbE5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlS2V5IGluIGxvY2FsU3RvcmFnZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdvdE1vZGVsKEpTT04ucGFyc2UobG9jYWxTdG9yYWdlW2NhY2hlS2V5XSkpO1xuICAgICAgICAgICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayhtb2RlbENhY2hlW21vZGVsTmFtZV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdhaXRpbmdDb25uZWN0aW9uc1ttb2RlbE5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcG9zdChtb2RlbE5hbWUgKyAnL2Rlc2NyaWJlJyxudWxsLCBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdE1vZGVsKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2sobW9kZWxDYWNoZVttb2RlbE5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV2ZW50cy5tb2RlbE5vdEZvdW5kLmhhbmRsZShtb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbGVkTW9kZWxzW21vZGVsTmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHdhaXQgZm9yIGNvbm5lY3Rpb25cbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmRlc2NyaWJlKG1vZGVsTmFtZSwgY2FsbEJhY2spO1xuICAgICAgICAgICAgICAgIH0sIDUwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gICAgICAgIFxuICAgIH07XG4gICAgdGhpcy5hZGRNb2RlbEhhbmRsZXIgPSBmdW5jdGlvbiAobW9kZWxOYW1lLCBkZWNvcmF0b3IpIHtcbiAgICAgICAgdmFyIGtleSA9IHV0aWxzLmhhc2goZGVjb3JhdG9yKTtcbiAgICAgICAgaWYgKCEobW9kZWxOYW1lIGluIGJ1aWxkZXJIYW5kbGVycykpIGJ1aWxkZXJIYW5kbGVyc1ttb2RlbE5hbWVdID0gbmV3IEhhbmRsZXIoKTtcbiAgICAgICAgaWYgKCEobW9kZWxOYW1lIGluIGJ1aWxkZXJIYW5kbGVyVXNlZCkpIGJ1aWxkZXJIYW5kbGVyVXNlZFttb2RlbE5hbWVdID0ge307XG4gICAgICAgIGlmIChrZXkgaW4gYnVpbGRlckhhbmRsZXJVc2VkW21vZGVsTmFtZV0pe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVpbGRlckhhbmRsZXJVc2VkW21vZGVsTmFtZV1ba2V5XSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBtb2RlbENhY2hlKSB7XG4gICAgICAgICAgICBkZWNvcmF0b3IobW9kZWxDYWNoZVttb2RlbE5hbWVdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1aWxkZXJIYW5kbGVyc1ttb2RlbE5hbWVdLmFkZEhhbmRsZXIoZGVjb3JhdG9yKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5hZGRQZXJzaXN0ZW50QXR0cmlidXRlcyA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgYXR0cmlidXRlcyl7XG4gICAgICAgIHZhciBhZGRQcm9wZXJ0eSA9IGZ1bmN0aW9uKG1vZGVsLCBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbCl7XG4gICAgICAgICAgICB2YXIga2V5ID0gJ3BBOicgKyBtb2RlbC5tb2RlbE5hbWUgKyAnOicgKyB2YWw7XG4gICAgICAgICAgICB2YXIga2F0dHIgPSAnX18nICsgdmFsO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZGVsLnByb3RvdHlwZSwgdmFsLCB7XG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZiAoIShrYXR0ciBpbiB0aGlzKSl7XG4gICAgICAgICAgICAgICAgICB2YXIgdiA9IGxvY2FsU3RvcmFnZVtrZXkgKyB0aGlzLmlkXTtcbiAgICAgICAgICAgICAgICAgIHRoaXNba2F0dHJdID0gdj9KU09OLnBhcnNlKHYpOm51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW2thdHRyXTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgICAgICAgICAgdGhpc1trYXR0cl0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Vba2V5ICsgdGhpcy5pZF0gPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gcGVyc2lzdGVudEF0dHJpYnV0ZXMpKSB7IHBlcnNpc3RlbnRBdHRyaWJ1dGVzW21vZGVsTmFtZV0gPSBbXTsgfVxuICAgICAgICB2YXIgYXR0cnMgPSBwZXJzaXN0ZW50QXR0cmlidXRlc1ttb2RlbE5hbWVdO1xuICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgdmFyIG5ld0F0dHJzID0gTGF6eShhdHRyaWJ1dGVzKS5kaWZmZXJlbmNlKGF0dHJzKS50b0FycmF5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgbmV3QXR0cnMgPSBhdHRycztcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3QXR0cnMubGVuZ3RoKXtcbiAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gbW9kZWxDYWNoZSl7XG4gICAgICAgICAgICAgICAgYWRkUHJvcGVydHkobW9kZWxDYWNoZVttb2RlbE5hbWVdLCBuZXdBdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcyl7XG4gICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoYXR0cnMsbmV3QXR0cnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICB0aGlzLm9uKCduZXctbW9kZWwnLCBmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgIGlmIChtb2RlbC5tb2RlbE5hbWUgaW4gYnVpbGRlckhhbmRsZXJzKXtcbiAgICAgICAgICAgIGJ1aWxkZXJIYW5kbGVyc1ttb2RlbC5tb2RlbE5hbWVdLmhhbmRsZShtb2RlbENhY2hlW21vZGVsLm1vZGVsTmFtZV0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb2RlbC5tb2RlbE5hbWUgaW4gcGVyc2lzdGVudEF0dHJpYnV0ZXMpe1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuYWRkUGVyc2lzdGVudEF0dHJpYnV0ZXMobW9kZWwubW9kZWxOYW1lKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuY29ubmVjdCA9IGZ1bmN0aW9uKGNhbGxCYWNrKXtcbiAgICAgICAgaWYgKHRoaXMuaXNDb25uZWN0ZWQpe1xuICAgICAgICAgICAgY2FsbEJhY2sodGhpcy5jb25uZWN0aW9uLm9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0aW9uLmNvbm5lY3QoZnVuY3Rpb24oc3RhdHVzKXtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5pc0Nvbm5lY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgY2FsbEJhY2soc3RhdHVzKTtcbiAgICAgICAgICAgIH0pOyAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgfTtcbiAgICB0aGlzLnF1ZXJ5ID0gZnVuY3Rpb24obW9kZWxOYW1lLCBmaWx0ZXIsIHRvZ2V0aGVyLCBjYWxsQmFjayl7XG4gICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICB0aGlzLmRlc2NyaWJlKG1vZGVsTmFtZSxmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgICAgICAvLyBhcnJheWZpeSBhbGwgZmlsdGVyIHZhbHVlc1xuICAgICAgICAgICAgZmlsdGVyID0gTGF6eShmaWx0ZXIpLm1hcChmdW5jdGlvbih2LGspeyByZXR1cm4gW2ssQXJyYXkuaXNBcnJheSh2KT92Olt2XV19KS50b09iamVjdCgpO1xuICAgICAgICAgICAgdmFyIGZpbHRlckZ1bmN0aW9uID0gdXRpbHMubWFrZUZpbHRlcihtb2RlbCwgZmlsdGVyKTtcbiAgICAgICAgICAgIHZhciBpZHggPSBnZXRJbmRleChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgdGhzLmZldGNoKG1vZGVsTmFtZSxmaWx0ZXIsdG9nZXRoZXIsIGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgIGNhbGxCYWNrKGlkeC5maWx0ZXIoZmlsdGVyRnVuY3Rpb24pLnZhbHVlcygpLnRvQXJyYXkoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICB9O1xuICAgIHRoaXMuZGVsZXRlID0gZnVuY3Rpb24obW9kZWxOYW1lLCBpZHMsIGNhbGxCYWNrKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHBvc3QobW9kZWxOYW1lICsgJy9kZWxldGUnLCB7IGlkIDogaWRzfSwgY2FsbEJhY2spO1xuICAgIH07XG59O1xuXG5mdW5jdGlvbiByZVdoZWVsT1JNKGVuZFBvaW50LCBsb2dpbkZ1bmMpe1xuICAgIHRoaXMuJG9ybSA9IG5ldyBiYXNlT1JNKG5ldyB1dGlscy5yZVdoZWVsQ29ubmVjdGlvbihlbmRQb2ludCwgbG9naW5GdW5jKSx0aGlzKTtcbiAgICB0aGlzLm9uID0gdGhpcy4kb3JtLm9uLmJpbmQodGhpcy4kb3JtKTtcbiAgICB0aGlzLmVtaXQgPSB0aGlzLiRvcm0uZW1pdC5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy51bmJpbmQgPSB0aGlzLiRvcm0udW5iaW5kLmJpbmQodGhpcy4kb3JtKTtcbiAgICB0aGlzLmFkZE1vZGVsSGFuZGxlciA9IHRoaXMuJG9ybS5hZGRNb2RlbEhhbmRsZXIuYmluZCh0aGlzLiRvcm0pO1xuICAgIHRoaXMuYWRkUGVyc2lzdGVudEF0dHJpYnV0ZXMgPSB0aGlzLiRvcm0uYWRkUGVyc2lzdGVudEF0dHJpYnV0ZXMuYmluZCh0aGlzLiRvcm0pO1xuICAgIHRoaXMudXRpbHMgPSB1dGlscztcbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUuZ2V0TW9kZWwgPSBmdW5jdGlvbihtb2RlbE5hbWUpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3Qpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc2VsZi4kb3JtLmNvbm5lY3QoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBzZWxmLiRvcm0uZGVzY3JpYmUobW9kZWxOYW1lLGFjY2VwdCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfVxuICAgIH0pXG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgaWRzKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHNpbmdsZSA9IGZhbHNlO1xuICAgIHZhciBtb2ROYW1lID0gbW9kZWxOYW1lO1xuICAgIGlmIChpZHMuY29uc3RydWN0b3IgIT09IEFycmF5KXtcbiAgICAgICAgc2luZ2xlID0gdHJ1ZTtcbiAgICAgICAgaWRzID0gW2lkc11cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgc2VsZi4kb3JtLmNvbm5lY3QoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZiAoc2luZ2xlKXtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi4kb3JtLmdldChtb2ROYW1lLCBpZHMsIGZ1bmN0aW9uKGl0ZW1zKXsgXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQoaXRlbXNbMF0pO31cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLiRvcm0uZ2V0KG1vZE5hbWUsIGlkcywgYWNjZXB0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn07XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLnF1ZXJ5ID0gZnVuY3Rpb24gKG1vZGVsTmFtZSwgZmlsdGVyLCByZWxhdGVkKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdmFyIHRvZ2V0aGVyID0gbnVsbDtcbiAgICAgICAgaWYgKHJlbGF0ZWQgJiYgKHJlbGF0ZWQuY29uc3RydWN0b3IgPT09IEFycmF5KSAmJiAocmVsYXRlZC5sZW5ndGgpKXtcbiAgICAgICAgICAgIHRvZ2V0aGVyID0gcmVsYXRlZDtcbiAgICAgICAgfSBlbHNlIGlmIChyZWxhdGVkICYmIChyZWxhdGVkLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpICYmIChyZWxhdGVkLmxlbmd0aCkpe1xuICAgICAgICAgICAgdG9nZXRoZXIgPSByZWxhdGVkLnNwbGl0KCcsJyk7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgaWYgKHNlbGYuJG9ybS5pc0Nvbm5lY3RlZCl7XG4gICAgICAgICAgICAgICAgc2VsZi4kb3JtLnF1ZXJ5KG1vZGVsTmFtZSwgZmlsdGVyLCB0b2dldGhlciwgYWNjZXB0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi4kb3JtLmNvbm5lY3QoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi4kb3JtLnF1ZXJ5KG1vZGVsTmFtZSwgZmlsdGVyLCB0b2dldGhlciwgYWNjZXB0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KVxufTtcblxucmVXaGVlbE9STS5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKG1vZGVsTmFtZSwgaWRzKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgaWYgKHNlbGYuJG9ybS5jb25uZWN0ZWQpe1xuICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5kZWxldGUobW9kZWxOYW1lLCBpZHMsIGFjY2VwdCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5jb25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5kZWxldGUobW9kZWxOYW1lLCBpZHMsIGFjY2VwdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9XG4gICAgfSlcbn07XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLiRzZW5kVG9FbmRwb2ludCA9IGZ1bmN0aW9uICh1cmwsIGRhdGEpe1xuICAgIHJldHVybiB0aGlzLiRvcm0uJHBvc3QodXJsLCBkYXRhKTtcbn1cblxuIl19
