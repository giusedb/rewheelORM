!function(t,e,n){"use strict";function i(){this.handlers=[],this.strHandlers={}}function r(){var t={},n={},i=0;this.on=function(e,r){e in t||(t[e]=new Array);var o=i++;return t[e].push(r),n[o]=r,o},this.emit=function(e){if(e in t){var n=Array.prototype.slice.call(arguments,1);t[e].forEach(function(t){t.apply(null,n)})}},this.unbind=function(i){var r=0;if(i in n){var o=n[i+""];e(t).each(function(t,e){var n=[];for(var i in t)t[i]===o&&(n.push(i),r++);n.reverse().forEach(function(e){t.splice(e,1)})})}return delete n[i],r},this.once=function(t,e){var n=this,i=this.on(t,function(){e.apply(this,arguments),n.unbind(i)})}}function o(){return new Proxy({},{get:function(t,e){return"string"==typeof e?"toString"===e?y:v.mock:t[e]}})}function s(t,e){var i=new n(t);i.onopen=function(t){console.log("open : "+t),i.tenant(),e.emit("realtime-connection-open",t)},i.onmessage=function(t){if("message"==t.type)try{e.emit("realtime-message-json",JSON.parse(t.data))}catch(n){e.emit("realtime-message-text",JSON.parse(t.data))}else console.log("from realtime ",t)},i.onclose=function(){setTimeout(v.wsConnect,1e3),e.emit("realtime-connection-closed")},i.tenant=function(){i.send("TENANT:"+e.cachedStatus.application+":"+e.cachedStatus.token)},this.close=function(){i.close()}}function a(t,e){var n=new r;this.getLogin=e,this.endPoint=t.endsWith("/")?t:t+"/",this.on=n.on,this.unbind=n.unbind,this.emit=n.emit,this.once=n.once,this.cachedStatus={},this.isConnected=!1,this.isLoggedIn=!1}function c(){var t=!1;this.touch=function(){t=!0},this.touched=function(){var e=t;return t=!1,e}}function u(t,n,i,r){if(!n)var n=[];var o=[];this.ask=function(i,s){r&&i in r.source||e(n).contains(i)||(o.push(i),s||n.push(i),t.touch())},this.getAskedIndex=function(){return n},this.missings=function(){return e(o.splice(0,o.length)).unique().toArray()}}function l(t,n,i,r){var o=new c,s={},a={},l={},f={},h={};this.mainIndex=s,this.foreignKeys=a,this.m2m=l,this.m2mIndex=f,this.permissions=h,i.on("model-definition",function(t,n){var i=r.getIndexFor(t.name,"id");s[t.name]=new u(o,i,"mainIndex."+t.name,n),h[t.name]=new u(o,null,"permissions."+t.name),e(t.references).each(function(e){var n=t.name+"_"+e.id;a[n]=new u(o,r.getIndexFor(e.to,"id"),e.to+".id foreignKeys."+n)}),e(t.referencedBy).each(function(t){var e=t.by+"."+t.id;a[e]=new u(o,r.getIndexFor(t.by,t.id),t.by+"."+t.id+" foreignKeys."+e)}),e(t.manyToMany).each(function(t){t.indexName in l||(l[t.indexName]=[new u(o,null,"m2m."+t.indexName+"[0]"),new u(o,null,"m2m."+t.indexName+"[1]")]),t.indexName in f||(f[t.indexName]=new d(t,l[t.indexName]))})});var p=function(e,n,r,o){i.$post((n?v.reverse("/",e):e)+"s/list",{collection:r},function(n){i.gotData(n,o),delete t[e]})},m=function(n,i,r,o){e(i).each(l[n][r].ask.bind(l[n][r])),i=l[n][r].missings(),i.length?(t[n]=1,p(n,r,i,o)):o&&o()};this.getM2M=m;var g=function(){if(o.touched()){if(e(t).values().sum())return void o.touch();var r=!1;e(l).each(function(t,n){e(t).each(function(t,o){var a=t.missings();if(a=e(a).filter(Boolean).map(function(t){return parseInt(t)}).toArray(),a.length){var c=f[n],u=c["get"+(1-o)].bind(c);r=!0,p(n,o,a,function(t){var r=a.map(u);if(r.length){var c=n.split("/")[1-o];i.describe(c,function(){e(r).flatten().unique().each(function(t){s[c].ask(t,!0)})})}})}})}),e(s).each(function(t,o){var s=t.missings();if(s.length){r=!0;o in n?n[o].keys():e();i.fetch(o,{id:s},null,v.noop)}}),e(a).map(function(t,e){return[e,t.missings()]}).filter(function(t){return t[1].length}).each(function(t){r=!0;var e=t[1],n=t[0],o=n.split("."),s=o[0],a=o[1],c={};c[a]=e,i.fetch(s,c)}),e(e(h).map(function(t,e){return[e,t.missings()]}).filter(function(t){return t[1].length}).toObject()).each(function(n,o){r=!0,n.length&&(t[o]=1,i.$post(o+"/my_perms",{ids:e(n).unique().toArray()},function(e){i.gotPermissions(e.PERMISSIONS),delete t[o]}))})}};setInterval(g,50)}function f(){var t={},n={},i={},r=function(t,n,i){var r=[];if(i)for(var o in t)for(var s in n)r.push(e([t[o],n[s]]).flatten().toArray());else for(var o in t)for(var s in n)r.push([t[o],n[s]]);return r},o=function(t){for(var e=!1,n=t[0],i=1;i<t.length;++i)n=r(n,t[i],e),e=!0;return n},s=function(t){var n=o(e(t).values().toArray()),i=e(t).keys().toArray();return n.map(function(t){var e={};return i.forEach(function(n,i){e[n]=t[i]}),e})},a=function(t,n,i){var r=t.modelName,o=this.getIndexFor,s=(e(n).map(function(t,e){return[e,r+"."+e]}).toObject(),e(n).keys().map(function(t){return[t,o(r,t)]}).toObject());for(var a in n){var c=e(n[a]).difference(s[a]).toArray();if(c.length){var u=e([[a,c]]).toObject();return i||Array.prototype.push.apply(s[a],c),u}return null}},c=function(t,n){t.name in i||(i[t.name]=[]);var r=i[t.name],o=e(n).size();r.filter(v.makeFilter(t,n," && ",!0)).filter(function(t){e(t).size()>o})};this.filter=function(r,o){var u=r.modelName,l=e(o).size();switch(l){case 0:var f=t[u];return t[u]=!0,u in n&&delete n[u],u in i&&delete i[u],f?null:{};case 1:var d=a.call(this,r,o);return c.call(this,r,o),d}var h=this,p=e(o).keys().some(function(t){var e={};return e[t]=o[t],null==a.call(h,r,e,!0)});if(p)return null;u in i||(i[u]=[]);var m=s(o),g=i[u].filter(v.makeFilter(r,o," || ",!0));if(g.length){var y=[];for(var w in g)y.push.apply(y,m.filter(v.makeFilter(r,g[w]," && ",!0)));var b=e(m).difference(y).toArray()}else var b=m;if(b.length){i[u].push.apply(i[u],b);var b=e(o).keys().map(function(t){var n=e(b).pluck(t).unique().toArray();return[t,n.length?n:o[t]]}).toObject();return c(r,b),b}return null},this.getIndexFor=function(t,e){var i=t+"."+e;return i in n||(n[i]=[]),n[i]}}function d(t,n){var i=[];this.add=i.push.bind(i),this.add=function(t){e(i).find(t)||i.push(t)},this.get0=function(t){return n[1].ask(t),e(i).filter(function(e){return e[0]===t}).pluck("1").toArray()},this.get1=function(t){return n[0].ask(t),e(i).filter(function(e){return e[1]===t}).pluck("0").toArray()},this["get"+v.capitalize(t.indexName.split("/")[1])]=this.get1,this["get"+v.capitalize(t.indexName.split("/")[0])]=this.get0,this.del=function(t){for(var e=i.length,n=null,r=0;r<e;r++)if(i[r][0]===t[0]&&i[r][1]===t[1]){n=r;break}n&&i.splice(r,1),console.log("deleting ",t)}}function h(t,n,i,r){var o=Array.prototype.slice.call(arguments,4),s={};e(o).each(function(e){t.orm.on(e,function(){s={}})});var a={get:function(){return this.id in s||(s[this.id]=i.call(this)),s[this.id]}};r&&(a.set=function(t){r.call(this,t),this.id in s&&delete s[this.id]}),Object.defineProperty(t,n,a)}function p(t){this.resource=t._resource,this.formIdx=t.formIdx,this.fields=t.errors}function m(t,e){this.$orm=new b(new v.reWheelConnection(t,e),this),this.on=this.$orm.on.bind(this.$orm),this.emit=this.$orm.emit.bind(this.$orm),this.unbind=this.$orm.unbind.bind(this.$orm),this.once=this.$orm.once,this.addModelHandler=this.$orm.addModelHandler.bind(this.$orm),this.addPersistentAttributes=this.$orm.addPersistentAttributes.bind(this.$orm),this.utils=v,this.logout=this.$orm.connection.logout.bind(this.$orm.connection)}i.prototype.addHandler=function(t){var e=v.hash(t.toString());e in this.strHandlers||(this.strHandlers[e]=t,this.handlers.push(t))},i.prototype.handle=function(){var t=Array.prototype.slice.call(arguments,0);this.handlers.forEach(function(e){e.apply(null,t)})},i.prototype.handleBy=function(){var t=Array.prototype.slice.call(arguments,1),e=arguments[0];this.handlers.forEach(function(n){n.apply(e,t)})};var g=0,y=function(){return""},v={renameFunction:function(t,e){return new Function("return function (call) { return function "+t+" () { return call(this, arguments) }; };")()(Function.apply.bind(e))},cached:function(t,e){function n(){return this[e]||(this[e]=t.call(this,[arguments])),this[e]}return e||(e="_"+g++),n},log:function(){console.log(arguments)},xdr:function(t,n,i,r,o){return new Promise(function(i,s){var a;n||(n={}),XMLHttpRequest?(a=new XMLHttpRequest,a.onreadystatechange=function(){if(4===a.readyState){try{var t=JSON.parse(a.responseText)}catch(t){var t=null}var e={responseData:t,responseText:a.responseText,status:a.status,request:a};a.status>=200&&a.status<400?i(e):s(e)}}):XDomainRequest?(a=new XDomainRequest,a.onload=function(){i(a.responseText,a.statusText,a)}):s(new Error("CORS not supported")),a.open("POST",t,!0),a.onerror=s,a.setRequestHeader("Accept","application/json"),r&&(n.__token__=r),o?(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n=e(n).map(function(t,e){return e+"="+encodeURI(t.toString())}).toArray().join("&")):(a.setRequestHeader("Content-Type","text/plain"),n=e(n).size()?JSON.stringify(n):""),a.send(n)})},capitalize:function(t){return t[0].toUpperCase()+t.slice(1).toLowerCase()},hash:function(t){t=t.toString();for(var e=1,n=0;n<t.length;n++)e*=1+t.charCodeAt(n);return(e%34958374957).toString()},makeFilter:function(t,n,i,r){if(i||(i=" && "),0===e(n).size())return function(t){return!0};var o=e(n).map(function(n,i){return n||(n=[null]),Array.isArray(n)||(n=[n]),r||"reference"!==t.fields[i].type?"string"===t.fields[i].type&&(n=n.map(JSON.stringify)):(i="_"+i,n=e(n).map(function(t){return t&&t.constructor!==Number?t.id:t}).toArray()),"("+e(n).map(function(t){return"(x."+i+" === "+t||"null)"}).join(" || ")+")"}).toArray().join(i);return new Function("x","return "+o)},sameAs:function(t,e){for(var n in t)if(e[n]!=t[n])return!1;return!0},pluralize:function(t,e){return t+"s"},beforeCall:function(t,e){var n=function(){e().then(t)};return n},cleanStorage:function(){e(localStorage).keys().each(function(t){delete localStorage[t]})},cleanDescription:function(){e(localStorage).filter(function(t,n){return e(n).startsWith("description:")}).keys().each(function(t){delete localStorage[t]})},reverse:function(t,e){return e.split(t).reverse().join(t)},permutations:function(t){for(var e=[],n=t.length-1;n>=0;n--)for(var i=t.length-1;i>=0;i--)n!==i&&e.push([t[n],t[i]]);return e},waitFor:function(t,e){var n=function(){t()?e():setTimeout(n,500)};setTimeout(n,500)},bool:Boolean,noop:function(){},tzOffset:6e4*(new Date).getTimezoneOffset(),transFieldType:{date:function(t){return new Date(1e3*t+v.tzOffset)},datetime:function(t){return new Date(1e3*t+v.tzOffset)},string:function(t){return t.toString()},text:function(t){return t.toString()},integer:function(t){return parseInt(t)},float:function(t){return parseFloat(t)}},mock:o()};const w="lastRWTConnectionStatus";a.prototype.$post=function(t,e,n){var i=this,r=new Promise(function(r,o){v.xdr(i.endPoint+t,e,i.cachedStatus.application,i.cachedStatus.token).then(function(o){i.emit("http-response",o.responseText,o.status,t,e),i.emit("http-response-"+o.status,o.responseText,t,e),o.responseData&&i.emit("http-response-"+o.status+"-json",o.responseData,t,e),n&&n(o.responseData||o.responseText),r(o.responseData||o.responseText)},function(n){n.responseData?(i.emit("error-json",n.responseData,n.status,t,e,n),i.emit("error-json-"+n.status,n.responseData,t,e,n)):(i.emit("error-http",n.responseText,n.status,t,e,n),i.emit("error-http-"+n.status,n.responseText,t,e,n)),o(n.responseData||n.responseText)})});return r},a.prototype.status=function(t,n){var i="token:"+this.endPoint,r=this;if(n&&(this.cachedStatus={},delete localStorage[i]),this.statusWaiting)return void v.waitFor(function(){return!r.statusWaiting},function(){r.status(t,n)});if(!e(this.cachedStatus).size()){var o={};return i in localStorage&&(o.__token__=localStorage[i]),this.statusWaiting=!0,void this.$post("api/status",o,function(e){r.updateStatus(e),localStorage[i]=e.token,t(e),r.statusWaiting=!1})}t(this.cachedStatus),t(this.cachedStatus)},a.prototype.updateStatus=function(t){var e=parseFloat(localStorage.lastBuild)||1;e<t.last_build&&(v.cleanDescription(),localStorage.lastBuild=t.last_build),this.isConnected=Boolean(t.token),this.isLoggedIn=Boolean(t.user_id);var n=this.cachedStatus;if(this.cachedStatus=t,!n.user_id&&t.user_id)this.emit("logged-in",t.user_id);else if(n.user_id&&!t.user_id)this.emit("logged-out");else if(this.isConnected&&!this.isLoggedIn&&(this.emit("login-required"),this.getLogin)){var i=this.getLogin();i.constructor===Object?this.login(i.username,i.password,i.callBack):i.constructor===Promise&&i.then(function(t){this.login(t.username,t.password,t.callBack)})}!n.realtimeEndPoint&&t.realtimeEndPoint?this.wsConnection=new s(t.realtimeEndPoint,this):n.realtimeEndPoint&&!t.realtimeEndPoint&&(this.wsConnection.close(),delete this.wsConnection),this.emit("update-connection-status",t,n),localStorage[w]=JSON.stringify(t)},a.prototype.login=function(t,e){var n=this;return new Promise(function(i,r){v.xdr(n.endPoint+"api/login",{username:t||"",password:e||""},null,n.cachedStatus.token,!0).then(function(t){n.updateStatus(t.responseData),i({status:"success",userid:n.cachedStatus.user_id})},function(t){i({error:t.responseData.error,status:"error"})})})},a.prototype.logout=function(){var t=this;return new Promise(function(e,n){t.$post("api/logout").then(function(n){t.updateStatus({}),delete localStorage[w],e()},n)})},a.prototype.connect=function(t){this.isLoggedIn?t(this.cachedStatus.user_id):(this.once("logged-in",function(e){t(e)}),this.status(t||v.noop))},v.reWheelConnection=a;var b=function(t,n){function r(t,e,n){this.klass=e,this.permissions=[],this.id=t;for(var i in n)this.push.apply(this,[i,n[i]])}if(t.constructor===String)var o=new a(t);else if(t.constructor===v.reWheelConnection)var o=t;this.connection=o,o.on("connected",function(){this.connected=!0}),this.on=o.on,this.emit=o.emit,this.unbind=o.unbind,this.once=o.once,this.$post=o.$post.bind(o),this.on("ws-connected",function(t){console.info("Websocket connected"),t.onMessageJson(s.gotData.bind(s)),t.onMessageText(function(t){console.info("WS message : "+t)})}),this.on("ws-disconnected",function(t){console.error("Websocket disconnected")}),this.on("error-json-404",function(t,e,n,i){console.error("JSON error ",JSON.stringify(t)),delete b[e.split("/")[0]]}),this.on("realtime-message-json",function(t){s.gotData(t)});var s=this,c={auth_group:e({})},u={},d={},m={},g={},y={},w={},b={},S=new f(e),N=new l(b,c,this,S);window.IDB=c,this.validationEvent=this.on("error-json-513",function(t,e,n,i){currentContext.savingErrorHanlder&&currentContext.savingErrorHanlder(new p(t))});var A=function(t){return t in c?c[t]:(c[t]=e({}),c[t])},_=function(t){return t in UNLINKED?UNLINKED[t]:(UNLINKED[t]={},UNLINKED[t])};r.prototype.save=function(t){var n={permissions:e(this.permissions).map(function(t){return[t[0].id,t[1]]}).toObject()};n.id=this.id;this.klass.modelName;s.$post(this.klass.modelName+"/set_permissions",n,function(e,n,i,r){t(e)})},r.prototype.push=function(t,n){var i=e(n),r=e(this.klass.allPermissions).map(function(t){return[t,i.contains(t)]}).toObject(),o=e(this.permissions).map(function(t){return t[0].id});o.contains(t)?this.permissions[o.indexOf(t)][1]=r:this.permissions.push([c.auth_group.get(t),r])};var x=function(t){t.fields.id.readable=!1,t.fields.id.writable=!1;var i=e(t.fields);t.privateArgs&&(i=i.merge(t.privateArgs)),s.emit("model-definition",t,A(t.name));var o="if (!row) { row = {}};\n";o+=t.references.map(function(t){return"this._"+t.id+" = row."+t.id+";"}).join(";\n"),o+=i.map(function(t,e){return"date"==t.type||"datetime"==t.type?"this."+e+" = row."+e+"?new Date(row."+e+" * 1000 - "+v.tzOffset+"):null;\n":"boolean"==t.type?"this."+e+" = (row."+e+' === "T") || (row.'+e+" === true);\n":"this."+e+" = row."+e+";\n"}).toString("\n"),o+="if (permissions) {this._permissions = permissions && Lazy(permissions).map(function (x) { return [x, true] }).toObject();}";var a=new Function("row","permissions",o);a.prototype.orm=n,a.ref_translations={},a.modelName=t.name,a.references=e(t.references).pluck("id").toArray(),a.inverse_references=t.referencedBy.map(function(t){return t.by+"_"+t.id+"_set"}),a.referents=t.referencedBy.map(function(t){return[t.by,t.id]}),a.fieldsOrder=t.fieldOrder,a.allPermissions=t.permissions,e(t.representation).size()&&(a.prototype.toString=new Function("return this."+e(t.representation).toString(' + " " + this.'))),a.prototype.toUpperCase=function(){return this.toString().toUpperCase()},a.prototype.toLowerCase=function(){return this.toString().toLowerCase()},a.prototype.delete=function(){return n.delete(this.constructor.modelName,[this.id])},Object.defineProperty(a.prototype,"permissions",{get:function(){return this._permissions?this._permissions:void N.permissions[this.constructor.modelName].ask(this.id)}}),a.prototype.all_perms=function(t){var n=this.id;s.$post(this.constructor.modelName+"/all_perms",{id:this.id},function(i){var o=i,u={},l=e(o).pluck("group_id").unique().map(function(t){return""+t}).difference(c.auth_group.keys()).toArray();e(o).groupBy(function(t){return t.group_id}).each(function(t,n){u[n]=e(t).pluck("name").toArray()});var f=function(e){t(new r(n,a,u))};l.length?s.get("auth_group",l,f):f()})},a.prototype.save=function(t){var n=this.asRaw(),i=a.fields,r=this.id,o=this.constructor.modelName;if(t)for(var c in t)n[c]=t[c];e(a.fieldsOrder).filter(function(t){return!i[t].writable}).each(function(t){t in n&&delete n[t]}),r&&(n.id=r);var u=s.$post(o+(r?"/post":"/put"),n);return t&&t.constructor===Function&&(u.context.savingErrorHanlder=t),u},a.prototype.copy=function(){var t=new this.constructor(this.asRaw());return t._permissions=this._permissions,t};var l="return {\n"+e(t.references).map(function(t){return t.id+" : this._"+t.id}).concat(i.map(function(t,e){return"date"==t.type||"datetime"==t.type?e+" : (this."+e+"?(Math.round(this."+e+".getTime() - this."+e+".getTimezoneOffset() * 60000) / 1000):null)":"boolean"==t.type?e+" : this."+e+'?"T":"F"':e+" : this."+e})).toString(",\n")+"};";a.prototype.asRaw=new Function(l),a.saveMulti=function(t,n,i){var r=[],o=e(a.fields).filter(function(t){return!t.writable}).pluck("id").toArray();e(t).map(function(t){return t.asRaw()}).each(function(t){e(o).each(function(e){delete t[e]}),r.push(t)}),s.$post(a.modelName,"put",{multiple:r,formIdx:s.formIdx++},function(t){s.gotData(t);var i=c[a.modelName],r=e(t[a.modelName].results).pluck("id").map(function(t){return i.get(t)}).toArray();n&&n(r)},i)},"extra_verbs"in t&&e(t.extra_verbs).each(function(t){var n=t[0],i=t[1],r="data = {id : this.id";i.length&&(r+=", "+e(i).map(function(t){return t+" : "+t}).join(",")),r+="};",i.push("cb"),a.prototype[n]=new Function(i,r+'W2S.W2P_POST(this.constructor.modelName,"'+n+'", data,function(data,status,headers,x){try{\n   if (!headers("nomodel")) {window.W2S.gotData(data,cb);}\n   else {if (cb) {cb(data)}}\n} catch(e){\nif (cb) {cb(data);}\n}\n});\n')}),"privateArgs"in t&&(a.privateArgs=e(t.privateArgs).keys().map(function(t){return[t,!0]}).toObject(),a.prototype.savePA=function(t){var n=this,i={id:this.id},r=this.constructor.privateArgs,o=this.constructor.fields,a=(new this.constructor(t).asRaw(),e(r).keys().map(function(t){return[t,o[t]]}).toObject());e(t).each(function(t,e){e in r&&a[e].writable&&(i[e]=t)}),s.$post(this.constructor.modelName+"/savePA",i,function(){e(i).each(function(t,e){n[e]=t})})}),y[a.modelName]=a;for(var f in t.fields)t.fields[f].id=f;return a.fields=e(t.fields).concat(e(t.privateArgs)).concat(e(t.references).tap(function(t){t.type=t.type||"reference"})).indexBy("id").toObject(),e(a.fields).each(function(t){t.widget||("reference"===t.type?t.widget="choices":t.widget=t.type)}),e(t.references).each(function(t){var e=t.to,i="_"+t.id;h(a.prototype,t.id,function(){if(!(e in c)){var t=this;s.describe(e,function(n){N.mainIndex[e].ask(t[i],!0)})}var n=e in c&&this[i]&&c[e].get(this[i]);return!n&&e in N.mainIndex?(N.mainIndex[e].ask(this[i],!0),v.mock):n},function(n){if(n){if(n.constructor!==v.mock&&n.constructor.modelName!==e)throw new TypeError("You can assign only "+e+" to "+t.id);this[i]=n.id}else this[i]=null},"new-"+e,"deleted-"+e,"updated-"+e,"new-model-"+e,"updated-"+a.modelName),a.prototype["get"+v.capitalize(t.id)]=function(){return n.get(e,this[i])}}),e(t.referencedBy).each(function(t){var e=t.by+"."+t.id,i=t.by+"_"+v.pluralize(t.id),r=t.by;a.prototype.hasOwnProperty(i)?console.error("Tryed to redefine property "+i+"s for "+a.modelName):h(a.prototype,i,function(){var t=r in c?u[e].get(this.id+""):null;return N.foreignKeys[e].ask(this.id,!0),t},null,"new-"+r,"updated-"+r,"deleted-"+r),a.prototype["get"+v.capitalize(v.pluralize(t.by))]=function(){var e={};return e[t.id]=[this.id],n.query(t.by,e)}}),t.manyToMany&&(e(t.manyToMany).each(function(t){var n=t.indexName,i=t.first?0:1,r=t.model,o=N.m2mIndex[n]["get"+(1-i)];h(a.prototype,t.model+"s",function(){var t=this,n=[],i=o(t.id),s=null;return i.length&&(s=A(r).get.bind(c[r])),i&&s&&(n=e(i).map(s).filter(v.bool).toArray()),n},null,"received-m2m-"+n,"received-"+r),a.prototype["get"+v.capitalize(v.pluralize(r))]=function(){var t=this;return new Promise(function(a,u){try{N.getM2M(n,[t.id],i,function(n){var i=o(t.id);i.length?s.fetch(r,{id:i},null,function(){var t=c[r].get.bind(c[r]);a(e(i).map(t).filter(v.bool).toArray())}):a([])})}catch(t){console.error(t),u(t)}})},a.fields[v.capitalize(r)]={id:v.capitalize(r),name:v.capitalize(r),writable:!0,readable:!0,type:"M2M",validators:[]}}),a.prototype.unlinkReference=function(t){var n=!1,i=this.id,r=[];"Array"==t.constructor.name&&(n=!0,r=t,t=r[0]);var o=t.constructor.modelName;if(n)var c=e(r).pluck("id").map(function(t){return[i,t]}).toArray();else var c=[[i,t.id]];s.$post(a.modelName+"/"+o+"s/delete",{collection:c})},a.prototype.linkReference=function(t){var n=!1,i=this.id,r=[];"Array"==t.constructor.name&&(n=!0,r=t,t=r[0]);var o=t.constructor.modelName,c=a.modelName+"/"+o;if(n){var u=[];if(c in INDEX_M2M&&(u=e(r).pluck("id").difference(e(INDEX_M2M[c][0].get(this.id))).toArray()),c=o+"/"+a.modelName,c in INDEX_M2M&&(u=e(r).pluck("id").difference(e(INDEX_M2M[c][0].get(this.id))).toArray()),u.length){var l=e(u).map(function(t){return[i,t]}).toArray();W2P_POST(a.modelName,o+"s/put",{collection:l},function(t){})}}else{if(c in N.m2mIndex&&e(N.m2mIndex[c]["get"+v.capitalize(o)](t.id)).find(this))return;s.$post(a.modelName+"/"+o+"s/put",{collection:[[this.id,t.id]]})}}),s.emit("new-model",a),s.emit("new-model-"+a.modelName),a};this.gotData=function(t,n){if(console.info("gotData"),"string"!=typeof t){"_extra"in t&&delete t._extra;var i=t.TOONE,r=t.TOMANY,o=t.MANYTOMANY,a=t.PERMISSIONS,l=t.PA;if(delete t.TOONE,delete t.TOMANY,delete t.MANYTOMANY,delete t.PERMISSIONS,delete t.PA,l||(l={}),t=e(t).filter(function(t,e){return!("deleted"in t)||e in y}).toObject(),"m2m"in t){var f=t.m2m;delete t.m2m}e(t).each(function(t,n){s.describe(n,function(i){var r=i;t.results&&t.results.length>0&&t.results[0].constructor==Array&&(t.results=e(t.results).map(function(t){return e(r.fieldsOrder).zip(t).toObject()}).toArray());var o=e(t.results),a=t.deleted;if(n in l){var f=l[n];e(o).each(function(t){t.id in f&&e(f[t.id]).each(function(e,n){t[n]=e})})}var d=A(n),h=d.source;a&&a.forEach(function(t){delete h[t]});var p=o.indexBy("id"),m=p.keys(),g=m.difference(d.keys().map(function(t){return parseInt(t)})),w=m.difference(g);w=w.filter(function(t){return!v.sameAs(p.get(t),d.get(t).asRaw())}).toArray();var b=e(t.permissions?t.permissions:{}),S=g.map(function(t){return new r(p.get(t),b.get(t))}),N=[];w.forEach(function(t){var n=h[t],o=n.copy(),s=new r(p.get(t));e(i.fields).keys().each(function(t){n[t]=s[t]}),N.push([s,o])}),N.length&&s.emit("updated-"+n,N);var _=S.toArray();e(_).each(function(t){h[t.id]=t}),e(y[n].references).each(function(t){u[n+"."+t]=c[n].groupBy("_"+t)}),_.length&&s.emit("new-"+n,e(_),t.totalResults),a&&s.emit("deleted-"+n,a),s.emit("received-"+n)})}),i&&(console.error("TOONE"),e(i).each(function(t,e){console.log(e);_(e)})),r&&(console.error("TOMANY"),e(r).each(function(t,n){n in ASKED_UNLINKED||(ASKED_UNLINKED[n]=e([])),e(t).each(function(t){ASKED_UNLINKED[n].source.push(t)})})),o&&(console.error("MANYTOMANY"),e(o).each(function(t,n){var i=parseInt(n.split("|")[1]);n=n.split("|")[0],n in ASKED_M2M||(ASKED_M2M[n]=[{},{}]);var r=ASKED_M2M[n][i];e(t).each(function(t){r[t+""]=!0,r[t]=!0})})),f&&s.gotM2M(f),a&&s.gotPermissions(a),n&&n(t),s.emit("got-data")}else if(console.log("data "+t+" refused from gotData()"),n)return n(t)},this.gotPermissions=function(t){e(t).each(function(t,n){e(t[0]).each(function(t,i){n in c&&i in c[n].source&&(c[n].get(i)._permissions=e(t).map(function(t){return[t,!0]}).toObject())}),e(t[0]).size()&&s.emit("update-permissions-"+n,e(t[0]).keys().toArray())}),this.emit("update-permissions")},this.gotM2M=function(t){e(t).each(function(t,n){var i=N.m2mIndex[n];e(t).each(function(t){e(t).each(function(t,e){i[e](t)})}),s.emit("received-m2m"),s.emit("received-m2m-"+n)})},this.fetch=function(t,e,n,i){t in b?setTimeout(function(){s.fetch(t,e,n,i)},500):s.describe(t,function(n){return s.connection.cachedStatus.realtimeEndPoint?(e=S.filter(n,e),e?(b[t]=!0,s.$post(t+"/list",{filter:e}).then(function(e){s.gotData(e,i),delete b[t]},function(e){delete b[t]})):i&&i(),e):void this.$post(t+"/list",sendData,function(n){e||GOT_ALL.source.push(t),s.gotData(n,i)})}.bind(this))},this.get=function(t,e,n){e.constructor!==Array&&(e=[e]),s.fetch(t,{id:e},null,function(){var i=[],r=c[t];for(var o in e)i.push(r.source[e[o]]);n(i)})},this.gotModel=function(t){for(var n in t){var i=t[n];localStorage["description:"+n]=JSON.stringify(t),y[n]=x(i),n in c||(c[n]=e({}))}},this.describe=function(t,e){var n=y[t];if(n)e&&e(n);else if(t in b)setTimeout(function(){s.describe(t,e)},500);else{if(t in w)return;var i="description:"+t;i in localStorage?(this.gotModel(JSON.parse(localStorage[i])),e&&e(y[t])):(b[t]=!0,this.$post(t+"/describe",null,function(n){s.gotModel(n),e&&e(y[t]),delete b[t]},function(e){this.modelNotFound.handle(t),w[t]=!0}))}},this.addModelHandler=function(t,e){var n=v.hash(e);t in d||(d[t]=new i),t in m||(m[t]={}),n in m[t]||(m[t][n]=!0,t in y?e(y[t]):d[t].addHandler(e))},this.addPersistentAttributes=function(t,n){var i=function(t,e){e.forEach(function(e){var n="pA:"+t.modelName+":"+e,i="__"+e;Object.defineProperty(t.prototype,e,{get:function(){if(!(i in this)){var t=localStorage[n+this.id];this[i]=t?JSON.parse(t):null}return this[i]},set:function(t){this[i]=t,localStorage[n+this.id]=JSON.stringify(t)}})})};t in g||(g[t]=[]);var r=g[t];if(n)var o=e(n).difference(r).toArray();else var o=r;o.length&&(t in y&&i(y[t],o),n&&Array.prototype.push.apply(r,o))},this.on("new-model",function(t){t.modelName in d&&d[t.modelName].handle(y[t.modelName]),t.modelName in g&&s.addPersistentAttributes(t.modelName)}),this.query=function(t,n,i,r){var o=this;this.describe(t,function(s){n=e(n).map(function(t,e){return[e,Array.isArray(t)?t:[t]]}).toObject();var a=v.makeFilter(s,n),c=A(t);o.fetch(t,n,i,function(t){r(c.filter(a).values().toArray())})})},this.delete=function(t,e,n){return this.$post(t+"/delete",{id:e},n)},this.connect=function(t){this.connection.isLoggedIn?t():this.connection.connect(t)}};m.prototype.connect=function(){var t=this.$orm.connection;return new Promise(function(e,n){t.connect(e)})},m.prototype.login=function(t,e){return new Promise(function(n,i){this.$orm.connection.login(t,e,n)}.bind(this))},m.prototype.logout=function(t){return this.$orm.connection.logout()},m.prototype.getModel=function(t){var e=this;return new Promise(function(n,i){try{e.$orm.connect(function(){e.$orm.describe(t,n)})}catch(t){i(t)}})},m.prototype.get=function(t,e){var n=this,i=!1,r=t;return e.constructor!==Array&&(i=!0,e=[e]),new Promise(function(t,o){try{n.$orm.connect(function(){i?n.$orm.get(r,e,function(e){t(e[0])}):n.$orm.get(r,e,t)})}catch(t){o(t)}})},m.prototype.query=function(t,e,n){var i=this;return new Promise(function(r,o){var s=null;n&&n.constructor===Array&&n.length?s=n:n&&n.constructor===String&&n.length&&(s=n.split(","));try{i.$orm.connect(function(){i.$orm.query(t,e,s,r)})}catch(t){o(t)}})},m.prototype.delete=function(t,e){var n=this;return new Promise(function(i,r){try{n.$orm.connect(function(){n.$orm.delete(t,e,i)})}catch(t){r(t)}})},m.prototype.getLoggedUser=function(){var t=this;return this.$orm.connection.cachedStatus.user_id?this.get("auth_user",this.$orm.connection.cachedStatus.user_id):new Promise(function(e,n){t.once("logged-in",function(n){t.get("auth_user",n).then(e)})})},m.prototype.$sendToEndpoint=function(t,e){return this.$orm.$post(t,e)},m.prototype.login=function(t,e){return this.$orm.connection.login(t,e)},t.rwt=m}(window,Lazy,SockJS);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhbmRsZXJzLmpzIiwidXRpbHMuanMiLCJjb25uZWN0aW9uLmpzIiwidG91Y2hlci5qcyIsInZhY3V1bWNhY2hlci5qcyIsImF1dG9saW5rZXIuanMiLCJsaXN0Y2FjaGVyLmpzIiwibWFueXRvbWFueS5qcyIsImNhY2hlci5qcyIsIm9ybS5qcyJdLCJuYW1lcyI6WyJIYW5kbGVyIiwidGhpcyIsImhhbmRsZXJzIiwic3RySGFuZGxlcnMiLCJOYW1lZEV2ZW50TWFuYWdlciIsImV2ZW50cyIsImhhbmRsZXJJZCIsImlkeElkIiwib24iLCJuYW1lIiwiZnVuYyIsIkFycmF5IiwiaWQiLCJwdXNoIiwiZW1pdCIsImFyZ3MiLCJwcm90b3R5cGUiLCJzbGljZSIsImNhbGwiLCJhcmd1bWVudHMiLCJmb3JFYWNoIiwiZXZlbnQiLCJhcHBseSIsInVuYmluZCIsImhhbmRsZXIiLCJjb3VudCIsIkxhenkiLCJlYWNoIiwidiIsImsiLCJpZHgiLCJuIiwicmV2ZXJzZSIsIngiLCJzcGxpY2UiLCJvbmNlIiwiZXZlbnROYW1lIiwiaGFuZGxlckZ1bmN0aW9uIiwic2VsZiIsIm1vY2tPYmplY3QiLCJQcm94eSIsImdldCIsInRhcmdldCIsIm51bGxTdHJpbmciLCJ1dGlscyIsIm1vY2siLCJSZWFsdGltZUNvbm5lY3Rpb24iLCJlbmRQb2ludCIsInJ3dENvbm5lY3Rpb24iLCJjb25uZWN0aW9uIiwiU29ja0pTIiwib25vcGVuIiwiY29uc29sZSIsImxvZyIsInRlbmFudCIsIm9ubWVzc2FnZSIsInR5cGUiLCJKU09OIiwicGFyc2UiLCJkYXRhIiwiZSIsIm9uY2xvc2UiLCJzZXRUaW1lb3V0Iiwid3NDb25uZWN0Iiwic2VuZCIsImNhY2hlZFN0YXR1cyIsImFwcGxpY2F0aW9uIiwidG9rZW4iLCJjbG9zZSIsInJlV2hlZWxDb25uZWN0aW9uIiwiZ2V0TG9naW4iLCJlbmRzV2l0aCIsImlzQ29ubmVjdGVkIiwiaXNMb2dnZWRJbiIsIlRvdWNoZXIiLCJ0b3VjaGVkIiwidG91Y2giLCJ0IiwiVmFjdXVtQ2FjaGVyIiwiYXNrZWQiLCJwa0luZGV4IiwibWlzc2luZyIsImFzayIsImxhenkiLCJzb3VyY2UiLCJjb250YWlucyIsImdldEFza2VkSW5kZXgiLCJtaXNzaW5ncyIsImxlbmd0aCIsInVuaXF1ZSIsInRvQXJyYXkiLCJBdXRvTGlua2VyIiwiYWN0aXZlcyIsIklEQiIsIlcyUFJFU09VUkNFIiwibGlzdENhY2hlIiwibWFpbkluZGV4IiwiZm9yZWlnbktleXMiLCJtMm0iLCJtMm1JbmRleCIsInBlcm1pc3Npb25zIiwibW9kZWwiLCJpbmRleCIsImdldEluZGV4Rm9yIiwicmVmZXJlbmNlcyIsInJlZmVyZW5jZSIsImluZGV4TmFtZSIsInRvIiwicmVmZXJlbmNlZEJ5IiwiZmllbGQiLCJieSIsIm1hbnlUb01hbnkiLCJyZWxhdGlvbiIsIk1hbnlUb01hbnlSZWxhdGlvbiIsIm0ybUdldCIsImNvbGxlY3Rpb24iLCJjYWxsQmFjayIsIiRwb3N0IiwiZ290RGF0YSIsImdldE0yTSIsImJpbmQiLCJsaW5rVW5saW5rZWQiLCJ2YWx1ZXMiLCJzdW0iLCJjaGFuZ2VkIiwiaW5kZXhlcyIsImZpbHRlciIsIkJvb2xlYW4iLCJtYXAiLCJwYXJzZUludCIsIklOREVYIiwiZ2V0dGVyIiwiaWRzIiwib3RoZXJJbmRleCIsInNwbGl0IiwiZGVzY3JpYmUiLCJmbGF0dGVuIiwibW9kZWxOYW1lIiwia2V5cyIsImZldGNoIiwibm9vcCIsIm1haW5SZXNvdXJjZSIsImZpZWxkTmFtZSIsInRvT2JqZWN0IiwicmVzb3VyY2VOYW1lIiwiZ290UGVybWlzc2lvbnMiLCJQRVJNSVNTSU9OUyIsInNldEludGVydmFsIiwiTGlzdENhY2hlciIsImdvdEFsbCIsImNvbXBvc2l0ZUFza2VkIiwiY2FydGVzaWFuUHJvZHVjdDEiLCJ5IiwiaXNBcnJheSIsInJldCIsImEiLCJiIiwiY2FydGVzaWFuUHJvZHVjdCIsImFyciIsImV4cGxvZGVGaWx0ZXIiLCJwcm9kdWN0IiwiciIsImZpbHRlclNpbmdsZSIsInRlc3RPbmx5Iiwia2V5IiwiZGlmZmVyZW5jZSIsImNsZWFuQ29tcG9zaXRlcyIsImZpbHRlckxlbiIsInNpemUiLCJtYWtlRmlsdGVyIiwiaXRlbSIsImdvdCIsInRocyIsInNpbmdsZSIsInNvbWUiLCJmIiwiZXhwbG9kZWQiLCJwYXJ0aWFscyIsImJhZCIsInBsdWNrIiwiaXRlbXMiLCJhZGQiLCJmaW5kIiwiZ2V0MCIsImdldDEiLCJjYXBpdGFsaXplIiwiZGVsIiwibCIsImNhY2hlZFByb3BlcnR5QnlFdmVudHMiLCJwcm90byIsInByb3BlcnR5TmFtZSIsInNldHRlciIsInJlc3VsdCIsIm9ybSIsInByb3BlcnR5RGVmIiwidmFsdWUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsIlZhbGlkYXRpb25FcnJvciIsInJlc291cmNlIiwiX3Jlc291cmNlIiwiZm9ybUlkeCIsImZpZWxkcyIsImVycm9ycyIsInJlV2hlZWxPUk0iLCJsb2dpbkZ1bmMiLCIkb3JtIiwiYmFzZU9STSIsImFkZE1vZGVsSGFuZGxlciIsImFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzIiwibG9nb3V0IiwiYWRkSGFuZGxlciIsInN0ckhhbmRsZXIiLCJoYXNoIiwidG9TdHJpbmciLCJoYW5kbGUiLCJoYW5kbGVCeSIsImNhY2hlZEtleUlkeCIsInJlbmFtZUZ1bmN0aW9uIiwiZm4iLCJGdW5jdGlvbiIsImNhY2hlZCIsIndyYXBwZXIiLCJ4ZHIiLCJ1cmwiLCJmb3JtRW5jb2RlIiwiUHJvbWlzZSIsImFjY2VwdCIsInJlamVjdCIsInJlcSIsIlhNTEh0dHBSZXF1ZXN0Iiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInJlc3BvbnNlRGF0YSIsInJlc3BvbnNlVGV4dCIsInJlc3BvbnNlIiwic3RhdHVzIiwicmVxdWVzdCIsIlhEb21haW5SZXF1ZXN0Iiwib25sb2FkIiwic3RhdHVzVGV4dCIsIkVycm9yIiwib3BlbiIsIm9uZXJyb3IiLCJzZXRSZXF1ZXN0SGVhZGVyIiwiX190b2tlbl9fIiwiZW5jb2RlVVJJIiwiam9pbiIsInN0cmluZ2lmeSIsInMiLCJ0b1VwcGVyQ2FzZSIsInRvTG93ZXJDYXNlIiwic3RyIiwiY2hhckNvZGVBdCIsInVuaWZpZXIiLCJkb250VHJhbnNsYXRlRmlsdGVyIiwidmFscyIsImNvbnN0cnVjdG9yIiwiTnVtYmVyIiwic2FtZUFzIiwicGx1cmFsaXplIiwiYmVmb3JlQ2FsbCIsImJlZm9yZSIsImRlY29yYXRvciIsInRoZW4iLCJjbGVhblN0b3JhZ2UiLCJsb2NhbFN0b3JhZ2UiLCJjbGVhbkRlc2NyaXB0aW9uIiwic3RhcnRzV2l0aCIsImNociIsInBlcm11dGF0aW9ucyIsIndhaXRGb3IiLCJ3YWl0ZXIiLCJib29sIiwidHpPZmZzZXQiLCJEYXRlIiwiZ2V0VGltZXpvbmVPZmZzZXQiLCJ0cmFuc0ZpZWxkVHlwZSIsImRhdGUiLCJkYXRldGltZSIsInN0cmluZyIsInRleHQiLCJpbnRlZ2VyIiwiZmxvYXQiLCJwYXJzZUZsb2F0IiwiU1RBVFVTS0VZIiwicHJvbWlzZSIsInhociIsImZvcmNlIiwic3RhdHVzV2FpdGluZyIsInVwZGF0ZVN0YXR1cyIsImxhc3RCdWlsZCIsImxhc3RfYnVpbGQiLCJ1c2VyX2lkIiwib2xkU3RhdHVzIiwibG9naW5JbmZvIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwib2JqIiwicmVhbHRpbWVFbmRQb2ludCIsIndzQ29ubmVjdGlvbiIsInVzZXJpZCIsImVycm9yIiwib2siLCJjb25uZWN0Iiwib3B0aW9ucyIsImV4dE9STSIsIlBlcm1pc3Npb25UYWJsZSIsImtsYXNzIiwiU3RyaW5nIiwiY29ubmVjdGVkIiwid3MiLCJpbmZvIiwib25NZXNzYWdlSnNvbiIsIm9uTWVzc2FnZVRleHQiLCJtZXNzYWdlIiwic2VudERhdGEiLCJ3YWl0aW5nQ29ubmVjdGlvbnMiLCJhdXRoX2dyb3VwIiwiUkVWSURYIiwiYnVpbGRlckhhbmRsZXJzIiwiYnVpbGRlckhhbmRsZXJVc2VkIiwicGVyc2lzdGVudEF0dHJpYnV0ZXMiLCJtb2RlbENhY2hlIiwiZmFpbGVkTW9kZWxzIiwibGlua2VyIiwid2luZG93IiwidmFsaWRhdGlvbkV2ZW50IiwiY3VycmVudENvbnRleHQiLCJzYXZpbmdFcnJvckhhbmxkZXIiLCJnZXRJbmRleCIsImdldFVubGlua2VkIiwiVU5MSU5LRUQiLCJzYXZlIiwiY2IiLCJteVBlcm1zIiwiZ3JvdXBfaWQiLCJwZXJtaXNzaW9uTGlzdCIsInAiLCJwZXJtcyIsImFsbFBlcm1pc3Npb25zIiwiaW5kZXhPZiIsIm1ha2VNb2RlbENsYXNzIiwicmVhZGFibGUiLCJ3cml0YWJsZSIsInByaXZhdGVBcmdzIiwibWVyZ2UiLCJmdW5jU3RyaW5nIiwiS2xhc3MiLCJyZWZfdHJhbnNsYXRpb25zIiwiaW52ZXJzZV9yZWZlcmVuY2VzIiwicmVmZXJlbnRzIiwiZmllbGRzT3JkZXIiLCJmaWVsZE9yZGVyIiwicmVwcmVzZW50YXRpb24iLCJkZWxldGUiLCJfcGVybWlzc2lvbnMiLCJhbGxfcGVybXMiLCJvYmplY3RfaWQiLCJncm91cGVkIiwidW5rbm93bl9ncm91cHMiLCJncm91cEJ5IiwibyIsImFzUmF3IiwiSUQiLCJhcmciLCJjb250ZXh0IiwiY29weSIsImFzciIsImNvbmNhdCIsInNhdmVNdWx0aSIsIm9iamVjdHMiLCJzY29wZSIsInJhdyIsImRlbGV0YWJsZSIsIm11bHRpcGxlIiwiZWxlbXMiLCJ0YWIiLCJvYmpzIiwicmVzdWx0cyIsImV4dHJhX3ZlcmJzIiwiZnVuY05hbWUiLCJkZGF0YSIsInNhdmVQQSIsIlQiLCJvbyIsIlBBIiwiRnMiLCJmaWVsZElkeCIsInRhcCIsImluZGV4QnkiLCJ3aWRnZXQiLCJyZWYiLCJleHRfcmVmIiwibG9jYWxfcmVmIiwiVHlwZUVycm9yIiwicmV2SW5kZXgiLCJoYXNPd25Qcm9wZXJ0eSIsIm9wdHMiLCJxdWVyeSIsImZpcnN0Iiwib21vZGVsTmFtZSIsInZhbGlkYXRvcnMiLCJ1bmxpbmtSZWZlcmVuY2UiLCJpbnN0YW5jZSIsImluc3RhbmNlcyIsIm9tb2RlbCIsImxpbmtSZWZlcmVuY2UiLCJyZWZzIiwiSU5ERVhfTTJNIiwiVzJQX1BPU1QiLCJfZXh0cmEiLCJUT09ORSIsIlRPTUFOWSIsIk1BTllUT01BTlkiLCJtb2RlbENsYXNzIiwiemlwIiwiZGVsZXRlZCIsIk1QQSIsInJlY29yZCIsIml0YWIiLCJ0YWJsZSIsImlrIiwibm5ldyIsInVwZGF0ZWQiLCJuZXdPYmplY3RzIiwib2xkSXRlbSIsIm9sZENvcHkiLCJuZXdJdGVtIiwibm8iLCJ0b3RhbFJlc3VsdHMiLCJBU0tFRF9VTkxJTktFRCIsIkFTS0VEX00yTSIsIk1JRFgiLCJnb3RNMk0iLCJyb3ciLCJtIiwidmVyYiIsInRvZ2V0aGVyIiwic2VuZERhdGEiLCJHT1RfQUxMIiwiZ290TW9kZWwiLCJjYWNoZUtleSIsIm1vZGVsTm90Rm91bmQiLCJhdHRyaWJ1dGVzIiwiYWRkUHJvcGVydHkiLCJ2YWwiLCJrYXR0ciIsInNldCIsImF0dHJzIiwibmV3QXR0cnMiLCJmaWx0ZXJGdW5jdGlvbiIsImdldE1vZGVsIiwibW9kTmFtZSIsInJlbGF0ZWQiLCJnZXRMb2dnZWRVc2VyIiwidXNlciIsIiRzZW5kVG9FbmRwb2ludCJdLCJtYXBwaW5ncyI6IjZCQUVBLFNBQUFBLEtBQ0FDLEtBQUFDLFlBQ0FELEtBQUFFLGVBeUJBLFFBQUFDLEtBQ0EsR0FBQUMsTUFDQUMsS0FDQUMsRUFBQSxDQUNBTixNQUFBTyxHQUFBLFNBQUFDLEVBQUFDLEdBQ0FELElBQUFKLEtBQ0FBLEVBQUFJLEdBQUEsR0FBQUUsT0FFQSxJQUFBQyxHQUFBTCxHQUdBLE9BRkFGLEdBQUFJLEdBQUFJLEtBQUFILEdBQ0FKLEVBQUFNLEdBQUFGLEVBQ0FFLEdBRUFYLEtBQUFhLEtBQUEsU0FBQUwsR0FDQSxHQUFBQSxJQUFBSixHQUFBLENBQ0EsR0FBQVUsR0FBQUosTUFBQUssVUFBQUMsTUFBQUMsS0FBQUMsVUFBQSxFQUNBZCxHQUFBSSxHQUFBVyxRQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLE1BQUEsS0FBQVAsT0FJQWQsS0FBQXNCLE9BQUEsU0FB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LE9BQ0ErVixFQUFBZ0IsRUFDQUEsR0FBQUEsRUFBQXRNLGNBQUFxRCxRQUFBaUosRUFBQS9XLFNBQ0ErVixFQUFBZ0IsRUFBQWpVLE1BQUEsS0FFQSxLQUNBaEcsRUFBQXdLLEtBQUFtRyxRQUFBLFdBQ0EzUSxFQUFBd0ssS0FBQWtNLE1BQUF2USxFQUFBWCxFQUFBeVQsRUFBQXBOLEtBRUEsTUFBQXZLLEdBQ0F3SyxFQUFBeEssT0FLQWdKLEVBQUE1TCxVQUFBb1YsT0FBQSxTQUFBM04sRUFBQUwsR0FDQSxHQUFBOUYsR0FBQXJDLElBQ0EsT0FBQSxJQUFBaU8sU0FBQSxTQUFBQyxFQUFBQyxHQUNBLElBQ0E5TCxFQUFBd0ssS0FBQW1HLFFBQUEsV0FDQTNRLEVBQUF3SyxLQUFBc0osT0FBQTNOLEVBQUFMLEVBQUErRixLQUVBLE1BQUF2SyxHQUNBd0ssRUFBQXhLLE9BS0FnSixFQUFBNUwsVUFBQXdiLGNBQUEsV0FDQSxHQUFBbGEsR0FBQXJDLElBQ0EsT0FBQUEsTUFBQTZNLEtBQUE3SixXQUFBZ0IsYUFBQW9PLFFBQ0FwUyxLQUFBd0MsSUFBQSxZQUFBeEMsS0FBQTZNLEtBQUE3SixXQUFBZ0IsYUFBQW9PLFNBRUEsR0FBQW5FLFNBQUEsU0FBQUMsRUFBQUMsR0FDQTlMLEVBQUFILEtBQUEsWUFBQSxTQUFBc2EsR0FDQW5hLEVBQUFHLElBQUEsWUFBQWdhLEdBQUFqTSxLQUFBckMsUUFNQXZCLEVBQUE1TCxVQUFBMGIsZ0JBQUEsU0FBQTFPLEVBQUFySyxHQUNBLE1BQUExRCxNQUFBNk0sS0FBQXpGLE1BQUEyRyxFQUFBckssSUFHQWlKLEVBQUE1TCxVQUFBd1IsTUFBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUF6UyxNQUFBNk0sS0FBQTdKLFdBQUF1UCxNQUFBQyxFQUFBQyIsImZpbGUiOiJyd3QubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBIYW5kbGVyKCl7XG4gICAgdGhpcy5oYW5kbGVycyA9IFtdO1xuICAgIHRoaXMuc3RySGFuZGxlcnMgPSB7fTtcbn07XG5cbkhhbmRsZXIucHJvdG90eXBlLmFkZEhhbmRsZXIgPSBmdW5jdGlvbiAoaGFuZGxlcil7XG4gICAgdmFyIHN0ckhhbmRsZXIgPSB1dGlscy5oYXNoKGhhbmRsZXIudG9TdHJpbmcoKSk7XG4gICAgaWYgKCEoc3RySGFuZGxlciBpbiB0aGlzLnN0ckhhbmRsZXJzKSl7XG4gICAgICAgIHRoaXMuc3RySGFuZGxlcnNbc3RySGFuZGxlcl0gPSBoYW5kbGVyO1xuICAgICAgICB0aGlzLmhhbmRsZXJzLnB1c2goaGFuZGxlcik7XG4gICAgfVxufTtcbkhhbmRsZXIucHJvdG90eXBlLmhhbmRsZSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCk7XG4gICAgdGhpcy5oYW5kbGVycy5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmMpe1xuICAgICAgICBmdW5jLmFwcGx5KG51bGwsYXJncyk7XG4gICAgfSlcbn07XG5IYW5kbGVyLnByb3RvdHlwZS5oYW5kbGVCeSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7XG4gICAgdmFyIHRocyA9IGFyZ3VtZW50c1swXTtcbiAgICB0aGlzLmhhbmRsZXJzLmZvckVhY2goZnVuY3Rpb24oZnVuYyl7XG4gICAgICAgIGZ1bmMuYXBwbHkodGhzLGFyZ3MpO1xuICAgIH0pXG59O1xuXG5cbmZ1bmN0aW9uIE5hbWVkRXZlbnRNYW5hZ2VyICgpe1xuICAgIHZhciBldmVudHMgPSB7fTtcbiAgICB2YXIgaGFuZGxlcklkID0ge307XG4gICAgdmFyIGlkeElkID0gMDtcbiAgICB0aGlzLm9uID0gZnVuY3Rpb24obmFtZSwgZnVuYyl7XG4gICAgICAgIGlmICghKG5hbWUgaW4gZXZlbnRzKSl7XG4gICAgICAgICAgICBldmVudHNbbmFtZV0gPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaWQgPSBpZHhJZCArKztcbiAgICAgICAgZXZlbnRzW25hbWVdLnB1c2goZnVuYyk7XG4gICAgICAgIGhhbmRsZXJJZFtpZF0gPSBmdW5jO1xuICAgICAgICByZXR1cm4gaWQ7XG4gICAgfTtcbiAgICB0aGlzLmVtaXQgPSBmdW5jdGlvbihuYW1lKXtcbiAgICAgICAgaWYgKG5hbWUgaW4gZXZlbnRzKXtcbiAgICAgICAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO1xuICAgICAgICAgICAgZXZlbnRzW25hbWVdLmZvckVhY2goZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgICAgICAgICAgIGV2ZW50LmFwcGx5KG51bGwsYXJncyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy51bmJpbmQgPSBmdW5jdGlvbihoYW5kbGVyKXtcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgaWYgKGhhbmRsZXIgaW4gaGFuZGxlcklkKXtcbiAgICAgICAgICAgIHZhciBmdW5jID0gaGFuZGxlcklkW2hhbmRsZXIgKyAnJ107XG4gICAgICAgICAgICBMYXp5KGV2ZW50cykuZWFjaChmdW5jdGlvbih2LGspe1xuICAgICAgICAgICAgICAgIHZhciBpZHggPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBuIGluIHYpe1xuICAgICAgICAgICAgICAgICAgICBpZiAodltuXSA9PT0gZnVuYyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZHgucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWR4LnJldmVyc2UoKS5mb3JFYWNoKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICB2LnNwbGljZSh4LDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlIGhhbmRsZXJJZFtoYW5kbGVyXTtcbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2FsbCBldmVudCBvbmNlXG4gICAgICovXG4gICAgdGhpcy5vbmNlID0gZnVuY3Rpb24oZXZlbnROYW1lLCBoYW5kbGVyRnVuY3Rpb24pIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMub24oZXZlbnROYW1lLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgaGFuZGxlckZ1bmN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICBzZWxmLnVuYmluZChoYW5kbGVyKTtcbiAgICAgICAgfSlcbiAgICB9XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBjYWNoZWRLZXlJZHggPSAwO1xuXG52YXIgbnVsbFN0cmluZyA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gJyd9O1xuXG5mdW5jdGlvbiBtb2NrT2JqZWN0KCl7XG4gICAgcmV0dXJuIG5ldyBQcm94eSh7fSwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKHRhcmdldCwgbmFtZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBuYW1lICA9PT0gJ3N0cmluZycpe1xuICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAndG9TdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsU3RyaW5nO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1dGlscy5tb2NrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFtuYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59XG5cbi8qXG52YXIgJFBPU1QgPSBmdW5jdGlvbih1cmwsIGRhdGEsIGNhbGxCYWNrLCBlcnJvckJhY2ssaGVhZGVycyl7XG4gICAgdmFyIG9wdHMgPSB7XG4gICAgICAgIGFjY2VwdHMgOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIHVybCA6IHVybCxcbiAgICAgICAgZGF0YSA6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgICAgICBkYXRhVHlwZSA6ICdqc29uJyxcbiAgICAgICAgc3VjY2VzcyA6IGNhbGxCYWNrLFxuICAgICAgICBlcnJvciA6IGVycm9yQmFjayxcbiAgICAgICAgbWV0aG9kIDogJ1BPU1QnLFxuICAgICAgICBjb250ZW50VHlwZSA6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgIH07XG4gICAgaWYgKGhlYWRlcnMpe1xuICAgICAgICBvcHRzLmhlYWRlcnMgPSBoZWFkZXJzO1xuICAgICAgICBvcHRzLmNyb3NzRG9tYWluID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuICQuYWpheChvcHRzKTtcbn1cblxuXG5mdW5jdGlvbiByZVdoZWVsQ29ubmVjdGlvbihlbmRQb2ludCwgZ2V0TG9naW4pe1xuICAgIC8vIG1haW4gXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuZ2V0TG9naW4gPSBnZXRMb2dpbjtcbiAgICB0aGlzLmV2ZW50cyA9IG5ldyBOYW1lZEV2ZW50TWFuYWdlcigpXG4gICAgdGhpcy4kUE9TVCA9ICRQT1NULmJpbmQodGhpcyk7XG4gICAgdGhpcy5vcHRpb25zID0ge2VuZFBvaW50IDogZW5kUG9pbnR9O1xuICAgIHRoaXMub24gPSB0aGlzLmV2ZW50cy5vbi5iaW5kKHRoaXMpO1xufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLnVwZGF0ZVN0YXR1cyA9IGZ1bmN0aW9uKHN0YXR1cywgY2FsbEJhY2ssIGVycm9yKSB7XG4gICAgaWYgKHN0YXR1cykge1xuICAgICAgICB2YXIgaXNMb2dnZWQgPSAoc3RhdHVzLnVzZXJfaWQgJiYgIXRoaXMub3B0aW9ucy51c2VyX2lkICk7XG4gICAgICAgIGZvciAodmFyIHggaW4gc3RhdHVzKXsgdGhpcy5vcHRpb25zW3hdID0gc3RhdHVzW3hdOyB9XG4gICAgICAgIGxvY2FsU3RvcmFnZS5sYXN0UldUU3RhdHVzID0gSlNPTi5zdHJpbmdpZnkoc3RhdHVzKTtcbiAgICAgICAgaWYgKGlzTG9nZ2VkKSB7XG4gICAgICAgICAgICB0aGlzLmV2ZW50cy5lbWl0KCdsb2dpbicsIHRoaXMub3B0aW9ucy51c2VyX2lkKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXRoaXMub3B0aW9ucy51c2VyX2lkICYmIHRoaXMuZ2V0TG9naW4pe1xuICAgICAgICB2YXIgbG9nSW5mbyA9IHRoaXMuZ2V0TG9naW4oZXJyb3IpO1xuICAgICAgICBpZiAobG9nSW5mby5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KXtcbiAgICAgICAgICAgIHRoaXMubG9naW4obG9nSW5mby51c2VybmFtZSwgbG9nSW5mby5wYXNzd29yZClcbiAgICAgICAgICAgIC50aGVuKChmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzKHN0YXR1cywgY2FsbEJhY2spO1xuICAgICAgICAgICAgfSkuYmluZCh0aGlzKSk7XG4gICAgICAgIH0gZWxzZSBpZiAobG9nSW5mby5jb25zdHJ1Y3RvciA9PT0gUHJvbWlzZSkge1xuICAgICAgICAgICAgbG9nSW5mby50aGVuKChmdW5jdGlvbihvYmope1xuICAgICAgICAgICAgICAgIHZhciB4ID0gdGhpcy5sb2dpbihvYmoudXNlcm5hbWUsb2JqLnBhc3N3b3JkKTtcbiAgICAgICAgICAgICAgICB2YXIgbWFuYWdlRXJyb3IgPSAoZnVuY3Rpb24oYmFkKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0dXMobnVsbCxjYWxsQmFjayxiYWQuZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxCYWNrKXtcbiAgICAgICAgICAgICAgICAgICAgeC50aGVuKGNhbGxCYWNrLG1hbmFnZUVycm9yKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB4LnRoZW4obnVsbCwgbWFuYWdlRXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2sodGhpcy5vcHRpb25zKTtcbiAgICB9ICAgIFxufVxuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuc3RhdHVzID0gZnVuY3Rpb24oY2FsbEJhY2ssIGZvcmNlKXtcbiAgICBpZiAoKCdsYXN0UldUU3RhdHVzJyBpbiBsb2NhbFN0b3JhZ2UpICYmICFmb3JjZSkge1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICB2YXIgc3RhdHVzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UubGFzdFJXVFN0YXR1cyk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1cyhzdGF0dXMsY2FsbEJhY2spO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXR1cyhjYWxsQmFjaywgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhbGxCYWNrICYmIGNhbGxCYWNrKHN0YXR1cyk7XG4gICAgfVxuICAgIGlmICh0aGlzLl9zdGF0dXNfY2FsbGluZyl7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNlbGYuc3RhdHVzKGNhbGxCYWNrKTtcbiAgICAgICAgfSw1MCk7XG4gICAgfVxuICAgIGlmICh0aGlzLm9wdGlvbnMgJiYgdGhpcy5vcHRpb25zLnRpbWVzdGFtcCl7XG4gICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHRoaXMub3B0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fc3RhdHVzX2NhbGxpbmcgPSB0cnVlO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLiRwb3N0KCdhcGkvc3RhdHVzJyxudWxsLGZ1bmN0aW9uKHN0YXR1cyl7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UubGFzdFJXVFN0YXR1cyA9IEpTT04uc3RyaW5naWZ5KHN0YXR1cyk7XG4gICAgICAgICAgICBzZWxmLl9zdGF0dXNfY2FsbGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVTdGF0dXMoc3RhdHVzLGNhbGxCYWNrKTtcbiAgICAgICAgfSk7ICAgICAgICBcbiAgICB9XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuJHBvc3QgPSBmdW5jdGlvbih1cmwsIGRhdGEsY2FsbEJhY2spe1xuICAgIHZhciB0aHMgPSB0aGlzO1xuICAgIGlmICh0aGlzLm9wdGlvbnMgJiYgdGhpcy5vcHRpb25zLnRva2VuKXtcbiAgICAgICAgaWYgKCFkYXRhKXtcbiAgICAgICAgICAgIGRhdGEgPSB7fTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAodGhpcy5vcHRpb25zLnRva2VuKXtcbiAgICAgICAgdmFyIGhlYWRlcnMgPSB7IFxuICAgICAgICAgICAgdG9rZW4gOiB0aGlzLm9wdGlvbnMudG9rZW4sXG4gICAgICAgICAgICBhcHBsaWNhdGlvbiA6IHRoaXMub3B0aW9ucy5hcHBsaWNhdGlvblxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBoZWFkZXJzID0gbnVsbDtcbiAgICB9XG5cbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCxyZWplY3Qpe1xuICAgICAgICB1dGlscy54ZHIodGhzLm9wdGlvbnMuZW5kUG9pbnQgKyB1cmwsIGRhdGEsIHRocy5vcHRpb25zLmFwcGxpY2F0aW9uLCB0aHMub3B0aW9ucy50b2tlbilcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdodHRwLXJlc3BvbnNlJywgeGhyLnJlc3BvbnNlVGV4dCwgeGhyLnN0YXR1cywgdXJsLCBkYXRhKTtcbiAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2h0dHAtcmVzcG9uc2UtJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZVRleHQsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZURhdGEpe1xuICAgICAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2h0dHAtcmVzcG9uc2UtJyArIHhoci5zdGF0dXMgKyAnLWpzb24nLCB4aHIucmVzcG9uc2VEYXRhLCB1cmwsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY2FsbEJhY2spIHsgY2FsbEJhY2soIHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCApfTtcbiAgICAgICAgICAgICAgICBhY2NlcHQoeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHhocikge1xuICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VEYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1qc29uJywgeGhyLnJlc3BvbnNlRGF0YSwgeGhyLnN0YXR1cywgdXJsLCBkYXRhLCB4aHIpO1xuICAgICAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2Vycm9yLWpzb24tJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZURhdGEsdXJsLCBkYXRhLCB4aHIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2Vycm9yLWh0dHAnLHhoci5yZXNwb25zZVRleHQsIHhoci5zdGF0dXMsdXJsLGRhdGEseGhyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1odHRwLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VUZXh0LHVybCxkYXRhLHhocik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlamVjdCh4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIHJldHVybiBwcm9taXNlO1xufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcbiAgICB2YXIgdXJsID0gdGhpcy5vcHRpb25zLmVuZFBvaW50ICsgJ2FwaS9sb2dpbic7XG4gICAgdmFyIGNvbm5lY3Rpb24gPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQscmVqZWN0KXtcbiAgICAgICAgdXRpbHMueGRyKHVybCx7IHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQgOiBwYXNzd29yZH0sIG51bGwsY29ubmVjdGlvbi5vcHRpb25zLnRva2VuLCB0cnVlKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oeGhyKXtcbiAgICAgICAgICAgICAgICBjb25uZWN0aW9uLnVwZGF0ZVN0YXR1cyh4aHIucmVzcG9uc2VEYXRhKTtcbiAgICAgICAgICAgICAgICBhY2NlcHQoc3RhdHVzKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgcmVqZWN0KHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24oY2FsbEJhY2spe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgd3Njb25uZWN0ID0gZnVuY3Rpb24oc2VsZil7XG4gICAgICAgIHNlbGYud3NDb25uZWN0aW9uID0gbmV3IHV0aWxzLndzQ29ubmVjdChzZWxmLm9wdGlvbnMpO1xuICAgICAgICBzZWxmLndzQ29ubmVjdGlvbi5vbkNvbm5lY3QoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNlbGYuZXZlbnRzLmVtaXQoJ3dzLWNvbm5lY3RlZCcsIHNlbGYud3NDb25uZWN0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYud3NDb25uZWN0aW9uLm9uRGlzY29ubmVjdChmdW5jdGlvbigpeyBcbiAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMgJiYgc2VsZi5vcHRpb25zLnJlYWx0aW1lRW5kUG9pbnQpe1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgd3Njb25uZWN0KHNlbGYpOyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9LDEwMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzKChmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICBpZiAoJ3Rva2VuJyBpbiBzZWxmLm9wdGlvbnMpe1xuICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2soc3RhdHVzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb25uZWN0aW5nIHRvICcgKyBzZWxmLm9wdGlvbnMuZW5kUG9pbnQpO1xuICAgICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy51c2VybmFtZSAmJiBzZWxmLm9wdGlvbnMucGFzc3dvcmQpe1xuICAgICAgICAgICAgICAgIHNlbGYubG9naW4oXG4gICAgICAgICAgICAgICAgICAgIHNlbGYub3B0aW9ucy51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5vcHRpb25zLnBhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlbmV3aW5nIGNvbm5lY3Rpb24nKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLm9wdGlvbnMudG9rZW4gJiYgc2VsZi5vcHRpb25zLnJlYWx0aW1lRW5kUG9pbnQgJiYgKCFzZWxmLndzQ29ubmVjdGlvbikpe1xuICAgICAgICAgICAgd3Njb25uZWN0KHNlbGYpO1xuICAgICAgICB9XG4gICAgfSkuYmluZCh0aGlzKSk7XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUubG9nT3V0ID0gZnVuY3Rpb24odXJsLCBjYWxsQmFjayl7XG4gICAgcmV0dXJuIHRoaXMuJHBvc3QoJ2FwaS9sb2dvdXQnLHt9LChmdW5jdGlvbihzdGF0dXMpIHtcbiAgICAgICAgaWYgKCdsYXN0UldUU3RhdHVzJyBpbiBsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2UubGFzdFJXVFN0YXR1cztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9wdGlvbnMgPSB7ZW5kUG9pbnQ6IHRoaXMub3B0aW9ucy5lbmRQb2ludH07XG4gICAgICAgIGlmICh0aGlzLndzQ29ubmVjdGlvbikgeyBcbiAgICAgICAgICAgIHRoaXMud3NDb25uZWN0aW9uLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLndzQ29ubmVjdGlvbiA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybCkgeyBsb2NhdGlvbiA9IHVybDsgfVxuICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjaygpO1xuICAgIH0pLmJpbmQodGhpcykpO1xufVxuKi9cbnZhciB1dGlscyA9IHtcbiAgICByZW5hbWVGdW5jdGlvbiA6IGZ1bmN0aW9uIChuYW1lLCBmbikge1xuICAgICAgICByZXR1cm4gKG5ldyBGdW5jdGlvbihcInJldHVybiBmdW5jdGlvbiAoY2FsbCkgeyByZXR1cm4gZnVuY3Rpb24gXCIgKyBuYW1lICtcbiAgICAgICAgICAgIFwiICgpIHsgcmV0dXJuIGNhbGwodGhpcywgYXJndW1lbnRzKSB9OyB9O1wiKSgpKShGdW5jdGlvbi5hcHBseS5iaW5kKGZuKSk7XG4gICAgfSxcbiAgICBjYWNoZWQgOiBmdW5jdGlvbihmdW5jLCBrZXkpe1xuICAgICAgICBpZiAoIWtleSl7ICAgIFxuICAgICAgICAgICAga2V5ID0gJ18nICsgY2FjaGVkS2V5SWR4Kys7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gd3JhcHBlcigpe1xuICAgICAgICAgICAgaWYgKCF0aGlzW2tleV0pe1xuICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IGZ1bmMuY2FsbCh0aGlzLFthcmd1bWVudHNdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzW2tleV07XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB3cmFwcGVyO1xuICAgIH0sXG4vLyAgICAkUE9TVCA6ICRQT1NULFxuLy8gICAgcmVXaGVlbENvbm5lY3Rpb246IHJlV2hlZWxDb25uZWN0aW9uLFxuICAgIGxvZzogZnVuY3Rpb24oKXsgXG4gICAgICAgIGNvbnNvbGUubG9nKGFyZ3VtZW50cyk7XG4gICAgfSxcblxuICAgIHhkcjogZnVuY3Rpb24gKHVybCwgZGF0YSwgYXBwbGljYXRpb24sdG9rZW4sIGZvcm1FbmNvZGUpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2UgYW4gSFRUUCBSZXF1ZXN0IGFuZCByZXR1cm4gaXRzIHByb21pc2UuXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciByZXE7XG4gICAgICAgICAgICBpZiAoIWRhdGEpIHsgZGF0YSA9IHt9O31cblxuICAgICAgICAgICAgaWYoWE1MSHR0cFJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICByZXEgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICByZXEub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXEucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBKU09OLnBhcnNlKHJlcS5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoYSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlRGF0YSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSB7cmVzcG9uc2VEYXRhOiByZXNwb25zZURhdGEsIHJlc3BvbnNlVGV4dDogcmVxLnJlc3BvbnNlVGV4dCxzdGF0dXM6IHJlcS5zdGF0dXMsIHJlcXVlc3Q6IHJlcX07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVxLnN0YXR1cyA+PSAyMDAgJiYgcmVxLnN0YXR1cyA8IDQwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VwdChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmKFhEb21haW5SZXF1ZXN0KXtcbiAgICAgICAgICAgICAgICByZXEgPSBuZXcgWERvbWFpblJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICByZXEub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjY2VwdChyZXEucmVzcG9uc2VUZXh0LHJlcS5zdGF0dXNUZXh0LCByZXEpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ0NPUlMgbm90IHN1cHBvcnRlZCcpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVxLm9wZW4oJ1BPU1QnLCB1cmwsIHRydWUpO1xuICAgICAgICAgICAgcmVxLm9uZXJyb3IgPSByZWplY3Q7XG4gICAgICAgICAgICByZXEuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgICAgICAgaWYgKHRva2VuKSB7IGRhdGEuX190b2tlbl9fID0gdG9rZW4gfVxuICAgICAgICAgICAgaWYgKCFmb3JtRW5jb2RlKXtcbiAgICAgICAgICAgICAgICByZXEuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywndGV4dC9wbGFpbicpO1xuICAgICAgICAgICAgICAgIGRhdGEgPSBMYXp5KGRhdGEpLnNpemUoKT9KU09OLnN0cmluZ2lmeShkYXRhKTonJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpO1xuICAgICAgICAgICAgICAgIGRhdGEgPSBMYXp5KGRhdGEpLm1hcChmdW5jdGlvbih2LGspe1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGsgKyAnPScgKyBlbmNvZGVVUkkodi50b1N0cmluZygpKTsgIFxuICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKS5qb2luKCcmJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXEuc2VuZChkYXRhKTtcbiAgICAvLyAgICAgICAgcmVxLnNlbmQobnVsbCk7XG4gICAgICAgIH0pXG4gICAgfSxcbiAgICBcbiAgICBjYXBpdGFsaXplIDogZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgcmV0dXJuIHNbMF0udG9VcHBlckNhc2UoKSArIHMuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcbiAgICB9LFxuXG4gICAgaGFzaCA6IGZ1bmN0aW9uKHN0cil7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIYXNoZWQgZnVuY3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIHN0ciA9IHN0ci50b1N0cmluZygpO1xuICAgICAgICB2YXIgcmV0ID0gMTtcbiAgICAgICAgZm9yICh2YXIgeCA9IDA7eDxzdHIubGVuZ3RoO3grKyl7XG4gICAgICAgICAgICByZXQgKj0gKDEgKyBzdHIuY2hhckNvZGVBdCh4KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChyZXQgJSAzNDk1ODM3NDk1NykudG9TdHJpbmcoKTtcbiAgICB9LFxuXG4gICAgbWFrZUZpbHRlciA6IGZ1bmN0aW9uIChtb2RlbCwgZmlsdGVyLCB1bmlmaWVyLCBkb250VHJhbnNsYXRlRmlsdGVyKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlIGZpbHRlciBmb3IgQXJyYXkuZmlsdGVyIGZ1bmN0aW9uIGFzIGFuIGFuZCBvZiBvclxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCF1bmlmaWVyKSB7IHVuaWZpZXIgPSAnICYmICc7fVxuICAgICAgICBpZiAoTGF6eShmaWx0ZXIpLnNpemUoKSA9PT0gMCl7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oeCl7IHJldHVybiB0cnVlIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNvdXJjZSA9IExhenkoZmlsdGVyKS5tYXAoZnVuY3Rpb24odmFscywgZmllbGQpe1xuICAgICAgICAgICAgaWYgKCF2YWxzKSB7IHZhbHMgPSBbbnVsbF19XG4gICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFscykpe1xuICAgICAgICAgICAgICAgIHZhbHMgPSBbdmFsc107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWRvbnRUcmFuc2xhdGVGaWx0ZXIgJiYgKG1vZGVsLmZpZWxkc1tmaWVsZF0udHlwZSA9PT0gJ3JlZmVyZW5jZScpKSB7XG4gICAgICAgICAgICAgICAgZmllbGQgPSAnXycgKyBmaWVsZDtcbiAgICAgICAgICAgICAgICB2YWxzID0gTGF6eSh2YWxzKS5tYXAoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4ICYmICh4LmNvbnN0cnVjdG9yICE9PSBOdW1iZXIpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4LmlkO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geDtcbiAgICAgICAgICAgICAgICB9KS50b0FycmF5KCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1vZGVsLmZpZWxkc1tmaWVsZF0udHlwZSA9PT0gJ3N0cmluZycpe1xuICAgICAgICAgICAgICAgIHZhbHMgPSB2YWxzLm1hcChKU09OLnN0cmluZ2lmeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJygnICsgIExhenkodmFscykubWFwKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgIHJldHVybiAnKHguJyArIGZpZWxkICsgJyA9PT0gJyArIHggfHwgJ251bGwnICsgJyknO1xuICAgICAgICAgICAgfSkuam9pbignIHx8ICcpICArJyknO1xuICAgICAgICB9KS50b0FycmF5KCkuam9pbih1bmlmaWVyKTtcbiAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcInhcIiwgXCJyZXR1cm4gXCIgKyBzb3VyY2UpO1xuICAgIH0sXG5cbiAgICBzYW1lQXMgOiBmdW5jdGlvbiAoeCwgeSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogRGVlcCBlcXVhbFxuICAgICAgICAgKi9cbiAgICAgICAgZm9yICh2YXIgayBpbiB4KSB7XG4gICAgICAgICAgICBpZiAoeVtrXSAhPSB4W2tdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgXG4gICAgcGx1cmFsaXplIDogZnVuY3Rpb24oc3RyLCBtb2RlbCl7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMZXhpY2FsbHkgcmV0dXJucyBlbmdsaXNoIHBsdXJhbCBmb3JtXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gc3RyICsgJ3MnO1xuICAgIH0sXG5cbiAgICBiZWZvcmVDYWxsIDogZnVuY3Rpb24oZnVuYywgYmVmb3JlKXtcbiAgICAgICAgdmFyIGRlY29yYXRvciA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBiZWZvcmUoKS50aGVuKGZ1bmMpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBkZWNvcmF0b3I7XG4gICAgfSxcblxuICAgIGNsZWFuU3RvcmFnZSA6IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDbGVhbiBsb2NhbFN0b3JhZ2Ugb2JqZWN0XG4gICAgICAgICAqL1xuICAgICAgICBMYXp5KGxvY2FsU3RvcmFnZSkua2V5cygpLmVhY2goZnVuY3Rpb24oayl7XG4gICAgICAgICAgICBkZWxldGUgbG9jYWxTdG9yYWdlW2tdO1xuICAgICAgICB9KVxuICAgIH0sXG5cbiAgICBjbGVhbkRlc2NyaXB0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgTGF6eShsb2NhbFN0b3JhZ2UpXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uKHYsIG4pIHsgcmV0dXJuIExhenkobikuc3RhcnRzV2l0aCgnZGVzY3JpcHRpb246Jyl9KVxuICAgICAgICAgICAgLmtleXMoKVxuICAgICAgICAgICAgLmVhY2goZnVuY3Rpb24obikgeyBkZWxldGUgbG9jYWxTdG9yYWdlW25dIH0pO1xuICAgIH0sXG4gICAgXG4gICAgcmV2ZXJzZSA6IGZ1bmN0aW9uIChjaHIsIHN0cikge1xuICAgICAgICByZXR1cm4gc3RyLnNwbGl0KGNocikucmV2ZXJzZSgpLmpvaW4oY2hyKTtcbiAgICB9LFxuICAgIHBlcm11dGF0aW9uczogZnVuY3Rpb24oYXJyKXtcbiAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICBmb3IgKHZhciB4ID0gYXJyLmxlbmd0aC0xOyB4ID49IDA7eC0tKXtcbiAgICAgICAgICAgIGZvciAodmFyIHkgPSBhcnIubGVuZ3RoLTE7IHkgPj0gMDsgeS0tKXtcbiAgICAgICAgICAgICAgICBpZiAoeCAhPT0geSlcbiAgICAgICAgICAgICAgICAgICAgcmV0LnB1c2goW2Fyclt4XSwgYXJyW3ldXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9LFxuXG4gICAgd2FpdEZvcjogZnVuY3Rpb24oZnVuYywgY2FsbEJhY2spIHtcbiAgICAgICAgdmFyIHdhaXRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKGZ1bmMoKSkge1xuICAgICAgICAgICAgICAgIGNhbGxCYWNrKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQod2FpdGVyLDUwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2V0VGltZW91dCh3YWl0ZXIsIDUwMCk7XG4gICAgfSxcblxuICAgIGJvb2w6IEJvb2xlYW4sXG5cbiAgICBub29wIDogZnVuY3Rpb24oKXt9LFxuXG4gICAgdHpPZmZzZXQ6IG5ldyBEYXRlKCkuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwMDAwLFxuXG4gICAgdHJhbnNGaWVsZFR5cGU6IHtcbiAgICAgICAgZGF0ZTogZnVuY3Rpb24oeCkgeyByZXR1cm4gbmV3IERhdGUoeCAqIDEwMDAgKyB1dGlscy50ek9mZnNldCApIH0sXG4gICAgICAgIGRhdGV0aW1lOiBmdW5jdGlvbih4KSB7IHJldHVybiBuZXcgRGF0ZSh4ICogMTAwMCArIHV0aWxzLnR6T2Zmc2V0ICkgfSxcbiAgICAgICAgc3RyaW5nOiBmdW5jdGlvbih4KSB7IHJldHVybiB4LnRvU3RyaW5nKCk7IH0sXG4gICAgICAgIHRleHQ6IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHgudG9TdHJpbmcoKTsgfSxcbiAgICAgICAgaW50ZWdlcjogZnVuY3Rpb24oeCkgeyByZXR1cm4gcGFyc2VJbnQoeCk7IH0sXG4gICAgICAgIGZsb2F0OiBmdW5jdGlvbih4KSB7IHJldHVybiBwYXJzZUZsb2F0KHgpOyB9XG4gICAgfSwgXG4gICAgbW9jayA6IG1vY2tPYmplY3QoKVxufTtcblxuXG4iLCIndXNlIHN0cmljdCc7XG5cbmNvbnN0IFNUQVRVU0tFWSA9ICdsYXN0UldUQ29ubmVjdGlvblN0YXR1cyc7XG5cbmZ1bmN0aW9uIFJlYWx0aW1lQ29ubmVjdGlvbihlbmRQb2ludCwgcnd0Q29ubmVjdGlvbil7XG4gICAgLyoqXG4gICAgICogQ29ubmVjdHMgYSB3ZWJzb2NrZXQgd2l0aCByZVdoZWVsIGNvbm5lY3Rpb25cbiAgICAgKi9cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICB2YXIgY29ubmVjdGlvbiA9IG5ldyBTb2NrSlMoZW5kUG9pbnQpO1xuICAgIGNvbm5lY3Rpb24ub25vcGVuID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ29wZW4gOiAnICsgeCk7XG4gICAgICAgIGNvbm5lY3Rpb24udGVuYW50KCk7XG4gICAgICAgIHJ3dENvbm5lY3Rpb24uZW1pdCgncmVhbHRpbWUtY29ubmVjdGlvbi1vcGVuJyx4KTtcbiAgICB9O1xuICAgIGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgaWYgKHgudHlwZSA9PSAnbWVzc2FnZScpIHtcbiAgICAgICAgICAgIC8vJC5ub3RpZnkoeC5kYXRhKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy9UT0RPIHNldCBmcm9tUmVhbHRpbWVcbiAgICAgICAgICAgICAgICByd3RDb25uZWN0aW9uLmVtaXQoJ3JlYWx0aW1lLW1lc3NhZ2UtanNvbicsIEpTT04ucGFyc2UoeC5kYXRhKSk7XG4gICAgICAgICAgICAgICAgLy9UT0RPIHVuc2V0IGZyb21SZWFsdGltZVxuICAgICAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAgICAgcnd0Q29ubmVjdGlvbi5lbWl0KCdyZWFsdGltZS1tZXNzYWdlLXRleHQnLCBKU09OLnBhcnNlKHguZGF0YSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Zyb20gcmVhbHRpbWUgJyx4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29ubmVjdGlvbi5vbmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBzZXRUaW1lb3V0KHV0aWxzLndzQ29ubmVjdCwxMDAwKTtcbiAgICAgICAgcnd0Q29ubmVjdGlvbi5lbWl0KCdyZWFsdGltZS1jb25uZWN0aW9uLWNsb3NlZCcpO1xuICAgIH07XG4gICAgY29ubmVjdGlvbi50ZW5hbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbm5lY3Rpb24uc2VuZCgnVEVOQU5UOicgKyByd3RDb25uZWN0aW9uLmNhY2hlZFN0YXR1cy5hcHBsaWNhdGlvbiArICc6JyArIHJ3dENvbm5lY3Rpb24uY2FjaGVkU3RhdHVzLnRva2VuKTtcbiAgICB9XG4gICAgdGhpcy5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25uZWN0aW9uLmNsb3NlKCk7XG4gICAgfVxufSAgICBcblxuZnVuY3Rpb24gcmVXaGVlbENvbm5lY3Rpb24oZW5kUG9pbnQsIGdldExvZ2luKXtcbiAgICAvKipcbiAgICAgKiBDb25uZWN0aW9uIGJhc2ljIGZvciByZVdoZWVsXG4gICAgICogQHBhcmFtIGVuZFBvaW50OiBzdHJpbmcgYmFzZSB1cmwgZm9yIGFsbCBjb211bmljYXRpb25cbiAgICAgKiBAcGFyYW0gZ2V0TG9naW46IGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBpbiBjYXNlIG9mIG1pc3NpbmcgbG9naW4uXG4gICAgICogIHRoaXMgZnVuY3Rpb24gY291bGQgcmV0dXJuIDpcbiAgICAgKiAgLSAgIGEgeyB1c2VybmFtZSA6IDx1c2VybmFtZT4gLCBwYXNzd29yZDogPHBhc3N3b3JkPn0gb3JcbiAgICAgKiAgLSAgIGIgUHJvbWlzZSAtPiB7IHVzZXJuYW1lIDogPHVzZXJuYW1lPiAsIHBhc3N3b3JkOiA8cGFzc3dvcmQ+fVxuICAgICAqL1xuICAgIC8vIG1haW4gaW5pdGlhbGl6YXRpb25cbiAgICB2YXIgZXZlbnRzID0gbmV3IE5hbWVkRXZlbnRNYW5hZ2VyKCk7XG4gICAgdGhpcy5nZXRMb2dpbiA9IGdldExvZ2luO1xuICAgIHRoaXMuZW5kUG9pbnQgPSBlbmRQb2ludC5lbmRzV2l0aCgnLycpPyBlbmRQb2ludDogKGVuZFBvaW50ICsgJy8nKTtcbiAgICB0aGlzLm9uID0gZXZlbnRzLm9uO1xuICAgIHRoaXMudW5iaW5kID0gZXZlbnRzLnVuYmluZDtcbiAgICB0aGlzLmVtaXQgPSBldmVudHMuZW1pdDtcbiAgICB0aGlzLm9uY2UgPSBldmVudHMub25jZTtcbiAgICB0aGlzLmNhY2hlZFN0YXR1cyA9IHt9O1xuICAgIHRoaXMuaXNDb25uZWN0ZWQgPSBmYWxzZTtcbiAgICB0aGlzLmlzTG9nZ2VkSW4gPSBmYWxzZTtcbiAgICAvLyByZWdpc3RlcmluZyB1cGRhdGUgc3RhdHVzXG4gICAgdmFyIHRocyA9IHRoaXM7XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuJHBvc3QgPSBmdW5jdGlvbih1cmwsIGRhdGEsY2FsbEJhY2spe1xuICAgIC8qKlxuICAgICAqIEFKQVggY2FsbCBmb3IgZmV0Y2ggYWxsIGRhdGEgZnJvbSBzZXJ2ZXJcbiAgICAgKiBAcGFyYW0gdXJsOiBsYXN0IHVybCBwYXJ0IGZvciBhamF4IGNhbGxcbiAgICAgKiBAcGFyYW0gZGF0YTogZGF0YSBvYmplY3QgdG8gYmUgc2VudFxuICAgICAqIEBwYXJhbSBjYWxsQmFjazogZnVuY3Rpb24oeGhyKSB3aWxsIGJlIGNhbGxlZCB3aGVuIGRhdGEgYXJyaXZlc1xuICAgICAqIEByZXR1cm5zIFByb21pc2U8eGhyPiBzYW1lIG9mIGNhbGxCYWNrXG4gICAgICovXG4gICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICB2YXIgdGhzID0gdGhpcztcbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCxyZWplY3Qpe1xuICAgICAgICB1dGlscy54ZHIodGhzLmVuZFBvaW50ICsgdXJsLCBkYXRhLCB0aHMuY2FjaGVkU3RhdHVzLmFwcGxpY2F0aW9uLCB0aHMuY2FjaGVkU3RhdHVzLnRva2VuKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oeGhyKXtcbiAgICAgICAgICAgICAgICB0aHMuZW1pdCgnaHR0cC1yZXNwb25zZScsIHhoci5yZXNwb25zZVRleHQsIHhoci5zdGF0dXMsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgdGhzLmVtaXQoJ2h0dHAtcmVzcG9uc2UtJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZVRleHQsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZURhdGEpe1xuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnaHR0cC1yZXNwb25zZS0nICsgeGhyLnN0YXR1cyArICctanNvbicsIHhoci5yZXNwb25zZURhdGEsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjYWxsQmFjaykgeyBjYWxsQmFjayggeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0ICl9O1xuICAgICAgICAgICAgICAgIGFjY2VwdCh4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oeGhyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZURhdGEpe1xuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnZXJyb3ItanNvbicsIHhoci5yZXNwb25zZURhdGEsIHhoci5zdGF0dXMsIHVybCwgZGF0YSwgeGhyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmVtaXQoJ2Vycm9yLWpzb24tJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZURhdGEsdXJsLCBkYXRhLCB4aHIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnZXJyb3ItaHR0cCcseGhyLnJlc3BvbnNlVGV4dCwgeGhyLnN0YXR1cyx1cmwsZGF0YSx4aHIpO1xuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnZXJyb3ItaHR0cC0nICsgeGhyLnN0YXR1cywgeGhyLnJlc3BvbnNlVGV4dCx1cmwsZGF0YSx4aHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZWplY3QoeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICByZXR1cm4gcHJvbWlzZTtcbn07XG5cbi8qKlxuICogQ2hlY2sgY3VycmVudCBzdGF0dXMgYW5kIGNhbGxiYWNrIGZvciByZXN1bHRzLlxuICogSXQgY2FjaGVzIHJlc3VsdHMgZm9yIGZ1cnRoZXIuXG4gKiBAcGFyYW0gY2FsbGJhY2s6IChzdGF0dXMgb2JqZWN0KVxuICogQHBhcmFtIGZvcmNlOiBib29sZWFuIGlmIHRydWUgZW1wdGllcyBjYWNoZSAgXG4gKiBAcmV0dXJuIHZvaWRcbiAqL1xucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLnN0YXR1cyA9IGZ1bmN0aW9uKGNhbGxCYWNrLCBmb3JjZSkge1xuICAgIC8vIGlmIGZvcmNlLCBjbGVhciBhbGwgY2FjaGVkIHZhbHVlc1xuICAgIHZhciBrZXkgPSAndG9rZW46JyArIHRoaXMuZW5kUG9pbnQ7XG4gICAgdmFyIHRocyA9IHRoaXM7XG4gICAgaWYgKGZvcmNlKSB7XG4gICAgICAgIHRoaXMuY2FjaGVkU3RhdHVzID0ge307XG4gICAgICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2Vba2V5XTtcbiAgICB9XG4gICAgaWYgKHRoaXMuc3RhdHVzV2FpdGluZykge1xuICAgICAgICAvLyB3YWl0IGZvciBzdGF0dXNcbiAgICAgICAgdXRpbHMud2FpdEZvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAhdGhzLnN0YXR1c1dhaXRpbmc7XG4gICAgICAgIH0sIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB0aHMuc3RhdHVzKGNhbGxCYWNrLGZvcmNlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gdHJ5IGZvciB2YWx1ZSByZXNvbHV0aW9uXG4gICAgLy8gZmlyc3Qgb24gbWVtb3J5XG4gICAgaWYgKExhenkodGhpcy5jYWNoZWRTdGF0dXMpLnNpemUoKSl7XG4gICAgICAgIGNhbGxCYWNrKHRoaXMuY2FjaGVkU3RhdHVzKVxuICAgIC8vIHRoZW4gaW4gbG9jYWxTdG9yYWdlXG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7fTtcbiAgICAgICAgaWYgKGtleSBpbiBsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgIGRhdGEuX190b2tlbl9fID0gbG9jYWxTdG9yYWdlW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdGF0dXNXYWl0aW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy4kcG9zdCgnYXBpL3N0YXR1cycsZGF0YSwgZnVuY3Rpb24oc3RhdHVzKXtcbiAgICAgICAgICAgIHRocy51cGRhdGVTdGF0dXMoc3RhdHVzKTtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZVtrZXldID0gc3RhdHVzLnRva2VuO1xuICAgICAgICAgICAgY2FsbEJhY2soc3RhdHVzKTtcbiAgICAgICAgICAgIHRocy5zdGF0dXNXYWl0aW5nID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBkb2Vzbid0IGNhbGwgY2FsbGJhY2tcbiAgICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNhbGxCYWNrKHRoaXMuY2FjaGVkU3RhdHVzKTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS51cGRhdGVTdGF0dXMgPSBmdW5jdGlvbihzdGF0dXMpe1xuICAgIHZhciBsYXN0QnVpbGQgPSBwYXJzZUZsb2F0KGxvY2FsU3RvcmFnZS5sYXN0QnVpbGQpIHx8IDE7XG4gICAgaWYgKGxhc3RCdWlsZCA8IHN0YXR1cy5sYXN0X2J1aWxkKXtcbiAgICAgICAgdXRpbHMuY2xlYW5EZXNjcmlwdGlvbigpO1xuICAgICAgICBsb2NhbFN0b3JhZ2UubGFzdEJ1aWxkID0gc3RhdHVzLmxhc3RfYnVpbGQ7XG4gICAgfVxuICAgIHRoaXMuaXNDb25uZWN0ZWQgPSBCb29sZWFuKHN0YXR1cy50b2tlbik7XG4gICAgdGhpcy5pc0xvZ2dlZEluID0gQm9vbGVhbihzdGF0dXMudXNlcl9pZCk7XG4gICAgdmFyIG9sZFN0YXR1cyA9IHRoaXMuY2FjaGVkU3RhdHVzO1xuICAgIHRoaXMuY2FjaGVkU3RhdHVzID0gc3RhdHVzO1xuICAgIGlmICghb2xkU3RhdHVzLnVzZXJfaWQgJiYgc3RhdHVzLnVzZXJfaWQpe1xuICAgICAgICB0aGlzLmVtaXQoJ2xvZ2dlZC1pbicsc3RhdHVzLnVzZXJfaWQpO1xuICAgIH0gZWxzZSBpZiAob2xkU3RhdHVzLnVzZXJfaWQgJiYgIXN0YXR1cy51c2VyX2lkKXtcbiAgICAgICAgdGhpcy5lbWl0KCdsb2dnZWQtb3V0Jyk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzQ29ubmVjdGVkICYmICF0aGlzLmlzTG9nZ2VkSW4pe1xuICAgICAgICB0aGlzLmVtaXQoJ2xvZ2luLXJlcXVpcmVkJyk7XG4gICAgICAgIGlmICh0aGlzLmdldExvZ2luKXtcbiAgICAgICAgICAgIHZhciBsb2dpbkluZm8gPSB0aGlzLmdldExvZ2luKCk7XG4gICAgICAgICAgICBpZiAobG9naW5JbmZvLmNvbnN0cnVjdG9yID09PSBPYmplY3Qpe1xuICAgICAgICAgICAgICAgIHRoaXMubG9naW4obG9naW5JbmZvLnVzZXJuYW1lLCBsb2dpbkluZm8ucGFzc3dvcmQsIGxvZ2luSW5mby5jYWxsQmFjayk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGxvZ2luSW5mby5jb25zdHJ1Y3RvciA9PT0gUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgIGxvZ2luSW5mby50aGVuKGZ1bmN0aW9uKG9iail7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9naW4ob2JqLnVzZXJuYW1lLCBvYmoucGFzc3dvcmQsIG9iai5jYWxsQmFjayk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyByZWFsdGltZSBjb25uZWN0aW9uIGlzIHNldHRlZFxuICAgIGlmICghb2xkU3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQgJiYgc3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQpIHtcbiAgICAgICAgdGhpcy53c0Nvbm5lY3Rpb24gPSBuZXcgUmVhbHRpbWVDb25uZWN0aW9uKHN0YXR1cy5yZWFsdGltZUVuZFBvaW50LCB0aGlzKTtcbiAgICAvLyByZWFsdGltZSBjb25uZWN0aW9uIGlzIGNsb3NlZFxuICAgIH0gZWxzZSBpZiAob2xkU3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQgJiYgIXN0YXR1cy5yZWFsdGltZUVuZFBvaW50KSB7XG4gICAgICAgIHRoaXMud3NDb25uZWN0aW9uLmNsb3NlKCk7XG4gICAgICAgIGRlbGV0ZSB0aGlzLndzQ29ubmVjdGlvbjtcbiAgICB9XG4gICAgdGhpcy5lbWl0KCd1cGRhdGUtY29ubmVjdGlvbi1zdGF0dXMnLCBzdGF0dXMsIG9sZFN0YXR1cyk7XG4gICAgbG9jYWxTdG9yYWdlW1NUQVRVU0tFWV0gPSBKU09OLnN0cmluZ2lmeShzdGF0dXMpO1xufVxuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpe1xuICAgIC8qKlxuICAgICAqIG1ha2UgbG9naW4gYW5kIHJldHVybiBhIHByb21pc2UuIElmIGxvZ2luIHN1Y2NlZCwgcHJvbWlzZSB3aWxsIGJlIGFjY2VwdGVkXG4gICAgICogSWYgbG9naW4gZmFpbHMgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIHdpdGggZXJyb3JcbiAgICAgKiBAcGFyYW0gdXNlcm5hbWU6IHVzZXJuYW1lXG4gICAgICogQHBhcmFtIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAqIEByZXR1cm4gUHJvbWlzZSAodXNlciBvYmplY3QpXG4gICAgICovXG4gICAgdmFyIHRocyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdXRpbHMueGRyKHRocy5lbmRQb2ludCArICdhcGkvbG9naW4nLCB7dXNlcm5hbWU6IHVzZXJuYW1lIHx8ICcnLCBwYXNzd29yZDogcGFzc3dvcmQgfHwgJyd9LG51bGwsdGhzLmNhY2hlZFN0YXR1cy50b2tlbiwgdHJ1ZSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHN0YXR1c1xuICAgICAgICAgICAgICAgIHRocy51cGRhdGVTdGF0dXMoeGhyLnJlc3BvbnNlRGF0YSk7XG4gICAgICAgICAgICAgICAgLy8gY2FsbCB3aXRoIHVzZXIgaWRcbiAgICAgICAgICAgICAgICBhY2NlcHQoe3N0YXR1cyA6ICdzdWNjZXNzJywgdXNlcmlkOiB0aHMuY2FjaGVkU3RhdHVzLnVzZXJfaWR9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHhocikge1xuICAgICAgICAgICAgICAgIC8vIGlmIGVycm9yIGNhbGwgZXJyb3IgbWFuYWdlciB3aXRoIGVycm9yXG4gICAgICAgICAgICAgICAgYWNjZXB0KHtlcnJvcjogeGhyLnJlc3BvbnNlRGF0YS5lcnJvciwgc3RhdHVzOiAnZXJyb3InfSk7XG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5sb2dvdXQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdGhzID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LHJlamVjdCkge1xuICAgICAgICB0aHMuJHBvc3QoJ2FwaS9sb2dvdXQnKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ob2spe1xuICAgICAgICAgICAgICAgIHRocy51cGRhdGVTdGF0dXMoe30pO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2VbU1RBVFVTS0VZXTtcbiAgICAgICAgICAgICAgICBhY2NlcHQoKVxuICAgICAgICAgICAgfSwgcmVqZWN0KTtcbiAgICB9KTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24oY2FsbEJhY2spIHtcbiAgICBpZiAodGhpcy5pc0xvZ2dlZEluKSB7XG4gICAgICAgIGNhbGxCYWNrKHRoaXMuY2FjaGVkU3RhdHVzLnVzZXJfaWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHdhaXQgZm9yIGxvZ2luXG4gICAgICAgIHRoaXMub25jZSgnbG9nZ2VkLWluJyxmdW5jdGlvbih1c2VyX2lkKXtcbiAgICAgICAgICAgIGNhbGxCYWNrKHVzZXJfaWQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zdGF0dXMoY2FsbEJhY2sgfHwgdXRpbHMubm9vcCk7XG4gICAgfVxufVxuXG51dGlscy5yZVdoZWVsQ29ubmVjdGlvbiA9IHJlV2hlZWxDb25uZWN0aW9uOyIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gVG91Y2hlcigpe1xuICAgIHZhciB0b3VjaGVkID0gZmFsc2VcbiAgICB0aGlzLnRvdWNoID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdG91Y2hlZCA9IHRydWU7XG4gICAgfTtcbiAgICB0aGlzLnRvdWNoZWQgPSBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgdCA9IHRvdWNoZWQ7XG4gICAgICAgIHRvdWNoZWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfVxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5cbmZ1bmN0aW9uIFZhY3V1bUNhY2hlcih0b3VjaCwgYXNrZWQsIG5hbWUsIHBrSW5kZXgpe1xuLypcbiAgICBpZiAobmFtZSl7XG4gICAgICAgIGNvbnNvbGUuaW5mbygnY3JlYXRlZCBWYWN1dW1DYWNoZXIgYXMgJyArIG5hbWUpO1xuICAgIH1cbiovXG4gICAgaWYgKCFhc2tlZCl7XG4gICAgICAgIHZhciBhc2tlZCA9IFtdO1xuICAgIH1cbiAgICB2YXIgbWlzc2luZyA9IFtdO1xuICAgIFxuICAgIHRoaXMuYXNrID0gZnVuY3Rpb24gKGlkLGxhenkpe1xuICAgICAgICBpZiAocGtJbmRleCAmJiAoaWQgaW4gcGtJbmRleC5zb3VyY2UpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFMYXp5KGFza2VkKS5jb250YWlucyhpZCkpe1xuLy8gICAgICAgICAgICBjb25zb2xlLmluZm8oJ2Fza2luZyAoJyArIGlkICsgJykgZnJvbSAnICsgbmFtZSk7XG4gICAgICAgICAgICBtaXNzaW5nLnB1c2goaWQpO1xuICAgICAgICAgICAgaWYgKCFsYXp5KVxuICAgICAgICAgICAgICAgIGFza2VkLnB1c2goaWQpO1xuICAgICAgICAgICAgdG91Y2gudG91Y2goKTtcbiAgICAgICAgfSBcbi8vICAgICAgICBlbHNlIGNvbnNvbGUud2FybignKCcgKyBpZCArICcpIHdhcyBqdXN0IGFza2VkIG9uICcgKyBuYW1lKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRBc2tlZEluZGV4ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGFza2VkO1xuICAgIH1cblxuICAgIHRoaXMubWlzc2luZ3MgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gTGF6eShtaXNzaW5nLnNwbGljZSgwLG1pc3NpbmcubGVuZ3RoKSkudW5pcXVlKCkudG9BcnJheSgpO1xuICAgIH1cbn1cbiIsImZ1bmN0aW9uIEF1dG9MaW5rZXIoYWN0aXZlcywgSURCLCBXMlBSRVNPVVJDRSwgbGlzdENhY2hlKXtcbiAgICB2YXIgdG91Y2ggPSBuZXcgVG91Y2hlcigpO1xuICAgIHZhciBtYWluSW5kZXggPSB7fTtcbiAgICB2YXIgZm9yZWlnbktleXMgPSB7fTtcbiAgICB2YXIgbTJtID0ge307XG4gICAgdmFyIG0ybUluZGV4ID0ge307XG4gICAgdmFyIHBlcm1pc3Npb25zID0ge307XG4gICAgdGhpcy5tYWluSW5kZXggPSBtYWluSW5kZXg7XG4gICAgdGhpcy5mb3JlaWduS2V5cyA9IGZvcmVpZ25LZXlzO1xuICAgIHRoaXMubTJtID0gbTJtO1xuICAgIHRoaXMubTJtSW5kZXggPSBtMm1JbmRleDtcbiAgICB0aGlzLnBlcm1pc3Npb25zID0gcGVybWlzc2lvbnM7XG5cbiAgICBXMlBSRVNPVVJDRS5vbignbW9kZWwtZGVmaW5pdGlvbicsZnVuY3Rpb24obW9kZWwsIGluZGV4KXtcbiAgICAgICAgLy8gZGVmaW5pbmcgYWxsIGluZGV4ZXMgZm9yIHByaW1hcnkga2V5XG4gICAgICAgIHZhciBwa0luZGV4ID0gbGlzdENhY2hlLmdldEluZGV4Rm9yKG1vZGVsLm5hbWUsICdpZCcpO1xuICAgICAgICBtYWluSW5kZXhbbW9kZWwubmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLCBwa0luZGV4LCAnbWFpbkluZGV4LicgKyBtb2RlbC5uYW1lLCBpbmRleCk7XG4gICAgICAgIFxuICAgICAgICAvLyBjcmVhdGluZyBwZXJtaXNzaW9uIGluZGV4ZXNcbiAgICAgICAgcGVybWlzc2lvbnNbbW9kZWwubmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLG51bGwsICdwZXJtaXNzaW9ucy4nICsgbW9kZWwubmFtZSk7XG5cbiAgICAgICAgLy8gY3JlYXRpbmcgaW5kZXhlcyBmb3IgZm9yZWlnbiBrZXlzXG4gICAgICAgIExhenkobW9kZWwucmVmZXJlbmNlcykuZWFjaChmdW5jdGlvbihyZWZlcmVuY2Upe1xuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IG1vZGVsLm5hbWUgKyAnXycgKyByZWZlcmVuY2UuaWQ7XG4gICAgICAgICAgICBmb3JlaWduS2V5c1tpbmRleE5hbWVdID0gbmV3IFZhY3V1bUNhY2hlcih0b3VjaCwgbGlzdENhY2hlLmdldEluZGV4Rm9yKHJlZmVyZW5jZS50bywgJ2lkJyksIHJlZmVyZW5jZS50byArICcuaWQgZm9yZWlnbktleXMuJyArIGluZGV4TmFtZSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBjcmVhdGluZyByZXZlcnNlIGZvcmVpZ24ga2V5c1xuICAgICAgICBMYXp5KG1vZGVsLnJlZmVyZW5jZWRCeSkuZWFjaChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gZmllbGQuYnkgKyAnLicgKyBmaWVsZC5pZDtcbiAgICAgICAgICAgIGZvcmVpZ25LZXlzW2luZGV4TmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLCBsaXN0Q2FjaGUuZ2V0SW5kZXhGb3IoZmllbGQuYnksZmllbGQuaWQpLCBmaWVsZC5ieSArICcuJyArIGZpZWxkLmlkICsgJyBmb3JlaWduS2V5cy4nICsgaW5kZXhOYW1lKTtcbiAgICAgICAgfSk7XG4gICAgICAgIExhenkobW9kZWwubWFueVRvTWFueSkuZWFjaChmdW5jdGlvbihyZWxhdGlvbil7XG4gICAgICAgICAgICBpZiAoIShyZWxhdGlvbi5pbmRleE5hbWUgaW4gbTJtKSlcbiAgICAgICAgICAgICAgICBtMm1bcmVsYXRpb24uaW5kZXhOYW1lXSA9IFtuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLG51bGwsJ20ybS4nICsgcmVsYXRpb24uaW5kZXhOYW1lICsgJ1swXScpLCBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLG51bGwsJ20ybS4nICsgcmVsYXRpb24uaW5kZXhOYW1lKydbMV0nKV07XG4gICAgICAgICAgICBpZiAoIShyZWxhdGlvbi5pbmRleE5hbWUgaW4gbTJtSW5kZXgpKVxuICAgICAgICAgICAgICAgIG0ybUluZGV4W3JlbGF0aW9uLmluZGV4TmFtZV0gPSBuZXcgTWFueVRvTWFueVJlbGF0aW9uKHJlbGF0aW9uLG0ybVtyZWxhdGlvbi5pbmRleE5hbWVdKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgdmFyIG0ybUdldCA9IGZ1bmN0aW9uKGluZGV4TmFtZSwgbiwgY29sbGVjdGlvbiwgY2FsbEJhY2spe1xuICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdCgobiA/IHV0aWxzLnJldmVyc2UoJy8nLCBpbmRleE5hbWUpIDogaW5kZXhOYW1lKSArICdzJyArICcvbGlzdCcsIHtjb2xsZWN0aW9uOiBjb2xsZWN0aW9ufSwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKGRhdGEsIGNhbGxCYWNrKTtcbiAgICAgICAgICAgIGRlbGV0ZSBhY3RpdmVzW2luZGV4TmFtZV1cbiAgICAgICAgfSk7ICAgICAgICBcbiAgICB9O1xuXG4gICAgdmFyIGdldE0yTSA9IGZ1bmN0aW9uKGluZGV4TmFtZSwgY29sbGVjdGlvbiwgbiwgY2FsbEJhY2spe1xuICAgICAgICAvLyBhc2sgYWxsIGl0ZW1zIGluIGNvbGxlY3Rpb24gdG8gbTJtIGluZGV4XG4gICAgICAgIExhenkoY29sbGVjdGlvbikuZWFjaChtMm1baW5kZXhOYW1lXVtuXS5hc2suYmluZChtMm1baW5kZXhOYW1lXVtuXSkpO1xuICAgICAgICAvLyByZW5ld2luZyBjb2xsZWN0aW9uIHdpdGhvdXQgYXNrZWRcbiAgICAgICAgY29sbGVjdGlvbiA9IG0ybVtpbmRleE5hbWVdW25dLm1pc3NpbmdzKCk7XG4gICAgICAgIC8vIGNhbGxpbmcgcmVtb3RlIGZvciBtMm0gY29sbGVjdGlvbiBpZiBhbnlcbiAgICAgICAgaWYgKGNvbGxlY3Rpb24ubGVuZ3RoKXtcbiAgICAgICAgICAgIGFjdGl2ZXNbaW5kZXhOYW1lXSA9IDE7XG4gICAgICAgICAgICBtMm1HZXQoaW5kZXhOYW1lLCBuLCBjb2xsZWN0aW9uLCBjYWxsQmFjayk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjaygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmdldE0yTSA9IGdldE0yTTtcblxuICAgIHZhciBsaW5rVW5saW5rZWQgPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyBwZXJmb3JtIGEgRGF0YUJhc2Ugc3luY2hyb25pemF0aW9uIHdpdGggc2VydmVyIGxvb2tpbmcgZm9yIHVua25vd24gZGF0YVxuICAgICAgICBpZiAoIXRvdWNoLnRvdWNoZWQoKSkgcmV0dXJuO1xuICAgICAgICBpZiAoTGF6eShhY3RpdmVzKS52YWx1ZXMoKS5zdW0oKSkge1xuICAgICAgICAgICAgdG91Y2gudG91Y2goKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICBMYXp5KG0ybSkuZWFjaChmdW5jdGlvbihpbmRleGVzLCBpbmRleE5hbWUpe1xuICAgICAgICAgICAgTGF6eShpbmRleGVzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCxuKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBpbmRleC5taXNzaW5ncygpO1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24gPSBMYXp5KGNvbGxlY3Rpb24pLmZpbHRlcihCb29sZWFuKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHgpXG4gICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIGlmIChjb2xsZWN0aW9uLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBJTkRFWCA9IG0ybUluZGV4W2luZGV4TmFtZV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBnZXR0ZXIgPSBJTkRFWFsnZ2V0JyArICgxIC0gbildLmJpbmQoSU5ERVgpO1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbTJtR2V0KGluZGV4TmFtZSwgbiwgY29sbGVjdGlvbiwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWRzID0gY29sbGVjdGlvbi5tYXAoZ2V0dGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3RoZXJJbmRleCA9IGluZGV4TmFtZS5zcGxpdCgnLycpWzEgLSBuXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5kZXNjcmliZShvdGhlckluZGV4LGZ1bmN0aW9uKCl7XG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGF6eShpZHMpLmZsYXR0ZW4oKS51bmlxdWUoKS5lYWNoKG1haW5JbmRleFtvdGhlckluZGV4XS5hc2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMYXp5KGlkcykuZmxhdHRlbigpLnVuaXF1ZSgpLmVhY2goZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWluSW5kZXhbb3RoZXJJbmRleF0uYXNrKHgsdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIExhenkobWFpbkluZGV4KS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgbW9kZWxOYW1lKSB7XG4gICAgICAgICAgICB2YXIgaWRzID0gaW5kZXgubWlzc2luZ3MoKTtcbiAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIGlkYiA9IG1vZGVsTmFtZSBpbiBJREIgPyBJREJbbW9kZWxOYW1lXS5rZXlzKCkgOiBMYXp5KCk7XG4gICAgICAgICAgICAgICAgLy9sb2coJ2xpbmtpbmcuJyArIG1vZGVsTmFtZSArICcgPSAnICsgVzJQUkVTT1VSQ0UubGlua2luZy5zb3VyY2VbbW9kZWxOYW1lXSk7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gobW9kZWxOYW1lLCB7aWQ6IGlkc30sbnVsbCx1dGlscy5ub29wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIEZvcmVpZ24ga2V5c1xuICAgICAgICBMYXp5KGZvcmVpZ25LZXlzKVxuICAgICAgICAubWFwKGZ1bmN0aW9uKHYsayl7XG4gICAgICAgICAgICByZXR1cm4gW2ssIHYubWlzc2luZ3MoKV1cbiAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uKHYpe1xuICAgICAgICAgICAgcmV0dXJuIHZbMV0ubGVuZ3RoXG4gICAgICAgIH0pLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIGlkcyA9IHhbMV07XG4gICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0geFswXTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGluZGV4TmFtZS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgdmFyIG1haW5SZXNvdXJjZSA9IGluZGV4WzBdO1xuICAgICAgICAgICAgdmFyIGZpZWxkTmFtZSA9IGluZGV4WzFdO1xuICAgICAgICAgICAgdmFyIGZpbHRlciA9IHt9O1xuICAgICAgICAgICAgZmlsdGVyW2ZpZWxkTmFtZV0gPSBpZHM7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5mZXRjaChtYWluUmVzb3VyY2UsIGZpbHRlcik7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgTGF6eShMYXp5KHBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24odixrKXtcbiAgICAgICAgICAgIHJldHVybiBbaywgdi5taXNzaW5ncygpXVxuICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIHJldHVybiB2WzFdLmxlbmd0aFxuICAgICAgICB9KS50b09iamVjdCgpKS5lYWNoKGZ1bmN0aW9uIChpZHMsIHJlc291cmNlTmFtZSkge1xuICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgYWN0aXZlc1tyZXNvdXJjZU5hbWVdID0gMTtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdChyZXNvdXJjZU5hbWUgKyAnL215X3Blcm1zJywge2lkczogTGF6eShpZHMpLnVuaXF1ZSgpLnRvQXJyYXkoKX0sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdFBlcm1pc3Npb25zKGRhdGEuUEVSTUlTU0lPTlMpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgYWN0aXZlc1tyZXNvdXJjZU5hbWVdXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRJbnRlcnZhbChsaW5rVW5saW5rZWQsNTApO1xufTtcblxuXG4iLCJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gTGlzdENhY2hlcigpe1xuICAgIHZhciBnb3RBbGwgPSB7fTtcbiAgICB2YXIgYXNrZWQgPSB7fTsgLy8gbWFwIG9mIGFycmF5XG4gICAgdmFyIGNvbXBvc2l0ZUFza2VkID0ge307XG4gICAgdmFyIGNhcnRlc2lhblByb2R1Y3QxID0gZnVuY3Rpb24oeCx5LGlzQXJyYXkpe1xuICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgIGlmIChpc0FycmF5KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBhIGluIHgpe1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGIgaW4geSl7XG4gICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKExhenkoW3hbYV0seVtiXV0pLmZsYXR0ZW4oKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAodmFyIGEgaW4geCl7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYiBpbiB5KXtcbiAgICAgICAgICAgICAgICAgICAgcmV0LnB1c2goW3hbYV0seVtiXV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH07XG4gICAgdmFyIGNhcnRlc2lhblByb2R1Y3QgPSBmdW5jdGlvbihhcnIpe1xuICAgICAgICB2YXIgaXNBcnJheSA9IGZhbHNlO1xuICAgICAgICB2YXIgcmV0ID0gYXJyWzBdOyBcbiAgICAgICAgZm9yICh2YXIgeCA9IDE7IHggPCBhcnIubGVuZ3RoOyArK3gpe1xuICAgICAgICAgICAgcmV0ID0gY2FydGVzaWFuUHJvZHVjdDEocmV0LCBhcnJbeF0sIGlzQXJyYXkpO1xuICAgICAgICAgICAgaXNBcnJheSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG4gICAgdmFyIGV4cGxvZGVGaWx0ZXIgPSBmdW5jdGlvbihmaWx0ZXIpIHtcbiAgICAgICAgdmFyIHByb2R1Y3QgPSBjYXJ0ZXNpYW5Qcm9kdWN0KExhenkoZmlsdGVyKS52YWx1ZXMoKS50b0FycmF5KCkpO1xuICAgICAgICB2YXIga2V5cyA9IExhenkoZmlsdGVyKS5rZXlzKCkudG9BcnJheSgpO1xuICAgICAgICByZXR1cm4gcHJvZHVjdC5tYXAoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICB2YXIgciA9IHt9O1xuICAgICAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGEsbil7XG4gICAgICAgICAgICAgICAgclthXSA9IHhbbl07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICB9O1xuICAgIHZhciBmaWx0ZXJTaW5nbGUgPSBmdW5jdGlvbihtb2RlbCwgZmlsdGVyLCB0ZXN0T25seSl7XG4gICAgICAgIC8vIExhenkgYXV0byBjcmVhdGUgaW5kZXhlc1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gbW9kZWwubW9kZWxOYW1lO1xuICAgICAgICB2YXIgZ2V0SW5kZXhGb3IgPSB0aGlzLmdldEluZGV4Rm9yO1xuICAgICAgICB2YXIga2V5cyA9IExhenkoZmlsdGVyKS5tYXAoZnVuY3Rpb24odixrZXkpeyByZXR1cm4gW2tleSwgbW9kZWxOYW1lICsgJy4nICsga2V5XTsgfSkudG9PYmplY3QoKTtcbiAgICAgICAgdmFyIGluZGV4ZXMgPSBMYXp5KGZpbHRlcikua2V5cygpLm1hcChmdW5jdGlvbihrZXkpeyByZXR1cm4gW2tleSwgZ2V0SW5kZXhGb3IobW9kZWxOYW1lLCBrZXkpXX0pLnRvT2JqZWN0KCk7IFxuICAgICAgICAvLyBmYWtlIGZvciAoaXQgd2lsbCBjeWNsZSBvbmNlKVxuICAgICAgICBmb3IgKHZhciB4IGluIGZpbHRlcil7XG4gICAgICAgICAgICAvLyBnZXQgYXNrZWQgaW5kZXggYW5kIGNoZWNrIHByZXNlbmNlXG4gICAgICAgICAgICB2YXIgZGlmZmVyZW5jZSA9IExhenkoZmlsdGVyW3hdKS5kaWZmZXJlbmNlKGluZGV4ZXNbeF0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIGlmIChkaWZmZXJlbmNlLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgLy8gZ2VuZXJhdGUgbmV3IGZpbHRlclxuICAgICAgICAgICAgICAgIHZhciByZXQgPSBMYXp5KFtbeCwgZGlmZmVyZW5jZV1dKS50b09iamVjdCgpO1xuICAgICAgICAgICAgICAgIC8vIHJlbWVtYmVyIGFza2VkXG4gICAgICAgICAgICAgICAgaWYgKCF0ZXN0T25seSlcbiAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoaW5kZXhlc1t4XSwgZGlmZmVyZW5jZSk7XG4vLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlIGZpbHRlciA6ICcgKyBKU09OLnN0cmluZ2lmeShmaWx0ZXIpICsgJ1xcbk91dCA6JyArIEpTT04uc3RyaW5naWZ5KHJldCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuLy8gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NpbmdsZSBmaWx0ZXIgOiAnICsgSlNPTi5zdHJpbmdpZnkoZmlsdGVyKSArICdcXG5PdXQgOiBudWxsJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIGNsZWFuQ29tcG9zaXRlcyA9IGZ1bmN0aW9uKG1vZGVsLGZpbHRlcil7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjbGVhbiBjb21wb3NpdGVBc2tlZFxuICAgICAgICAgKi9cbiAgICAgICAgLy8gbGF6eSBjcmVhdGUgY29uZGl0aW9uYWwgYXNrZWQgaW5kZXhcbiAgICAgICAgaWYgKCEobW9kZWwubmFtZSBpbiBjb21wb3NpdGVBc2tlZCkpIHsgY29tcG9zaXRlQXNrZWRbbW9kZWwubmFtZV0gPSBbXSB9O1xuICAgICAgICB2YXIgaW5kZXggPSBjb21wb3NpdGVBc2tlZFttb2RlbC5uYW1lXTtcbiAgICAgICAgLy8gc2VhcmNoIGZvciBhbGwgZWxlbWVudHMgd2hvIGhhdmUgc2FtZSBwYXJ0aWFsXG4gICAgICAgIHZhciBmaWx0ZXJMZW4gPSBMYXp5KGZpbHRlcikuc2l6ZSgpO1xuICAgICAgICB2YXIgaXRlbXMgPSBpbmRleC5maWx0ZXIodXRpbHMubWFrZUZpbHRlcihtb2RlbCwgZmlsdGVyLCAnICYmICcsdHJ1ZSkpLmZpbHRlcihmdW5jdGlvbihpdGVtKXsgTGF6eShpdGVtKS5zaXplKCkgPiBmaWx0ZXJMZW4gfSk7XG4vLyAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0aW5nIDonICsgSlNPTi5zdHJpbmdpZnkoaXRlbXMpKTtcbiAgICB9O1xuXG4gICAgdGhpcy5maWx0ZXIgPSBmdW5jdGlvbihtb2RlbCwgZmlsdGVyKXtcbi8vICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tXFxuZmlsdGVyIDogJyArIEpTT04uc3RyaW5naWZ5KGZpbHRlcikpO1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gbW9kZWwubW9kZWxOYW1lO1xuXG4gICAgICAgIC8vIGlmIHlvdSBmZXRjaCBhbGwgb2JqZWN0cyBmcm9tIHNlcnZlciwgdGhpcyBtb2RlbCBoYXMgdG8gYmUgbWFya2VkIGFzIGdvdCBhbGw7XG4gICAgICAgIHZhciBmaWx0ZXJMZW4gID0gTGF6eShmaWx0ZXIpLnNpemUoKTtcbiAgICAgICAgc3dpdGNoIChmaWx0ZXJMZW4pIHtcbiAgICAgICAgICAgIGNhc2UgMCA6IHtcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gbnVsbCBvciBhbGxcbiAgICAgICAgICAgICAgICB2YXIgZ290ID0gZ290QWxsW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgZ290QWxsW21vZGVsTmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gYXNrZWQpe1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgYXNrZWRbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnb3V0IDogbnVsbCAoZ290IGFsbCknKTtcbiAgICAgICAgICAgICAgICAvLyBjb25kaXRpb25hbCBjbGVhblxuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gY29tcG9zaXRlQXNrZWQpeyBcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnb3QpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgMSA6IHtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gZmlsdGVyU2luZ2xlLmNhbGwodGhpcywgbW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICAgICAgY2xlYW5Db21wb3NpdGVzLmNhbGwodGhpcywgbW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgdmFyIHNpbmdsZSA9IExhenkoZmlsdGVyKS5rZXlzKCkuc29tZShmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIHZhciBmID0ge307XG4gICAgICAgICAgICBmW2tleV0gPSBmaWx0ZXJba2V5XTtcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJTaW5nbGUuY2FsbCh0aHMsIG1vZGVsLCBmLCB0cnVlKSA9PSBudWxsO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHNpbmdsZSkgeyByZXR1cm4gbnVsbCB9XG4gICAgICAgIC8vIGxhenkgY3JlYXRlIGNvbXBvc2l0ZUFza2VkXG4gICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBjb21wb3NpdGVBc2tlZCkpeyBjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdID0gW107IH1cbiAgICAgICAgLy8gZXhwbG9kZSBmaWx0ZXJcbiAgICAgICAgdmFyIGV4cGxvZGVkID0gZXhwbG9kZUZpbHRlcihmaWx0ZXIpO1xuICAgICAgICAvLyBjb2xsZWN0IHBhcnRpYWxzXG4gICAgICAgIHZhciBwYXJ0aWFscyA9IGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV0uZmlsdGVyKHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIGZpbHRlciwgJyB8fCAnLHRydWUpKTtcbiAgICAgICAgLy8gY29sbGVjdCBtaXNzaW5ncyAoZXhwbG9kZWQgLSBwYXJ0aWFscylcbiAgICAgICAgaWYgKHBhcnRpYWxzLmxlbmd0aCl7XG4gICAgICAgICAgICB2YXIgYmFkICA9IFtdO1xuICAgICAgICAgICAgLy8gcGFydGlhbCBkaWZmZXJlbmNlXG4gICAgICAgICAgICBmb3IgKHZhciB4IGluIHBhcnRpYWxzKXtcbiAgICAgICAgICAgICAgICBiYWQucHVzaC5hcHBseShiYWQsZXhwbG9kZWQuZmlsdGVyKHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIHBhcnRpYWxzW3hdLCcgJiYgJywgdHJ1ZSkpKTtcbiAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgY29uc29sZS5sb2coJ2V4cGxvZGVkIC0gcGFydGlhbCA6ICcgKyBKU09OLnN0cmluZ2lmeShiYWQpKTtcbiAgICAgICAgICAgIHZhciBtaXNzaW5ncyA9IExhenkoZXhwbG9kZWQpLmRpZmZlcmVuY2UoYmFkKS50b0FycmF5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgbWlzc2luZ3MgPSBleHBsb2RlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZpbHRlciBwYXJ0aWFsc1xuICAgICAgICBpZiAobWlzc2luZ3MubGVuZ3RoKXtcbiAgICAgICAgICAgIGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV0ucHVzaC5hcHBseShjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdLG1pc3NpbmdzKTtcbiAgICAgICAgICAgIC8vIGFnZ3JlZ2F0ZSBtaXNzaW5nc1xuICAgICAgICAgICAgdmFyIG1pc3NpbmdzID0gTGF6eShmaWx0ZXIpLmtleXMoKS5tYXAoZnVuY3Rpb24oa2V5KXtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gTGF6eShtaXNzaW5ncykucGx1Y2soa2V5KS51bmlxdWUoKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtrZXksIHJldC5sZW5ndGg/cmV0OmZpbHRlcltrZXldXTtcbiAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4vLyAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvdXQgOiAnICsgSlNPTi5zdHJpbmdpZnkobWlzc2luZ3MpKTtcbiAgICAgICAgICAgIC8vIGNsZWFuIGNvbmRpdGlvbmFsXG4gICAgICAgICAgICBjbGVhbkNvbXBvc2l0ZXMobW9kZWwsIG1pc3NpbmdzKTtcbiAgICAgICAgICAgIHJldHVybiBtaXNzaW5ncztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRJbmRleEZvciA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgZmllbGROYW1lKXtcbiAgICAgICAgdmFyIGluZGV4TmFtZSA9IG1vZGVsTmFtZSArICcuJyArIGZpZWxkTmFtZTtcbiAgICAgICAgaWYgKCEoaW5kZXhOYW1lIGluIGFza2VkKSl7XG4gICAgICAgICAgICBhc2tlZFtpbmRleE5hbWVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFza2VkW2luZGV4TmFtZV07XG4gICAgfVxufTsiLCIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIE1hbnlUb01hbnlSZWxhdGlvbihyZWxhdGlvbixtMm0pe1xuICAgIHZhciBpdGVtcyA9IFtdO1xuICAgIHRoaXMuYWRkID0gaXRlbXMucHVzaC5iaW5kKGl0ZW1zKTtcbiAgICB0aGlzLmFkZCA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAvLyAgICAgIGNvbnNvbGUubG9nKCdhZGRpbmcgJyArIGl0ZW0pO1xuICAgICAgICBpZiAoIShMYXp5KGl0ZW1zKS5maW5kKGl0ZW0pKSl7XG4gICAgICAgICAgICBpdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5nZXQwID0gZnVuY3Rpb24oaWQpe1xuICAgICAgICBtMm1bMV0uYXNrKGlkKTtcbiAgICAgICAgcmV0dXJuIExhenkoaXRlbXMpLmZpbHRlcihmdW5jdGlvbih4KXtcbiAgICAgICAgICAgIHJldHVybiB4WzBdID09PSBpZDtcbiAgICAgICAgfSkucGx1Y2soXCIxXCIpLnRvQXJyYXkoKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXQxID0gZnVuY3Rpb24oaWQpe1xuICAgICAgICBtMm1bMF0uYXNrKGlkKTtcbiAgICAgICAgcmV0dXJuIExhenkoaXRlbXMpLmZpbHRlcihmdW5jdGlvbih4KXtcbiAgICAgICAgICAgIHJldHVybiB4WzFdID09PSBpZDtcbiAgICAgICAgfSkucGx1Y2soXCIwXCIpLnRvQXJyYXkoKTtcbiAgICB9O1xuICAgIHRoaXNbJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKHJlbGF0aW9uLmluZGV4TmFtZS5zcGxpdCgnLycpWzFdKV0gPSB0aGlzLmdldDE7XG4gICAgdGhpc1snZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUocmVsYXRpb24uaW5kZXhOYW1lLnNwbGl0KCcvJylbMF0pXSA9IHRoaXMuZ2V0MDtcblxuICAgIHRoaXMuZGVsID0gZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgIHZhciBsID0gaXRlbXMubGVuZ3RoO1xuICAgICAgICB2YXIgaWR4ID0gbnVsbDtcbiAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCBsOyBhKyspeyBcbiAgICAgICAgICAgIGlmICgoaXRlbXNbYV1bMF0gPT09IGl0ZW1bMF0pICYmIChpdGVtc1thXVsxXSA9PT0gaXRlbVsxXSkpe1xuICAgICAgICAgICAgICAgIGlkeCA9IGE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlkeCl7XG4gICAgICAgICAgICBpdGVtcy5zcGxpY2UoYSwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0aW5nICcsIGl0ZW0pO1xuICAgIH07XG59IiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBjYWNoZWRQcm9wZXJ0eUJ5RXZlbnRzKHByb3RvLCBwcm9wZXJ0eU5hbWUsZ2V0dGVyLCBzZXR0ZXIpe1xuICAgIHZhciBldmVudHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNCk7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIFxuICAgIExhenkoZXZlbnRzKS5lYWNoKGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgcHJvdG8ub3JtLm9uKGV2ZW50LGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICByZXN1bHQgPSB7fTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgdmFyIHByb3BlcnR5RGVmID0ge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGNhY2hlZCgpe1xuICAgICAgICAgICAgaWYgKCEodGhpcy5pZCBpbiByZXN1bHQpKXtcbiAgICAgICAgICAgICAgICByZXN1bHRbdGhpcy5pZF0gPSBnZXR0ZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHRbdGhpcy5pZF07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGlmIChzZXR0ZXIpe1xuICAgICAgICBwcm9wZXJ0eURlZlsnc2V0J10gPSBmdW5jdGlvbih2YWx1ZSl7XG4vLyAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gcmVzdWx0W3RoaXMuaWRdKXtcbiAgICAgICAgICAgICAgICBzZXR0ZXIuY2FsbCh0aGlzLHZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pZCBpbiByZXN1bHQpe1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgcmVzdWx0W3RoaXMuaWRdO1xuICAgICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm90bywgcHJvcGVydHlOYW1lLHByb3BlcnR5RGVmKTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gVmFsaWRhdGlvbkVycm9yKGRhdGEpe1xuICAgIHRoaXMucmVzb3VyY2UgPSBkYXRhLl9yZXNvdXJjZTtcbiAgICB0aGlzLmZvcm1JZHggPSBkYXRhLmZvcm1JZHg7XG4gICAgdGhpcy5maWVsZHMgPSBkYXRhLmVycm9ycztcbn1cbnZhciBiYXNlT1JNID0gZnVuY3Rpb24ob3B0aW9ucywgZXh0T1JNKXtcbiAgICBcbiAgICAvLyBjcmVhdGluZyByZXdoZWVsIGNvbm5lY3Rpb25cbiAgICBpZiAob3B0aW9ucy5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKXtcbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBuZXcgcmVXaGVlbENvbm5lY3Rpb24ob3B0aW9ucyk7XG4gICAgfSBlbHNlIGlmIChvcHRpb25zLmNvbnN0cnVjdG9yID09PSB1dGlscy5yZVdoZWVsQ29ubmVjdGlvbil7XG4gICAgICAgIHZhciBjb25uZWN0aW9uID0gb3B0aW9ucztcbiAgICB9XG4gICAgdGhpcy5jb25uZWN0aW9uID0gY29ubmVjdGlvbjtcbiAgICBjb25uZWN0aW9uLm9uKCdjb25uZWN0ZWQnLCBmdW5jdGlvbigpeyBcbiAgICAgICAgdGhpcy5jb25uZWN0ZWQgPSB0cnVlO1xuICAgIH0pO1xuICAgIHRoaXMub24gPSBjb25uZWN0aW9uLm9uO1xuICAgIHRoaXMuZW1pdCA9IGNvbm5lY3Rpb24uZW1pdDtcbiAgICB0aGlzLnVuYmluZCA9IGNvbm5lY3Rpb24udW5iaW5kO1xuICAgIHRoaXMub25jZSA9IGNvbm5lY3Rpb24ub25jZTtcbiAgICB0aGlzLiRwb3N0ID0gY29ubmVjdGlvbi4kcG9zdC5iaW5kKGNvbm5lY3Rpb24pO1xuXG4gICAgLy8gaGFuZGxpbmcgd2Vic29ja2V0IGV2ZW50c1xuICAgIHRoaXMub24oJ3dzLWNvbm5lY3RlZCcsZnVuY3Rpb24od3Mpe1xuICAgICAgICBjb25zb2xlLmluZm8oJ1dlYnNvY2tldCBjb25uZWN0ZWQnKTtcbiAgICAgICAgLy8gYWxsIGpzb24gZGF0YSBoYXMgdG8gYmUgcGFyc2VkIGJ5IGdvdERhdGFcbiAgICAgICAgd3Mub25NZXNzYWdlSnNvbihXMlBSRVNPVVJDRS5nb3REYXRhLmJpbmQoVzJQUkVTT1VSQ0UpKTtcbiAgICAgICAgLy9cbiAgICAgICAgd3Mub25NZXNzYWdlVGV4dChmdW5jdGlvbihtZXNzYWdlKXtcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnV1MgbWVzc2FnZSA6ICcgKyBtZXNzYWdlKVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICB0aGlzLm9uKCd3cy1kaXNjb25uZWN0ZWQnLCBmdW5jdGlvbih3cyl7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dlYnNvY2tldCBkaXNjb25uZWN0ZWQnKVxuICAgIH0pO1xuICAgIHRoaXMub24oJ2Vycm9yLWpzb24tNDA0JyxmdW5jdGlvbihlcnJvcix1cmwsIHNlbnREYXRhLCB4aHIpeyBcbiAgICAgICAgY29uc29sZS5lcnJvcignSlNPTiBlcnJvciAnLCBKU09OLnN0cmluZ2lmeShlcnJvcikpO1xuICAgICAgICBkZWxldGUgd2FpdGluZ0Nvbm5lY3Rpb25zW3VybC5zcGxpdCgnLycpWzBdXTtcbiAgICB9KTtcbiAgICB0aGlzLm9uKCdyZWFsdGltZS1tZXNzYWdlLWpzb24nLCBmdW5jdGlvbihtZXNzYWdlKXtcbiAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShtZXNzYWdlKTtcbiAgICB9KTtcblxuICAgIC8vIGluaXRpYWxpemF0aW9uXG4gICAgdmFyIFcyUFJFU09VUkNFID0gdGhpcztcbiAgICB2YXIgSURCID0ge2F1dGhfZ3JvdXAgOiBMYXp5KHt9KX07IC8vIHRhYmxlTmFtZSAtPiBkYXRhIGFzIEFycmF5XG4gICAgdmFyIElEWCA9IHt9OyAvLyB0YWJsZU5hbWUgLT4gTGF6eShpbmRleEJ5KCdpZCcpKSAtPiBJREJbZGF0YV1cbiAgICB2YXIgUkVWSURYID0ge307IC8vIHRhYmxlTmFtZSAtPiBmaWVsZE5hbWUgLT4gTGF6eS5ncm91cEJ5KCkgLT4gSURCW0RBVEFdXG4gICAgdmFyIGJ1aWxkZXJIYW5kbGVycyA9IHt9O1xuICAgIHZhciBidWlsZGVySGFuZGxlclVzZWQgPSB7fTtcbiAgICB2YXIgcGVyc2lzdGVudEF0dHJpYnV0ZXMgPSB7fTtcbiAgICB2YXIgZXZlbnRIYW5kbGVycyA9IHt9O1xuICAgIHZhciBwZXJtaXNzaW9uV2FpdGluZyA9IHt9O1xuICAgIHZhciBtb2RlbENhY2hlID0ge307XG4gICAgdmFyIGZhaWxlZE1vZGVscyA9IHt9O1xuICAgIHZhciB3YWl0aW5nQ29ubmVjdGlvbnMgPSB7fSAvLyBhY3R1YWwgY29ubmVjdGlvbiB3aG8gaSdtIHdhaXRpbmcgZm9yXG4gICAgdmFyIGxpc3RDYWNoZSA9IG5ldyBMaXN0Q2FjaGVyKExhenkpO1xuICAgIHZhciBsaW5rZXIgPSBuZXcgQXV0b0xpbmtlcih3YWl0aW5nQ29ubmVjdGlvbnMsSURCLCB0aGlzLCBsaXN0Q2FjaGUpO1xuLyogICAgd2luZG93LmxsID0gbGlua2VyO1xuICAgIHdpbmRvdy5sYyA9IGxpc3RDYWNoZTtcbiovXG4gICAgd2luZG93LklEQiA9IElEQjtcbiAgICB0aGlzLnZhbGlkYXRpb25FdmVudCA9IHRoaXMub24oJ2Vycm9yLWpzb24tNTEzJywgZnVuY3Rpb24oZGF0YSwgdXJsLCBzZW50RGF0YSwgeGhyKXtcbiAgICAgICAgaWYgKGN1cnJlbnRDb250ZXh0LnNhdmluZ0Vycm9ySGFubGRlcil7XG4gICAgICAgICAgICBjdXJyZW50Q29udGV4dC5zYXZpbmdFcnJvckhhbmxkZXIobmV3IFZhbGlkYXRpb25FcnJvcihkYXRhKSk7XG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgdmFyIGdldEluZGV4ID0gZnVuY3Rpb24gKGluZGV4TmFtZSkge1xuICAgICAgICBpZiAoaW5kZXhOYW1lIGluIElEQilcbiAgICAgICAgICAgIHJldHVybiBJREJbaW5kZXhOYW1lXTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBJREJbaW5kZXhOYW1lXSA9IExhenkoe30pO1xuICAgICAgICAgICAgcmV0dXJuIElEQltpbmRleE5hbWVdO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgZ2V0VW5saW5rZWQgPSBmdW5jdGlvbiAoaW5kZXhOYW1lKSB7XG4gICAgICAgIGlmIChpbmRleE5hbWUgaW4gVU5MSU5LRUQpXG4gICAgICAgICAgICByZXR1cm4gVU5MSU5LRURbaW5kZXhOYW1lXTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBVTkxJTktFRFtpbmRleE5hbWVdID0ge307XG4gICAgICAgICAgICByZXR1cm4gVU5MSU5LRURbaW5kZXhOYW1lXTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBQZXJtaXNzaW9uVGFibGUoaWQsIGtsYXNzLCBwZXJtaXNzaW9ucykge1xuICAgICAgICAvLyBjcmVhdGUgUGVybWlzc2lvblRhYmxlIGNsYXNzXG4gICAgICAgIHRoaXMua2xhc3MgPSBrbGFzcztcbiAgICAgICAgdGhpcy5wZXJtaXNzaW9ucyA9IFtdO1xuICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgIGZvciAodmFyIGsgaW4gcGVybWlzc2lvbnMpIHtcbiAgICAgICAgICAgIHRoaXMucHVzaC5hcHBseSh0aGlzLCBbaywgcGVybWlzc2lvbnNba11dKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBQZXJtaXNzaW9uVGFibGUucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgLy8gc2F2ZSBPYmplY3QgdG8gc2VydmVyXG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgcGVybWlzc2lvbnM6IExhenkodGhpcy5wZXJtaXNzaW9ucykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFt4WzBdLmlkLCB4WzFdXVxuICAgICAgICAgICAgfSkudG9PYmplY3QoKVxuICAgICAgICB9O1xuICAgICAgICBkYXRhLmlkID0gdGhpcy5pZDtcbiAgICAgICAgdmFyIG1vZGVsTmFtZSA9IHRoaXMua2xhc3MubW9kZWxOYW1lO1xuICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdCh0aGlzLmtsYXNzLm1vZGVsTmFtZSArICcvc2V0X3Blcm1pc3Npb25zJywgZGF0YSwgZnVuY3Rpb24gKG15UGVybXMsIGEsIGIsIHJlcSkge1xuICAgICAgICAgICAgY2IobXlQZXJtcyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUGVybWlzc2lvblRhYmxlLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKGdyb3VwX2lkLCBwZXJtaXNzaW9uTGlzdCkge1xuICAgICAgICB2YXIgcCA9IExhenkocGVybWlzc2lvbkxpc3QpO1xuICAgICAgICB2YXIgcGVybXMgPSBMYXp5KHRoaXMua2xhc3MuYWxsUGVybWlzc2lvbnMpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuIFt4LCBwLmNvbnRhaW5zKHgpXVxuICAgICAgICB9KS50b09iamVjdCgpO1xuICAgICAgICB2YXIgbCA9IExhenkodGhpcy5wZXJtaXNzaW9ucykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4geFswXS5pZFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGwuY29udGFpbnMoZ3JvdXBfaWQpKVxuICAgICAgICAgICAgdGhpcy5wZXJtaXNzaW9uc1tsLmluZGV4T2YoZ3JvdXBfaWQpXVsxXSA9IHBlcm1zO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0aGlzLnBlcm1pc3Npb25zLnB1c2goW0lEQi5hdXRoX2dyb3VwLmdldChncm91cF9pZCksIHBlcm1zXSk7XG4gICAgfTtcblxuICAgIC8vIGNyZWF0ZXMgZHluYW1pY2FsIG1vZGVsc1xuICAgIHZhciBtYWtlTW9kZWxDbGFzcyA9IGZ1bmN0aW9uIChtb2RlbCkge1xuICAgICAgICB2YXIgX21vZGVsID0gbW9kZWw7XG4gICAgICAgIG1vZGVsLmZpZWxkcy5pZC5yZWFkYWJsZSA9IGZhbHNlO1xuICAgICAgICBtb2RlbC5maWVsZHMuaWQud3JpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgdmFyIGZpZWxkcyA9IExhenkobW9kZWwuZmllbGRzKTtcbiAgICAgICAgaWYgKG1vZGVsLnByaXZhdGVBcmdzKSB7XG4gICAgICAgICAgICBmaWVsZHMgPSBmaWVsZHMubWVyZ2UobW9kZWwucHJpdmF0ZUFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ21vZGVsLWRlZmluaXRpb24nLCBtb2RlbCwgZ2V0SW5kZXgobW9kZWwubmFtZSkpO1xuICAgICAgICAvLyBnZXR0aW5nIGZpZWxkcyBvZiB0eXBlIGRhdGUgYW5kIGRhdGV0aW1lXG4vKlxuICAgICAgICB2YXIgREFURUZJRUxEUyA9IGZpZWxkcy5maWx0ZXIoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHJldHVybiAoeC50eXBlID09ICdkYXRlJykgfHwgKHgudHlwZSA9PSAnZGF0ZXRpbWUnKVxuICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKHgsIHYpIHtcbiAgICAgICAgICAgIHJldHVybiBbdiwgdHJ1ZV1cbiAgICAgICAgfSkudG9PYmplY3QoKTtcblxuICAgICAgICAvLyBnZXR0aW5nIGJvb2xlYW4gZmllbGRzXG4gICAgICAgIHZhciBCT09MRklFTERTID0gZmllbGRzLmZpbHRlcihmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuICh4LnR5cGUgPT0gJ2Jvb2xlYW4nKVxuICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKHgsIHYpIHtcbiAgICAgICAgICAgIHJldHVybiBbdiwgdHJ1ZV1cbiAgICAgICAgfSkudG9PYmplY3QoKTtcblxuICAgICAgICAvLyBib29sZWFucyBhbmQgZGF0ZXRpbWVzIHN0b3JhZ2UgZXh0ZXJuYWwgXG4gICAgICAgIE1PREVMX0RBVEVGSUVMRFNbbW9kZWwubmFtZV0gPSBEQVRFRklFTERTO1xuICAgICAgICBNT0RFTF9CT09MRklFTERTW21vZGVsLm5hbWVdID0gQk9PTEZJRUxEUztcbiovXG4gICAgICAgIC8vIGluaXRpYWxpemF0aW9uXG4gICAgICAgIHZhciBmdW5jU3RyaW5nID0gXCJpZiAoIXJvdykgeyByb3cgPSB7fX07XFxuXCI7XG4gICAgICAgIGZ1bmNTdHJpbmcgKz0gbW9kZWwucmVmZXJlbmNlcy5tYXAoZnVuY3Rpb24oZmllbGQpe1xuICAgICAgICAgICAgcmV0dXJuICd0aGlzLl8nICsgZmllbGQuaWQgKyAnID0gcm93LicgKyBmaWVsZC5pZCArICc7JztcbiAgICAgICAgfSkuam9pbignO1xcbicpO1xuICAgICAgICBcbiAgICAgICAgLy8gZGF0ZWZpZWxkIGNvbnZlcnNpb25cbiAgICAgICAgZnVuY1N0cmluZyArPSBmaWVsZHMubWFwKGZ1bmN0aW9uICh4LGspIHtcbiAgICAgICAgICAgIGlmICgoeC50eXBlID09ICdkYXRlJykgfHwgKHgudHlwZSA9PSAnZGF0ZXRpbWUnKSl7XG4gICAgICAgICAgICAgICAgcmV0dXJuICd0aGlzLicgKyBrICsgJyA9IHJvdy4nICsgayArICc/bmV3IERhdGUocm93LicgKyBrICsgJyAqIDEwMDAgLSAnICsgdXRpbHMudHpPZmZzZXQgKyAnKTpudWxsO1xcbic7IFxuICAgICAgICAgICAgfSBlbHNlIGlmICh4LnR5cGUgPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICd0aGlzLicgKyBrICsgJyA9IChyb3cuJyArIGsgKyAnID09PSBcIlRcIikgfHwgKHJvdy4nICsgayArICcgPT09IHRydWUpO1xcbic7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAndGhpcy4nICsgayArICcgPSByb3cuJyArIGsgKyAnO1xcbic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLnRvU3RyaW5nKCdcXG4nKTsgKyAnXFxuJztcblxuICAgICAgICBmdW5jU3RyaW5nICs9IFwiaWYgKHBlcm1pc3Npb25zKSB7dGhpcy5fcGVybWlzc2lvbnMgPSBwZXJtaXNzaW9ucyAmJiBMYXp5KHBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIFt4LCB0cnVlXSB9KS50b09iamVjdCgpO31cIlxuXG4gICAgICAgIFxuICAgICAgICAvLyBtYXN0ZXIgY2xhc3MgZnVuY3Rpb25cbiAgICAgICAgdmFyIEtsYXNzID0gbmV3IEZ1bmN0aW9uKCdyb3cnLCAncGVybWlzc2lvbnMnLGZ1bmNTdHJpbmcpXG5cbiAgICAgICAgS2xhc3MucHJvdG90eXBlLm9ybSA9IGV4dE9STTtcbiAgICAgICAgS2xhc3MucmVmX3RyYW5zbGF0aW9ucyA9IHt9O1xuICAgICAgICBLbGFzcy5tb2RlbE5hbWUgPSBtb2RlbC5uYW1lO1xuICAgICAgICBLbGFzcy5yZWZlcmVuY2VzID0gTGF6eShtb2RlbC5yZWZlcmVuY2VzKS5wbHVjaygnaWQnKS50b0FycmF5KCk7XG5cbiAgICAgICAgS2xhc3MuaW52ZXJzZV9yZWZlcmVuY2VzID0gbW9kZWwucmVmZXJlbmNlZEJ5Lm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgLy8gbWFuYWdpbmcgcmVmZXJlbmNlcyB3aGVyZSBcbiAgICAgICAgICAgIHJldHVybiB4LmJ5ICsgJ18nICsgeC5pZCArICdfc2V0J1xuICAgICAgICB9KTtcbiAgICAgICAgS2xhc3MucmVmZXJlbnRzID0gbW9kZWwucmVmZXJlbmNlZEJ5Lm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuIFt4LmJ5LCB4LmlkXVxuICAgICAgICB9KTtcbiAgICAgICAgS2xhc3MuZmllbGRzT3JkZXIgPSBtb2RlbC5maWVsZE9yZGVyO1xuICAgICAgICBLbGFzcy5hbGxQZXJtaXNzaW9ucyA9IG1vZGVsLnBlcm1pc3Npb25zO1xuXG4gICAgICAgIC8vIHJlZGVmaW5pbmcgdG9TdHJpbmcgbWV0aG9kXG4gICAgICAgIGlmIChMYXp5KG1vZGVsLnJlcHJlc2VudGF0aW9uKS5zaXplKCkpe1xuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlLnRvU3RyaW5nID0gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcy4nICsgTGF6eShtb2RlbC5yZXByZXNlbnRhdGlvbikudG9TdHJpbmcoJyArIFwiIFwiICsgdGhpcy4nKSk7XG4gICAgICAgIH1cbiAgICAgICAgS2xhc3MucHJvdG90eXBlLnRvVXBwZXJDYXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gcmVkZWZpbmUgdG8gVXBwZXJDYXNlXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b1N0cmluZygpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIH07XG4gICAgICBcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLnRvTG93ZXJDYXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIGRlbGV0ZSBpbnN0YW5jZSBmcm9tIHNlcnZlclxuICAgICAgICAgICAgcmV0dXJuIGV4dE9STS5kZWxldGUodGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUsIFt0aGlzLmlkXSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gcGVybWlzc2lvbiBnZXR0ZXIgcHJvcGVydHlcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtsYXNzLnByb3RvdHlwZSwgJ3Blcm1pc3Npb25zJywge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Blcm1pc3Npb25zKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcGVybWlzc2lvbnM7XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmtlci5wZXJtaXNzaW9uc1t0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZV0uYXNrKHRoaXMuaWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGdldHRpbmcgZnVsbCBwZXJtaXNzaW9uIHRhYmxlIGZvciBhbiBvYmplY3RcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLmFsbF9wZXJtcyA9IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAgICAgdmFyIG9iamVjdF9pZCA9IHRoaXMuaWQ7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdCh0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZSArICcvYWxsX3Blcm1zJywge2lkOiB0aGlzLmlkfSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGVybWlzc2lvbnMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIHZhciBncm91cGVkID0ge307XG4gICAgICAgICAgICAgICAgdmFyIHVua25vd25fZ3JvdXBzID0gTGF6eShwZXJtaXNzaW9ucykucGx1Y2soJ2dyb3VwX2lkJykudW5pcXVlKCkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnJyArIHhcbiAgICAgICAgICAgICAgICB9KS5kaWZmZXJlbmNlKElEQi5hdXRoX2dyb3VwLmtleXMoKSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIExhenkocGVybWlzc2lvbnMpLmdyb3VwQnkoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHguZ3JvdXBfaWRcbiAgICAgICAgICAgICAgICB9KS5lYWNoKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwZWRba10gPSBMYXp5KHYpLnBsdWNrKCduYW1lJykudG9BcnJheSgpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIGNhbGwgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICBjYihuZXcgUGVybWlzc2lvblRhYmxlKG9iamVjdF9pZCwgS2xhc3MsIGdyb3VwZWQpKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmICh1bmtub3duX2dyb3Vwcy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdldCgnYXV0aF9ncm91cCcsdW5rbm93bl9ncm91cHMsY2FsbCk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBjYWxsKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBLbGFzcy5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgbyA9IHRoaXMuYXNSYXcoKTtcbiAgICAgICAgICAgIHZhciBmaWVsZHMgPSBLbGFzcy5maWVsZHM7XG4gICAgICAgICAgICB2YXIgSUQgPSB0aGlzLmlkO1xuICAgICAgICAgICAgdmFyIG1vZGVsTmFtZSA9IHRoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lO1xuICAgICAgICAgICAgaWYgKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBhcmcgaW4gYXJncykge1xuICAgICAgICAgICAgICAgICAgICBvW2FyZ10gPSBhcmdzW2FyZ107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZWxpbWluYXRlIHVud3JpdGFibGVzXG4gICAgICAgICAgICBMYXp5KEtsYXNzLmZpZWxkc09yZGVyKS5maWx0ZXIoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuICFmaWVsZHNbeF0ud3JpdGFibGU7XG4gICAgICAgICAgICB9KS5lYWNoKGZ1bmN0aW9uKGZpZWxkTmFtZSl7XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkTmFtZSBpbiBvKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvW2ZpZWxkTmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoSUQpIHsgby5pZCA9IElEOyB9XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IFcyUFJFU09VUkNFLiRwb3N0KG1vZGVsTmFtZSArIChJRCA/ICcvcG9zdCcgOiAnL3B1dCcpLCBvKTtcbiAgICAgICAgICAgIGlmIChhcmdzICYmIChhcmdzLmNvbnN0cnVjdG9yID09PSBGdW5jdGlvbikpe1xuICAgICAgICAgICAgICAgIC8vIHBsYWNpbmcgY2FsbGJhY2sgaW4gYSBjb21tb24gcGxhY2VcbiAgICAgICAgICAgICAgICBwcm9taXNlLmNvbnRleHQuc2F2aW5nRXJyb3JIYW5sZGVyID0gYXJncztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlXG4gICAgICAgIH07XG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG9iaiA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuYXNSYXcoKSk7XG4gICAgICAgICAgICBvYmouX3Blcm1pc3Npb25zID0gdGhpcy5fcGVybWlzc2lvbnM7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGJ1aWxkaW5nIHNlcmlhbGl6YXRpb24gZnVuY3Rpb25cbiAgICAgICAgdmFyIGFzciA9ICdyZXR1cm4ge1xcbicgKyBMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLm1hcChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICByZXR1cm4gZmllbGQuaWQgKyAnIDogdGhpcy5fJyArIGZpZWxkLmlkO1xuICAgICAgICB9KS5jb25jYXQoZmllbGRzLm1hcChmdW5jdGlvbiAoeCxrKSB7XG4gICAgICAgICAgICBpZiAoKHgudHlwZSA9PSAnZGF0ZScpIHx8ICh4LnR5cGUgPT0gJ2RhdGV0aW1lJykpe1xuICAgICAgICAgICAgICAgIHJldHVybiBrICsgJyA6ICh0aGlzLicgKyBrICsgJz8oTWF0aC5yb3VuZCh0aGlzLicgKyBrICsgJy5nZXRUaW1lKCkgLSB0aGlzLicgKyBrICsgJy5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDApIC8gMTAwMCk6bnVsbCknOyBcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoeC50eXBlID09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBrICsgJyA6IHRoaXMuJyArIGsgKyAnP1wiVFwiOlwiRlwiJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGsgKyAnIDogdGhpcy4nICsgaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLnRvU3RyaW5nKCcsXFxuJykgKyAnfTsnO1xuICAgICAgICBLbGFzcy5wcm90b3R5cGUuYXNSYXcgPSBuZXcgRnVuY3Rpb24oYXNyKTtcblxuICAgICAgICBLbGFzcy5zYXZlTXVsdGkgPSBmdW5jdGlvbiAob2JqZWN0cywgY2IsIHNjb3BlKSB7XG4gICAgICAgICAgICB2YXIgcmF3ID0gW107XG4gICAgICAgICAgICB2YXIgZGVsZXRhYmxlID0gTGF6eShLbGFzcy5maWVsZHMpXG4gICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXgud3JpdGFibGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5wbHVjaygnaWQnKVxuICAgICAgICAgICAgICAgIC50b0FycmF5KCk7XG4gICAgICAgICAgICBMYXp5KG9iamVjdHMpXG4gICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geC5hc1JhdygpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICBMYXp5KGRlbGV0YWJsZSkuZWFjaChmdW5jdGlvbiAoeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHhbeV07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByYXcucHVzaCh4KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KEtsYXNzLm1vZGVsTmFtZSwgJ3B1dCcsIHttdWx0aXBsZTogcmF3LCBmb3JtSWR4IDogVzJQUkVTT1VSQ0UuZm9ybUlkeCsrfSwgZnVuY3Rpb24gKGVsZW1zKSB7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShlbGVtcyk7XG4gICAgICAgICAgICAgICAgdmFyIHRhYiA9IElEQltLbGFzcy5tb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgIHZhciBvYmpzID0gTGF6eShlbGVtc1tLbGFzcy5tb2RlbE5hbWVdLnJlc3VsdHMpLnBsdWNrKCdpZCcpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFiLmdldCh4KVxuICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICBpZiAoY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgY2Iob2Jqcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgc2NvcGUpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoJ2V4dHJhX3ZlcmJzJyBpbiBtb2RlbClcbiAgICAgICAgICAgIExhenkobW9kZWwuZXh0cmFfdmVyYnMpLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZnVuY05hbWUgPSB4WzBdO1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0geFsxXTtcbiAgICAgICAgICAgICAgICB2YXIgZGRhdGEgPSAnZGF0YSA9IHtpZCA6IHRoaXMuaWQnO1xuICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgZGRhdGEgKz0gJywgJyArIExhenkoYXJncykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHggKyAnIDogJyArIHg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5qb2luKCcsJyk7XG4gICAgICAgICAgICAgICAgZGRhdGEgKz0gJ307JztcbiAgICAgICAgICAgICAgICBhcmdzLnB1c2goJ2NiJyk7XG4gICAgICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlW2Z1bmNOYW1lXSA9IG5ldyBGdW5jdGlvbihhcmdzLCBkZGF0YSArICdXMlMuVzJQX1BPU1QodGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUsXCInICsgZnVuY05hbWUgKyAnXCIsIGRhdGEsZnVuY3Rpb24oZGF0YSxzdGF0dXMsaGVhZGVycyx4KXsnICtcbiAgICAgICAgICAgICAgICAgICAgJ3RyeXtcXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJyAgIGlmICghaGVhZGVycyhcIm5vbW9kZWxcIikpIHt3aW5kb3cuVzJTLmdvdERhdGEoZGF0YSxjYik7fVxcbicgK1xuICAgICAgICAgICAgICAgICAgICAnICAgZWxzZSB7aWYgKGNiKSB7Y2IoZGF0YSl9fVxcbicgK1xuICAgICAgICAgICAgICAgICAgICAnfSBjYXRjaChlKXtcXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJ2lmIChjYikge2NiKGRhdGEpO31cXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJ31cXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJ30pO1xcbidcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIGlmICgncHJpdmF0ZUFyZ3MnIGluIG1vZGVsKSB7XG4gICAgICAgICAgICBLbGFzcy5wcml2YXRlQXJncyA9IExhenkobW9kZWwucHJpdmF0ZUFyZ3MpLmtleXMoKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW3gsIHRydWVdO1xuICAgICAgICAgICAgfSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZS5zYXZlUEEgPSBmdW5jdGlvbiAobykge1xuICAgICAgICAgICAgICAgIHZhciBUID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgb28gPSB7aWQ6IHRoaXMuaWR9O1xuICAgICAgICAgICAgICAgIHZhciBQQSA9IHRoaXMuY29uc3RydWN0b3IucHJpdmF0ZUFyZ3M7XG4gICAgICAgICAgICAgICAgdmFyIEZzID0gdGhpcy5jb25zdHJ1Y3Rvci5maWVsZHM7XG4gICAgICAgICAgICAgICAgdmFyIHQgPSBuZXcgdGhpcy5jb25zdHJ1Y3RvcihvKS5hc1JhdygpO1xuICAgICAgICAgICAgICAgIHZhciBmaWVsZElkeCA9IExhenkoUEEpLmtleXMoKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFt4LCBGc1t4XV1cbiAgICAgICAgICAgICAgICB9KS50b09iamVjdCgpO1xuICAgICAgICAgICAgICAgIExhenkobykuZWFjaChmdW5jdGlvbiAodiwgaykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKGsgaW4gUEEpICYmIGZpZWxkSWR4W2tdLndyaXRhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvb1trXSA9IHY7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdCh0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZSArICcvc2F2ZVBBJywgb28sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgTGF6eShvbykuZWFjaChmdW5jdGlvbiAodiwgaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgVFtrXSA9IHY7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1vZGVsQ2FjaGVbS2xhc3MubW9kZWxOYW1lXSA9IEtsYXNzO1xuICAgICAgICAvLyBhZGRpbmcgaWQgdG8gZmllbGRzXG4gICAgICAgIGZvciAodmFyIGYgaW4gbW9kZWwuZmllbGRzKSB7XG4gICAgICAgICAgICBtb2RlbC5maWVsZHNbZl0uaWQgPSBmO1xuICAgICAgICB9XG4gICAgICAgIEtsYXNzLmZpZWxkcyA9IExhenkobW9kZWwuZmllbGRzKS5jb25jYXQoTGF6eShtb2RlbC5wcml2YXRlQXJncykpLmNvbmNhdChMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLnRhcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgeC50eXBlID0geC50eXBlIHx8ICdyZWZlcmVuY2UnXG4gICAgICAgIH0pKS5pbmRleEJ5KCdpZCcpLnRvT2JqZWN0KCk7XG4gICAgICAgIC8vIHNldHRpbmcgd2lkZ2V0cyBmb3IgZmllbGRzXG4gICAgICAgIExhenkoS2xhc3MuZmllbGRzKS5lYWNoKGZ1bmN0aW9uKGZpZWxkKXtcbiAgICAgICAgICAgIGlmICghZmllbGQud2lkZ2V0KXtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQudHlwZSA9PT0gJ3JlZmVyZW5jZScpe1xuICAgICAgICAgICAgICAgICAgICBmaWVsZC53aWRnZXQgPSAnY2hvaWNlcydcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZC53aWRnZXQgPSBmaWVsZC50eXBlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGJ1aWxkaW5nIHJlZmVyZW5jZXMgdG8gKG1hbnkgdG8gb25lKSBmaWVsZHNcbiAgICAgICAgTGF6eShtb2RlbC5yZWZlcmVuY2VzKS5lYWNoKGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgICAgICAgIHZhciBleHRfcmVmID0gcmVmLnRvO1xuICAgICAgICAgICAgdmFyIGxvY2FsX3JlZiA9ICdfJyArIHJlZi5pZDtcbiAgICAgICAgICAgIGNhY2hlZFByb3BlcnR5QnlFdmVudHMoS2xhc3MucHJvdG90eXBlLCByZWYuaWQsZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICghKGV4dF9yZWYgaW4gSURCKSl7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5kZXNjcmliZShleHRfcmVmLGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlua2VyLm1haW5JbmRleFtleHRfcmVmXS5hc2sodGhzW2xvY2FsX3JlZl0sdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gKGV4dF9yZWYgaW4gSURCKSAmJiB0aGlzW2xvY2FsX3JlZl0gJiYgSURCW2V4dF9yZWZdLmdldCh0aGlzW2xvY2FsX3JlZl0pO1xuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0ICYmIChleHRfcmVmIGluIGxpbmtlci5tYWluSW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFza2luZyB0byBsaW5rZXJcbiAgICAgICAgICAgICAgICAgICAgbGlua2VyLm1haW5JbmRleFtleHRfcmVmXS5hc2sodGhpc1tsb2NhbF9yZWZdLHRydWUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXRpbHMubW9jaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKHZhbHVlLmNvbnN0cnVjdG9yICE9PSB1dGlscy5tb2NrKSAmJiAodmFsdWUuY29uc3RydWN0b3IubW9kZWxOYW1lICE9PSBleHRfcmVmKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignWW91IGNhbiBhc3NpZ24gb25seSAnICsgZXh0X3JlZiArICcgdG8gJyArIHJlZi5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpc1tsb2NhbF9yZWZdID0gdmFsdWUuaWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1tsb2NhbF9yZWZdID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAnbmV3LScgKyBleHRfcmVmLCAnZGVsZXRlZC0nICsgZXh0X3JlZiwndXBkYXRlZC0nICsgZXh0X3JlZiwgJ25ldy1tb2RlbC0nICsgZXh0X3JlZiwgJ3VwZGF0ZWQtJyArIEtsYXNzLm1vZGVsTmFtZSk7XG5cblxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZShyZWYuaWQpXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXh0T1JNLmdldChleHRfcmVmLHRoaXNbbG9jYWxfcmVmXSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2J1aWxkaW5nIHJlZmVyZW5jZXMgdG8gKG9uZSB0byBtYW55KSBmaWVsZHNcbiAgICAgICAgTGF6eShtb2RlbC5yZWZlcmVuY2VkQnkpLmVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IHJlZi5ieSArICcuJyArIHJlZi5pZDtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSByZWYuYnkgKyAnXycgKyB1dGlscy5wbHVyYWxpemUocmVmLmlkKTtcbiAgICAgICAgICAgIHZhciByZXZJbmRleCA9IHJlZi5ieTtcbiAgICAgICAgICAgIGlmIChLbGFzcy5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkocHJvcGVydHlOYW1lKSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RyeWVkIHRvIHJlZGVmaW5lIHByb3BlcnR5ICcgKyBwcm9wZXJ0eU5hbWUgKyAncycgKyAnIGZvciAnICsgS2xhc3MubW9kZWxOYW1lKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2FjaGVkUHJvcGVydHlCeUV2ZW50cyhLbGFzcy5wcm90b3R5cGUsIHByb3BlcnR5TmFtZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmV0ID0gKHJldkluZGV4IGluIElEQikgPyBSRVZJRFhbaW5kZXhOYW1lXS5nZXQodGhpcy5pZCArICcnKTpudWxsO1xuICAgICAgICAgICAgICAgICAgICBsaW5rZXIuZm9yZWlnbktleXNbaW5kZXhOYW1lXS5hc2sodGhpcy5pZCx0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgICAgICB9LCBudWxsLCAnbmV3LScgKyByZXZJbmRleCwgJ3VwZGF0ZWQtJyArIHJldkluZGV4LCAnZGVsZXRlZC0nICsgcmV2SW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZSh1dGlscy5wbHVyYWxpemUocmVmLmJ5KSldID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBvcHRzID0ge307XG4gICAgICAgICAgICAgICAgb3B0c1tyZWYuaWRdID0gW3RoaXMuaWRdO1xuICAgICAgICAgICAgICAgIHJldHVybiBleHRPUk0ucXVlcnkocmVmLmJ5LG9wdHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9idWlsZGluZyByZWZlcmVuY2UgdG8gKG1hbnkgdG8gbWFueSkgZmllbGRzXG4gICAgICAgIGlmIChtb2RlbC5tYW55VG9NYW55KSB7XG4gICAgICAgICAgICBMYXp5KG1vZGVsLm1hbnlUb01hbnkpLmVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgICAgICAgICAgIHZhciBpbmRleE5hbWUgPSByZWYuaW5kZXhOYW1lO1xuICAgICAgICAgICAgICAgIHZhciBmaXJzdCA9IHJlZi5maXJzdD8gMCA6IDE7XG4gICAgICAgICAgICAgICAgdmFyIG9tb2RlbE5hbWUgPSByZWYubW9kZWw7XG4vLyAgICAgICAgICAgICAgICB2YXIgb21vZGVsID0gZ2V0SW5kZXgob21vZGVsTmFtZSk7XG4gICAgICAgICAgICAgICAgdmFyIGdldHRlciA9IGxpbmtlci5tMm1JbmRleFtpbmRleE5hbWVdWydnZXQnICsgKDEgLSBmaXJzdCldO1xuXG4gICAgICAgICAgICAgICAgY2FjaGVkUHJvcGVydHlCeUV2ZW50cyhLbGFzcy5wcm90b3R5cGUsIHJlZi5tb2RlbCArICdzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRocyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWRzID0gZ2V0dGVyKHRocy5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1cyUFJFU09VUkNFLmZldGNoKG9tb2RlbE5hbWUsIHtpZCA6IGlkc30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldCA9IGdldEluZGV4KG9tb2RlbE5hbWUpLmdldC5iaW5kKElEQltvbW9kZWxOYW1lXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHMgJiYgZ2V0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IExhenkoaWRzKS5tYXAoZ2V0KS5maWx0ZXIodXRpbHMuYm9vbCkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgICAgICAgICAgfSwgbnVsbCwgJ3JlY2VpdmVkLW0ybS0nICsgaW5kZXhOYW1lLCAncmVjZWl2ZWQtJyArIG9tb2RlbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZSh1dGlscy5wbHVyYWxpemUob21vZGVsTmFtZSkpXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRocyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtlci5nZXRNMk0oaW5kZXhOYW1lLCBbdGhzLmlkXSwgZmlyc3QsZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHMgPSBnZXR0ZXIodGhzLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkcy5sZW5ndGgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gob21vZGVsTmFtZSwge2lkIDogaWRzfSxudWxsLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdldCA9IElEQltvbW9kZWxOYW1lXS5nZXQuYmluZChJREJbb21vZGVsTmFtZV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VwdChMYXp5KGlkcykubWFwKGdldCkuZmlsdGVyKHV0aWxzLmJvb2wpLnRvQXJyYXkoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VwdChbXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgICAgICBLbGFzcy5maWVsZHNbdXRpbHMuY2FwaXRhbGl6ZShvbW9kZWxOYW1lKV0gPSB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB1dGlscy5jYXBpdGFsaXplKG9tb2RlbE5hbWUpLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiB1dGlscy5jYXBpdGFsaXplKG9tb2RlbE5hbWUpLFxuICAgICAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgcmVhZGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdNMk0nLFxuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0b3JzOiBbXVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBLbGFzcy5wcm90b3R5cGUudW5saW5rUmVmZXJlbmNlID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG11bHRpcGxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIElEID0gdGhpcy5pZDtcbiAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2VzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLmNvbnN0cnVjdG9yLm5hbWUgPT0gJ0FycmF5Jykge1xuICAgICAgICAgICAgICAgICAgICBtdWx0aXBsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlcyA9IGluc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZSA9IGluc3RhbmNlc1swXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG9tb2RlbCA9IGluc3RhbmNlLmNvbnN0cnVjdG9yLm1vZGVsTmFtZTtcbiAgICAgICAgICAgICAgICBpZiAobXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBMYXp5KGluc3RhbmNlcykucGx1Y2soJ2lkJykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW0lELCB4XVxuICAgICAgICAgICAgICAgICAgICB9KS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBbW0lELCBpbnN0YW5jZS5pZF1dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdChLbGFzcy5tb2RlbE5hbWUgKyAnLycgKyBvbW9kZWwgKyAncy9kZWxldGUnLCB7Y29sbGVjdGlvbjogY29sbGVjdGlvbn0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlLmxpbmtSZWZlcmVuY2UgPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbXVsdGlwbGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgSUQgPSB0aGlzLmlkO1xuICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2UuY29uc3RydWN0b3IubmFtZSA9PSAnQXJyYXknKSB7XG4gICAgICAgICAgICAgICAgICAgIG11bHRpcGxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VzID0gaW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlID0gaW5zdGFuY2VzWzBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgb21vZGVsID0gaW5zdGFuY2UuY29uc3RydWN0b3IubW9kZWxOYW1lO1xuICAgICAgICAgICAgICAgIHZhciBpbmRleE5hbWUgPSBLbGFzcy5tb2RlbE5hbWUgKyAnLycgKyBvbW9kZWw7XG4gICAgICAgICAgICAgICAgaWYgKG11bHRpcGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZWZzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleE5hbWUgaW4gSU5ERVhfTTJNKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWZzID0gTGF6eShpbnN0YW5jZXMpLnBsdWNrKCdpZCcpLmRpZmZlcmVuY2UoTGF6eShJTkRFWF9NMk1baW5kZXhOYW1lXVswXS5nZXQodGhpcy5pZCkpKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaW5kZXhOYW1lID0gb21vZGVsICsgJy8nICsgS2xhc3MubW9kZWxOYW1lO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXhOYW1lIGluIElOREVYX00yTSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcyA9IExhenkoaW5zdGFuY2VzKS5wbHVjaygnaWQnKS5kaWZmZXJlbmNlKExhenkoSU5ERVhfTTJNW2luZGV4TmFtZV1bMF0uZ2V0KHRoaXMuaWQpKSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZWZzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBMYXp5KHJlZnMpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbSUQsIHhdXG4gICAgICAgICAgICAgICAgICAgICAgICB9KS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBXMlBfUE9TVChLbGFzcy5tb2RlbE5hbWUsIG9tb2RlbCArICdzL3B1dCcsIHtjb2xsZWN0aW9uOiBjb2xsZWN0aW9ufSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChpbmRleE5hbWUgaW4gbGlua2VyLm0ybUluZGV4KSAmJiBMYXp5KGxpbmtlci5tMm1JbmRleFtpbmRleE5hbWVdWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZShvbW9kZWwpXShpbnN0YW5jZS5pZCkpLmZpbmQodGhpcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdChLbGFzcy5tb2RlbE5hbWUgKyAnLycgKyBvbW9kZWwgKyAncy9wdXQnLCB7Y29sbGVjdGlvbjogW1t0aGlzLmlkLCBpbnN0YW5jZS5pZF1dfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCduZXctbW9kZWwnLCBLbGFzcyk7XG4gICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ25ldy1tb2RlbC0nICsgS2xhc3MubW9kZWxOYW1lKTtcbiAgICAgICAgcmV0dXJuIEtsYXNzO1xuICAgIH07XG5cbiAgICB0aGlzLmdvdERhdGEgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbEJhY2spIHtcbiAgICAgICAgLy8gcmVjZWl2ZSBhbGwgZGF0YSBmcm9tIGV2ZXJ5IGVuZCBwb2ludFxuICAgICAgICBjb25zb2xlLmluZm8oJ2dvdERhdGEnKTtcbiAgICAgICAgaWYgKHR5cGVvZihkYXRhKSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2RhdGEgJyArIGRhdGEgKyAnIHJlZnVzZWQgZnJvbSBnb3REYXRhKCknKTtcbiAgICAgICAgICAgIGlmIChjYWxsQmFjaykge1xuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsQmFjayhkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBjbGVhbiBkYXRhIGZyb20gcmVsYXRpb25zIGFuZCBwZXJtaXNzaW9ucyBmb3IgdXNpbmcgaXQgYWZ0ZXIgbW9kZWwgcGFyc2luZ1xuICAgICAgICBpZiAoJ19leHRyYScgaW4gZGF0YSl7IGRlbGV0ZSBkYXRhLl9leHRyYSB9XG4gICAgICAgIHZhciBUT09ORSA9IGRhdGEuVE9PTkU7XG4gICAgICAgIHZhciBUT01BTlkgPSBkYXRhLlRPTUFOWTtcbiAgICAgICAgdmFyIE1BTllUT01BTlkgPSBkYXRhLk1BTllUT01BTlk7XG4gICAgICAgIHZhciBQRVJNSVNTSU9OUyA9IGRhdGEuUEVSTUlTU0lPTlM7XG4gICAgICAgIHZhciBQQSA9IGRhdGEuUEE7XG4gICAgICAgIGRlbGV0ZSBkYXRhLlRPT05FO1xuICAgICAgICBkZWxldGUgZGF0YS5UT01BTlk7XG4gICAgICAgIGRlbGV0ZSBkYXRhLk1BTllUT01BTlk7XG4gICAgICAgIGRlbGV0ZSBkYXRhLlBFUk1JU1NJT05TO1xuICAgICAgICBkZWxldGUgZGF0YS5QQTtcbiAgICAgICAgaWYgKCFQQSkgeyBQQSA9IHt9OyB9XG5cbiAgICAgICAgLy8gY2xlYW5pbmcgZnJvbSB1c2VsZXNzIGRlbGV0ZWQgZGF0YVxuICAgICAgICBkYXRhID0gTGF6eShkYXRhKS5maWx0ZXIoZnVuY3Rpb24gKHYsIGspIHtcbiAgICAgICAgICAgIHJldHVybiAoISgnZGVsZXRlZCcgaW4gdikgfHwgKChrIGluIG1vZGVsQ2FjaGUpKSk7XG4gICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoJ20ybScgaW4gZGF0YSkge1xuICAgICAgICAgICAgdmFyIG0ybSA9IGRhdGEubTJtO1xuICAgICAgICAgICAgZGVsZXRlIGRhdGFbJ20ybSddO1xuICAgICAgICB9XG4gICAgICAgIExhenkoZGF0YSkuZWFjaChmdW5jdGlvbiAoZGF0YSwgbW9kZWxOYW1lKSB7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5kZXNjcmliZShtb2RlbE5hbWUsIGZ1bmN0aW9uIChtb2RlbCkge1xuICAgICAgICAgICAgICAgIHZhciBtb2RlbENsYXNzID0gbW9kZWw7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEucmVzdWx0cyAmJiAoZGF0YS5yZXN1bHRzLmxlbmd0aCA+IDApICYmIChkYXRhLnJlc3VsdHNbMF0uY29uc3RydWN0b3IgPT0gQXJyYXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEucmVzdWx0cyA9IExhenkoZGF0YS5yZXN1bHRzKS5tYXAoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTGF6eShtb2RlbENsYXNzLmZpZWxkc09yZGVyKS56aXAoeCkudG9PYmplY3QoKVxuICAgICAgICAgICAgICAgICAgICB9KS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gTGF6eShkYXRhLnJlc3VsdHMpO1xuICAgICAgICAgICAgICAgIHZhciBkZWxldGVkID0gZGF0YS5kZWxldGVkO1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gUEEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIE1QQSA9IFBBW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIExhenkocmVzdWx0cykuZWFjaChmdW5jdGlvbiAocmVjb3JkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVjb3JkLmlkIGluIE1QQSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExhenkoTVBBW3JlY29yZC5pZF0pLmVhY2goZnVuY3Rpb24gKHYsIGspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3JkW2tdID0gdjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBpbmRleGluZyByZWZlcmVuY2VzIGJ5IGl0cyBJRFxuICAgICAgICAgICAgICAgIHZhciBpdGFiID0gZ2V0SW5kZXgobW9kZWxOYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgdGFibGUgPSBpdGFiLnNvdXJjZTtcblxuICAgICAgICAgICAgICAgIC8vIG9iamVjdCBkZWxldGlvblxuICAgICAgICAgICAgICAgIGlmIChkZWxldGVkKXtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlZC5mb3JFYWNoKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRhYmxlW3hdO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbi8qXG4gICAgICAgICAgICAgICAgTGF6eShkZWxldGVkKS5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YWJsZVt4XTtcbiAgICAgICAgICAgICAgICB9KTtcbiovXG4gICAgICAgICAgICAgICAgdmFyIGlkeCA9IHJlc3VsdHMuaW5kZXhCeSgnaWQnKTtcbiAgICAgICAgICAgICAgICB2YXIgaWsgPSBpZHgua2V5cygpO1xuICAgICAgICAgICAgICAgIHZhciBubmV3ID0gaWsuZGlmZmVyZW5jZShpdGFiLmtleXMoKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHgpXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIHZhciB1cGRhdGVkID0gaWsuZGlmZmVyZW5jZShubmV3KTtcbiAgICAgICAgICAgICAgICAvLyByZW1vdmluZyBvbGQgaWRlbnRpY2FsIHZhbHVlc1xuICAgICAgICAgICAgICAgIHVwZGF0ZWQgPSB1cGRhdGVkLmZpbHRlcihmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXV0aWxzLnNhbWVBcyhpZHguZ2V0KHgpLCBpdGFiLmdldCh4KS5hc1JhdygpKTtcbiAgICAgICAgICAgICAgICB9KS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgLy8gY2xhc3NpZnkgcmVjb3Jkc1xuICAgICAgICAgICAgICAgIHZhciBwZXJtcyA9IGRhdGEucGVybWlzc2lvbnMgPyBMYXp5KGRhdGEucGVybWlzc2lvbnMpIDogTGF6eSh7fSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld09iamVjdHMgPSBubmV3Lm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IG1vZGVsQ2xhc3MoaWR4LmdldCh4KSwgcGVybXMuZ2V0KHgpKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8vLyBjbGFzc2lmeWluZyB1cGRhdGVkXG4gICAgICAgICAgICAgICAgLy92YXIgdXBkYXRlZE9iamVjdHMgPSB1cGRhdGVkLm1hcChmdW5jdGlvbih4KXtyZXR1cm4gbmV3IG1vZGVsQ2xhc3MoaWR4LmdldCh4KSxwZXJtcy5nZXQoeCkpfSk7XG4gICAgICAgICAgICAgICAgLy92YXIgdW8gPSB1cGRhdGVkT2JqZWN0cy50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgLy91cGRhdGVkT2JqZWN0cyA9IExhenkodW8pLm1hcChmdW5jdGlvbih4KXtyZXR1cm4gW3gsdGFibGVbeC5pZF1dfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIC8vIFVwZGF0aW5nIHNpbmdsZSBvYmplY3RzXG4gICAgICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBbXTtcbi8vICAgICAgICAgICAgICAgIHZhciBEQVRFRklFTERTID0gTU9ERUxfREFURUZJRUxEU1ttb2RlbE5hbWVdO1xuLy8gICAgICAgICAgICAgICAgdmFyIEJPT0xGSUVMRFMgPSBNT0RFTF9CT09MRklFTERTW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgdXBkYXRlZC5mb3JFYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRJdGVtID0gdGFibGVbeF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRDb3B5ID0gb2xkSXRlbS5jb3B5KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtID0gbmV3IG1vZGVsQ2xhc3MoaWR4LmdldCh4KSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBvbGQgaXRlbSB0byBtYXRjaCBuZXcgaXRlbTtcbiAgICAgICAgICAgICAgICAgICAgTGF6eShtb2RlbC5maWVsZHMpLmtleXMoKS5lYWNoKGZ1bmN0aW9uKGspe1xuICAgICAgICAgICAgICAgICAgICAgICAgb2xkSXRlbVtrXSA9IG5ld0l0ZW1ba107XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkLnB1c2goW25ld0l0ZW0sIG9sZENvcHldKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vLy8gc2VuZGluZyBzaWduYWwgZm9yIHVwZGF0ZWQgdmFsdWVzXG4gICAgICAgICAgICAgICAgaWYgKGNoYW5nZWQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ3VwZGF0ZWQtJyArIG1vZGVsTmFtZSwgY2hhbmdlZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vKioqKioqKiogVXBkYXRlIHVuaXZlcnNlICoqKioqKioqXG4gICAgICAgICAgICAgICAgdmFyIG5vID0gbmV3T2JqZWN0cy50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgTGF6eShubykuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICB0YWJsZVt4LmlkXSA9IHhcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyByZWJ1bGRpbmcgcmV2ZXJzZSBpbmRleGVzXG4gICAgICAgICAgICAgICAgTGF6eShtb2RlbENhY2hlW21vZGVsTmFtZV0ucmVmZXJlbmNlcykuZWFjaChmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIFJFVklEWFttb2RlbE5hbWUgKyAnLicgKyByZWZdID0gSURCW21vZGVsTmFtZV0uZ3JvdXBCeSgnXycgKyByZWYpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIHNlbmRpbmcgZXZlbnRzIGZvciBuZXcgdmFsdWVzXG4gICAgICAgICAgICAgICAgaWYgKG5vLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgnbmV3LScgKyBtb2RlbE5hbWUsIExhenkobm8pLCBkYXRhLnRvdGFsUmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgaWYgKGRlbGV0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgnZGVsZXRlZC0nICsgbW9kZWxOYW1lLCBkZWxldGVkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gc2VuZGluZyBldmVudHMgZm9yIGRhdGEgYXJyaXZlZFxuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ3JlY2VpdmVkLScgKyBtb2RlbE5hbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoVE9PTkUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RPT05FJyk7XG4gICAgICAgICAgICBMYXp5KFRPT05FKS5lYWNoKGZ1bmN0aW9uICh2YWxzLCBtb2RlbE5hbWUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciB1ZHggPSBnZXRVbmxpbmtlZChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFRPTUFOWSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignVE9NQU5ZJyk7XG4gICAgICAgICAgICBMYXp5KFRPTUFOWSkuZWFjaChmdW5jdGlvbiAodmFscywgaW5kZXhOYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoaW5kZXhOYW1lIGluIEFTS0VEX1VOTElOS0VEKSkge1xuICAgICAgICAgICAgICAgICAgICBBU0tFRF9VTkxJTktFRFtpbmRleE5hbWVdID0gTGF6eShbXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIExhenkodmFscykuZWFjaChmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQVNLRURfVU5MSU5LRURbaW5kZXhOYW1lXS5zb3VyY2UucHVzaChpZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTUFOWVRPTUFOWSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignTUFOWVRPTUFOWScpO1xuICAgICAgICAgICAgTGF6eShNQU5ZVE9NQU5ZKS5lYWNoKGZ1bmN0aW9uICh2YWxzLCBpbmRleE5hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3QgPSBwYXJzZUludChpbmRleE5hbWUuc3BsaXQoJ3wnKVsxXSk7XG4gICAgICAgICAgICAgICAgaW5kZXhOYW1lID0gaW5kZXhOYW1lLnNwbGl0KCd8JylbMF07XG4gICAgICAgICAgICAgICAgaWYgKCEoaW5kZXhOYW1lIGluIEFTS0VEX00yTSkpIHtcbiAgICAgICAgICAgICAgICAgICAgQVNLRURfTTJNW2luZGV4TmFtZV0gPSBbe30sIHt9XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIE1JRFggPSBBU0tFRF9NMk1baW5kZXhOYW1lXVtmaXJzdF07XG4gICAgICAgICAgICAgICAgTGF6eSh2YWxzKS5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIE1JRFhbeCArICcnXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIE1JRFhbeF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0ybSkge1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290TTJNKG0ybSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFBFUk1JU1NJT05TKSB7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3RQZXJtaXNzaW9ucyhQRVJNSVNTSU9OUyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2FsbEJhY2spIHtcbiAgICAgICAgICAgIGNhbGxCYWNrKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ2dvdC1kYXRhJyk7XG4gICAgfTtcbiAgICB0aGlzLmdvdFBlcm1pc3Npb25zID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgTGF6eShkYXRhKS5lYWNoKGZ1bmN0aW9uICh2LCByZXNvdXJjZU5hbWUpIHtcbiAgICAgICAgICAgIExhenkodlswXSkuZWFjaChmdW5jdGlvbiAocm93LCBpZCkge1xuICAgICAgICAgICAgICAgIGlmICgocmVzb3VyY2VOYW1lIGluIElEQikgJiYgKGlkIGluIElEQltyZXNvdXJjZU5hbWVdLnNvdXJjZSkpe1xuICAgICAgICAgICAgICAgICAgICBJREJbcmVzb3VyY2VOYW1lXS5nZXQoaWQpLl9wZXJtaXNzaW9ucyA9IExhenkocm93KS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbeCwgdHJ1ZV1cbiAgICAgICAgICAgICAgICAgICAgfSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChMYXp5KHZbMF0pLnNpemUoKSl7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgndXBkYXRlLXBlcm1pc3Npb25zLScgKyByZXNvdXJjZU5hbWUsIExhenkodlswXSkua2V5cygpLnRvQXJyYXkoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmVtaXQoJ3VwZGF0ZS1wZXJtaXNzaW9ucycpO1xuICAgIH07XG5cblxuICAgIHRoaXMuZ290TTJNID0gZnVuY3Rpb24obTJtKXtcbiAgICAgICAgTGF6eShtMm0pLmVhY2goZnVuY3Rpb24oZGF0YSwgaW5kZXhOYW1lKXtcbiAgICAgICAgICAgIHZhciBtMm1JbmRleCA9IGxpbmtlci5tMm1JbmRleFtpbmRleE5hbWVdO1xuICAgICAgICAgICAgTGF6eShkYXRhKS5lYWNoKGZ1bmN0aW9uKG0pe1xuICAgICAgICAgICAgICAgIExhenkobSkuZWFjaChmdW5jdGlvbihkYXRhLHZlcmIpe1xuICAgICAgICAgICAgICAgICAgICBtMm1JbmRleFt2ZXJiXShkYXRhKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgncmVjZWl2ZWQtbTJtJyk7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCdyZWNlaXZlZC1tMm0tJyArIGluZGV4TmFtZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMuZmV0Y2ggPSBmdW5jdGlvbiAobW9kZWxOYW1lLCBmaWx0ZXIsIHRvZ2V0aGVyLCBjYWxsQmFjaykgeyAgLy9cbiAgICAgICAgLy8gaWYgYSBjb25uZWN0aW9uIGlzIGN1cnJlbnRseSBydW5uaW5nLCB3YWl0IGZvciBjb25uZWN0aW9uLlxuICAgICAgICBpZiAobW9kZWxOYW1lIGluIHdhaXRpbmdDb25uZWN0aW9ucyl7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gobW9kZWxOYW1lLCBmaWx0ZXIsIHRvZ2V0aGVyLCBjYWxsQmFjayk7XG4gICAgICAgICAgICB9LDUwMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBmZXRjaGluZyBhc3luY2hyb21vdXMgbW9kZWwgZnJvbSBzZXJ2ZXJcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmRlc2NyaWJlKG1vZGVsTmFtZSwgKGZ1bmN0aW9uKG1vZGVsKXtcbiAgICAgICAgICAgICAgICAvLyBpZiBkYXRhIGNhbWVzIGZyb20gcmVhbHRpbWUgY29ubmVjdGlvblxuICAgICAgICAgICAgICAgIGlmIChXMlBSRVNPVVJDRS5jb25uZWN0aW9uLmNhY2hlZFN0YXR1cy5yZWFsdGltZUVuZFBvaW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIGdldHRpbmcgZmlsdGVyIGZpbHRlcmVkIGJ5IGNhY2hpbmcgc3lzdGVtXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlciA9IGxpc3RDYWNoZS5maWx0ZXIobW9kZWwsZmlsdGVyKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBpZiBzb210aGluZyBpcyBtaXNzaW5nIG9uIG15IGxvY2FsIERCIFxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsdGVyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFzayBmb3IgbWlzc2luZ3MgYW5kIHBhcnNlIHNlcnZlciByZXNwb25zZSBpbiBvcmRlciB0byBlbnJpY2ggbXkgbG9jYWwgREIuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwbGFjaW5nIGxvY2sgZm9yIHRoaXMgbW9kZWxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRpbmdDb25uZWN0aW9uc1ttb2RlbE5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KG1vZGVsTmFtZSArICcvbGlzdCcsIHtmaWx0ZXIgOiBmaWx0ZXJ9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKGRhdGEsY2FsbEJhY2spO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbGVhc2UgbG9ja1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2FpdGluZ0Nvbm5lY3Rpb25zW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmV0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVsZWFzZSBsb2NrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlcjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRwb3N0KG1vZGVsTmFtZSArICcvbGlzdCcsIHNlbmREYXRhLGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWx0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR09UX0FMTC5zb3VyY2UucHVzaChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKGRhdGEsIGNhbGxCYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24obW9kZWxOYW1lLCBpZHMsIGNhbGxCYWNrKXtcbiAgICAgICAgLy8gc2VhcmNoIG9iamVjdHMgZnJvbSBJREIuIElmIHNvbWUgaWQgaXMgbWlzc2luZywgaXQgcmVzb2x2ZSBpdCBieSB0aGUgc2VydmVyXG4gICAgICAgIC8vIGlmIGEgcmVxdWVzdCB0byB0aGUgc2FtZSBtb2RlbCBpcyBwZW5kaW5nLCB3YWl0IGZvciBpdHMgY29tcGxldGlvblxuICAgICAgICBcbiAgICAgICAgaWYgKGlkcy5jb25zdHJ1Y3RvciAhPT0gQXJyYXkpe1xuICAgICAgICAgICAgaWRzID0gW2lkc107XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWYgc29tZSBlbnRpdHkgaXMgbWlzc2luZyBcbiAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gobW9kZWxOYW1lICwge2lkOiBpZHN9LCBudWxsLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgICAgICB2YXIgaXRhYiA9IElEQlttb2RlbE5hbWVdXG4gICAgICAgICAgICBmb3IgKHZhciBpZCBpbiBpZHMpe1xuICAgICAgICAgICAgICAgIHJldC5wdXNoKGl0YWIuc291cmNlW2lkc1tpZF1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhbGxCYWNrKHJldCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0aGlzLmdvdE1vZGVsID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgZm9yICh2YXIgbW9kZWxOYW1lIGluIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBtb2RlbCA9IGRhdGFbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZVsnZGVzY3JpcHRpb246JyArIG1vZGVsTmFtZV0gPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgICAgICAgIG1vZGVsQ2FjaGVbbW9kZWxOYW1lXSA9IG1ha2VNb2RlbENsYXNzKG1vZGVsKTtcbiAgICAgICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBJREIpKSB7XG4gICAgICAgICAgICAgICAgSURCW21vZGVsTmFtZV0gPSBMYXp5KHt9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmRlc2NyaWJlID0gZnVuY3Rpb24obW9kZWxOYW1lLCBjYWxsQmFjayl7XG4gICAgICAgIHZhciByZXQgPSBtb2RlbENhY2hlW21vZGVsTmFtZV07XG4gICAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHJldCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gd2FpdGluZ0Nvbm5lY3Rpb25zKSl7XG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBmYWlsZWRNb2RlbHMpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNhY2hlS2V5ID0gJ2Rlc2NyaXB0aW9uOicgKyBtb2RlbE5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlS2V5IGluIGxvY2FsU3RvcmFnZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdvdE1vZGVsKEpTT04ucGFyc2UobG9jYWxTdG9yYWdlW2NhY2hlS2V5XSkpO1xuICAgICAgICAgICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayhtb2RlbENhY2hlW21vZGVsTmFtZV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdhaXRpbmdDb25uZWN0aW9uc1ttb2RlbE5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcG9zdChtb2RlbE5hbWUgKyAnL2Rlc2NyaWJlJyxudWxsLCBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdE1vZGVsKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2sobW9kZWxDYWNoZVttb2RlbE5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGVsTm90Rm91bmQuaGFuZGxlKG1vZGVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmYWlsZWRNb2RlbHNbbW9kZWxOYW1lXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gd2FpdCBmb3IgY29ubmVjdGlvblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUobW9kZWxOYW1lLCBjYWxsQmFjayk7XG4gICAgICAgICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSAgICAgICAgXG4gICAgfTtcbiAgICB0aGlzLmFkZE1vZGVsSGFuZGxlciA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIGRlY29yYXRvcikge1xuICAgICAgICB2YXIga2V5ID0gdXRpbHMuaGFzaChkZWNvcmF0b3IpO1xuICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gYnVpbGRlckhhbmRsZXJzKSkgYnVpbGRlckhhbmRsZXJzW21vZGVsTmFtZV0gPSBuZXcgSGFuZGxlcigpO1xuICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gYnVpbGRlckhhbmRsZXJVc2VkKSkgYnVpbGRlckhhbmRsZXJVc2VkW21vZGVsTmFtZV0gPSB7fTtcbiAgICAgICAgaWYgKGtleSBpbiBidWlsZGVySGFuZGxlclVzZWRbbW9kZWxOYW1lXSl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidWlsZGVySGFuZGxlclVzZWRbbW9kZWxOYW1lXVtrZXldID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobW9kZWxOYW1lIGluIG1vZGVsQ2FjaGUpIHtcbiAgICAgICAgICAgIGRlY29yYXRvcihtb2RlbENhY2hlW21vZGVsTmFtZV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVpbGRlckhhbmRsZXJzW21vZGVsTmFtZV0uYWRkSGFuZGxlcihkZWNvcmF0b3IpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzID0gZnVuY3Rpb24obW9kZWxOYW1lLCBhdHRyaWJ1dGVzKXtcbiAgICAgICAgdmFyIGFkZFByb3BlcnR5ID0gZnVuY3Rpb24obW9kZWwsIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICBhdHRyaWJ1dGVzLmZvckVhY2goZnVuY3Rpb24odmFsKXtcbiAgICAgICAgICAgIHZhciBrZXkgPSAncEE6JyArIG1vZGVsLm1vZGVsTmFtZSArICc6JyArIHZhbDtcbiAgICAgICAgICAgIHZhciBrYXR0ciA9ICdfXycgKyB2YWw7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kZWwucHJvdG90eXBlLCB2YWwsIHtcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGlmICghKGthdHRyIGluIHRoaXMpKXtcbiAgICAgICAgICAgICAgICAgIHZhciB2ID0gbG9jYWxTdG9yYWdlW2tleSArIHRoaXMuaWRdO1xuICAgICAgICAgICAgICAgICAgdGhpc1trYXR0cl0gPSB2P0pTT04ucGFyc2Uodik6bnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNba2F0dHJdO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgICAgICAgICB0aGlzW2thdHRyXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZVtrZXkgKyB0aGlzLmlkXSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBwZXJzaXN0ZW50QXR0cmlidXRlcykpIHsgcGVyc2lzdGVudEF0dHJpYnV0ZXNbbW9kZWxOYW1lXSA9IFtdOyB9XG4gICAgICAgIHZhciBhdHRycyA9IHBlcnNpc3RlbnRBdHRyaWJ1dGVzW21vZGVsTmFtZV07XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICB2YXIgbmV3QXR0cnMgPSBMYXp5KGF0dHJpYnV0ZXMpLmRpZmZlcmVuY2UoYXR0cnMpLnRvQXJyYXkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBuZXdBdHRycyA9IGF0dHJzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdBdHRycy5sZW5ndGgpe1xuICAgICAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBtb2RlbENhY2hlKXtcbiAgICAgICAgICAgICAgICBhZGRQcm9wZXJ0eShtb2RlbENhY2hlW21vZGVsTmFtZV0sIG5ld0F0dHJzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzKXtcbiAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShhdHRycyxuZXdBdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMub24oJ25ldy1tb2RlbCcsIGZ1bmN0aW9uKG1vZGVsKXtcbiAgICAgICAgaWYgKG1vZGVsLm1vZGVsTmFtZSBpbiBidWlsZGVySGFuZGxlcnMpe1xuICAgICAgICAgICAgYnVpbGRlckhhbmRsZXJzW21vZGVsLm1vZGVsTmFtZV0uaGFuZGxlKG1vZGVsQ2FjaGVbbW9kZWwubW9kZWxOYW1lXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vZGVsLm1vZGVsTmFtZSBpbiBwZXJzaXN0ZW50QXR0cmlidXRlcyl7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5hZGRQZXJzaXN0ZW50QXR0cmlidXRlcyhtb2RlbC5tb2RlbE5hbWUpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLnF1ZXJ5ID0gZnVuY3Rpb24obW9kZWxOYW1lLCBmaWx0ZXIsIHRvZ2V0aGVyLCBjYWxsQmFjayl7XG4gICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICB0aGlzLmRlc2NyaWJlKG1vZGVsTmFtZSxmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgICAgICAvLyBhcnJheWZpeSBhbGwgZmlsdGVyIHZhbHVlc1xuICAgICAgICAgICAgZmlsdGVyID0gTGF6eShmaWx0ZXIpLm1hcChmdW5jdGlvbih2LGspeyByZXR1cm4gW2ssQXJyYXkuaXNBcnJheSh2KT92Olt2XV19KS50b09iamVjdCgpO1xuICAgICAgICAgICAgdmFyIGZpbHRlckZ1bmN0aW9uID0gdXRpbHMubWFrZUZpbHRlcihtb2RlbCwgZmlsdGVyKTtcbiAgICAgICAgICAgIHZhciBpZHggPSBnZXRJbmRleChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgdGhzLmZldGNoKG1vZGVsTmFtZSxmaWx0ZXIsdG9nZXRoZXIsIGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgIGNhbGxCYWNrKGlkeC5maWx0ZXIoZmlsdGVyRnVuY3Rpb24pLnZhbHVlcygpLnRvQXJyYXkoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICB9O1xuICAgIHRoaXMuZGVsZXRlID0gZnVuY3Rpb24obW9kZWxOYW1lLCBpZHMsIGNhbGxCYWNrKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHBvc3QobW9kZWxOYW1lICsgJy9kZWxldGUnLCB7IGlkIDogaWRzfSwgY2FsbEJhY2spO1xuICAgIH07XG5cbiAgICB0aGlzLmNvbm5lY3QgPSBmdW5jdGlvbiAoY2FsbEJhY2spIHtcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGlvbi5pc0xvZ2dlZEluKSB7XG4gICAgICAgICAgICBjYWxsQmFjaygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0aW9uLmNvbm5lY3QoY2FsbEJhY2spO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuZnVuY3Rpb24gcmVXaGVlbE9STShlbmRQb2ludCwgbG9naW5GdW5jKXtcbiAgICB0aGlzLiRvcm0gPSBuZXcgYmFzZU9STShuZXcgdXRpbHMucmVXaGVlbENvbm5lY3Rpb24oZW5kUG9pbnQsIGxvZ2luRnVuYyksdGhpcyk7XG4gICAgdGhpcy5vbiA9IHRoaXMuJG9ybS5vbi5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy5lbWl0ID0gdGhpcy4kb3JtLmVtaXQuYmluZCh0aGlzLiRvcm0pO1xuICAgIHRoaXMudW5iaW5kID0gdGhpcy4kb3JtLnVuYmluZC5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy5vbmNlID0gdGhpcy4kb3JtLm9uY2U7XG4gICAgdGhpcy5hZGRNb2RlbEhhbmRsZXIgPSB0aGlzLiRvcm0uYWRkTW9kZWxIYW5kbGVyLmJpbmQodGhpcy4kb3JtKTtcbiAgICB0aGlzLmFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzID0gdGhpcy4kb3JtLmFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzLmJpbmQodGhpcy4kb3JtKTtcbiAgICB0aGlzLnV0aWxzID0gdXRpbHM7XG4gICAgdGhpcy5sb2dvdXQgPSB0aGlzLiRvcm0uY29ubmVjdGlvbi5sb2dvdXQuYmluZCh0aGlzLiRvcm0uY29ubmVjdGlvbik7XG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbigpe1xuICAgIHZhciBjb25uZWN0aW9uID0gdGhpcy4kb3JtLmNvbm5lY3Rpb247XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihjYWxsQmFjayxyZWplY3Qpe1xuICAgICAgICBjb25uZWN0aW9uLmNvbm5lY3QoY2FsbEJhY2spO1xuICAgIH0pKTtcbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKGFjY2VwdCxyZWplY3Qpe1xuICAgICAgICB0aGlzLiRvcm0uY29ubmVjdGlvbi5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQsIGFjY2VwdCk7ICAgIFxuICAgIH0pLmJpbmQodGhpcykpO1xuICAgIFxufTtcblxucmVXaGVlbE9STS5wcm90b3R5cGUubG9nb3V0ID0gZnVuY3Rpb24odXJsKXtcbiAgICByZXR1cm4gdGhpcy4kb3JtLmNvbm5lY3Rpb24ubG9nb3V0KCk7XG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmdldE1vZGVsID0gZnVuY3Rpb24obW9kZWxOYW1lKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHNlbGYuJG9ybS5jb25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgc2VsZi4kb3JtLmRlc2NyaWJlKG1vZGVsTmFtZSxhY2NlcHQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihtb2RlbE5hbWUsIGlkcyl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBzaW5nbGUgPSBmYWxzZTtcbiAgICB2YXIgbW9kTmFtZSA9IG1vZGVsTmFtZTtcbiAgICBpZiAoaWRzLmNvbnN0cnVjdG9yICE9PSBBcnJheSl7XG4gICAgICAgIHNpbmdsZSA9IHRydWU7XG4gICAgICAgIGlkcyA9IFtpZHNdXG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCl7XG4gICAgICAgIHRyeXtcbiAgICAgICAgICAgIHNlbGYuJG9ybS5jb25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKHNpbmdsZSl7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5nZXQobW9kTmFtZSwgaWRzLCBmdW5jdGlvbihpdGVtcyl7IFxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0KGl0ZW1zWzBdKTt9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi4kb3JtLmdldChtb2ROYW1lLCBpZHMsIGFjY2VwdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5xdWVyeSA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIGZpbHRlciwgcmVsYXRlZCl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCl7XG4gICAgICAgIHZhciB0b2dldGhlciA9IG51bGw7XG4gICAgICAgIGlmIChyZWxhdGVkICYmIChyZWxhdGVkLmNvbnN0cnVjdG9yID09PSBBcnJheSkgJiYgKHJlbGF0ZWQubGVuZ3RoKSl7XG4gICAgICAgICAgICB0b2dldGhlciA9IHJlbGF0ZWQ7XG4gICAgICAgIH0gZWxzZSBpZiAocmVsYXRlZCAmJiAocmVsYXRlZC5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSAmJiAocmVsYXRlZC5sZW5ndGgpKXtcbiAgICAgICAgICAgIHRvZ2V0aGVyID0gcmVsYXRlZC5zcGxpdCgnLCcpO1xuICAgICAgICB9XG4gICAgICAgIHRyeXtcbiAgICAgICAgICAgIHNlbGYuJG9ybS5jb25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgc2VsZi4kb3JtLnF1ZXJ5KG1vZGVsTmFtZSwgZmlsdGVyLCB0b2dldGhlciwgYWNjZXB0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfVxuICAgIH0pXG59O1xuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAobW9kZWxOYW1lLCBpZHMpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3Qpe1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICBzZWxmLiRvcm0uY29ubmVjdChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5kZWxldGUobW9kZWxOYW1lLCBpZHMsIGFjY2VwdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KVxufTtcblxucmVXaGVlbE9STS5wcm90b3R5cGUuZ2V0TG9nZ2VkVXNlciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBpZiAodGhpcy4kb3JtLmNvbm5lY3Rpb24uY2FjaGVkU3RhdHVzLnVzZXJfaWQpXG4gICAgICAgIHJldHVybiB0aGlzLmdldCgnYXV0aF91c2VyJyx0aGlzLiRvcm0uY29ubmVjdGlvbi5jYWNoZWRTdGF0dXMudXNlcl9pZCk7XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCkge1xuICAgICAgICAgICAgc2VsZi5vbmNlKCdsb2dnZWQtaW4nLGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmdldCgnYXV0aF91c2VyJywgdXNlcikudGhlbihhY2NlcHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUuJHNlbmRUb0VuZHBvaW50ID0gZnVuY3Rpb24gKHVybCwgZGF0YSl7XG4gICAgcmV0dXJuIHRoaXMuJG9ybS4kcG9zdCh1cmwsIGRhdGEpO1xufVxuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCl7XG4gICAgcmV0dXJuIHRoaXMuJG9ybS5jb25uZWN0aW9uLmxvZ2luKHVzZXJuYW1lLHBhc3N3b3JkKTtcbn1cbiJdfQ==
