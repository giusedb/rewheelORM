!function(t,n,e){"use strict";function i(){this.handlers=[],this.strHandlers={}}function o(){var t={},e={},i=0;this.on=function(n,o){n in t||(t[n]=new Array);var r=i++;return t[n].push(o),e[r]=o,r},this.emit=function(n){if(n in t){var e=Array.prototype.slice.call(arguments,1);t[n].forEach(function(t){t.apply(null,e)})}},this.unbind=function(i){var o=0;if(i in e){var r=e[i+""];n(t).each(function(t,n){var e=[];for(var i in t)t[i]===r&&(e.push(i),o++);e.reverse().forEach(function(n){t.splice(n,1)})})}return delete e[i],o}}function r(){return new Proxy({},{get:function(t,n){return"string"==typeof n?"toString"===n?g:r():t[n]}})}function s(t,n){this.getLogin=n,this.events=new o,this.$POST=v.bind(this),this.options={endPoint:t},this.on=this.events.on.bind(this)}function a(){var t=!1;this.touch=function(){t=!0},this.touched=function(){var n=t;return t=!1,n}}function c(t,e,i){if(!e)var e=[];var o=[];this.ask=function(i,r){n(e).contains(i)||(o.push(i),r||e.push(i),t.touch())},this.getAskedIndex=function(){return e},this.missings=function(){return n(o.splice(0,o.length)).unique().toArray()}}function u(t,e,i,o,r){var s=new a,u={},l={},d={},p={},h={};this.mainIndex=u,this.foreignKeys=l,this.m2m=d,this.m2mIndex=p,this.permissions=h,t.on("model-definition",function(t){var e=r.getIndexFor(t.name,"id");u[t.name]=new c(s,e,"mainIndex."+t.name),h[t.name]=new c(s,null,"permissions."+t.name),n(t.references).each(function(n){var e=t.name+"_"+n.id;l[e]=new c(s,r.getIndexFor(n.to,"id"),n.to+".id foreignKeys."+e)}),n(t.referencedBy).each(function(t){var n=t.by+"."+t.id;l[n]=new c(s,r.getIndexFor(t.by,t.id),t.by+"."+t.id+" foreignKeys."+n)}),n(t.manyToMany).each(function(t){t.indexName in d||(d[t.indexName]=[new c(s,null,"m2m."+t.indexName+"[0]"),new c(s,null,"m2m."+t.indexName+"[1]")]),t.indexName in p||(p[t.indexName]=new f(t,d[t.indexName]))})});var m=function(t,n,i,r){o.$post((n?y.reverse("/",t):t)+"s/list",{collection:i},function(n){o.gotData(n,r),delete e[t]})},g=function(t,i,o,r){n(i).each(d[t][o].ask.bind(d[t][o])),i=d[t][o].missings(),i.length?(e[t]=1,m(t,o,i,r)):r&&r()};this.getM2M=g;var v=function(){if(s.touched()){if(n(e).values().sum())return void s.touch();var t=!1;n(d).each(function(e,i){n(e).each(function(e,r){var s=e.missings();if(s=n(s).filter(Boolean).map(function(t){return parseInt(t)}).toArray(),s.length){var a=p[i],c=a["get"+(1-r)].bind(a);t=!0,m(i,r,s,function(t){var e=s.map(c);if(e.length){var a=i.split("/")[1-r];o.describe(a,function(){n(e).flatten().unique().each(function(t){u[a].ask(t,!0)})})}})}})}),n(u).each(function(e,r){var s=e.missings();if(s.length){t=!0;r in i?i[r].keys():n();o.fetch(r,{id:s},null,y.noop)}}),n(l).map(function(t,n){return[n,t.missings()]}).filter(function(t){return t[1].length}).each(function(n){t=!0;var e=n[1],i=n[0],r=i.split("."),s=r[0],a=r[1],c={};c[a]=e,o.fetch(s,c)}),n(n(h).map(function(t,n){return[n,t.missings()]}).filter(function(t){return t[1].length}).toObject()).each(function(i,r){t=!0,i.length&&(e[r]=1,o.$post(r+"/my_perms",{ids:n(i).unique().toArray()},function(t){o.gotPermissions(t.PERMISSIONS),delete e[r]}))})}};setInterval(v,50)}function l(){var t={},e={},i={},o=function(t,e,i){var o=[];if(i)for(var r in t)for(var s in e)o.push(n([t[r],e[s]]).flatten().toArray());else for(var r in t)for(var s in e)o.push([t[r],e[s]]);return o},r=function(t){for(var n=!1,e=t[0],i=1;i<t.length;++i)e=o(e,t[i],n),n=!0;return e},s=function(t){var e=r(n(t).values().toArray()),i=n(t).keys().toArray();return e.map(function(t){var n={};return i.forEach(function(e,i){n[e]=t[i]}),n})},a=function(t,e,i){var o=t.modelName,r=this.getIndexFor,s=(n(e).map(function(t,n){return[n,o+"."+n]}).toObject(),n(e).keys().map(function(t){return[t,r(o,t)]}).toObject());for(var a in e){var c=n(e[a]).difference(s[a]).toArray();if(c.length){var u=n([[a,c]]).toObject();return i||Array.prototype.push.apply(s[a],c),u}return null}},c=function(t,e){t.name in i||(i[t.name]=[]);var o=i[t.name],r=n(e).size();o.filter(y.makeFilter(t,e," && ",!0)).filter(function(t){n(t).size()>r})};this.filter=function(o,r){var u=o.modelName,l=n(r).size();switch(l){case 0:var f=t[u];return t[u]=!0,u in e&&delete e[u],u in i&&delete i[u],f?null:{};case 1:var d=a.call(this,o,r);return c.call(this,o,r),d}var p=this,h=n(r).keys().some(function(t){var n={};return n[t]=r[t],null==a.call(p,o,n,!0)});if(h)return null;u in i||(i[u]=[]);var m=s(r),g=i[u].filter(y.makeFilter(o,r," || ",!0));if(g.length){var v=[];for(var w in g)v.push.apply(v,m.filter(y.makeFilter(o,g[w]," && ",!0)));var b=n(m).difference(v).toArray()}else var b=m;if(b.length){i[u].push.apply(i[u],b);var b=n(r).keys().map(function(t){var e=n(b).pluck(t).unique().toArray();return[t,e.length?e:r[t]]}).toObject();return c(o,b),b}return null},this.getIndexFor=function(t,n){var i=t+"."+n;return i in e||(e[i]=[]),e[i]}}function f(t,e){var i=[];this.add=i.push.bind(i),this.add=function(t){console.log("adding "+t),n(i).find(t)||i.push(t)},this.get0=function(t){return e[1].ask(t),n(i).filter(function(n){return n[0]===t}).pluck("1").toArray()},this.get1=function(t){return e[0].ask(t),n(i).filter(function(n){return n[1]===t}).pluck("0").toArray()},this["get"+y.capitalize(t.indexName.split("/")[1])]=this.get1,this["get"+y.capitalize(t.indexName.split("/")[0])]=this.get0,this.del=function(t){for(var n=i.length,e=null,o=0;o<n;o++)if(i[o][0]===t[0]&&i[o][1]===t[1]){e=o;break}e&&i.splice(o,1),console.log("deleting ",t)}}function d(t,e,i,o){var r=Array.prototype.slice.call(arguments,4),s={};n(r).each(function(n){t.orm.on(n,function(){s={}})});var a={get:function(){return this.id in s||(s[this.id]=i.call(this)),s[this.id]}};o&&(a.set=function(t){t!==s[this.id]&&(o.call(this,t),this.id in s&&delete s[this.id])}),Object.defineProperty(t,e,a)}function p(t){this.resource=t._resource,this.formIdx=t.formIdx,this.fields=t.errors}function h(t,n){this.$orm=new w(new y.reWheelConnection(t,n),this),this.on=this.$orm.on.bind(this.$orm),this.emit=this.$orm.emit.bind(this.$orm),this.unbind=this.$orm.unbind.bind(this.$orm),this.addModelHandler=this.$orm.addModelHandler.bind(this.$orm),this.addPersistentAttributes=this.$orm.addPersistentAttributes.bind(this.$orm),this.utils=y}i.prototype.addHandler=function(t){var n=y.hash(t.toString());n in this.strHandlers||(this.strHandlers[n]=t,this.handlers.push(t))},i.prototype.handle=function(){var t=Array.prototype.slice.call(arguments,0);this.handlers.forEach(function(n){n.apply(null,t)})},i.prototype.handleBy=function(){var t=Array.prototype.slice.call(arguments,1),n=arguments[0];this.handlers.forEach(function(e){e.apply(n,t)})};var m=0,g=function(){return""},v=function(t,n,e,i,o){var r={accepts:"application/json",url:t,data:JSON.stringify(n),dataType:"json",success:e,error:i,method:"POST",contentType:"application/json"};return o&&(r.headers=o,r.crossDomain=!0),$.ajax(r)};s.prototype.status=function(t,n){if("lastRWTStatus"in localStorage&&!n){try{var e=JSON.parse(localStorage.lastRWTStatus);for(var i in e)this.options[i]=e[i]}catch(n){return this.status(t,!0)}return t&&t(e)}if(this._status_calling){var o=this;return setTimeout(function(){o.status(t)},50)}if(!this.options||!this.options.timestamp){this._status_calling=!0;var o=this;return this.$post("api/status",null,function(n){localStorage.lastRWTStatus=JSON.stringify(n),o._status_calling=!1;for(var e in n)o.options[e]=n[e];if(!n.user_id&&o.getLogin){var i=o.getLogin();i.constructor===Object&&o.login(i.username,i.password).then(function(n){for(var e in n)o.options[e]=n[e];localStorage.lastRWTStatus=JSON.stringify(n),t&&t(n)})}else t&&t(o.options)})}t&&t(this.options)},s.prototype.$post=function(t,n,e){var i=this;if(this.options&&this.options.token&&(n||(n={})),this.options.token){({token:this.options.token,application:this.options.application})}else;var o=new Promise(function(o,r){y.xdr(i.options.endPoint+t,n,i.options.application,i.options.token).then(function(r){i.events.emit("http-response",r.responseText,r.status,t,n),i.events.emit("http-response-"+r.status,r.responseText,t,n),r.responseData&&i.events.emit("http-response-"+r.status+"-json",r.responseData,t,n),e&&e(r.responseData||r.responseText),o(r.responseData||r.responseText)},function(e){e.responseData?(i.events.emit("error-json",e.responseData,e.status,t,n,e),i.events.emit("error-json-"+e.status,e.responseData,t,n,e)):(i.events.emit("error-http",e.responseText,e.status,t,n,e),i.events.emit("error-http-"+e.status,e.responseText,t,n,e)),r(e.responseData||e.responseText)})});return o},s.prototype.login=function(t,n){var e=this.options.endPoint+"api/login",i=this;return new Promise(function(o,r){y.xdr(e,{username:t,password:n},null,i.options.token,!0).then(function(t){var n=t.responseData;for(var e in n)i.options[e]=n[e];o(n)},function(t){r(t.responseData||responseText)})})},s.prototype.connect=function(t){var n=this,e=function(t){t.wsConnection=new y.wsConnect(t.options),t.wsConnection.onConnect(function(){t.events.emit("ws-connected",t.wsConnection)}),t.wsConnection.onDisconnect(function(){setTimeout(function(){e(t)},1e3)})};return this.status(function(i){"token"in n.options?t&&t(i):(console.log("connecting to "+n.options.endPoint),n.options.username&&n.options.password&&n.login(n.options.username,n.options.password,function(n){t&&t(n),console.log("renewing connection")})),i.token&&i.realtimeEndPoint&&!n.wsConnection&&e(n)})};var y={renameFunction:function(t,n){return new Function("return function (call) { return function "+t+" () { return call(this, arguments) }; };")()(Function.apply.bind(n))},cached:function(t,n){function e(){return this[n]||(this[n]=t.call(this,[arguments])),this[n]}return n||(n="_"+m++),e},$POST:v,reWheelConnection:s,log:function(){console.log(arguments)},xdr:function(t,e,i,o,r){return new Promise(function(i,s){var a;e||(e={}),XMLHttpRequest?(a=new XMLHttpRequest,a.onreadystatechange=function(){if(4===a.readyState){try{var t=JSON.parse(a.responseText)}catch(t){var t=null}var n={responseData:t,responseText:a.responseText,status:a.statusText,request:a};a.status>=200&&a.status<400?i(n):s(n)}}):XDomainRequest?(a=new XDomainRequest,a.onload=function(){i(a.responseText,a.statusText,a)}):s(new Error("CORS not supported")),a.open("POST",t,!0),a.onerror=s,a.setRequestHeader("Accept","application/json"),o&&(e.__token__=o),r?(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e=n(e).map(function(t,n){return n+"="+encodeURI(t.toString())}).toArray().join("&")):(a.setRequestHeader("Content-Type","text/plain"),e=n(e).size()?JSON.stringify(e):""),a.send(e)})},capitalize:function(t){return t[0].toUpperCase()+t.slice(1).toLowerCase()},hash:function(t){t=t.toString();for(var n=1,e=0;e<t.length;e++)n*=1+t.charCodeAt(e);return(n%34958374957).toString()},makeFilter:function(t,e,i,o){if(i||(i=" && "),0===n(e).size())return function(t){return!0};var r=n(e).map(function(e,i){return e||(e=[null]),Array.isArray(e)||(e=[e]),o||"reference"!==t.fields[i].type?"string"===t.fields[i].type&&(e=e.map(JSON.stringify)):(i="_"+i,e=n(e).map(function(t){return t&&t.constructor!==Number?t.id:t}).toArray()),"("+n(e).map(function(t){return"(x."+i+" === "+t+")"}).join(" || ")+")"}).toArray().join(i);return new Function("x","return "+r)},sameAs:function(t,n){for(var e in t)if(n[e]!=t[e])return!1;return!0},wsConnect:function(t){if(t){var n=this;this.handlers={wizard:new i,onConnection:new i,onDisconnection:new i,onMessageJson:new i,onMessageText:new i},this.onWizard=this.handlers.wizard.addHandler.bind(this.handlers.wizard),this.onConnect=this.handlers.onConnection.addHandler.bind(this.handlers.onConnection),this.onDisconnect=this.handlers.onDisconnection.addHandler.bind(this.handlers.onDisconnection),this.onMessageJson=this.handlers.onMessageJson.addHandler.bind(this.handlers.onMessageJson),this.onMessageText=this.handlers.onMessageText.addHandler.bind(this.handlers.onMessageText),this.options=t;var o=new e(t.realtimeEndPoint);o.onopen=function(t){console.log("open : "+t),o.tenant(),n.handlers.onConnection.handle(t)},o.onmessage=function(t){if("message"==t.type)try{n.handlers.onMessageJson.handle(JSON.parse(t.data))}catch(e){n.handlers.onMessageText.handle(t.data)}else console.log(t)},o.onclose=function(){setTimeout(y.wsConnect,1e3),n.handlers.onDisconnection.handle()},o.tenant=function(){o.send("TENANT:"+n.options.application+":"+n.options.token)}}},pluralize:function(t,n){return t+"s"},beforeCall:function(t,n){var e=function(){n().then(t)};return e},cleanStorage:function(){n(localStorage).keys().each(function(t){delete localStorage[t]})},reverse:function(t,n){return n.split(t).reverse().join(t)},permutations:function(t){for(var n=[],e=t.length-1;e>=0;e--)for(var i=t.length-1;i>=0;i--)e!==i&&n.push([t[e],t[i]]);return n},bool:Boolean,noop:function(){},tzOffset:6e4*(new Date).getTimezoneOffset(),transFieldType:{date:function(t){return new Date(1e3*t+y.tzOffset)},datetime:function(t){return new Date(1e3*t+y.tzOffset)},string:function(t){return t.toString()},text:function(t){return t.toString()},integer:function(t){return parseInt(t)},float:function(t){return parseFloat(t)}},mock:r},w=function(t,e){function o(t,n,e){this.klass=n,this.permissions=[],this.id=t;for(var i in e)this.push.apply(this,[i,e[i]])}if(t.constructor===String)var r=new s(t);else if(t.constructor===y.reWheelConnection)var r=t;this.connection=r,r.on("connected",function(){this.connected=!0});var a=r.events;this.on=a.on.bind(this),this.emit=a.emit.bind(this),this.unbind=a.unbind.bind(this),this.$post=r.$post.bind(r),a.on("ws-connected",function(t){console.info("Websocket connected"),t.onMessageJson(c.gotData.bind(c)),t.onMessageText(function(t){console.info("WS message : "+t)})}),a.on("ws-disconnected",function(t){console.error("Websocket disconnected")}),a.on("error-json-404",function(t,n,e,i){console.error("JSON error ",JSON.stringify(t)),delete N[n.split("/")[0]]});var c=this,f={auth_group:n({})},h={},m={},g={},v={},w={},b={},N={},A=new l(n),x=new u(a,N,f,this,A);this.validationEvent=a.on("error-json-513",function(t,n,e,i){currentContext.savingErrorHanlder&&currentContext.savingErrorHanlder(new p(t))});var S=function(t){return t in f?f[t]:(f[t]=n({}),f[t])},O=function(t){return t in UNLINKED?UNLINKED[t]:(UNLINKED[t]={},UNLINKED[t])};o.prototype.save=function(t){var e={permissions:n(this.permissions).map(function(t){return[t[0].id,t[1]]}).toObject()};e.id=this.id;this.klass.modelName;c.$post(this.klass.modelName+"/set_permissions",e,function(n,e,i,o){t(n)})},o.prototype.push=function(t,e){var i=n(e),o=n(this.klass.allPermissions).map(function(t){return[t,i.contains(t)]}).toObject(),r=n(this.permissions).map(function(t){return t[0].id});r.contains(t)?this.permissions[r.indexOf(t)][1]=o:this.permissions.push([f.auth_group.get(t),o])};var T=function(t){var i=n(t.fields);t.privateArgs&&(i=i.merge(t.privateArgs)),c.emit("model-definition",t);var r="if (!row) { row = {}};\n";r+=t.references.map(function(t){return"this._"+t.id+" = row."+t.id+";"}).join(";\n"),r+=i.map(function(t,n){return"date"==t.type||"datetime"==t.type?"this."+n+" = row."+n+"?new Date(row."+n+" * 1000 - "+y.tzOffset+"):null;\n":"boolean"==t.type?"this."+n+" = (row."+n+' === "T") || (row.'+n+" === true);\n":"this."+n+" = row."+n+";\n"}).toString("\n"),r+="if (permissions) {this._permissions = permissions && Lazy(permissions).map(function (x) { return [x, true] }).toObject();}";var s=new Function("row","permissions",r);s.prototype.orm=e,s.ref_translations={},s.modelName=t.name,s.references=n(t.references).pluck("id").toArray(),s.inverse_references=t.referencedBy.map(function(t){return t.by+"_"+t.id+"_set"}),s.referents=t.referencedBy.map(function(t){return[t.by,t.id]}),s.fieldsOrder=t.fieldOrder,s.allPermissions=t.permissions,n(t.representation).size()&&(s.prototype.toString=new Function("return this."+n(t.representation).toString(' + " " + this.'))),s.prototype.toUpperCase=function(){return this.toString().toUpperCase()},s.prototype.toLowerCase=function(){return this.toString().toLowerCase()},s.prototype.delete=function(){return e.delete(this.constructor.modelName,[this.id])},Object.defineProperty(s.prototype,"permissions",{get:function(){return this._permissions?this._permissions:void x.permissions[this.constructor.modelName].ask(this.id)}}),s.prototype.all_perms=function(t){var e=this.id;c.$post(this.constructor.modelName+"/all_perms",{id:this.id},function(i){var r=i,a={},u=n(r).pluck("group_id").unique().map(function(t){return""+t}).difference(f.auth_group.keys()).toArray();n(r).groupBy(function(t){return t.group_id}).each(function(t,e){a[e]=n(t).pluck("name").toArray()});var l=function(n){t(new o(e,s,a))};u.length?c.get("auth_group",u,l):l()})},s.prototype.save=function(t){var e=this.asRaw(),i=s.fields,o=this.id,r=this.constructor.modelName;if(t)for(var a in t)e[a]=t[a];n(s.fieldsOrder).filter(function(t){return!i[t].writable}).each(function(t){t in e&&delete e[t]});var u=c.$post(r+(o?"/post":"/put"),e);return t&&t.constructor===Function&&(u.context.savingErrorHanlder=t),u},s.prototype.copy=function(){var t=new this.constructor(this.asRaw());return t._permissions=this._permissions,t};var u="return {\n"+n(t.references).map(function(t){return t.id+" : this._"+t.id}).concat(i.map(function(t,n){return"date"==t.type||"datetime"==t.type?n+" : (this."+n+"?(Math.round(this."+n+".getTime() - this."+n+".getTimezoneOffset() * 60000) / 1000):null)":"boolean"==t.type?n+" : this."+n+'?"T":"F"':n+" : this."+n})).toString(",\n")+"};";s.prototype.asRaw=new Function(u),s.saveMulti=function(t,e,i){var o=[],r=n(s.fields).filter(function(t){return!t.writable}).pluck("id").toArray();n(t).map(function(t){return t.asRaw()}).each(function(t){n(r).each(function(n){delete t[n]}),o.push(t)}),c.$post(s.modelName,"put",{multiple:o,formIdx:c.formIdx++},function(t){c.gotData(t);var i=f[s.modelName],o=n(t[s.modelName].results).pluck("id").map(function(t){return i.get(t)}).toArray();e&&e(o)},i)},"extra_verbs"in t&&n(t.extra_verbs).each(function(t){var e=t[0],i=t[1],o="data = {id : this.id";i.length&&(o+=", "+n(i).map(function(t){return t+" : "+t}).join(",")),o+="};",i.push("cb"),s.prototype[e]=new Function(i,o+'W2S.W2P_POST(this.constructor.modelName,"'+e+'", data,function(data,status,headers,x){try{\n   if (!headers("nomodel")) {window.W2S.gotData(data,cb);}\n   else {if (cb) {cb(data)}}\n} catch(e){\nif (cb) {cb(data);}\n}\n});\n')}),"privateArgs"in t&&(s.privateArgs=n(t.privateArgs).keys().map(function(t){return[t,!0]}).toObject(),s.prototype.savePA=function(t){var e=this,i={id:this.id},o=this.constructor.privateArgs,r=this.constructor.fields,s=(new this.constructor(t).asRaw(),n(o).keys().map(function(t){return[t,r[t]]}).toObject());n(t).each(function(t,n){n in o&&s[n].writable&&(i[n]=t)}),c.$post(this.constructor.modelName+"/savePA",i,function(){n(i).each(function(t,n){e[n]=t})})}),w[s.modelName]=s;for(var l in t.fields)t.fields[l].id=l;return s.fields=n(t.fields).concat(n(t.privateArgs)).concat(n(t.references).tap(function(t){t.type=t.type||"reference"})).indexBy("id").toObject(),n(s.fields).each(function(t){t.widget||("reference"===t.type?t.widget="choices":t.widget=t.type)}),n(t.references).each(function(t){var n=t.to,i="_"+t.id;d(s.prototype,t.id,function(){if(!(n in f)){var t=this;c.describe(n,function(e){x.mainIndex[n].ask(t[i],!0)})}var e=n in f&&this[i]&&f[n].get(this[i]);return!e&&n in x.mainIndex?(x.mainIndex[n].ask(this[i],!0),y.mock()):e},function(e){if(e&&e.constructor.modelName!=n)throw new TypeError("You can assign only "+n+" to "+t.id);this[i]=e.id},"new-"+n,"deleted-"+n,"updated-"+n,"new-model-"+n),s.prototype["get"+y.capitalize(t.id)]=function(){return e.get(n,this[i])}}),n(t.referencedBy).each(function(t){var n=t.by+"."+t.id,i=t.by+"_"+y.pluralize(t.id),o=t.by;s.prototype.hasOwnProperty(i)?$log.error("Tryed to redefine property "+i+"s for "+s.modelName):d(s.prototype,i,function(){var t=o in f?h[n].get(this.id+""):null;return x.foreignKeys[n].ask(this.id,!0),t},null,"new-"+o,"updated-"+o,"deleted-"+o),s.prototype["get"+y.capitalize(y.pluralize(t.by))]=function(){var n={};return n[t.id]=[this.id],e.query(t.by,n)}}),t.manyToMany&&(n(t.manyToMany).each(function(t){var e=t.indexName,i=t.first?0:1,o=t.model,r=x.m2mIndex[e]["get"+(1-i)];d(s.prototype,t.model+"s",function(){var t=this,e=[],i=r(t.id),s=null;return i.length&&(s=S(o).get.bind(f[o])),i&&s&&(e=n(i).map(s).filter(y.bool).toArray()),e},null,"received-m2m-"+e,"received-"+o),s.prototype["get"+y.capitalize(y.pluralize(o))]=function(){var t=this;return new Promise(function(s,a){try{x.getM2M(e,[t.id],i,function(e){var i=r(t.id);i.length?c.fetch(o,{id:i},null,function(){var t=f[o].get.bind(f[o]);s(n(i).map(t).filter(y.bool).toArray())}):s([])})}catch(t){console.error(t),a(t)}})},s.fields[y.capitalize(o)]={id:y.capitalize(o),name:y.capitalize(o),writable:!0,readable:!0,type:"M2M",validators:[]}}),s.prototype.unlinkReference=function(t){var e=!1,i=this.id,o=[];"Array"==t.constructor.name&&(e=!0,o=t,t=o[0]);var r=t.constructor.modelName;if(e)var a=n(o).pluck("id").map(function(t){return[i,t]}).toArray();else var a=[[i,t.id]];c.$post(s.modelName+"/"+r+"s/delete",{collection:a})},s.prototype.linkReference=function(t){var e=!1,i=this.id,o=[];"Array"==t.constructor.name&&(e=!0,o=t,t=o[0]);var r=t.constructor.modelName,a=s.modelName+"/"+r;if(e){var u=[];if(a in INDEX_M2M&&(u=n(o).pluck("id").difference(n(INDEX_M2M[a][0].get(this.id))).toArray()),a=r+"/"+s.modelName,a in INDEX_M2M&&(u=n(o).pluck("id").difference(n(INDEX_M2M[a][0].get(this.id))).toArray()),u.length){var l=n(u).map(function(t){return[i,t]}).toArray();W2P_POST(s.modelName,r+"s/put",{collection:l},function(t){})}}else{if(a in x.m2mIndex&&n(x.m2mIndex[a]["get"+y.capitalize(r)](t.id)).find(this))return;c.$post(s.modelName+"/"+r+"s/put",{collection:[[this.id,t.id]]})}}),a.emit("new-model",s),a.emit("new-model-"+s.modelName),s};this.gotData=function(t,e){if(console.info("gotData"),"string"!=typeof t){"_extra"in t&&delete t._extra;var i=t.TOONE,o=t.TOMANY,r=t.MANYTOMANY,s=t.PERMISSIONS,u=t.PA;if(delete t.TOONE,delete t.TOMANY,delete t.MANYTOMANY,delete t.PERMISSIONS,delete t.PA,u||(u={}),t=n(t).filter(function(t,n){return!("deleted"in t)||n in w}).toObject(),"m2m"in t){var l=t.m2m;delete t.m2m}n(t).each(function(t,e){c.describe(e,function(i){var o=i;t.results&&t.results.length>0&&t.results[0].constructor==Array&&(t.results=n(t.results).map(function(t){return n(o.fieldsOrder).zip(t).toObject()}).toArray());var r=n(t.results),s=t.deleted;if(e in u){var c=u[e];n(r).each(function(t){t.id in c&&n(c[t.id]).each(function(n,e){t[e]=n})})}var l=S(e),d=l.source;s&&s.forEach(function(t){delete d[t]});var p=r.indexBy("id"),m=p.keys(),g=m.difference(l.keys().map(function(t){return parseInt(t)})),v=m.difference(g);v=v.filter(function(t){return!y.sameAs(p.get(t),l.get(t).asRaw())});var b=n(t.permissions?t.permissions:{}),N=g.map(function(t){return new o(p.get(t),b.get(t))}),A=[];v.each(function(t){var e=l.get(t),r=e.copy(),s=new o(p.get(t));n(i.fields).keys().each(function(t){e[t]=s[t]}),A.push([e,r])}),A.length&&a.emit("updated-"+e,A);var x=N.toArray();n(x).each(function(t){d[t.id]=t}),n(w[e].references).each(function(t){h[e+"."+t]=f[e].groupBy("_"+t)}),x.length&&a.emit("new-"+e,n(x),t.totalResults),s&&a.emit("deleted-"+e,s),a.emit("received-"+e)})}),i&&(console.error("TOONE"),n(i).each(function(t,n){console.log(n);O(n)})),o&&(console.error("TOMANY"),n(o).each(function(t,e){e in ASKED_UNLINKED||(ASKED_UNLINKED[e]=n([])),n(t).each(function(t){ASKED_UNLINKED[e].source.push(t)})})),r&&(console.error("MANYTOMANY"),n(r).each(function(t,e){var i=parseInt(e.split("|")[1]);e=e.split("|")[0],e in ASKED_M2M||(ASKED_M2M[e]=[{},{}]);var o=ASKED_M2M[e][i];n(t).each(function(t){o[t+""]=!0,o[t]=!0})})),l&&c.gotM2M(l),s&&c.gotPermissions(s),e&&e(t),a.emit("got-data")}else if(console.log("data "+t+" refused from gotData()"),e)return e(t)},this.gotPermissions=function(t){n(t).each(function(t,e){n(t[0]).each(function(t,i){e in f&&i in f[e].source&&(f[e].get(i)._permissions=n(t).map(function(t){return[t,!0]}).toObject())}),n(t[0]).size()&&c.emit("update-permissions-"+e,n(t[0]).keys().toArray())}),this.emit("update-permissions")},this.gotM2M=function(t){n(t).each(function(t,e){var i=x.m2mIndex[e];n(t).each(function(t){n(t).each(function(t,n){i[n](t)})}),a.emit("received-m2m"),a.emit("received-m2m-"+e)})},this.fetch=function(t,n,e,i){t in N?setTimeout(function(){c.fetch(t,n,e,i)},500):c.describe(t,function(e){return c.connection.options.realtimeEndPoint?(n=A.filter(e,n),n?(N[t]=!0,c.$post(t+"/list",{filter:n},function(n){c.gotData(n,i),delete N[t]},function(){delete N[t]})):i&&i(),n):void this.$post(t+"/list",sendData,function(e){n||GOT_ALL.source.push(t),c.gotData(e,i)})})},this.get=function(t,n,e){n.constructor!==Array&&(n=[n]),c.fetch(t,{id:n},null,function(){var i=[],o=f[t];for(var r in n)i.push(o.source[n[r]]);e(i)})},this.gotModel=function(t){for(var e in t){var i=t[e];localStorage["description:"+e]=JSON.stringify(t),w[e]=T(i),e in f||(f[e]=n({}))}},this.describe=function(t,n){var e=w[t];if(e)n&&n(e);else if(t in N)setTimeout(function(){c.describe(t,n)},500);else{if(t in b)return;var i="description:"+t;i in localStorage?(this.gotModel(JSON.parse(localStorage[i])),n&&n(w[t])):(N[t]=!0,this.$post(t+"/describe",null,function(e){c.gotModel(e),n&&n(w[t]),delete N[t]},function(n){this.events.modelNotFound.handle(t),b[t]=!0}))}},this.addModelHandler=function(t,n){var e=y.hash(n);t in m||(m[t]=new i),t in g||(g[t]={}),e in g[t]||(g[t][e]=!0,t in w?n(w[t]):m[t].addHandler(n))},this.addPersistentAttributes=function(t,e){var i=function(t,n){n.forEach(function(n){var e="pA:"+t.modelName+":"+n,i="__"+n;Object.defineProperty(t.prototype,n,{get:function(){if(!(i in this)){var t=localStorage[e+this.id];this[i]=t?JSON.parse(t):null}return this[i]},set:function(t){this[i]=t,localStorage[e+this.id]=JSON.stringify(t)}})})};t in v||(v[t]=[]);var o=v[t];if(e)var r=n(e).difference(o).toArray();else var r=o;r.length&&(t in w&&i(w[t],r),e&&Array.prototype.push.apply(o,r))},this.on("new-model",function(t){t.modelName in m&&m[t.modelName].handle(w[t.modelName]),t.modelName in v&&c.addPersistentAttributes(t.modelName)}),this.connect=function(t){this.isConnected?t(this.connection.options):this.connection.connect(function(n){c.isConnected=!0,t(n)})},this.query=function(t,e,i,o){var r=this;this.describe(t,function(s){e=n(e).map(function(t,n){return[n,Array.isArray(t)?t:[t]]}).toObject();var a=y.makeFilter(s,e),c=S(t);r.fetch(t,e,i,function(t){o(c.filter(a).values().toArray())})})},this.delete=function(t,n,e){return this.$post(t+"/delete",{id:n},e)}};h.prototype.getModel=function(t){var n=this;return new Promise(function(e,i){try{n.$orm.connect(function(){n.$orm.describe(t,e)})}catch(t){i(t)}})},h.prototype.get=function(t,n){var e=this,i=!1,o=t;return n.constructor!==Array&&(i=!0,n=[n]),new Promise(function(t,r){try{e.$orm.connect(function(){i?e.$orm.get(o,n,function(n){t(n[0])}):e.$orm.get(o,n,t)})}catch(t){r(t)}})},h.prototype.query=function(t,n,e){var i=this;return new Promise(function(o,r){var s=null;e&&e.constructor===Array&&e.length?s=e:e&&e.constructor===String&&e.length&&(s=e.split(","));try{i.$orm.isConnected?i.$orm.query(t,n,s,o):i.$orm.connect(function(){i.$orm.query(t,n,s,o)})}catch(t){r(t)}})},h.prototype.delete=function(t,n){var e=this;return new Promise(function(i,o){try{e.$orm.connected?e.$orm.delete(t,n,i):e.$orm.connect(function(){e.$orm.delete(t,n,i)})}catch(t){o(t)}})},h.prototype.getLoggedUser=function(){return this.$orm.connection.options.user_id?this.get("auth_user",this.$orm.connection.options.user_id):new Promse(function(t,n){this.on("login",function(n){t(n)})})},h.prototype.$sendToEndpoint=function(t,n){return this.$orm.$post(t,n)},t.rwt=h}(window,Lazy,SockJS);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhbmRsZXJzLmpzIiwidXRpbHMuanMiLCJ0b3VjaGVyLmpzIiwidmFjdXVtY2FjaGVyLmpzIiwiYXV0b2xpbmtlci5qcyIsImxpc3RjYWNoZXIuanMiLCJtYW55dG9tYW55LmpzIiwiY2FjaGVyLmpzIiwib3JtLmpzIl0sIm5hbWVzIjpbIkhhbmRsZXIiLCJ0aGlzIiwiaGFuZGxlcnMiLCJzdHJIYW5kbGVycyIsIk5hbWVkRXZlbnRNYW5hZ2VyIiwiZXZlbnRzIiwiaGFuZGxlcklkIiwiaWR4SWQiLCJvbiIsIm5hbWUiLCJmdW5jIiwiQXJyYXkiLCJpZCIsInB1c2giLCJlbWl0IiwiYXJncyIsInByb3RvdHlwZSIsInNsaWNlIiwiY2FsbCIsImFyZ3VtZW50cyIsImZvckVhY2giLCJldmVudCIsImFwcGx5IiwidW5iaW5kIiwiaGFuZGxlciIsImNvdW50IiwiTGF6eSIsImVhY2giLCJ2IiwiayIsImlkeCIsIm4iLCJyZXZlcnNlIiwieCIsInNwbGljZSIsIm1vY2tPYmplY3QiLCJQcm94eSIsImdldCIsInRhcmdldCIsIm51bGxTdHJpbmciLCJyZVdoZWVsQ29ubmVjdGlvbiIsImVuZFBvaW50IiwiZ2V0TG9naW4iLCIkUE9TVCIsImJpbmQiLCJvcHRpb25zIiwiVG91Y2hlciIsInRvdWNoZWQiLCJ0b3VjaCIsInQiLCJWYWN1dW1DYWNoZXIiLCJhc2tlZCIsIm1pc3NpbmciLCJhc2siLCJsYXp5IiwiY29udGFpbnMiLCJnZXRBc2tlZEluZGV4IiwibWlzc2luZ3MiLCJsZW5ndGgiLCJ1bmlxdWUiLCJ0b0FycmF5IiwiQXV0b0xpbmtlciIsImFjdGl2ZXMiLCJJREIiLCJXMlBSRVNPVVJDRSIsImxpc3RDYWNoZSIsIm1haW5JbmRleCIsImZvcmVpZ25LZXlzIiwibTJtIiwibTJtSW5kZXgiLCJwZXJtaXNzaW9ucyIsIm1vZGVsIiwicGtJbmRleCIsImdldEluZGV4Rm9yIiwicmVmZXJlbmNlcyIsInJlZmVyZW5jZSIsImluZGV4TmFtZSIsInRvIiwicmVmZXJlbmNlZEJ5IiwiZmllbGQiLCJieSIsIm1hbnlUb01hbnkiLCJyZWxhdGlvbiIsIk1hbnlUb01hbnlSZWxhdGlvbiIsIm0ybUdldCIsImNvbGxlY3Rpb24iLCJjYWxsQmFjayIsIiRwb3N0IiwidXRpbHMiLCJkYXRhIiwiZ290RGF0YSIsImdldE0yTSIsImxpbmtVbmxpbmtlZCIsInZhbHVlcyIsInN1bSIsImNoYW5nZWQiLCJpbmRleGVzIiwiaW5kZXgiLCJmaWx0ZXIiLCJCb29sZWFuIiwibWFwIiwicGFyc2VJbnQiLCJJTkRFWCIsImdldHRlciIsImlkcyIsIm90aGVySW5kZXgiLCJzcGxpdCIsImRlc2NyaWJlIiwiZmxhdHRlbiIsIm1vZGVsTmFtZSIsImtleXMiLCJmZXRjaCIsIm5vb3AiLCJtYWluUmVzb3VyY2UiLCJmaWVsZE5hbWUiLCJ0b09iamVjdCIsInJlc291cmNlTmFtZSIsImdvdFBlcm1pc3Npb25zIiwiUEVSTUlTU0lPTlMiLCJzZXRJbnRlcnZhbCIsIkxpc3RDYWNoZXIiLCJnb3RBbGwiLCJjb21wb3NpdGVBc2tlZCIsImNhcnRlc2lhblByb2R1Y3QxIiwieSIsImlzQXJyYXkiLCJyZXQiLCJhIiwiYiIsImNhcnRlc2lhblByb2R1Y3QiLCJhcnIiLCJleHBsb2RlRmlsdGVyIiwicHJvZHVjdCIsInIiLCJmaWx0ZXJTaW5nbGUiLCJ0ZXN0T25seSIsImtleSIsImRpZmZlcmVuY2UiLCJjbGVhbkNvbXBvc2l0ZXMiLCJmaWx0ZXJMZW4iLCJzaXplIiwibWFrZUZpbHRlciIsIml0ZW0iLCJnb3QiLCJ0aHMiLCJzaW5nbGUiLCJzb21lIiwiZiIsImV4cGxvZGVkIiwicGFydGlhbHMiLCJiYWQiLCJwbHVjayIsIml0ZW1zIiwiYWRkIiwiY29uc29sZSIsImxvZyIsImZpbmQiLCJnZXQwIiwiZ2V0MSIsImNhcGl0YWxpemUiLCJkZWwiLCJsIiwiY2FjaGVkUHJvcGVydHlCeUV2ZW50cyIsInByb3RvIiwicHJvcGVydHlOYW1lIiwic2V0dGVyIiwicmVzdWx0Iiwib3JtIiwicHJvcGVydHlEZWYiLCJ2YWx1ZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiVmFsaWRhdGlvbkVycm9yIiwicmVzb3VyY2UiLCJfcmVzb3VyY2UiLCJmb3JtSWR4IiwiZmllbGRzIiwiZXJyb3JzIiwicmVXaGVlbE9STSIsImxvZ2luRnVuYyIsIiRvcm0iLCJiYXNlT1JNIiwiYWRkTW9kZWxIYW5kbGVyIiwiYWRkUGVyc2lzdGVudEF0dHJpYnV0ZXMiLCJhZGRIYW5kbGVyIiwic3RySGFuZGxlciIsImhhc2giLCJ0b1N0cmluZyIsImhhbmRsZSIsImhhbmRsZUJ5IiwiY2FjaGVkS2V5SWR4IiwidXJsIiwiZXJyb3JCYWNrIiwiaGVhZGVycyIsIm9wdHMiLCJhY2NlcHRzIiwiSlNPTiIsInN0cmluZ2lmeSIsImRhdGFUeXBlIiwic3VjY2VzcyIsImVycm9yIiwibWV0aG9kIiwiY29udGVudFR5cGUiLCJjcm9zc0RvbWFpbiIsIiQiLCJhamF4Iiwic3RhdHVzIiwiZm9yY2UiLCJsb2NhbFN0b3JhZ2UiLCJwYXJzZSIsImxhc3RSV1RTdGF0dXMiLCJlIiwiX3N0YXR1c19jYWxsaW5nIiwic2VsZiIsInNldFRpbWVvdXQiLCJ0aW1lc3RhbXAiLCJ1c2VyX2lkIiwibG9nSW5mbyIsImNvbnN0cnVjdG9yIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidGhlbiIsInRva2VuIiwiYXBwbGljYXRpb24iLCJwcm9taXNlIiwiUHJvbWlzZSIsImFjY2VwdCIsInJlamVjdCIsInhkciIsInhociIsInJlc3BvbnNlVGV4dCIsInJlc3BvbnNlRGF0YSIsImNvbm5lY3Rpb24iLCJjb25uZWN0Iiwid3Njb25uZWN0Iiwid3NDb25uZWN0aW9uIiwid3NDb25uZWN0Iiwib25Db25uZWN0Iiwib25EaXNjb25uZWN0IiwicmVhbHRpbWVFbmRQb2ludCIsInJlbmFtZUZ1bmN0aW9uIiwiZm4iLCJGdW5jdGlvbiIsImNhY2hlZCIsIndyYXBwZXIiLCJmb3JtRW5jb2RlIiwicmVxIiwiWE1MSHR0cFJlcXVlc3QiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwicmVzcG9uc2UiLCJzdGF0dXNUZXh0IiwicmVxdWVzdCIsIlhEb21haW5SZXF1ZXN0Iiwib25sb2FkIiwiRXJyb3IiLCJvcGVuIiwib25lcnJvciIsInNldFJlcXVlc3RIZWFkZXIiLCJfX3Rva2VuX18iLCJlbmNvZGVVUkkiLCJqb2luIiwic2VuZCIsInMiLCJ0b1VwcGVyQ2FzZSIsInRvTG93ZXJDYXNlIiwic3RyIiwiY2hhckNvZGVBdCIsInVuaWZpZXIiLCJkb250VHJhbnNsYXRlRmlsdGVyIiwic291cmNlIiwidmFscyIsInR5cGUiLCJOdW1iZXIiLCJzYW1lQXMiLCJ3aXphcmQiLCJvbkNvbm5lY3Rpb24iLCJvbkRpc2Nvbm5lY3Rpb24iLCJvbk1lc3NhZ2VKc29uIiwib25NZXNzYWdlVGV4dCIsIm9uV2l6YXJkIiwiU29ja0pTIiwib25vcGVuIiwidGVuYW50Iiwib25tZXNzYWdlIiwib25jbG9zZSIsInBsdXJhbGl6ZSIsImJlZm9yZUNhbGwiLCJiZWZvcmUiLCJkZWNvcmF0b3IiLCJjbGVhblN0b3JhZ2UiLCJjaHIiLCJwZXJtdXRhdGlvbnMiLCJib29sIiwidHpPZmZzZXQiLCJEYXRlIiwiZ2V0VGltZXpvbmVPZmZzZXQiLCJ0cmFuc0ZpZWxkVHlwZSIsImRhdGUiLCJkYXRldGltZSIsInN0cmluZyIsInRleHQiLCJpbnRlZ2VyIiwiZmxvYXQiLCJwYXJzZUZsb2F0IiwibW9jayIsImV4dE9STSIsIlBlcm1pc3Npb25UYWJsZSIsImtsYXNzIiwiU3RyaW5nIiwiY29ubmVjdGVkIiwid3MiLCJpbmZvIiwibWVzc2FnZSIsInNlbnREYXRhIiwid2FpdGluZ0Nvbm5lY3Rpb25zIiwiYXV0aF9ncm91cCIsIlJFVklEWCIsImJ1aWxkZXJIYW5kbGVycyIsImJ1aWxkZXJIYW5kbGVyVXNlZCIsInBlcnNpc3RlbnRBdHRyaWJ1dGVzIiwibW9kZWxDYWNoZSIsImZhaWxlZE1vZGVscyIsImxpbmtlciIsInZhbGlkYXRpb25FdmVudCIsImN1cnJlbnRDb250ZXh0Iiwic2F2aW5nRXJyb3JIYW5sZGVyIiwiZ2V0SW5kZXgiLCJnZXRVbmxpbmtlZCIsIlVOTElOS0VEIiwic2F2ZSIsImNiIiwibXlQZXJtcyIsImdyb3VwX2lkIiwicGVybWlzc2lvbkxpc3QiLCJwIiwicGVybXMiLCJhbGxQZXJtaXNzaW9ucyIsImluZGV4T2YiLCJtYWtlTW9kZWxDbGFzcyIsInByaXZhdGVBcmdzIiwibWVyZ2UiLCJmdW5jU3RyaW5nIiwiS2xhc3MiLCJyZWZfdHJhbnNsYXRpb25zIiwiaW52ZXJzZV9yZWZlcmVuY2VzIiwicmVmZXJlbnRzIiwiZmllbGRzT3JkZXIiLCJmaWVsZE9yZGVyIiwicmVwcmVzZW50YXRpb24iLCJkZWxldGUiLCJfcGVybWlzc2lvbnMiLCJhbGxfcGVybXMiLCJvYmplY3RfaWQiLCJncm91cGVkIiwidW5rbm93bl9ncm91cHMiLCJncm91cEJ5IiwibyIsImFzUmF3IiwiSUQiLCJhcmciLCJ3cml0YWJsZSIsImNvbnRleHQiLCJjb3B5Iiwib2JqIiwiYXNyIiwiY29uY2F0Iiwic2F2ZU11bHRpIiwib2JqZWN0cyIsInNjb3BlIiwicmF3IiwiZGVsZXRhYmxlIiwibXVsdGlwbGUiLCJlbGVtcyIsInRhYiIsIm9ianMiLCJyZXN1bHRzIiwiZXh0cmFfdmVyYnMiLCJmdW5jTmFtZSIsImRkYXRhIiwic2F2ZVBBIiwiVCIsIm9vIiwiUEEiLCJGcyIsImZpZWxkSWR4IiwidGFwIiwiaW5kZXhCeSIsIndpZGdldCIsInJlZiIsImV4dF9yZWYiLCJsb2NhbF9yZWYiLCJUeXBlRXJyb3IiLCJyZXZJbmRleCIsImhhc093blByb3BlcnR5IiwiJGxvZyIsInF1ZXJ5IiwiZmlyc3QiLCJvbW9kZWxOYW1lIiwicmVhZGFibGUiLCJ2YWxpZGF0b3JzIiwidW5saW5rUmVmZXJlbmNlIiwiaW5zdGFuY2UiLCJpbnN0YW5jZXMiLCJvbW9kZWwiLCJsaW5rUmVmZXJlbmNlIiwicmVmcyIsIklOREVYX00yTSIsIlcyUF9QT1NUIiwiX2V4dHJhIiwiVE9PTkUiLCJUT01BTlkiLCJNQU5ZVE9NQU5ZIiwibW9kZWxDbGFzcyIsInppcCIsImRlbGV0ZWQiLCJNUEEiLCJyZWNvcmQiLCJpdGFiIiwidGFibGUiLCJpayIsIm5uZXciLCJ1cGRhdGVkIiwibmV3T2JqZWN0cyIsIm9sZEl0ZW0iLCJvbGRDb3B5IiwibmV3SXRlbSIsIm5vIiwidG90YWxSZXN1bHRzIiwiQVNLRURfVU5MSU5LRUQiLCJBU0tFRF9NMk0iLCJNSURYIiwiZ290TTJNIiwicm93IiwibSIsInZlcmIiLCJ0b2dldGhlciIsInNlbmREYXRhIiwiR09UX0FMTCIsImdvdE1vZGVsIiwiY2FjaGVLZXkiLCJtb2RlbE5vdEZvdW5kIiwiYXR0cmlidXRlcyIsImFkZFByb3BlcnR5IiwidmFsIiwia2F0dHIiLCJzZXQiLCJhdHRycyIsIm5ld0F0dHJzIiwiaXNDb25uZWN0ZWQiLCJmaWx0ZXJGdW5jdGlvbiIsImdldE1vZGVsIiwibW9kTmFtZSIsInJlbGF0ZWQiLCJnZXRMb2dnZWRVc2VyIiwiUHJvbXNlIiwidXNlciIsIiRzZW5kVG9FbmRwb2ludCJdLCJtYXBwaW5ncyI6IjZCQUVBLFNBQUFBLEtBQ0FDLEtBQUFDLFlBQ0FELEtBQUFFLGVBeUJBLFFBQUFDLEtBQ0EsR0FBQUMsTUFDQUMsS0FDQUMsRUFBQSxDQUNBTixNQUFBTyxHQUFBLFNBQUFDLEVBQUFDLEdBQ0FELElBQUFKLEtBQ0FBLEVBQUFJLEdBQUEsR0FBQUUsT0FFQSxJQUFBQyxHQUFBTCxHQUdBLE9BRkFGLEdBQUFJLEdBQUFJLEtBQUFILEdBQ0FKLEVBQUFNLEdBQUFGLEVBQ0FFLEdBRUFYLEtBQUFhLEtBQUEsU0FBQUwsR0FDQSxHQUFBQSxJQUFBSixHQUFBLENBQ0EsR0FBQVUsR0FBQUosTUFBQUssVUFBQUMsTUFBQUMsS0FBQUMsVUFBQSxFQUNBZCxHQUFBSSxHQUFBVyxRQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLE1BQUEsS0FBQVAsT0FJQWQsS0FBQXNCLE9BQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBLENBQ0EsSUFBQUQsSUFBQWxCLEdB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QUFBMkssT0FBQWxQLEVBQUFMLEVBQUEySCxLQUdBLE1BQUFoQixHQUNBaUIsRUFBQWpCLE9BS0FqQyxFQUFBbEssVUFBQXViLGNBQUEsV0FDQSxNQUFBdGMsTUFBQW1MLEtBQUFxRCxXQUFBNUwsUUFBQTJLLFFBQ0F2TixLQUFBb0MsSUFBQSxZQUFBcEMsS0FBQW1MLEtBQUFxRCxXQUFBNUwsUUFBQTJLLFNBRUEsR0FBQWdQLFFBQUEsU0FBQXJPLEVBQUFDLEdBQ0FuTyxLQUFBTyxHQUFBLFFBQUEsU0FBQWljLEdBQ0F0TyxFQUFBc08sUUFNQXZSLEVBQUFsSyxVQUFBMGIsZ0JBQUEsU0FBQTNRLEVBQUF0RyxHQUNBLE1BQUF4RixNQUFBbUwsS0FBQTdGLE1BQUF3RyxFQUFBdEciLCJmaWxlIjoicnd0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gSGFuZGxlcigpe1xuICAgIHRoaXMuaGFuZGxlcnMgPSBbXTtcbiAgICB0aGlzLnN0ckhhbmRsZXJzID0ge307XG59O1xuXG5IYW5kbGVyLnByb3RvdHlwZS5hZGRIYW5kbGVyID0gZnVuY3Rpb24gKGhhbmRsZXIpe1xuICAgIHZhciBzdHJIYW5kbGVyID0gdXRpbHMuaGFzaChoYW5kbGVyLnRvU3RyaW5nKCkpO1xuICAgIGlmICghKHN0ckhhbmRsZXIgaW4gdGhpcy5zdHJIYW5kbGVycykpe1xuICAgICAgICB0aGlzLnN0ckhhbmRsZXJzW3N0ckhhbmRsZXJdID0gaGFuZGxlcjtcbiAgICAgICAgdGhpcy5oYW5kbGVycy5wdXNoKGhhbmRsZXIpO1xuICAgIH1cbn07XG5IYW5kbGVyLnByb3RvdHlwZS5oYW5kbGUgPSBmdW5jdGlvbigpe1xuICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApO1xuICAgIHRoaXMuaGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbihmdW5jKXtcbiAgICAgICAgZnVuYy5hcHBseShudWxsLGFyZ3MpO1xuICAgIH0pXG59O1xuSGFuZGxlci5wcm90b3R5cGUuaGFuZGxlQnkgPSBmdW5jdGlvbigpe1xuICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO1xuICAgIHZhciB0aHMgPSBhcmd1bWVudHNbMF07XG4gICAgdGhpcy5oYW5kbGVycy5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmMpe1xuICAgICAgICBmdW5jLmFwcGx5KHRocyxhcmdzKTtcbiAgICB9KVxufTtcblxuXG5mdW5jdGlvbiBOYW1lZEV2ZW50TWFuYWdlciAoKXtcbiAgICB2YXIgZXZlbnRzID0ge307XG4gICAgdmFyIGhhbmRsZXJJZCA9IHt9O1xuICAgIHZhciBpZHhJZCA9IDA7XG4gICAgdGhpcy5vbiA9IGZ1bmN0aW9uKG5hbWUsIGZ1bmMpe1xuICAgICAgICBpZiAoIShuYW1lIGluIGV2ZW50cykpe1xuICAgICAgICAgICAgZXZlbnRzW25hbWVdID0gbmV3IEFycmF5KCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlkID0gaWR4SWQgKys7XG4gICAgICAgIGV2ZW50c1tuYW1lXS5wdXNoKGZ1bmMpO1xuICAgICAgICBoYW5kbGVySWRbaWRdID0gZnVuYztcbiAgICAgICAgcmV0dXJuIGlkO1xuICAgIH07XG4gICAgdGhpcy5lbWl0ID0gZnVuY3Rpb24obmFtZSl7XG4gICAgICAgIGlmIChuYW1lIGluIGV2ZW50cyl7XG4gICAgICAgICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtcbiAgICAgICAgICAgIGV2ZW50c1tuYW1lXS5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgICAgICAgICBldmVudC5hcHBseShudWxsLGFyZ3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMudW5iaW5kID0gZnVuY3Rpb24oaGFuZGxlcil7XG4gICAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICAgIGlmIChoYW5kbGVyIGluIGhhbmRsZXJJZCl7XG4gICAgICAgICAgICB2YXIgZnVuYyA9IGhhbmRsZXJJZFtoYW5kbGVyICsgJyddO1xuICAgICAgICAgICAgTGF6eShldmVudHMpLmVhY2goZnVuY3Rpb24odixrKXtcbiAgICAgICAgICAgICAgICB2YXIgaWR4ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbiBpbiB2KXtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZbbl0gPT09IGZ1bmMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWR4LnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlkeC5yZXZlcnNlKCkuZm9yRWFjaChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICAgICAgdi5zcGxpY2UoeCwxKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZSBoYW5kbGVySWRbaGFuZGxlcl07XG4gICAgICAgIHJldHVybiBjb3VudDtcbiAgICB9O1xufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgY2FjaGVkS2V5SWR4ID0gMDtcblxudmFyIG51bGxTdHJpbmcgPSBmdW5jdGlvbigpIHsgcmV0dXJuICcnfTtcblxuZnVuY3Rpb24gbW9ja09iamVjdCgpe1xuICAgIHJldHVybiBuZXcgUHJveHkoe30sIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbih0YXJnZXQsIG5hbWUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgbmFtZSAgPT09ICdzdHJpbmcnKXtcbiAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gJ3RvU3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFN0cmluZztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9ja09iamVjdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFtuYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59XG5cbnZhciAkUE9TVCA9IGZ1bmN0aW9uKHVybCwgZGF0YSwgY2FsbEJhY2ssIGVycm9yQmFjayxoZWFkZXJzKXtcbiAgICB2YXIgb3B0cyA9IHtcbiAgICAgICAgYWNjZXB0cyA6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgdXJsIDogdXJsLFxuICAgICAgICBkYXRhIDogSlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgICAgIGRhdGFUeXBlIDogJ2pzb24nLFxuICAgICAgICBzdWNjZXNzIDogY2FsbEJhY2ssXG4gICAgICAgIGVycm9yIDogZXJyb3JCYWNrLFxuICAgICAgICBtZXRob2QgOiAnUE9TVCcsXG4gICAgICAgIGNvbnRlbnRUeXBlIDogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgfTtcbiAgICBpZiAoaGVhZGVycyl7XG4gICAgICAgIG9wdHMuaGVhZGVycyA9IGhlYWRlcnM7XG4gICAgICAgIG9wdHMuY3Jvc3NEb21haW4gPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gJC5hamF4KG9wdHMpO1xufVxuXG5mdW5jdGlvbiByZVdoZWVsQ29ubmVjdGlvbihlbmRQb2ludCwgZ2V0TG9naW4pe1xuICAgIC8vIG1haW4gXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuZ2V0TG9naW4gPSBnZXRMb2dpbjtcbiAgICB0aGlzLmV2ZW50cyA9IG5ldyBOYW1lZEV2ZW50TWFuYWdlcigpXG4gICAgdGhpcy4kUE9TVCA9ICRQT1NULmJpbmQodGhpcyk7XG4gICAgdGhpcy5vcHRpb25zID0ge2VuZFBvaW50IDogZW5kUG9pbnR9O1xuICAgIHRoaXMub24gPSB0aGlzLmV2ZW50cy5vbi5iaW5kKHRoaXMpO1xufTtcbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5zdGF0dXMgPSBmdW5jdGlvbihjYWxsQmFjaywgZm9yY2Upe1xuICAgIGlmICgoJ2xhc3RSV1RTdGF0dXMnIGluIGxvY2FsU3RvcmFnZSkgJiYgIWZvcmNlKSB7XG4gICAgICAgIHRyeXtcbiAgICAgICAgICAgIHZhciBzdGF0dXMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5sYXN0UldUU3RhdHVzKTtcbiAgICAgICAgICAgIGZvciAodmFyIHggaW4gc3RhdHVzKXsgdGhpcy5vcHRpb25zW3hdID0gc3RhdHVzW3hdOyB9XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhdHVzKGNhbGxCYWNrLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2FsbEJhY2sgJiYgY2FsbEJhY2soc3RhdHVzKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuX3N0YXR1c19jYWxsaW5nKXtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgc2VsZi5zdGF0dXMoY2FsbEJhY2spO1xuICAgICAgICB9LDUwKTtcbiAgICB9XG4gICAgaWYgKHRoaXMub3B0aW9ucyAmJiB0aGlzLm9wdGlvbnMudGltZXN0YW1wKXtcbiAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2sodGhpcy5vcHRpb25zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9zdGF0dXNfY2FsbGluZyA9IHRydWU7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHRoaXMuJHBvc3QoJ2FwaS9zdGF0dXMnLG51bGwsZnVuY3Rpb24oc3RhdHVzKXtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5sYXN0UldUU3RhdHVzID0gSlNPTi5zdHJpbmdpZnkoc3RhdHVzKTtcbiAgICAgICAgICAgIHNlbGYuX3N0YXR1c19jYWxsaW5nID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKHZhciB4IGluIHN0YXR1cyl7IHNlbGYub3B0aW9uc1t4XSA9IHN0YXR1c1t4XTsgfVxuICAgICAgICAgICAgaWYgKCFzdGF0dXMudXNlcl9pZCAmJiBzZWxmLmdldExvZ2luKXtcbiAgICAgICAgICAgICAgICB2YXIgbG9nSW5mbyA9IHNlbGYuZ2V0TG9naW4oKTtcbiAgICAgICAgICAgICAgICBpZiAobG9nSW5mby5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KXtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2dpbihsb2dJbmZvLnVzZXJuYW1lLCBsb2dJbmZvLnBhc3N3b3JkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgeCBpbiBzdGF0dXMpeyBzZWxmLm9wdGlvbnNbeF0gPSBzdGF0dXNbeF07IH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5sYXN0UldUU3RhdHVzID0gSlNPTi5zdHJpbmdpZnkoc3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHN0YXR1cylcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHNlbGYub3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pOyAgICAgICAgXG4gICAgfVxufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLiRwb3N0ID0gZnVuY3Rpb24odXJsLCBkYXRhLGNhbGxCYWNrKXtcbiAgICB2YXIgdGhzID0gdGhpcztcbiAgICBpZiAodGhpcy5vcHRpb25zICYmIHRoaXMub3B0aW9ucy50b2tlbil7XG4gICAgICAgIGlmICghZGF0YSl7XG4gICAgICAgICAgICBkYXRhID0ge307XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRoaXMub3B0aW9ucy50b2tlbil7XG4gICAgICAgIHZhciBoZWFkZXJzID0geyBcbiAgICAgICAgICAgIHRva2VuIDogdGhpcy5vcHRpb25zLnRva2VuLFxuICAgICAgICAgICAgYXBwbGljYXRpb24gOiB0aGlzLm9wdGlvbnMuYXBwbGljYXRpb25cbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgaGVhZGVycyA9IG51bGw7XG4gICAgfVxuXG4gICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQscmVqZWN0KXtcbiAgICAgICAgdXRpbHMueGRyKHRocy5vcHRpb25zLmVuZFBvaW50ICsgdXJsLCBkYXRhLCB0aHMub3B0aW9ucy5hcHBsaWNhdGlvbiwgdGhzLm9wdGlvbnMudG9rZW4pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbih4aHIpe1xuICAgICAgICAgICAgICAgIHRocy5ldmVudHMuZW1pdCgnaHR0cC1yZXNwb25zZScsIHhoci5yZXNwb25zZVRleHQsIHhoci5zdGF0dXMsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdodHRwLXJlc3BvbnNlLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VUZXh0LCB1cmwsIGRhdGEpO1xuICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VEYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdodHRwLXJlc3BvbnNlLScgKyB4aHIuc3RhdHVzICsgJy1qc29uJywgeGhyLnJlc3BvbnNlRGF0YSwgdXJsLCBkYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxCYWNrKSB7IGNhbGxCYWNrKCB4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQgKX07XG4gICAgICAgICAgICAgICAgYWNjZXB0KHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbih4aHIpIHtcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlRGF0YSl7XG4gICAgICAgICAgICAgICAgICAgIHRocy5ldmVudHMuZW1pdCgnZXJyb3ItanNvbicsIHhoci5yZXNwb25zZURhdGEsIHhoci5zdGF0dXMsIHVybCwgZGF0YSwgeGhyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1qc29uLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VEYXRhLHVybCwgZGF0YSwgeGhyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1odHRwJyx4aHIucmVzcG9uc2VUZXh0LCB4aHIuc3RhdHVzLHVybCxkYXRhLHhocik7XG4gICAgICAgICAgICAgICAgICAgIHRocy5ldmVudHMuZW1pdCgnZXJyb3ItaHR0cC0nICsgeGhyLnN0YXR1cywgeGhyLnJlc3BvbnNlVGV4dCx1cmwsZGF0YSx4aHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZWplY3QoeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICByZXR1cm4gcHJvbWlzZTtcbn07XG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpe1xuICAgIHZhciB1cmwgPSB0aGlzLm9wdGlvbnMuZW5kUG9pbnQgKyAnYXBpL2xvZ2luJztcbiAgICB2YXIgY29ubmVjdGlvbiA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCxyZWplY3Qpe1xuICAgICAgICB1dGlscy54ZHIodXJsLHsgdXNlcm5hbWU6IHVzZXJuYW1lLCBwYXNzd29yZCA6IHBhc3N3b3JkfSwgbnVsbCxjb25uZWN0aW9uLm9wdGlvbnMudG9rZW4sIHRydWUpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbih4aHIpe1xuICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSB4aHIucmVzcG9uc2VEYXRhO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHggaW4gc3RhdHVzKXsgY29ubmVjdGlvbi5vcHRpb25zW3hdID0gc3RhdHVzW3hdOyB9XG4gICAgICAgICAgICAgICAgYWNjZXB0KHN0YXR1cyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbih4aHIpe1xuICAgICAgICAgICAgICAgIHJlamVjdCh4aHIucmVzcG9uc2VEYXRhIHx8IHJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICB9KTtcbi8qICAgICAgICAkLmFqYXgoe1xuLy8gICAgICAgICAgICBoZWFkZXJzIDogaGVhZGVycyxcbiAgICAgICAgICAgIHVybCA6IHVybCxcbiAgICAgICAgICAgIGRhdGEgOiB7IHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQgOiBwYXNzd29yZH0sXG4gICAgICAgICAgICBkYXRhVHlwZSA6ICdqc29uJyxcbiAgICAgICAgICAgIG1ldGhvZCA6ICdQT1NUJyxcbi8vICAgICAgICAgICAgY29udGVudFR5cGUgOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICBtaW1lVHlwZSA6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIGNyb3NzRG9tYWluIDogdHJ1ZSxcbiAgICAgICAgICAgIHN1Y2Nlc3MgOiBmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHggaW4gc3RhdHVzKXsgY29ubmVjdGlvbi5vcHRpb25zW3hdID0gc3RhdHVzW3hdOyB9XG4gICAgICAgICAgICAgICAgYWNjZXB0KHN0YXR1cyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3IgOiBmdW5jdGlvbih4aHIsZGF0YSwgc3RhdHVzKXtcbiAgICAgICAgICAgICAgICByZWplY3QoeGhyLnJlc3BvbnNlSlNPTik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgfSlcbiovXG4gICAgfSk7XG59O1xucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbihjYWxsQmFjayl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciB3c2Nvbm5lY3QgPSBmdW5jdGlvbihzZWxmKXtcbiAgICAgICAgc2VsZi53c0Nvbm5lY3Rpb24gPSBuZXcgdXRpbHMud3NDb25uZWN0KHNlbGYub3B0aW9ucyk7XG4gICAgICAgIHNlbGYud3NDb25uZWN0aW9uLm9uQ29ubmVjdChmdW5jdGlvbigpe1xuICAgICAgICAgICAgc2VsZi5ldmVudHMuZW1pdCgnd3MtY29ubmVjdGVkJywgc2VsZi53c0Nvbm5lY3Rpb24pO1xuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi53c0Nvbm5lY3Rpb24ub25EaXNjb25uZWN0KGZ1bmN0aW9uKCl7IFxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHdzY29ubmVjdChzZWxmKTsgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9LDEwMDApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5zdGF0dXMoZnVuY3Rpb24oc3RhdHVzKXtcbiAgICAgICAgaWYgKCd0b2tlbicgaW4gc2VsZi5vcHRpb25zKXtcbiAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHN0YXR1cyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY29ubmVjdGluZyB0byAnICsgc2VsZi5vcHRpb25zLmVuZFBvaW50KTtcbiAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMudXNlcm5hbWUgJiYgc2VsZi5vcHRpb25zLnBhc3N3b3JkKXtcbiAgICAgICAgICAgICAgICBzZWxmLmxvZ2luKFxuICAgICAgICAgICAgICAgICAgICBzZWxmLm9wdGlvbnMudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNlbGYub3B0aW9ucy5wYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZW5ld2luZyBjb25uZWN0aW9uJylcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RhdHVzLnRva2VuICYmIHN0YXR1cy5yZWFsdGltZUVuZFBvaW50ICYmICghc2VsZi53c0Nvbm5lY3Rpb24pKXtcbiAgICAgICAgICAgIHdzY29ubmVjdChzZWxmKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxudmFyIHV0aWxzID0ge1xuICAgIHJlbmFtZUZ1bmN0aW9uIDogZnVuY3Rpb24gKG5hbWUsIGZuKSB7XG4gICAgICAgIHJldHVybiAobmV3IEZ1bmN0aW9uKFwicmV0dXJuIGZ1bmN0aW9uIChjYWxsKSB7IHJldHVybiBmdW5jdGlvbiBcIiArIG5hbWUgK1xuICAgICAgICAgICAgXCIgKCkgeyByZXR1cm4gY2FsbCh0aGlzLCBhcmd1bWVudHMpIH07IH07XCIpKCkpKEZ1bmN0aW9uLmFwcGx5LmJpbmQoZm4pKTtcbiAgICB9LFxuICAgIGNhY2hlZCA6IGZ1bmN0aW9uKGZ1bmMsIGtleSl7XG4gICAgICAgIGlmICgha2V5KXsgICAgXG4gICAgICAgICAgICBrZXkgPSAnXycgKyBjYWNoZWRLZXlJZHgrKztcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB3cmFwcGVyKCl7XG4gICAgICAgICAgICBpZiAoIXRoaXNba2V5XSl7XG4gICAgICAgICAgICAgICAgdGhpc1trZXldID0gZnVuYy5jYWxsKHRoaXMsW2FyZ3VtZW50c10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXNba2V5XTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHdyYXBwZXI7XG4gICAgfSxcbiAgICAkUE9TVCA6ICRQT1NULFxuICAgIHJlV2hlZWxDb25uZWN0aW9uOiByZVdoZWVsQ29ubmVjdGlvbixcbiAgICBsb2c6IGZ1bmN0aW9uKCl7IFxuICAgICAgICBjb25zb2xlLmxvZyhhcmd1bWVudHMpO1xuICAgIH0sXG5cbiAgICB4ZHI6IGZ1bmN0aW9uICh1cmwsIGRhdGEsIGFwcGxpY2F0aW9uLHRva2VuLCBmb3JtRW5jb2RlKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlIGFuIEhUVFAgUmVxdWVzdCBhbmQgcmV0dXJuIGl0cyBwcm9taXNlLlxuICAgICAgICAgKi9cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgcmVxO1xuICAgICAgICAgICAgaWYgKCFkYXRhKSB7IGRhdGEgPSB7fTt9XG5cbiAgICAgICAgICAgIGlmKFhNTEh0dHBSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgcmVxID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgcmVxLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVxLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VEYXRhID0gSlNPTi5wYXJzZShyZXEucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0ge3Jlc3BvbnNlRGF0YTogcmVzcG9uc2VEYXRhLCByZXNwb25zZVRleHQ6IHJlcS5yZXNwb25zZVRleHQsc3RhdHVzOiByZXEuc3RhdHVzVGV4dCwgcmVxdWVzdDogcmVxfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXEuc3RhdHVzID49IDIwMCAmJiByZXEuc3RhdHVzIDwgNDAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0KHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYoWERvbWFpblJlcXVlc3Qpe1xuICAgICAgICAgICAgICAgIHJlcSA9IG5ldyBYRG9tYWluUmVxdWVzdCgpO1xuICAgICAgICAgICAgICAgIHJlcS5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgYWNjZXB0KHJlcS5yZXNwb25zZVRleHQscmVxLnN0YXR1c1RleHQsIHJlcSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignQ09SUyBub3Qgc3VwcG9ydGVkJykpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXEub3BlbignUE9TVCcsIHVybCwgdHJ1ZSk7XG4gICAgICAgICAgICByZXEub25lcnJvciA9IHJlamVjdDtcbiAgICAgICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdBY2NlcHQnLCdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICAgICAgICBpZiAodG9rZW4pIHsgZGF0YS5fX3Rva2VuX18gPSB0b2tlbiB9XG4gICAgICAgICAgICBpZiAoIWZvcm1FbmNvZGUpe1xuICAgICAgICAgICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCd0ZXh0L3BsYWluJyk7XG4gICAgICAgICAgICAgICAgZGF0YSA9IExhenkoZGF0YSkuc2l6ZSgpP0pTT04uc3RyaW5naWZ5KGRhdGEpOicnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXEuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyk7XG4gICAgICAgICAgICAgICAgZGF0YSA9IExhenkoZGF0YSkubWFwKGZ1bmN0aW9uKHYsayl7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gayArICc9JyArIGVuY29kZVVSSSh2LnRvU3RyaW5nKCkpOyAgXG4gICAgICAgICAgICAgICAgfSkudG9BcnJheSgpLmpvaW4oJyYnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlcS5zZW5kKGRhdGEpO1xuICAgIC8vICAgICAgICByZXEuc2VuZChudWxsKTtcbiAgICAgICAgfSlcbiAgICB9LFxuICAgIFxuICAgIGNhcGl0YWxpemUgOiBmdW5jdGlvbiAocykge1xuICAgICAgICByZXR1cm4gc1swXS50b1VwcGVyQ2FzZSgpICsgcy5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuICAgIH0sXG5cbiAgICBoYXNoIDogZnVuY3Rpb24oc3RyKXtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhhc2hlZCBmdW5jdGlvblxuICAgICAgICAgKi9cbiAgICAgICAgc3RyID0gc3RyLnRvU3RyaW5nKCk7XG4gICAgICAgIHZhciByZXQgPSAxO1xuICAgICAgICBmb3IgKHZhciB4ID0gMDt4PHN0ci5sZW5ndGg7eCsrKXtcbiAgICAgICAgICAgIHJldCAqPSAoMSArIHN0ci5jaGFyQ29kZUF0KHgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKHJldCAlIDM0OTU4Mzc0OTU3KS50b1N0cmluZygpO1xuICAgIH0sXG5cbiAgICBtYWtlRmlsdGVyIDogZnVuY3Rpb24gKG1vZGVsLCBmaWx0ZXIsIHVuaWZpZXIsIGRvbnRUcmFuc2xhdGVGaWx0ZXIpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2UgZmlsdGVyIGZvciBBcnJheS5maWx0ZXIgZnVuY3Rpb24gYXMgYW4gYW5kIG9mIG9yXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoIXVuaWZpZXIpIHsgdW5pZmllciA9ICcgJiYgJzt9XG4gICAgICAgIGlmIChMYXp5KGZpbHRlcikuc2l6ZSgpID09PSAwKXtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbih4KXsgcmV0dXJuIHRydWUgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc291cmNlID0gTGF6eShmaWx0ZXIpLm1hcChmdW5jdGlvbih2YWxzLCBmaWVsZCl7XG4gICAgICAgICAgICBpZiAoIXZhbHMpIHsgdmFscyA9IFtudWxsXX1cbiAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWxzKSl7XG4gICAgICAgICAgICAgICAgdmFscyA9IFt2YWxzXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZG9udFRyYW5zbGF0ZUZpbHRlciAmJiAobW9kZWwuZmllbGRzW2ZpZWxkXS50eXBlID09PSAncmVmZXJlbmNlJykpIHtcbiAgICAgICAgICAgICAgICBmaWVsZCA9ICdfJyArIGZpZWxkO1xuICAgICAgICAgICAgICAgIHZhbHMgPSBMYXp5KHZhbHMpLm1hcChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHggJiYgKHguY29uc3RydWN0b3IgIT09IE51bWJlcikpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHguaWQ7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4O1xuICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobW9kZWwuZmllbGRzW2ZpZWxkXS50eXBlID09PSAnc3RyaW5nJyl7XG4gICAgICAgICAgICAgICAgdmFscyA9IHZhbHMubWFwKEpTT04uc3RyaW5naWZ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAnKCcgKyAgTGF6eSh2YWxzKS5tYXAoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcoeC4nICsgZmllbGQgKyAnID09PSAnICsgeCArICcpJztcbiAgICAgICAgICAgIH0pLmpvaW4oJyB8fCAnKSAgKycpJztcbiAgICAgICAgfSkudG9BcnJheSgpLmpvaW4odW5pZmllcik7XG4gICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oXCJ4XCIsIFwicmV0dXJuIFwiICsgc291cmNlKTtcbiAgICB9LFxuXG4gICAgc2FtZUFzIDogZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlZXAgZXF1YWxcbiAgICAgICAgICovXG4gICAgICAgIGZvciAodmFyIGsgaW4geCkge1xuICAgICAgICAgICAgaWYgKHlba10gIT0geFtrXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuXG5cbiAgICB3c0Nvbm5lY3QgOiBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICAvKipcbiAgICAgICAgICogQ29ubmVjdHMgYSB3ZWJzb2NrZXQgd2l0aCByZVdoZWVsIGNvbm5lY3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIGlmKCFvcHRpb25zKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIFxuICAgICAgICAvLyByZWdpc3RlcmluZyBhbGwgZXZlbnQgaGFuZGxlcnNcblxuICAgICAgICB0aGlzLmhhbmRsZXJzID0ge1xuICAgICAgICAgICAgd2l6YXJkIDogbmV3IEhhbmRsZXIoKSxcbiAgICAgICAgICAgIG9uQ29ubmVjdGlvbiA6IG5ldyBIYW5kbGVyKCksXG4gICAgICAgICAgICBvbkRpc2Nvbm5lY3Rpb24gOiBuZXcgSGFuZGxlcigpLFxuICAgICAgICAgICAgb25NZXNzYWdlSnNvbiA6IG5ldyBIYW5kbGVyKCksXG4gICAgICAgICAgICBvbk1lc3NhZ2VUZXh0IDogbmV3IEhhbmRsZXIoKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMub25XaXphcmQgPSB0aGlzLmhhbmRsZXJzLndpemFyZC5hZGRIYW5kbGVyLmJpbmQodGhpcy5oYW5kbGVycy53aXphcmQpO1xuICAgICAgICB0aGlzLm9uQ29ubmVjdCA9IHRoaXMuaGFuZGxlcnMub25Db25uZWN0aW9uLmFkZEhhbmRsZXIuYmluZCh0aGlzLmhhbmRsZXJzLm9uQ29ubmVjdGlvbik7XG4gICAgICAgIHRoaXMub25EaXNjb25uZWN0ID0gdGhpcy5oYW5kbGVycy5vbkRpc2Nvbm5lY3Rpb24uYWRkSGFuZGxlci5iaW5kKHRoaXMuaGFuZGxlcnMub25EaXNjb25uZWN0aW9uKTtcbiAgICAgICAgdGhpcy5vbk1lc3NhZ2VKc29uID0gdGhpcy5oYW5kbGVycy5vbk1lc3NhZ2VKc29uLmFkZEhhbmRsZXIuYmluZCh0aGlzLmhhbmRsZXJzLm9uTWVzc2FnZUpzb24pO1xuICAgICAgICB0aGlzLm9uTWVzc2FnZVRleHQgPSB0aGlzLmhhbmRsZXJzLm9uTWVzc2FnZVRleHQuYWRkSGFuZGxlci5iaW5kKHRoaXMuaGFuZGxlcnMub25NZXNzYWdlVGV4dCk7XG5cbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9uc1xuXG4gICAgICAgIHZhciBjb25uZWN0aW9uID0gbmV3IFNvY2tKUyhvcHRpb25zLnJlYWx0aW1lRW5kUG9pbnQpO1xuICAgICAgICBjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnb3BlbiA6ICcgKyB4KTtcbiAgICAgICAgICAgIGNvbm5lY3Rpb24udGVuYW50KCk7XG4gICAgICAgICAgICBzZWxmLmhhbmRsZXJzLm9uQ29ubmVjdGlvbi5oYW5kbGUoeCk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIGlmICh4LnR5cGUgPT0gJ21lc3NhZ2UnKSB7XG4gICAgICAgICAgICAgICAgLy8kLm5vdGlmeSh4LmRhdGEpO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIC8vVE9ETyBzZXQgZnJvbVJlYWx0aW1lXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaGFuZGxlcnMub25NZXNzYWdlSnNvbi5oYW5kbGUoSlNPTi5wYXJzZSh4LmRhdGEpKTtcbiAgICAgICAgICAgICAgICAgICAgLy9UT0RPIHVuc2V0IGZyb21SZWFsdGltZVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmhhbmRsZXJzLm9uTWVzc2FnZVRleHQuaGFuZGxlKHguZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY29ubmVjdGlvbi5vbmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2V0VGltZW91dCh1dGlscy53c0Nvbm5lY3QsMTAwMCk7XG4gICAgICAgICAgICBzZWxmLmhhbmRsZXJzLm9uRGlzY29ubmVjdGlvbi5oYW5kbGUoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29ubmVjdGlvbi50ZW5hbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25uZWN0aW9uLnNlbmQoJ1RFTkFOVDonICsgc2VsZi5vcHRpb25zLmFwcGxpY2F0aW9uICsgJzonICsgc2VsZi5vcHRpb25zLnRva2VuKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBwbHVyYWxpemUgOiBmdW5jdGlvbihzdHIsIG1vZGVsKXtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIExleGljYWxseSByZXR1cm5zIGVuZ2xpc2ggcGx1cmFsIGZvcm1cbiAgICAgICAgICovXG4gICAgICAgIHJldHVybiBzdHIgKyAncyc7XG4gICAgfSxcblxuICAgIGJlZm9yZUNhbGwgOiBmdW5jdGlvbihmdW5jLCBiZWZvcmUpe1xuICAgICAgICB2YXIgZGVjb3JhdG9yID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGJlZm9yZSgpLnRoZW4oZnVuYylcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGRlY29yYXRvcjtcbiAgICB9LFxuXG4gICAgY2xlYW5TdG9yYWdlIDogZnVuY3Rpb24oKXtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENsZWFuIGxvY2FsU3RvcmFnZSBvYmplY3RcbiAgICAgICAgICovXG4gICAgICAgIExhenkobG9jYWxTdG9yYWdlKS5rZXlzKCkuZWFjaChmdW5jdGlvbihrKXtcbiAgICAgICAgICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2Vba107XG4gICAgICAgIH0pXG4gICAgfSxcbiAgICBcbiAgICByZXZlcnNlIDogZnVuY3Rpb24gKGNociwgc3RyKSB7XG4gICAgICAgIHJldHVybiBzdHIuc3BsaXQoY2hyKS5yZXZlcnNlKCkuam9pbihjaHIpO1xuICAgIH0sXG4gICAgcGVybXV0YXRpb25zOiBmdW5jdGlvbihhcnIpe1xuICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgIGZvciAodmFyIHggPSBhcnIubGVuZ3RoLTE7IHggPj0gMDt4LS0pe1xuICAgICAgICAgICAgZm9yICh2YXIgeSA9IGFyci5sZW5ndGgtMTsgeSA+PSAwOyB5LS0pe1xuICAgICAgICAgICAgICAgIGlmICh4ICE9PSB5KVxuICAgICAgICAgICAgICAgICAgICByZXQucHVzaChbYXJyW3hdLCBhcnJbeV1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH0sXG5cbiAgICBib29sOiBCb29sZWFuLFxuXG4gICAgbm9vcCA6IGZ1bmN0aW9uKCl7fSxcblxuICAgIHR6T2Zmc2V0OiBuZXcgRGF0ZSgpLmdldFRpbWV6b25lT2Zmc2V0KCkgKiA2MDAwMCxcblxuICAgIHRyYW5zRmllbGRUeXBlOiB7XG4gICAgICAgIGRhdGU6IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIG5ldyBEYXRlKHggKiAxMDAwICsgdXRpbHMudHpPZmZzZXQgKSB9LFxuICAgICAgICBkYXRldGltZTogZnVuY3Rpb24oeCkgeyByZXR1cm4gbmV3IERhdGUoeCAqIDEwMDAgKyB1dGlscy50ek9mZnNldCApIH0sXG4gICAgICAgIHN0cmluZzogZnVuY3Rpb24oeCkgeyByZXR1cm4geC50b1N0cmluZygpOyB9LFxuICAgICAgICB0ZXh0OiBmdW5jdGlvbih4KSB7IHJldHVybiB4LnRvU3RyaW5nKCk7IH0sXG4gICAgICAgIGludGVnZXI6IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHBhcnNlSW50KHgpOyB9LFxuICAgICAgICBmbG9hdDogZnVuY3Rpb24oeCkgeyByZXR1cm4gcGFyc2VGbG9hdCh4KTsgfVxuICAgIH0sIFxuICAgIG1vY2sgOiBtb2NrT2JqZWN0XG59O1xuXG5cbiIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gVG91Y2hlcigpe1xuICAgIHZhciB0b3VjaGVkID0gZmFsc2VcbiAgICB0aGlzLnRvdWNoID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdG91Y2hlZCA9IHRydWU7XG4gICAgfTtcbiAgICB0aGlzLnRvdWNoZWQgPSBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgdCA9IHRvdWNoZWQ7XG4gICAgICAgIHRvdWNoZWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfVxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5cbmZ1bmN0aW9uIFZhY3V1bUNhY2hlcih0b3VjaCwgYXNrZWQsIG5hbWUpe1xuLypcbiAgICBpZiAobmFtZSl7XG4gICAgICAgIGNvbnNvbGUuaW5mbygnY3JlYXRlZCBWYWN1dW1DYWNoZXIgYXMgJyArIG5hbWUpO1xuICAgIH1cbiovXG4gICAgaWYgKCFhc2tlZCl7XG4gICAgICAgIHZhciBhc2tlZCA9IFtdO1xuICAgIH1cbiAgICB2YXIgbWlzc2luZyA9IFtdO1xuICAgIFxuICAgIHRoaXMuYXNrID0gZnVuY3Rpb24gKGlkLGxhenkpe1xuICAgICAgICBpZiAoIUxhenkoYXNrZWQpLmNvbnRhaW5zKGlkKSl7XG4vLyAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnYXNraW5nICgnICsgaWQgKyAnKSBmcm9tICcgKyBuYW1lKTtcbiAgICAgICAgICAgIG1pc3NpbmcucHVzaChpZCk7XG4gICAgICAgICAgICBpZiAoIWxhenkpXG4gICAgICAgICAgICAgICAgYXNrZWQucHVzaChpZCk7XG4gICAgICAgICAgICB0b3VjaC50b3VjaCgpO1xuICAgICAgICB9IFxuLy8gICAgICAgIGVsc2UgY29uc29sZS53YXJuKCcoJyArIGlkICsgJykgd2FzIGp1c3QgYXNrZWQgb24gJyArIG5hbWUpO1xuICAgIH07XG5cbiAgICB0aGlzLmdldEFza2VkSW5kZXggPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gYXNrZWQ7XG4gICAgfVxuXG4gICAgdGhpcy5taXNzaW5ncyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBMYXp5KG1pc3Npbmcuc3BsaWNlKDAsbWlzc2luZy5sZW5ndGgpKS51bmlxdWUoKS50b0FycmF5KCk7XG4gICAgfVxufVxuIiwiZnVuY3Rpb24gQXV0b0xpbmtlcihldmVudHMsIGFjdGl2ZXMsIElEQiwgVzJQUkVTT1VSQ0UsIGxpc3RDYWNoZSl7XG4gICAgdmFyIHRvdWNoID0gbmV3IFRvdWNoZXIoKTtcbiAgICB2YXIgbWFpbkluZGV4ID0ge307XG4gICAgdmFyIGZvcmVpZ25LZXlzID0ge307XG4gICAgdmFyIG0ybSA9IHt9O1xuICAgIHZhciBtMm1JbmRleCA9IHt9O1xuICAgIHZhciBwZXJtaXNzaW9ucyA9IHt9O1xuICAgIHRoaXMubWFpbkluZGV4ID0gbWFpbkluZGV4O1xuICAgIHRoaXMuZm9yZWlnbktleXMgPSBmb3JlaWduS2V5cztcbiAgICB0aGlzLm0ybSA9IG0ybTtcbiAgICB0aGlzLm0ybUluZGV4ID0gbTJtSW5kZXg7XG4gICAgdGhpcy5wZXJtaXNzaW9ucyA9IHBlcm1pc3Npb25zO1xuXG4gICAgZXZlbnRzLm9uKCdtb2RlbC1kZWZpbml0aW9uJyxmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgIC8vIGRlZmluaW5nIGFsbCBpbmRleGVzIGZvciBwcmltYXJ5IGtleVxuICAgICAgICB2YXIgcGtJbmRleCA9IGxpc3RDYWNoZS5nZXRJbmRleEZvcihtb2RlbC5uYW1lLCAnaWQnKTtcbiAgICAgICAgbWFpbkluZGV4W21vZGVsLm5hbWVdID0gbmV3IFZhY3V1bUNhY2hlcih0b3VjaCwgcGtJbmRleCwgJ21haW5JbmRleC4nICsgbW9kZWwubmFtZSk7XG4gICAgICAgIFxuICAgICAgICAvLyBjcmVhdGluZyBwZXJtaXNzaW9uIGluZGV4ZXNcbiAgICAgICAgcGVybWlzc2lvbnNbbW9kZWwubmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLG51bGwsICdwZXJtaXNzaW9ucy4nICsgbW9kZWwubmFtZSk7XG5cbiAgICAgICAgLy8gY3JlYXRpbmcgaW5kZXhlcyBmb3IgZm9yZWlnbiBrZXlzXG4gICAgICAgIExhenkobW9kZWwucmVmZXJlbmNlcykuZWFjaChmdW5jdGlvbihyZWZlcmVuY2Upe1xuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IG1vZGVsLm5hbWUgKyAnXycgKyByZWZlcmVuY2UuaWQ7XG4gICAgICAgICAgICBmb3JlaWduS2V5c1tpbmRleE5hbWVdID0gbmV3IFZhY3V1bUNhY2hlcih0b3VjaCwgbGlzdENhY2hlLmdldEluZGV4Rm9yKHJlZmVyZW5jZS50bywgJ2lkJyksIHJlZmVyZW5jZS50byArICcuaWQgZm9yZWlnbktleXMuJyArIGluZGV4TmFtZSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBjcmVhdGluZyByZXZlcnNlIGZvcmVpZ24ga2V5c1xuICAgICAgICBMYXp5KG1vZGVsLnJlZmVyZW5jZWRCeSkuZWFjaChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gZmllbGQuYnkgKyAnLicgKyBmaWVsZC5pZDtcbiAgICAgICAgICAgIGZvcmVpZ25LZXlzW2luZGV4TmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLCBsaXN0Q2FjaGUuZ2V0SW5kZXhGb3IoZmllbGQuYnksZmllbGQuaWQpLCBmaWVsZC5ieSArICcuJyArIGZpZWxkLmlkICsgJyBmb3JlaWduS2V5cy4nICsgaW5kZXhOYW1lKTtcbiAgICAgICAgfSk7XG4gICAgICAgIExhenkobW9kZWwubWFueVRvTWFueSkuZWFjaChmdW5jdGlvbihyZWxhdGlvbil7XG4gICAgICAgICAgICBpZiAoIShyZWxhdGlvbi5pbmRleE5hbWUgaW4gbTJtKSlcbiAgICAgICAgICAgICAgICBtMm1bcmVsYXRpb24uaW5kZXhOYW1lXSA9IFtuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLG51bGwsJ20ybS4nICsgcmVsYXRpb24uaW5kZXhOYW1lICsgJ1swXScpLCBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLG51bGwsJ20ybS4nICsgcmVsYXRpb24uaW5kZXhOYW1lKydbMV0nKV07XG4gICAgICAgICAgICBpZiAoIShyZWxhdGlvbi5pbmRleE5hbWUgaW4gbTJtSW5kZXgpKVxuICAgICAgICAgICAgICAgIG0ybUluZGV4W3JlbGF0aW9uLmluZGV4TmFtZV0gPSBuZXcgTWFueVRvTWFueVJlbGF0aW9uKHJlbGF0aW9uLG0ybVtyZWxhdGlvbi5pbmRleE5hbWVdKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgdmFyIG0ybUdldCA9IGZ1bmN0aW9uKGluZGV4TmFtZSwgbiwgY29sbGVjdGlvbiwgY2FsbEJhY2spe1xuICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdCgobiA/IHV0aWxzLnJldmVyc2UoJy8nLCBpbmRleE5hbWUpIDogaW5kZXhOYW1lKSArICdzJyArICcvbGlzdCcsIHtjb2xsZWN0aW9uOiBjb2xsZWN0aW9ufSwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKGRhdGEsIGNhbGxCYWNrKTtcbiAgICAgICAgICAgIGRlbGV0ZSBhY3RpdmVzW2luZGV4TmFtZV1cbiAgICAgICAgfSk7ICAgICAgICBcbiAgICB9O1xuXG4gICAgdmFyIGdldE0yTSA9IGZ1bmN0aW9uKGluZGV4TmFtZSwgY29sbGVjdGlvbiwgbiwgY2FsbEJhY2spe1xuICAgICAgICAvLyBhc2sgYWxsIGl0ZW1zIGluIGNvbGxlY3Rpb24gdG8gbTJtIGluZGV4XG4gICAgICAgIExhenkoY29sbGVjdGlvbikuZWFjaChtMm1baW5kZXhOYW1lXVtuXS5hc2suYmluZChtMm1baW5kZXhOYW1lXVtuXSkpO1xuICAgICAgICAvLyByZW5ld2luZyBjb2xsZWN0aW9uIHdpdGhvdXQgYXNrZWRcbiAgICAgICAgY29sbGVjdGlvbiA9IG0ybVtpbmRleE5hbWVdW25dLm1pc3NpbmdzKCk7XG4gICAgICAgIC8vIGNhbGxpbmcgcmVtb3RlIGZvciBtMm0gY29sbGVjdGlvbiBpZiBhbnlcbiAgICAgICAgaWYgKGNvbGxlY3Rpb24ubGVuZ3RoKXtcbiAgICAgICAgICAgIGFjdGl2ZXNbaW5kZXhOYW1lXSA9IDE7XG4gICAgICAgICAgICBtMm1HZXQoaW5kZXhOYW1lLCBuLCBjb2xsZWN0aW9uLCBjYWxsQmFjayk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjaygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmdldE0yTSA9IGdldE0yTTtcblxuICAgIHZhciBsaW5rVW5saW5rZWQgPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyBwZXJmb3JtIGEgRGF0YUJhc2Ugc3luY2hyb25pemF0aW9uIHdpdGggc2VydmVyIGxvb2tpbmcgZm9yIHVua25vd24gZGF0YVxuICAgICAgICBpZiAoIXRvdWNoLnRvdWNoZWQoKSkgcmV0dXJuO1xuICAgICAgICBpZiAoTGF6eShhY3RpdmVzKS52YWx1ZXMoKS5zdW0oKSkge1xuICAgICAgICAgICAgdG91Y2gudG91Y2goKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICBMYXp5KG0ybSkuZWFjaChmdW5jdGlvbihpbmRleGVzLCBpbmRleE5hbWUpe1xuICAgICAgICAgICAgTGF6eShpbmRleGVzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCxuKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBpbmRleC5taXNzaW5ncygpO1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24gPSBMYXp5KGNvbGxlY3Rpb24pLmZpbHRlcihCb29sZWFuKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHgpXG4gICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIGlmIChjb2xsZWN0aW9uLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBJTkRFWCA9IG0ybUluZGV4W2luZGV4TmFtZV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBnZXR0ZXIgPSBJTkRFWFsnZ2V0JyArICgxIC0gbildLmJpbmQoSU5ERVgpO1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbTJtR2V0KGluZGV4TmFtZSwgbiwgY29sbGVjdGlvbiwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWRzID0gY29sbGVjdGlvbi5tYXAoZ2V0dGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3RoZXJJbmRleCA9IGluZGV4TmFtZS5zcGxpdCgnLycpWzEgLSBuXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5kZXNjcmliZShvdGhlckluZGV4LGZ1bmN0aW9uKCl7XG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGF6eShpZHMpLmZsYXR0ZW4oKS51bmlxdWUoKS5lYWNoKG1haW5JbmRleFtvdGhlckluZGV4XS5hc2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMYXp5KGlkcykuZmxhdHRlbigpLnVuaXF1ZSgpLmVhY2goZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWluSW5kZXhbb3RoZXJJbmRleF0uYXNrKHgsdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIExhenkobWFpbkluZGV4KS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgbW9kZWxOYW1lKSB7XG4gICAgICAgICAgICB2YXIgaWRzID0gaW5kZXgubWlzc2luZ3MoKTtcbiAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIGlkYiA9IG1vZGVsTmFtZSBpbiBJREIgPyBJREJbbW9kZWxOYW1lXS5rZXlzKCkgOiBMYXp5KCk7XG4gICAgICAgICAgICAgICAgLy9sb2coJ2xpbmtpbmcuJyArIG1vZGVsTmFtZSArICcgPSAnICsgVzJQUkVTT1VSQ0UubGlua2luZy5zb3VyY2VbbW9kZWxOYW1lXSk7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gobW9kZWxOYW1lLCB7aWQ6IGlkc30sbnVsbCx1dGlscy5ub29wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIEZvcmVpZ24ga2V5c1xuICAgICAgICBMYXp5KGZvcmVpZ25LZXlzKVxuICAgICAgICAubWFwKGZ1bmN0aW9uKHYsayl7XG4gICAgICAgICAgICByZXR1cm4gW2ssIHYubWlzc2luZ3MoKV1cbiAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uKHYpe1xuICAgICAgICAgICAgcmV0dXJuIHZbMV0ubGVuZ3RoXG4gICAgICAgIH0pLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIGlkcyA9IHhbMV07XG4gICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0geFswXTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGluZGV4TmFtZS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgdmFyIG1haW5SZXNvdXJjZSA9IGluZGV4WzBdO1xuICAgICAgICAgICAgdmFyIGZpZWxkTmFtZSA9IGluZGV4WzFdO1xuICAgICAgICAgICAgdmFyIGZpbHRlciA9IHt9O1xuICAgICAgICAgICAgZmlsdGVyW2ZpZWxkTmFtZV0gPSBpZHM7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5mZXRjaChtYWluUmVzb3VyY2UsIGZpbHRlcik7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgTGF6eShMYXp5KHBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24odixrKXtcbiAgICAgICAgICAgIHJldHVybiBbaywgdi5taXNzaW5ncygpXVxuICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIHJldHVybiB2WzFdLmxlbmd0aFxuICAgICAgICB9KS50b09iamVjdCgpKS5lYWNoKGZ1bmN0aW9uIChpZHMsIHJlc291cmNlTmFtZSkge1xuICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgYWN0aXZlc1tyZXNvdXJjZU5hbWVdID0gMTtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdChyZXNvdXJjZU5hbWUgKyAnL215X3Blcm1zJywge2lkczogTGF6eShpZHMpLnVuaXF1ZSgpLnRvQXJyYXkoKX0sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdFBlcm1pc3Npb25zKGRhdGEuUEVSTUlTU0lPTlMpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgYWN0aXZlc1tyZXNvdXJjZU5hbWVdXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRJbnRlcnZhbChsaW5rVW5saW5rZWQsNTApO1xufTtcblxuXG4iLCJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gTGlzdENhY2hlcigpe1xuICAgIHZhciBnb3RBbGwgPSB7fTtcbiAgICB2YXIgYXNrZWQgPSB7fTsgLy8gbWFwIG9mIGFycmF5XG4gICAgdmFyIGNvbXBvc2l0ZUFza2VkID0ge307XG4gICAgdmFyIGNhcnRlc2lhblByb2R1Y3QxID0gZnVuY3Rpb24oeCx5LGlzQXJyYXkpe1xuICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgIGlmIChpc0FycmF5KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBhIGluIHgpe1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGIgaW4geSl7XG4gICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKExhenkoW3hbYV0seVtiXV0pLmZsYXR0ZW4oKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAodmFyIGEgaW4geCl7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYiBpbiB5KXtcbiAgICAgICAgICAgICAgICAgICAgcmV0LnB1c2goW3hbYV0seVtiXV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH07XG4gICAgdmFyIGNhcnRlc2lhblByb2R1Y3QgPSBmdW5jdGlvbihhcnIpe1xuICAgICAgICB2YXIgaXNBcnJheSA9IGZhbHNlO1xuICAgICAgICB2YXIgcmV0ID0gYXJyWzBdOyBcbiAgICAgICAgZm9yICh2YXIgeCA9IDE7IHggPCBhcnIubGVuZ3RoOyArK3gpe1xuICAgICAgICAgICAgcmV0ID0gY2FydGVzaWFuUHJvZHVjdDEocmV0LCBhcnJbeF0sIGlzQXJyYXkpO1xuICAgICAgICAgICAgaXNBcnJheSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG4gICAgdmFyIGV4cGxvZGVGaWx0ZXIgPSBmdW5jdGlvbihmaWx0ZXIpIHtcbiAgICAgICAgdmFyIHByb2R1Y3QgPSBjYXJ0ZXNpYW5Qcm9kdWN0KExhenkoZmlsdGVyKS52YWx1ZXMoKS50b0FycmF5KCkpO1xuICAgICAgICB2YXIga2V5cyA9IExhenkoZmlsdGVyKS5rZXlzKCkudG9BcnJheSgpO1xuICAgICAgICByZXR1cm4gcHJvZHVjdC5tYXAoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICB2YXIgciA9IHt9O1xuICAgICAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGEsbil7XG4gICAgICAgICAgICAgICAgclthXSA9IHhbbl07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICB9O1xuICAgIHZhciBmaWx0ZXJTaW5nbGUgPSBmdW5jdGlvbihtb2RlbCwgZmlsdGVyLCB0ZXN0T25seSl7XG4gICAgICAgIC8vIExhenkgYXV0byBjcmVhdGUgaW5kZXhlc1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gbW9kZWwubW9kZWxOYW1lO1xuICAgICAgICB2YXIgZ2V0SW5kZXhGb3IgPSB0aGlzLmdldEluZGV4Rm9yO1xuICAgICAgICB2YXIga2V5cyA9IExhenkoZmlsdGVyKS5tYXAoZnVuY3Rpb24odixrZXkpeyByZXR1cm4gW2tleSwgbW9kZWxOYW1lICsgJy4nICsga2V5XTsgfSkudG9PYmplY3QoKTtcbiAgICAgICAgdmFyIGluZGV4ZXMgPSBMYXp5KGZpbHRlcikua2V5cygpLm1hcChmdW5jdGlvbihrZXkpeyByZXR1cm4gW2tleSwgZ2V0SW5kZXhGb3IobW9kZWxOYW1lLCBrZXkpXX0pLnRvT2JqZWN0KCk7IFxuICAgICAgICAvLyBmYWtlIGZvciAoaXQgd2lsbCBjeWNsZSBvbmNlKVxuICAgICAgICBmb3IgKHZhciB4IGluIGZpbHRlcil7XG4gICAgICAgICAgICAvLyBnZXQgYXNrZWQgaW5kZXggYW5kIGNoZWNrIHByZXNlbmNlXG4gICAgICAgICAgICB2YXIgZGlmZmVyZW5jZSA9IExhenkoZmlsdGVyW3hdKS5kaWZmZXJlbmNlKGluZGV4ZXNbeF0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIGlmIChkaWZmZXJlbmNlLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgLy8gZ2VuZXJhdGUgbmV3IGZpbHRlclxuICAgICAgICAgICAgICAgIHZhciByZXQgPSBMYXp5KFtbeCwgZGlmZmVyZW5jZV1dKS50b09iamVjdCgpO1xuICAgICAgICAgICAgICAgIC8vIHJlbWVtYmVyIGFza2VkXG4gICAgICAgICAgICAgICAgaWYgKCF0ZXN0T25seSlcbiAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoaW5kZXhlc1t4XSwgZGlmZmVyZW5jZSk7XG4vLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlIGZpbHRlciA6ICcgKyBKU09OLnN0cmluZ2lmeShmaWx0ZXIpICsgJ1xcbk91dCA6JyArIEpTT04uc3RyaW5naWZ5KHJldCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuLy8gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NpbmdsZSBmaWx0ZXIgOiAnICsgSlNPTi5zdHJpbmdpZnkoZmlsdGVyKSArICdcXG5PdXQgOiBudWxsJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIGNsZWFuQ29tcG9zaXRlcyA9IGZ1bmN0aW9uKG1vZGVsLGZpbHRlcil7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjbGVhbiBjb21wb3NpdGVBc2tlZFxuICAgICAgICAgKi9cbiAgICAgICAgLy8gbGF6eSBjcmVhdGUgY29uZGl0aW9uYWwgYXNrZWQgaW5kZXhcbiAgICAgICAgaWYgKCEobW9kZWwubmFtZSBpbiBjb21wb3NpdGVBc2tlZCkpIHsgY29tcG9zaXRlQXNrZWRbbW9kZWwubmFtZV0gPSBbXSB9O1xuICAgICAgICB2YXIgaW5kZXggPSBjb21wb3NpdGVBc2tlZFttb2RlbC5uYW1lXTtcbiAgICAgICAgLy8gc2VhcmNoIGZvciBhbGwgZWxlbWVudHMgd2hvIGhhdmUgc2FtZSBwYXJ0aWFsXG4gICAgICAgIHZhciBmaWx0ZXJMZW4gPSBMYXp5KGZpbHRlcikuc2l6ZSgpO1xuICAgICAgICB2YXIgaXRlbXMgPSBpbmRleC5maWx0ZXIodXRpbHMubWFrZUZpbHRlcihtb2RlbCwgZmlsdGVyLCAnICYmICcsdHJ1ZSkpLmZpbHRlcihmdW5jdGlvbihpdGVtKXsgTGF6eShpdGVtKS5zaXplKCkgPiBmaWx0ZXJMZW4gfSk7XG4vLyAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0aW5nIDonICsgSlNPTi5zdHJpbmdpZnkoaXRlbXMpKTtcbiAgICB9O1xuXG4gICAgdGhpcy5maWx0ZXIgPSBmdW5jdGlvbihtb2RlbCwgZmlsdGVyKXtcbi8vICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tXFxuZmlsdGVyIDogJyArIEpTT04uc3RyaW5naWZ5KGZpbHRlcikpO1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gbW9kZWwubW9kZWxOYW1lO1xuXG4gICAgICAgIC8vIGlmIHlvdSBmZXRjaCBhbGwgb2JqZWN0cyBmcm9tIHNlcnZlciwgdGhpcyBtb2RlbCBoYXMgdG8gYmUgbWFya2VkIGFzIGdvdCBhbGw7XG4gICAgICAgIHZhciBmaWx0ZXJMZW4gID0gTGF6eShmaWx0ZXIpLnNpemUoKTtcbiAgICAgICAgc3dpdGNoIChmaWx0ZXJMZW4pIHtcbiAgICAgICAgICAgIGNhc2UgMCA6IHtcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gbnVsbCBvciBhbGxcbiAgICAgICAgICAgICAgICB2YXIgZ290ID0gZ290QWxsW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgZ290QWxsW21vZGVsTmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gYXNrZWQpe1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgYXNrZWRbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnb3V0IDogbnVsbCAoZ290IGFsbCknKTtcbiAgICAgICAgICAgICAgICAvLyBjb25kaXRpb25hbCBjbGVhblxuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gY29tcG9zaXRlQXNrZWQpeyBcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnb3QpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgMSA6IHtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gZmlsdGVyU2luZ2xlLmNhbGwodGhpcywgbW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICAgICAgY2xlYW5Db21wb3NpdGVzLmNhbGwodGhpcywgbW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgdmFyIHNpbmdsZSA9IExhenkoZmlsdGVyKS5rZXlzKCkuc29tZShmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIHZhciBmID0ge307XG4gICAgICAgICAgICBmW2tleV0gPSBmaWx0ZXJba2V5XTtcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJTaW5nbGUuY2FsbCh0aHMsIG1vZGVsLCBmLCB0cnVlKSA9PSBudWxsO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHNpbmdsZSkgeyByZXR1cm4gbnVsbCB9XG4gICAgICAgIC8vIGxhenkgY3JlYXRlIGNvbXBvc2l0ZUFza2VkXG4gICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBjb21wb3NpdGVBc2tlZCkpeyBjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdID0gW107IH1cbiAgICAgICAgLy8gZXhwbG9kZSBmaWx0ZXJcbiAgICAgICAgdmFyIGV4cGxvZGVkID0gZXhwbG9kZUZpbHRlcihmaWx0ZXIpO1xuICAgICAgICAvLyBjb2xsZWN0IHBhcnRpYWxzXG4gICAgICAgIHZhciBwYXJ0aWFscyA9IGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV0uZmlsdGVyKHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIGZpbHRlciwgJyB8fCAnLHRydWUpKTtcbiAgICAgICAgLy8gY29sbGVjdCBtaXNzaW5ncyAoZXhwbG9kZWQgLSBwYXJ0aWFscylcbiAgICAgICAgaWYgKHBhcnRpYWxzLmxlbmd0aCl7XG4gICAgICAgICAgICB2YXIgYmFkICA9IFtdO1xuICAgICAgICAgICAgLy8gcGFydGlhbCBkaWZmZXJlbmNlXG4gICAgICAgICAgICBmb3IgKHZhciB4IGluIHBhcnRpYWxzKXtcbiAgICAgICAgICAgICAgICBiYWQucHVzaC5hcHBseShiYWQsZXhwbG9kZWQuZmlsdGVyKHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIHBhcnRpYWxzW3hdLCcgJiYgJywgdHJ1ZSkpKTtcbiAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgY29uc29sZS5sb2coJ2V4cGxvZGVkIC0gcGFydGlhbCA6ICcgKyBKU09OLnN0cmluZ2lmeShiYWQpKTtcbiAgICAgICAgICAgIHZhciBtaXNzaW5ncyA9IExhenkoZXhwbG9kZWQpLmRpZmZlcmVuY2UoYmFkKS50b0FycmF5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgbWlzc2luZ3MgPSBleHBsb2RlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZpbHRlciBwYXJ0aWFsc1xuICAgICAgICBpZiAobWlzc2luZ3MubGVuZ3RoKXtcbiAgICAgICAgICAgIGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV0ucHVzaC5hcHBseShjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdLG1pc3NpbmdzKTtcbiAgICAgICAgICAgIC8vIGFnZ3JlZ2F0ZSBtaXNzaW5nc1xuICAgICAgICAgICAgdmFyIG1pc3NpbmdzID0gTGF6eShmaWx0ZXIpLmtleXMoKS5tYXAoZnVuY3Rpb24oa2V5KXtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gTGF6eShtaXNzaW5ncykucGx1Y2soa2V5KS51bmlxdWUoKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtrZXksIHJldC5sZW5ndGg/cmV0OmZpbHRlcltrZXldXTtcbiAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4vLyAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvdXQgOiAnICsgSlNPTi5zdHJpbmdpZnkobWlzc2luZ3MpKTtcbiAgICAgICAgICAgIC8vIGNsZWFuIGNvbmRpdGlvbmFsXG4gICAgICAgICAgICBjbGVhbkNvbXBvc2l0ZXMobW9kZWwsIG1pc3NpbmdzKTtcbiAgICAgICAgICAgIHJldHVybiBtaXNzaW5ncztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRJbmRleEZvciA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgZmllbGROYW1lKXtcbiAgICAgICAgdmFyIGluZGV4TmFtZSA9IG1vZGVsTmFtZSArICcuJyArIGZpZWxkTmFtZTtcbiAgICAgICAgaWYgKCEoaW5kZXhOYW1lIGluIGFza2VkKSl7XG4gICAgICAgICAgICBhc2tlZFtpbmRleE5hbWVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFza2VkW2luZGV4TmFtZV07XG4gICAgfVxufTsiLCIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIE1hbnlUb01hbnlSZWxhdGlvbihyZWxhdGlvbixtMm0pe1xuICAgIHZhciBpdGVtcyA9IFtdO1xuICAgIHRoaXMuYWRkID0gaXRlbXMucHVzaC5iaW5kKGl0ZW1zKTtcbiAgICB0aGlzLmFkZCA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICBjb25zb2xlLmxvZygnYWRkaW5nICcgKyBpdGVtKTtcbiAgICAgICAgaWYgKCEoTGF6eShpdGVtcykuZmluZChpdGVtKSkpe1xuICAgICAgICAgICAgaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZ2V0MCA9IGZ1bmN0aW9uKGlkKXtcbiAgICAgICAgbTJtWzFdLmFzayhpZCk7XG4gICAgICAgIHJldHVybiBMYXp5KGl0ZW1zKS5maWx0ZXIoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICByZXR1cm4geFswXSA9PT0gaWQ7XG4gICAgICAgIH0pLnBsdWNrKFwiMVwiKS50b0FycmF5KCk7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0MSA9IGZ1bmN0aW9uKGlkKXtcbiAgICAgICAgbTJtWzBdLmFzayhpZCk7XG4gICAgICAgIHJldHVybiBMYXp5KGl0ZW1zKS5maWx0ZXIoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICByZXR1cm4geFsxXSA9PT0gaWQ7XG4gICAgICAgIH0pLnBsdWNrKFwiMFwiKS50b0FycmF5KCk7XG4gICAgfTtcbiAgICB0aGlzWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZShyZWxhdGlvbi5pbmRleE5hbWUuc3BsaXQoJy8nKVsxXSldID0gdGhpcy5nZXQxO1xuICAgIHRoaXNbJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKHJlbGF0aW9uLmluZGV4TmFtZS5zcGxpdCgnLycpWzBdKV0gPSB0aGlzLmdldDA7XG5cbiAgICB0aGlzLmRlbCA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICB2YXIgbCA9IGl0ZW1zLmxlbmd0aDtcbiAgICAgICAgdmFyIGlkeCA9IG51bGw7XG4gICAgICAgIGZvciAodmFyIGEgPSAwOyBhIDwgbDsgYSsrKXsgXG4gICAgICAgICAgICBpZiAoKGl0ZW1zW2FdWzBdID09PSBpdGVtWzBdKSAmJiAoaXRlbXNbYV1bMV0gPT09IGl0ZW1bMV0pKXtcbiAgICAgICAgICAgICAgICBpZHggPSBhO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpZHgpe1xuICAgICAgICAgICAgaXRlbXMuc3BsaWNlKGEsIDEpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKCdkZWxldGluZyAnLCBpdGVtKTtcbiAgICB9O1xufSIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gY2FjaGVkUHJvcGVydHlCeUV2ZW50cyhwcm90bywgcHJvcGVydHlOYW1lLGdldHRlciwgc2V0dGVyKXtcbiAgICB2YXIgZXZlbnRzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDQpO1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICBcbiAgICBMYXp5KGV2ZW50cykuZWFjaChmdW5jdGlvbihldmVudCl7XG4gICAgICAgIHByb3RvLm9ybS5vbihldmVudCxmdW5jdGlvbigpe1xuICAgICAgICAgICAgcmVzdWx0ID0ge307XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHZhciBwcm9wZXJ0eURlZiA9IHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBjYWNoZWQoKXtcbiAgICAgICAgICAgIGlmICghKHRoaXMuaWQgaW4gcmVzdWx0KSl7XG4gICAgICAgICAgICAgICAgcmVzdWx0W3RoaXMuaWRdID0gZ2V0dGVyLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0W3RoaXMuaWRdO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBpZiAoc2V0dGVyKXtcbiAgICAgICAgcHJvcGVydHlEZWZbJ3NldCddID0gZnVuY3Rpb24odmFsdWUpe1xuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSByZXN1bHRbdGhpcy5pZF0pe1xuICAgICAgICAgICAgICAgIHNldHRlci5jYWxsKHRoaXMsdmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlkIGluIHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSByZXN1bHRbdGhpcy5pZF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm90bywgcHJvcGVydHlOYW1lLHByb3BlcnR5RGVmKTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gVmFsaWRhdGlvbkVycm9yKGRhdGEpe1xuICAgIHRoaXMucmVzb3VyY2UgPSBkYXRhLl9yZXNvdXJjZTtcbiAgICB0aGlzLmZvcm1JZHggPSBkYXRhLmZvcm1JZHg7XG4gICAgdGhpcy5maWVsZHMgPSBkYXRhLmVycm9ycztcbn1cbnZhciBiYXNlT1JNID0gZnVuY3Rpb24ob3B0aW9ucywgZXh0T1JNKXtcbiAgICBcbiAgICAvLyBjcmVhdGluZyByZXdoZWVsIGNvbm5lY3Rpb25cbiAgICBpZiAob3B0aW9ucy5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKXtcbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBuZXcgcmVXaGVlbENvbm5lY3Rpb24ob3B0aW9ucyk7XG4gICAgfSBlbHNlIGlmIChvcHRpb25zLmNvbnN0cnVjdG9yID09PSB1dGlscy5yZVdoZWVsQ29ubmVjdGlvbil7XG4gICAgICAgIHZhciBjb25uZWN0aW9uID0gb3B0aW9ucztcbiAgICB9XG4gICAgdGhpcy5jb25uZWN0aW9uID0gY29ubmVjdGlvbjtcbiAgICBjb25uZWN0aW9uLm9uKCdjb25uZWN0ZWQnLCBmdW5jdGlvbigpeyBcbiAgICAgICAgdGhpcy5jb25uZWN0ZWQgPSB0cnVlO1xuICAgIH0pO1xuICAgIHZhciBldmVudHMgPSBjb25uZWN0aW9uLmV2ZW50cztcbiAgICB0aGlzLm9uID0gZXZlbnRzLm9uLmJpbmQodGhpcyk7XG4gICAgdGhpcy5lbWl0ID0gZXZlbnRzLmVtaXQuYmluZCh0aGlzKTtcbiAgICB0aGlzLnVuYmluZCA9IGV2ZW50cy51bmJpbmQuYmluZCh0aGlzKTtcbiAgICB0aGlzLiRwb3N0ID0gY29ubmVjdGlvbi4kcG9zdC5iaW5kKGNvbm5lY3Rpb24pO1xuXG4gICAgLy8gaGFuZGxpbmcgd2Vic29ja2V0IGV2ZW50c1xuICAgIGV2ZW50cy5vbignd3MtY29ubmVjdGVkJyxmdW5jdGlvbih3cyl7XG4gICAgICAgIGNvbnNvbGUuaW5mbygnV2Vic29ja2V0IGNvbm5lY3RlZCcpO1xuICAgICAgICAvLyBhbGwganNvbiBkYXRhIGhhcyB0byBiZSBwYXJzZWQgYnkgZ290RGF0YVxuICAgICAgICB3cy5vbk1lc3NhZ2VKc29uKFcyUFJFU09VUkNFLmdvdERhdGEuYmluZChXMlBSRVNPVVJDRSkpO1xuICAgICAgICAvL1xuICAgICAgICB3cy5vbk1lc3NhZ2VUZXh0KGZ1bmN0aW9uKG1lc3NhZ2Upe1xuICAgICAgICAgICAgY29uc29sZS5pbmZvKCdXUyBtZXNzYWdlIDogJyArIG1lc3NhZ2UpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIGV2ZW50cy5vbignd3MtZGlzY29ubmVjdGVkJywgZnVuY3Rpb24od3Mpe1xuICAgICAgICBjb25zb2xlLmVycm9yKCdXZWJzb2NrZXQgZGlzY29ubmVjdGVkJylcbiAgICB9KTtcbiAgICBldmVudHMub24oJ2Vycm9yLWpzb24tNDA0JyxmdW5jdGlvbihlcnJvcix1cmwsIHNlbnREYXRhLCB4aHIpeyBcbiAgICAgICAgY29uc29sZS5lcnJvcignSlNPTiBlcnJvciAnLCBKU09OLnN0cmluZ2lmeShlcnJvcikpO1xuICAgICAgICBkZWxldGUgd2FpdGluZ0Nvbm5lY3Rpb25zW3VybC5zcGxpdCgnLycpWzBdXTtcbiAgICB9KVxuXG4gICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICB2YXIgVzJQUkVTT1VSQ0UgPSB0aGlzO1xuICAgIHZhciBJREIgPSB7YXV0aF9ncm91cCA6IExhenkoe30pfTsgLy8gdGFibGVOYW1lIC0+IGRhdGEgYXMgQXJyYXlcbiAgICB2YXIgSURYID0ge307IC8vIHRhYmxlTmFtZSAtPiBMYXp5KGluZGV4QnkoJ2lkJykpIC0+IElEQltkYXRhXVxuICAgIHZhciBSRVZJRFggPSB7fTsgLy8gdGFibGVOYW1lIC0+IGZpZWxkTmFtZSAtPiBMYXp5Lmdyb3VwQnkoKSAtPiBJREJbREFUQV1cbiAgICB2YXIgYnVpbGRlckhhbmRsZXJzID0ge307XG4gICAgdmFyIGJ1aWxkZXJIYW5kbGVyVXNlZCA9IHt9O1xuICAgIHZhciBwZXJzaXN0ZW50QXR0cmlidXRlcyA9IHt9O1xuICAgIHZhciBldmVudEhhbmRsZXJzID0ge307XG4gICAgdmFyIHBlcm1pc3Npb25XYWl0aW5nID0ge307XG4gICAgdmFyIG1vZGVsQ2FjaGUgPSB7fTtcbiAgICB2YXIgZmFpbGVkTW9kZWxzID0ge307XG4gICAgdmFyIHdhaXRpbmdDb25uZWN0aW9ucyA9IHt9IC8vIGFjdHVhbCBjb25uZWN0aW9uIHdobyBpJ20gd2FpdGluZyBmb3JcbiAgICB2YXIgbGlzdENhY2hlID0gbmV3IExpc3RDYWNoZXIoTGF6eSk7XG4gICAgdmFyIGxpbmtlciA9IG5ldyBBdXRvTGlua2VyKGV2ZW50cyx3YWl0aW5nQ29ubmVjdGlvbnMsSURCLCB0aGlzLCBsaXN0Q2FjaGUpO1xuLyogICAgd2luZG93LmxsID0gbGlua2VyO1xuICAgIHdpbmRvdy5sYyA9IGxpc3RDYWNoZTtcbiovXG4gICAgdGhpcy52YWxpZGF0aW9uRXZlbnQgPSBldmVudHMub24oJ2Vycm9yLWpzb24tNTEzJywgZnVuY3Rpb24oZGF0YSwgdXJsLCBzZW50RGF0YSwgeGhyKXtcbiAgICAgICAgaWYgKGN1cnJlbnRDb250ZXh0LnNhdmluZ0Vycm9ySGFubGRlcil7XG4gICAgICAgICAgICBjdXJyZW50Q29udGV4dC5zYXZpbmdFcnJvckhhbmxkZXIobmV3IFZhbGlkYXRpb25FcnJvcihkYXRhKSk7XG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgdmFyIGdldEluZGV4ID0gZnVuY3Rpb24gKGluZGV4TmFtZSkge1xuICAgICAgICBpZiAoaW5kZXhOYW1lIGluIElEQilcbiAgICAgICAgICAgIHJldHVybiBJREJbaW5kZXhOYW1lXTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBJREJbaW5kZXhOYW1lXSA9IExhenkoe30pO1xuICAgICAgICAgICAgcmV0dXJuIElEQltpbmRleE5hbWVdO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgZ2V0VW5saW5rZWQgPSBmdW5jdGlvbiAoaW5kZXhOYW1lKSB7XG4gICAgICAgIGlmIChpbmRleE5hbWUgaW4gVU5MSU5LRUQpXG4gICAgICAgICAgICByZXR1cm4gVU5MSU5LRURbaW5kZXhOYW1lXTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBVTkxJTktFRFtpbmRleE5hbWVdID0ge307XG4gICAgICAgICAgICByZXR1cm4gVU5MSU5LRURbaW5kZXhOYW1lXTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBQZXJtaXNzaW9uVGFibGUoaWQsIGtsYXNzLCBwZXJtaXNzaW9ucykge1xuICAgICAgICAvLyBjcmVhdGUgUGVybWlzc2lvblRhYmxlIGNsYXNzXG4gICAgICAgIHRoaXMua2xhc3MgPSBrbGFzcztcbiAgICAgICAgdGhpcy5wZXJtaXNzaW9ucyA9IFtdO1xuICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgIGZvciAodmFyIGsgaW4gcGVybWlzc2lvbnMpIHtcbiAgICAgICAgICAgIHRoaXMucHVzaC5hcHBseSh0aGlzLCBbaywgcGVybWlzc2lvbnNba11dKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBQZXJtaXNzaW9uVGFibGUucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgLy8gc2F2ZSBPYmplY3QgdG8gc2VydmVyXG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgcGVybWlzc2lvbnM6IExhenkodGhpcy5wZXJtaXNzaW9ucykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFt4WzBdLmlkLCB4WzFdXVxuICAgICAgICAgICAgfSkudG9PYmplY3QoKVxuICAgICAgICB9O1xuICAgICAgICBkYXRhLmlkID0gdGhpcy5pZDtcbiAgICAgICAgdmFyIG1vZGVsTmFtZSA9IHRoaXMua2xhc3MubW9kZWxOYW1lO1xuICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdCh0aGlzLmtsYXNzLm1vZGVsTmFtZSArICcvc2V0X3Blcm1pc3Npb25zJywgZGF0YSwgZnVuY3Rpb24gKG15UGVybXMsIGEsIGIsIHJlcSkge1xuICAgICAgICAgICAgY2IobXlQZXJtcyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUGVybWlzc2lvblRhYmxlLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKGdyb3VwX2lkLCBwZXJtaXNzaW9uTGlzdCkge1xuICAgICAgICB2YXIgcCA9IExhenkocGVybWlzc2lvbkxpc3QpO1xuICAgICAgICB2YXIgcGVybXMgPSBMYXp5KHRoaXMua2xhc3MuYWxsUGVybWlzc2lvbnMpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuIFt4LCBwLmNvbnRhaW5zKHgpXVxuICAgICAgICB9KS50b09iamVjdCgpO1xuICAgICAgICB2YXIgbCA9IExhenkodGhpcy5wZXJtaXNzaW9ucykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4geFswXS5pZFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGwuY29udGFpbnMoZ3JvdXBfaWQpKVxuICAgICAgICAgICAgdGhpcy5wZXJtaXNzaW9uc1tsLmluZGV4T2YoZ3JvdXBfaWQpXVsxXSA9IHBlcm1zO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0aGlzLnBlcm1pc3Npb25zLnB1c2goW0lEQi5hdXRoX2dyb3VwLmdldChncm91cF9pZCksIHBlcm1zXSk7XG4gICAgfTtcblxuICAgIC8vIGNyZWF0ZXMgZHluYW1pY2FsIG1vZGVsc1xuICAgIHZhciBtYWtlTW9kZWxDbGFzcyA9IGZ1bmN0aW9uIChtb2RlbCkge1xuICAgICAgICB2YXIgX21vZGVsID0gbW9kZWw7XG4gICAgICAgIHZhciBmaWVsZHMgPSBMYXp5KG1vZGVsLmZpZWxkcyk7XG4gICAgICAgIGlmIChtb2RlbC5wcml2YXRlQXJncykge1xuICAgICAgICAgICAgZmllbGRzID0gZmllbGRzLm1lcmdlKG1vZGVsLnByaXZhdGVBcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCdtb2RlbC1kZWZpbml0aW9uJywgbW9kZWwpO1xuICAgICAgICAvLyBnZXR0aW5nIGZpZWxkcyBvZiB0eXBlIGRhdGUgYW5kIGRhdGV0aW1lXG4vKlxuICAgICAgICB2YXIgREFURUZJRUxEUyA9IGZpZWxkcy5maWx0ZXIoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHJldHVybiAoeC50eXBlID09ICdkYXRlJykgfHwgKHgudHlwZSA9PSAnZGF0ZXRpbWUnKVxuICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKHgsIHYpIHtcbiAgICAgICAgICAgIHJldHVybiBbdiwgdHJ1ZV1cbiAgICAgICAgfSkudG9PYmplY3QoKTtcblxuICAgICAgICAvLyBnZXR0aW5nIGJvb2xlYW4gZmllbGRzXG4gICAgICAgIHZhciBCT09MRklFTERTID0gZmllbGRzLmZpbHRlcihmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuICh4LnR5cGUgPT0gJ2Jvb2xlYW4nKVxuICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKHgsIHYpIHtcbiAgICAgICAgICAgIHJldHVybiBbdiwgdHJ1ZV1cbiAgICAgICAgfSkudG9PYmplY3QoKTtcblxuICAgICAgICAvLyBib29sZWFucyBhbmQgZGF0ZXRpbWVzIHN0b3JhZ2UgZXh0ZXJuYWwgXG4gICAgICAgIE1PREVMX0RBVEVGSUVMRFNbbW9kZWwubmFtZV0gPSBEQVRFRklFTERTO1xuICAgICAgICBNT0RFTF9CT09MRklFTERTW21vZGVsLm5hbWVdID0gQk9PTEZJRUxEUztcbiovXG4gICAgICAgIC8vIGluaXRpYWxpemF0aW9uXG4gICAgICAgIHZhciBmdW5jU3RyaW5nID0gXCJpZiAoIXJvdykgeyByb3cgPSB7fX07XFxuXCI7XG4gICAgICAgIGZ1bmNTdHJpbmcgKz0gbW9kZWwucmVmZXJlbmNlcy5tYXAoZnVuY3Rpb24oZmllbGQpe1xuICAgICAgICAgICAgcmV0dXJuICd0aGlzLl8nICsgZmllbGQuaWQgKyAnID0gcm93LicgKyBmaWVsZC5pZCArICc7JztcbiAgICAgICAgfSkuam9pbignO1xcbicpO1xuICAgICAgICBcbiAgICAgICAgLy8gZGF0ZWZpZWxkIGNvbnZlcnNpb25cbiAgICAgICAgZnVuY1N0cmluZyArPSBmaWVsZHMubWFwKGZ1bmN0aW9uICh4LGspIHtcbiAgICAgICAgICAgIGlmICgoeC50eXBlID09ICdkYXRlJykgfHwgKHgudHlwZSA9PSAnZGF0ZXRpbWUnKSl7XG4gICAgICAgICAgICAgICAgcmV0dXJuICd0aGlzLicgKyBrICsgJyA9IHJvdy4nICsgayArICc/bmV3IERhdGUocm93LicgKyBrICsgJyAqIDEwMDAgLSAnICsgdXRpbHMudHpPZmZzZXQgKyAnKTpudWxsO1xcbic7IFxuICAgICAgICAgICAgfSBlbHNlIGlmICh4LnR5cGUgPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICd0aGlzLicgKyBrICsgJyA9IChyb3cuJyArIGsgKyAnID09PSBcIlRcIikgfHwgKHJvdy4nICsgayArICcgPT09IHRydWUpO1xcbic7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAndGhpcy4nICsgayArICcgPSByb3cuJyArIGsgKyAnO1xcbic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLnRvU3RyaW5nKCdcXG4nKTsgKyAnXFxuJztcblxuICAgICAgICBmdW5jU3RyaW5nICs9IFwiaWYgKHBlcm1pc3Npb25zKSB7dGhpcy5fcGVybWlzc2lvbnMgPSBwZXJtaXNzaW9ucyAmJiBMYXp5KHBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIFt4LCB0cnVlXSB9KS50b09iamVjdCgpO31cIlxuXG4gICAgICAgIFxuICAgICAgICAvLyBtYXN0ZXIgY2xhc3MgZnVuY3Rpb25cbiAgICAgICAgdmFyIEtsYXNzID0gbmV3IEZ1bmN0aW9uKCdyb3cnLCAncGVybWlzc2lvbnMnLGZ1bmNTdHJpbmcpXG5cbiAgICAgICAgS2xhc3MucHJvdG90eXBlLm9ybSA9IGV4dE9STTtcbiAgICAgICAgS2xhc3MucmVmX3RyYW5zbGF0aW9ucyA9IHt9O1xuICAgICAgICBLbGFzcy5tb2RlbE5hbWUgPSBtb2RlbC5uYW1lO1xuICAgICAgICBLbGFzcy5yZWZlcmVuY2VzID0gTGF6eShtb2RlbC5yZWZlcmVuY2VzKS5wbHVjaygnaWQnKS50b0FycmF5KCk7XG5cbiAgICAgICAgS2xhc3MuaW52ZXJzZV9yZWZlcmVuY2VzID0gbW9kZWwucmVmZXJlbmNlZEJ5Lm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgLy8gbWFuYWdpbmcgcmVmZXJlbmNlcyB3aGVyZSBcbiAgICAgICAgICAgIHJldHVybiB4LmJ5ICsgJ18nICsgeC5pZCArICdfc2V0J1xuICAgICAgICB9KTtcbiAgICAgICAgS2xhc3MucmVmZXJlbnRzID0gbW9kZWwucmVmZXJlbmNlZEJ5Lm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuIFt4LmJ5LCB4LmlkXVxuICAgICAgICB9KTtcbiAgICAgICAgS2xhc3MuZmllbGRzT3JkZXIgPSBtb2RlbC5maWVsZE9yZGVyO1xuICAgICAgICBLbGFzcy5hbGxQZXJtaXNzaW9ucyA9IG1vZGVsLnBlcm1pc3Npb25zO1xuXG4gICAgICAgIC8vIHJlZGVmaW5pbmcgdG9TdHJpbmcgbWV0aG9kXG4gICAgICAgIGlmIChMYXp5KG1vZGVsLnJlcHJlc2VudGF0aW9uKS5zaXplKCkpe1xuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlLnRvU3RyaW5nID0gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcy4nICsgTGF6eShtb2RlbC5yZXByZXNlbnRhdGlvbikudG9TdHJpbmcoJyArIFwiIFwiICsgdGhpcy4nKSk7XG4gICAgICAgIH1cbiAgICAgICAgS2xhc3MucHJvdG90eXBlLnRvVXBwZXJDYXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gcmVkZWZpbmUgdG8gVXBwZXJDYXNlXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b1N0cmluZygpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIH07XG4gICAgICBcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLnRvTG93ZXJDYXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIGRlbGV0ZSBpbnN0YW5jZSBmcm9tIHNlcnZlclxuICAgICAgICAgICAgcmV0dXJuIGV4dE9STS5kZWxldGUodGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUsIFt0aGlzLmlkXSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gcGVybWlzc2lvbiBnZXR0ZXIgcHJvcGVydHlcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtsYXNzLnByb3RvdHlwZSwgJ3Blcm1pc3Npb25zJywge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Blcm1pc3Npb25zKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcGVybWlzc2lvbnM7XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmtlci5wZXJtaXNzaW9uc1t0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZV0uYXNrKHRoaXMuaWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGdldHRpbmcgZnVsbCBwZXJtaXNzaW9uIHRhYmxlIGZvciBhbiBvYmplY3RcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLmFsbF9wZXJtcyA9IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAgICAgdmFyIG9iamVjdF9pZCA9IHRoaXMuaWQ7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdCh0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZSArICcvYWxsX3Blcm1zJywge2lkOiB0aGlzLmlkfSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGVybWlzc2lvbnMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIHZhciBncm91cGVkID0ge307XG4gICAgICAgICAgICAgICAgdmFyIHVua25vd25fZ3JvdXBzID0gTGF6eShwZXJtaXNzaW9ucykucGx1Y2soJ2dyb3VwX2lkJykudW5pcXVlKCkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnJyArIHhcbiAgICAgICAgICAgICAgICB9KS5kaWZmZXJlbmNlKElEQi5hdXRoX2dyb3VwLmtleXMoKSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIExhenkocGVybWlzc2lvbnMpLmdyb3VwQnkoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHguZ3JvdXBfaWRcbiAgICAgICAgICAgICAgICB9KS5lYWNoKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwZWRba10gPSBMYXp5KHYpLnBsdWNrKCduYW1lJykudG9BcnJheSgpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIGNhbGwgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICBjYihuZXcgUGVybWlzc2lvblRhYmxlKG9iamVjdF9pZCwgS2xhc3MsIGdyb3VwZWQpKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmICh1bmtub3duX2dyb3Vwcy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdldCgnYXV0aF9ncm91cCcsdW5rbm93bl9ncm91cHMsY2FsbCk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBjYWxsKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBLbGFzcy5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgbyA9IHRoaXMuYXNSYXcoKTtcbiAgICAgICAgICAgIHZhciBmaWVsZHMgPSBLbGFzcy5maWVsZHM7XG4gICAgICAgICAgICB2YXIgSUQgPSB0aGlzLmlkO1xuICAgICAgICAgICAgdmFyIG1vZGVsTmFtZSA9IHRoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lO1xuICAgICAgICAgICAgaWYgKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBhcmcgaW4gYXJncykge1xuICAgICAgICAgICAgICAgICAgICBvW2FyZ10gPSBhcmdzW2FyZ107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZWxpbWluYXRlIHVud3JpdGFibGVzXG4gICAgICAgICAgICBMYXp5KEtsYXNzLmZpZWxkc09yZGVyKS5maWx0ZXIoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuICFmaWVsZHNbeF0ud3JpdGFibGU7XG4gICAgICAgICAgICB9KS5lYWNoKGZ1bmN0aW9uKGZpZWxkTmFtZSl7XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkTmFtZSBpbiBvKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvW2ZpZWxkTmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IFcyUFJFU09VUkNFLiRwb3N0KG1vZGVsTmFtZSArIChJRCA/ICcvcG9zdCcgOiAnL3B1dCcpLCBvKTtcbiAgICAgICAgICAgIGlmIChhcmdzICYmIChhcmdzLmNvbnN0cnVjdG9yID09PSBGdW5jdGlvbikpe1xuICAgICAgICAgICAgICAgIC8vIHBsYWNpbmcgY2FsbGJhY2sgaW4gYSBjb21tb24gcGxhY2VcbiAgICAgICAgICAgICAgICBwcm9taXNlLmNvbnRleHQuc2F2aW5nRXJyb3JIYW5sZGVyID0gYXJncztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlXG4gICAgICAgIH07XG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG9iaiA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuYXNSYXcoKSk7XG4gICAgICAgICAgICBvYmouX3Blcm1pc3Npb25zID0gdGhpcy5fcGVybWlzc2lvbnM7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGJ1aWxkaW5nIHNlcmlhbGl6YXRpb24gZnVuY3Rpb25cbiAgICAgICAgdmFyIGFzciA9ICdyZXR1cm4ge1xcbicgKyBMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLm1hcChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICByZXR1cm4gZmllbGQuaWQgKyAnIDogdGhpcy5fJyArIGZpZWxkLmlkO1xuICAgICAgICB9KS5jb25jYXQoZmllbGRzLm1hcChmdW5jdGlvbiAoeCxrKSB7XG4gICAgICAgICAgICBpZiAoKHgudHlwZSA9PSAnZGF0ZScpIHx8ICh4LnR5cGUgPT0gJ2RhdGV0aW1lJykpe1xuICAgICAgICAgICAgICAgIHJldHVybiBrICsgJyA6ICh0aGlzLicgKyBrICsgJz8oTWF0aC5yb3VuZCh0aGlzLicgKyBrICsgJy5nZXRUaW1lKCkgLSB0aGlzLicgKyBrICsgJy5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDApIC8gMTAwMCk6bnVsbCknOyBcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoeC50eXBlID09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBrICsgJyA6IHRoaXMuJyArIGsgKyAnP1wiVFwiOlwiRlwiJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGsgKyAnIDogdGhpcy4nICsgaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLnRvU3RyaW5nKCcsXFxuJykgKyAnfTsnO1xuICAgICAgICBLbGFzcy5wcm90b3R5cGUuYXNSYXcgPSBuZXcgRnVuY3Rpb24oYXNyKTtcblxuICAgICAgICBLbGFzcy5zYXZlTXVsdGkgPSBmdW5jdGlvbiAob2JqZWN0cywgY2IsIHNjb3BlKSB7XG4gICAgICAgICAgICB2YXIgcmF3ID0gW107XG4gICAgICAgICAgICB2YXIgZGVsZXRhYmxlID0gTGF6eShLbGFzcy5maWVsZHMpXG4gICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXgud3JpdGFibGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5wbHVjaygnaWQnKVxuICAgICAgICAgICAgICAgIC50b0FycmF5KCk7XG4gICAgICAgICAgICBMYXp5KG9iamVjdHMpXG4gICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geC5hc1JhdygpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICBMYXp5KGRlbGV0YWJsZSkuZWFjaChmdW5jdGlvbiAoeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHhbeV07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByYXcucHVzaCh4KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KEtsYXNzLm1vZGVsTmFtZSwgJ3B1dCcsIHttdWx0aXBsZTogcmF3LCBmb3JtSWR4IDogVzJQUkVTT1VSQ0UuZm9ybUlkeCsrfSwgZnVuY3Rpb24gKGVsZW1zKSB7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShlbGVtcyk7XG4gICAgICAgICAgICAgICAgdmFyIHRhYiA9IElEQltLbGFzcy5tb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgIHZhciBvYmpzID0gTGF6eShlbGVtc1tLbGFzcy5tb2RlbE5hbWVdLnJlc3VsdHMpLnBsdWNrKCdpZCcpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFiLmdldCh4KVxuICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICBpZiAoY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgY2Iob2Jqcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgc2NvcGUpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoJ2V4dHJhX3ZlcmJzJyBpbiBtb2RlbClcbiAgICAgICAgICAgIExhenkobW9kZWwuZXh0cmFfdmVyYnMpLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZnVuY05hbWUgPSB4WzBdO1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0geFsxXTtcbiAgICAgICAgICAgICAgICB2YXIgZGRhdGEgPSAnZGF0YSA9IHtpZCA6IHRoaXMuaWQnO1xuICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgZGRhdGEgKz0gJywgJyArIExhenkoYXJncykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHggKyAnIDogJyArIHg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5qb2luKCcsJyk7XG4gICAgICAgICAgICAgICAgZGRhdGEgKz0gJ307JztcbiAgICAgICAgICAgICAgICBhcmdzLnB1c2goJ2NiJyk7XG4gICAgICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlW2Z1bmNOYW1lXSA9IG5ldyBGdW5jdGlvbihhcmdzLCBkZGF0YSArICdXMlMuVzJQX1BPU1QodGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUsXCInICsgZnVuY05hbWUgKyAnXCIsIGRhdGEsZnVuY3Rpb24oZGF0YSxzdGF0dXMsaGVhZGVycyx4KXsnICtcbiAgICAgICAgICAgICAgICAgICAgJ3RyeXtcXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJyAgIGlmICghaGVhZGVycyhcIm5vbW9kZWxcIikpIHt3aW5kb3cuVzJTLmdvdERhdGEoZGF0YSxjYik7fVxcbicgK1xuICAgICAgICAgICAgICAgICAgICAnICAgZWxzZSB7aWYgKGNiKSB7Y2IoZGF0YSl9fVxcbicgK1xuICAgICAgICAgICAgICAgICAgICAnfSBjYXRjaChlKXtcXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJ2lmIChjYikge2NiKGRhdGEpO31cXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJ31cXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJ30pO1xcbidcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIGlmICgncHJpdmF0ZUFyZ3MnIGluIG1vZGVsKSB7XG4gICAgICAgICAgICBLbGFzcy5wcml2YXRlQXJncyA9IExhenkobW9kZWwucHJpdmF0ZUFyZ3MpLmtleXMoKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW3gsIHRydWVdO1xuICAgICAgICAgICAgfSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZS5zYXZlUEEgPSBmdW5jdGlvbiAobykge1xuICAgICAgICAgICAgICAgIHZhciBUID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgb28gPSB7aWQ6IHRoaXMuaWR9O1xuICAgICAgICAgICAgICAgIHZhciBQQSA9IHRoaXMuY29uc3RydWN0b3IucHJpdmF0ZUFyZ3M7XG4gICAgICAgICAgICAgICAgdmFyIEZzID0gdGhpcy5jb25zdHJ1Y3Rvci5maWVsZHM7XG4gICAgICAgICAgICAgICAgdmFyIHQgPSBuZXcgdGhpcy5jb25zdHJ1Y3RvcihvKS5hc1JhdygpO1xuICAgICAgICAgICAgICAgIHZhciBmaWVsZElkeCA9IExhenkoUEEpLmtleXMoKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFt4LCBGc1t4XV1cbiAgICAgICAgICAgICAgICB9KS50b09iamVjdCgpO1xuICAgICAgICAgICAgICAgIExhenkobykuZWFjaChmdW5jdGlvbiAodiwgaykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKGsgaW4gUEEpICYmIGZpZWxkSWR4W2tdLndyaXRhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvb1trXSA9IHY7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdCh0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZSArICcvc2F2ZVBBJywgb28sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgTGF6eShvbykuZWFjaChmdW5jdGlvbiAodiwgaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgVFtrXSA9IHY7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1vZGVsQ2FjaGVbS2xhc3MubW9kZWxOYW1lXSA9IEtsYXNzO1xuICAgICAgICAvLyBhZGRpbmcgaWQgdG8gZmllbGRzXG4gICAgICAgIGZvciAodmFyIGYgaW4gbW9kZWwuZmllbGRzKSB7XG4gICAgICAgICAgICBtb2RlbC5maWVsZHNbZl0uaWQgPSBmO1xuICAgICAgICB9XG4gICAgICAgIEtsYXNzLmZpZWxkcyA9IExhenkobW9kZWwuZmllbGRzKS5jb25jYXQoTGF6eShtb2RlbC5wcml2YXRlQXJncykpLmNvbmNhdChMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLnRhcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgeC50eXBlID0geC50eXBlIHx8ICdyZWZlcmVuY2UnXG4gICAgICAgIH0pKS5pbmRleEJ5KCdpZCcpLnRvT2JqZWN0KCk7XG4gICAgICAgIC8vIHNldHRpbmcgd2lkZ2V0cyBmb3IgZmllbGRzXG4gICAgICAgIExhenkoS2xhc3MuZmllbGRzKS5lYWNoKGZ1bmN0aW9uKGZpZWxkKXtcbiAgICAgICAgICAgIGlmICghZmllbGQud2lkZ2V0KXtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQudHlwZSA9PT0gJ3JlZmVyZW5jZScpe1xuICAgICAgICAgICAgICAgICAgICBmaWVsZC53aWRnZXQgPSAnY2hvaWNlcydcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZC53aWRnZXQgPSBmaWVsZC50eXBlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGJ1aWxkaW5nIHJlZmVyZW5jZXMgdG8gKG1hbnkgdG8gb25lKSBmaWVsZHNcbiAgICAgICAgTGF6eShtb2RlbC5yZWZlcmVuY2VzKS5lYWNoKGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgICAgICAgIHZhciBleHRfcmVmID0gcmVmLnRvO1xuICAgICAgICAgICAgdmFyIGxvY2FsX3JlZiA9ICdfJyArIHJlZi5pZDtcbiAgICAgICAgICAgIGNhY2hlZFByb3BlcnR5QnlFdmVudHMoS2xhc3MucHJvdG90eXBlLCByZWYuaWQsZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICghKGV4dF9yZWYgaW4gSURCKSl7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5kZXNjcmliZShleHRfcmVmLGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlua2VyLm1haW5JbmRleFtleHRfcmVmXS5hc2sodGhzW2xvY2FsX3JlZl0sdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gKGV4dF9yZWYgaW4gSURCKSAmJiB0aGlzW2xvY2FsX3JlZl0gJiYgSURCW2V4dF9yZWZdLmdldCh0aGlzW2xvY2FsX3JlZl0pO1xuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0ICYmIChleHRfcmVmIGluIGxpbmtlci5tYWluSW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFza2luZyB0byBsaW5rZXJcbiAgICAgICAgICAgICAgICAgICAgbGlua2VyLm1haW5JbmRleFtleHRfcmVmXS5hc2sodGhpc1tsb2NhbF9yZWZdLHRydWUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXRpbHMubW9jaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUgIT0gZXh0X3JlZikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignWW91IGNhbiBhc3NpZ24gb25seSAnICsgZXh0X3JlZiArICcgdG8gJyArIHJlZi5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc1tsb2NhbF9yZWZdID0gdmFsdWUuaWQ7XG4gICAgICAgICAgICB9LCAnbmV3LScgKyBleHRfcmVmLCAnZGVsZXRlZC0nICsgZXh0X3JlZiwndXBkYXRlZC0nICsgZXh0X3JlZiwgJ25ldy1tb2RlbC0nICsgZXh0X3JlZik7XG5cblxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZShyZWYuaWQpXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXh0T1JNLmdldChleHRfcmVmLHRoaXNbbG9jYWxfcmVmXSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2J1aWxkaW5nIHJlZmVyZW5jZXMgdG8gKG9uZSB0byBtYW55KSBmaWVsZHNcbiAgICAgICAgTGF6eShtb2RlbC5yZWZlcmVuY2VkQnkpLmVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IHJlZi5ieSArICcuJyArIHJlZi5pZDtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSByZWYuYnkgKyAnXycgKyB1dGlscy5wbHVyYWxpemUocmVmLmlkKTtcbiAgICAgICAgICAgIHZhciByZXZJbmRleCA9IHJlZi5ieTtcbiAgICAgICAgICAgIGlmIChLbGFzcy5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkocHJvcGVydHlOYW1lKSkge1xuICAgICAgICAgICAgICAgICRsb2cuZXJyb3IoJ1RyeWVkIHRvIHJlZGVmaW5lIHByb3BlcnR5ICcgKyBwcm9wZXJ0eU5hbWUgKyAncycgKyAnIGZvciAnICsgS2xhc3MubW9kZWxOYW1lKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2FjaGVkUHJvcGVydHlCeUV2ZW50cyhLbGFzcy5wcm90b3R5cGUsIHByb3BlcnR5TmFtZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmV0ID0gKHJldkluZGV4IGluIElEQikgPyBSRVZJRFhbaW5kZXhOYW1lXS5nZXQodGhpcy5pZCArICcnKTpudWxsO1xuICAgICAgICAgICAgICAgICAgICBsaW5rZXIuZm9yZWlnbktleXNbaW5kZXhOYW1lXS5hc2sodGhpcy5pZCx0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgICAgICB9LCBudWxsLCAnbmV3LScgKyByZXZJbmRleCwgJ3VwZGF0ZWQtJyArIHJldkluZGV4LCAnZGVsZXRlZC0nICsgcmV2SW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZSh1dGlscy5wbHVyYWxpemUocmVmLmJ5KSldID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBvcHRzID0ge307XG4gICAgICAgICAgICAgICAgb3B0c1tyZWYuaWRdID0gW3RoaXMuaWRdO1xuICAgICAgICAgICAgICAgIHJldHVybiBleHRPUk0ucXVlcnkocmVmLmJ5LG9wdHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9idWlsZGluZyByZWZlcmVuY2UgdG8gKG1hbnkgdG8gbWFueSkgZmllbGRzXG4gICAgICAgIGlmIChtb2RlbC5tYW55VG9NYW55KSB7XG4gICAgICAgICAgICBMYXp5KG1vZGVsLm1hbnlUb01hbnkpLmVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgICAgICAgICAgIHZhciBpbmRleE5hbWUgPSByZWYuaW5kZXhOYW1lO1xuICAgICAgICAgICAgICAgIHZhciBmaXJzdCA9IHJlZi5maXJzdD8gMCA6IDE7XG4gICAgICAgICAgICAgICAgdmFyIG9tb2RlbE5hbWUgPSByZWYubW9kZWw7XG4vLyAgICAgICAgICAgICAgICB2YXIgb21vZGVsID0gZ2V0SW5kZXgob21vZGVsTmFtZSk7XG4gICAgICAgICAgICAgICAgdmFyIGdldHRlciA9IGxpbmtlci5tMm1JbmRleFtpbmRleE5hbWVdWydnZXQnICsgKDEgLSBmaXJzdCldO1xuXG4gICAgICAgICAgICAgICAgY2FjaGVkUHJvcGVydHlCeUV2ZW50cyhLbGFzcy5wcm90b3R5cGUsIHJlZi5tb2RlbCArICdzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRocyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWRzID0gZ2V0dGVyKHRocy5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1cyUFJFU09VUkNFLmZldGNoKG9tb2RlbE5hbWUsIHtpZCA6IGlkc30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldCA9IGdldEluZGV4KG9tb2RlbE5hbWUpLmdldC5iaW5kKElEQltvbW9kZWxOYW1lXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHMgJiYgZ2V0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IExhenkoaWRzKS5tYXAoZ2V0KS5maWx0ZXIodXRpbHMuYm9vbCkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgICAgICAgICAgfSwgbnVsbCwgJ3JlY2VpdmVkLW0ybS0nICsgaW5kZXhOYW1lLCAncmVjZWl2ZWQtJyArIG9tb2RlbE5hbWUpO1xuXG4gICAgICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZSh1dGlscy5wbHVyYWxpemUob21vZGVsTmFtZSkpXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRocyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtlci5nZXRNMk0oaW5kZXhOYW1lLCBbdGhzLmlkXSwgZmlyc3QsZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHMgPSBnZXR0ZXIodGhzLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkcy5sZW5ndGgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gob21vZGVsTmFtZSwge2lkIDogaWRzfSxudWxsLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdldCA9IElEQltvbW9kZWxOYW1lXS5nZXQuYmluZChJREJbb21vZGVsTmFtZV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VwdChMYXp5KGlkcykubWFwKGdldCkuZmlsdGVyKHV0aWxzLmJvb2wpLnRvQXJyYXkoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VwdChbXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgICAgICBLbGFzcy5maWVsZHNbdXRpbHMuY2FwaXRhbGl6ZShvbW9kZWxOYW1lKV0gPSB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB1dGlscy5jYXBpdGFsaXplKG9tb2RlbE5hbWUpLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiB1dGlscy5jYXBpdGFsaXplKG9tb2RlbE5hbWUpLFxuICAgICAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgcmVhZGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdNMk0nLFxuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0b3JzOiBbXVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBLbGFzcy5wcm90b3R5cGUudW5saW5rUmVmZXJlbmNlID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG11bHRpcGxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIElEID0gdGhpcy5pZDtcbiAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2VzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLmNvbnN0cnVjdG9yLm5hbWUgPT0gJ0FycmF5Jykge1xuICAgICAgICAgICAgICAgICAgICBtdWx0aXBsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlcyA9IGluc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZSA9IGluc3RhbmNlc1swXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG9tb2RlbCA9IGluc3RhbmNlLmNvbnN0cnVjdG9yLm1vZGVsTmFtZTtcbiAgICAgICAgICAgICAgICBpZiAobXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBMYXp5KGluc3RhbmNlcykucGx1Y2soJ2lkJykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW0lELCB4XVxuICAgICAgICAgICAgICAgICAgICB9KS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBbW0lELCBpbnN0YW5jZS5pZF1dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdChLbGFzcy5tb2RlbE5hbWUgKyAnLycgKyBvbW9kZWwgKyAncy9kZWxldGUnLCB7Y29sbGVjdGlvbjogY29sbGVjdGlvbn0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlLmxpbmtSZWZlcmVuY2UgPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbXVsdGlwbGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgSUQgPSB0aGlzLmlkO1xuICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2UuY29uc3RydWN0b3IubmFtZSA9PSAnQXJyYXknKSB7XG4gICAgICAgICAgICAgICAgICAgIG11bHRpcGxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VzID0gaW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlID0gaW5zdGFuY2VzWzBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgb21vZGVsID0gaW5zdGFuY2UuY29uc3RydWN0b3IubW9kZWxOYW1lO1xuICAgICAgICAgICAgICAgIHZhciBpbmRleE5hbWUgPSBLbGFzcy5tb2RlbE5hbWUgKyAnLycgKyBvbW9kZWw7XG4gICAgICAgICAgICAgICAgaWYgKG11bHRpcGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZWZzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleE5hbWUgaW4gSU5ERVhfTTJNKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWZzID0gTGF6eShpbnN0YW5jZXMpLnBsdWNrKCdpZCcpLmRpZmZlcmVuY2UoTGF6eShJTkRFWF9NMk1baW5kZXhOYW1lXVswXS5nZXQodGhpcy5pZCkpKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaW5kZXhOYW1lID0gb21vZGVsICsgJy8nICsgS2xhc3MubW9kZWxOYW1lO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXhOYW1lIGluIElOREVYX00yTSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcyA9IExhenkoaW5zdGFuY2VzKS5wbHVjaygnaWQnKS5kaWZmZXJlbmNlKExhenkoSU5ERVhfTTJNW2luZGV4TmFtZV1bMF0uZ2V0KHRoaXMuaWQpKSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZWZzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBMYXp5KHJlZnMpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbSUQsIHhdXG4gICAgICAgICAgICAgICAgICAgICAgICB9KS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBXMlBfUE9TVChLbGFzcy5tb2RlbE5hbWUsIG9tb2RlbCArICdzL3B1dCcsIHtjb2xsZWN0aW9uOiBjb2xsZWN0aW9ufSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChpbmRleE5hbWUgaW4gbGlua2VyLm0ybUluZGV4KSAmJiBMYXp5KGxpbmtlci5tMm1JbmRleFtpbmRleE5hbWVdWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZShvbW9kZWwpXShpbnN0YW5jZS5pZCkpLmZpbmQodGhpcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdChLbGFzcy5tb2RlbE5hbWUgKyAnLycgKyBvbW9kZWwgKyAncy9wdXQnLCB7Y29sbGVjdGlvbjogW1t0aGlzLmlkLCBpbnN0YW5jZS5pZF1dfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBldmVudHMuZW1pdCgnbmV3LW1vZGVsJywgS2xhc3MpO1xuICAgICAgICBldmVudHMuZW1pdCgnbmV3LW1vZGVsLScgKyBLbGFzcy5tb2RlbE5hbWUpO1xuICAgICAgICByZXR1cm4gS2xhc3M7XG4gICAgfTtcblxuICAgIHRoaXMuZ290RGF0YSA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsQmFjaykge1xuICAgICAgICAvLyByZWNlaXZlIGFsbCBkYXRhIGZyb20gZXZlcnkgZW5kIHBvaW50XG4gICAgICAgIGNvbnNvbGUuaW5mbygnZ290RGF0YScpO1xuICAgICAgICBpZiAodHlwZW9mKGRhdGEpID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZGF0YSAnICsgZGF0YSArICcgcmVmdXNlZCBmcm9tIGdvdERhdGEoKScpO1xuICAgICAgICAgICAgaWYgKGNhbGxCYWNrKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxCYWNrKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIGNsZWFuIGRhdGEgZnJvbSByZWxhdGlvbnMgYW5kIHBlcm1pc3Npb25zIGZvciB1c2luZyBpdCBhZnRlciBtb2RlbCBwYXJzaW5nXG4gICAgICAgIGlmICgnX2V4dHJhJyBpbiBkYXRhKXsgZGVsZXRlIGRhdGEuX2V4dHJhIH1cbiAgICAgICAgdmFyIFRPT05FID0gZGF0YS5UT09ORTtcbiAgICAgICAgdmFyIFRPTUFOWSA9IGRhdGEuVE9NQU5ZO1xuICAgICAgICB2YXIgTUFOWVRPTUFOWSA9IGRhdGEuTUFOWVRPTUFOWTtcbiAgICAgICAgdmFyIFBFUk1JU1NJT05TID0gZGF0YS5QRVJNSVNTSU9OUztcbiAgICAgICAgdmFyIFBBID0gZGF0YS5QQTtcbiAgICAgICAgZGVsZXRlIGRhdGEuVE9PTkU7XG4gICAgICAgIGRlbGV0ZSBkYXRhLlRPTUFOWTtcbiAgICAgICAgZGVsZXRlIGRhdGEuTUFOWVRPTUFOWTtcbiAgICAgICAgZGVsZXRlIGRhdGEuUEVSTUlTU0lPTlM7XG4gICAgICAgIGRlbGV0ZSBkYXRhLlBBO1xuICAgICAgICBpZiAoIVBBKSB7IFBBID0ge307IH1cblxuICAgICAgICAvLyBjbGVhbmluZyBmcm9tIHVzZWxlc3MgZGVsZXRlZCBkYXRhXG4gICAgICAgIGRhdGEgPSBMYXp5KGRhdGEpLmZpbHRlcihmdW5jdGlvbiAodiwgaykge1xuICAgICAgICAgICAgcmV0dXJuICghKCdkZWxldGVkJyBpbiB2KSB8fCAoKGsgaW4gbW9kZWxDYWNoZSkpKTtcbiAgICAgICAgfSkudG9PYmplY3QoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICgnbTJtJyBpbiBkYXRhKSB7XG4gICAgICAgICAgICB2YXIgbTJtID0gZGF0YS5tMm07XG4gICAgICAgICAgICBkZWxldGUgZGF0YVsnbTJtJ107XG4gICAgICAgIH1cbiAgICAgICAgTGF6eShkYXRhKS5lYWNoKGZ1bmN0aW9uIChkYXRhLCBtb2RlbE5hbWUpIHtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmRlc2NyaWJlKG1vZGVsTmFtZSwgZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsQ2xhc3MgPSBtb2RlbDtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5yZXN1bHRzICYmIChkYXRhLnJlc3VsdHMubGVuZ3RoID4gMCkgJiYgKGRhdGEucmVzdWx0c1swXS5jb25zdHJ1Y3RvciA9PSBBcnJheSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5yZXN1bHRzID0gTGF6eShkYXRhLnJlc3VsdHMpLm1hcChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBMYXp5KG1vZGVsQ2xhc3MuZmllbGRzT3JkZXIpLnppcCh4KS50b09iamVjdCgpXG4gICAgICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBMYXp5KGRhdGEucmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgdmFyIGRlbGV0ZWQgPSBkYXRhLmRlbGV0ZWQ7XG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBQQSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgTVBBID0gUEFbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgTGF6eShyZXN1bHRzKS5lYWNoKGZ1bmN0aW9uIChyZWNvcmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWNvcmQuaWQgaW4gTVBBKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTGF6eShNUEFbcmVjb3JkLmlkXSkuZWFjaChmdW5jdGlvbiAodiwgaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNvcmRba10gPSB2O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGluZGV4aW5nIHJlZmVyZW5jZXMgYnkgaXRzIElEXG4gICAgICAgICAgICAgICAgdmFyIGl0YWIgPSBnZXRJbmRleChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciB0YWJsZSA9IGl0YWIuc291cmNlO1xuXG4gICAgICAgICAgICAgICAgLy8gb2JqZWN0IGRlbGV0aW9uXG4gICAgICAgICAgICAgICAgaWYgKGRlbGV0ZWQpe1xuICAgICAgICAgICAgICAgICAgICBkZWxldGVkLmZvckVhY2goZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFibGVbeF07XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuLypcbiAgICAgICAgICAgICAgICBMYXp5KGRlbGV0ZWQpLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRhYmxlW3hdO1xuICAgICAgICAgICAgICAgIH0pO1xuKi9cbiAgICAgICAgICAgICAgICB2YXIgaWR4ID0gcmVzdWx0cy5pbmRleEJ5KCdpZCcpO1xuICAgICAgICAgICAgICAgIHZhciBpayA9IGlkeC5rZXlzKCk7XG4gICAgICAgICAgICAgICAgdmFyIG5uZXcgPSBpay5kaWZmZXJlbmNlKGl0YWIua2V5cygpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoeClcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWQgPSBpay5kaWZmZXJlbmNlKG5uZXcpO1xuICAgICAgICAgICAgICAgIC8vIHJlbW92aW5nIG9sZCBpZGVudGljYWwgdmFsdWVzXG4gICAgICAgICAgICAgICAgdXBkYXRlZCA9IHVwZGF0ZWQuZmlsdGVyKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhdXRpbHMuc2FtZUFzKGlkeC5nZXQoeCksIGl0YWIuZ2V0KHgpLmFzUmF3KCkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIGNsYXNzaWZ5IHJlY29yZHNcbiAgICAgICAgICAgICAgICB2YXIgcGVybXMgPSBkYXRhLnBlcm1pc3Npb25zID8gTGF6eShkYXRhLnBlcm1pc3Npb25zKSA6IExhenkoe30pO1xuICAgICAgICAgICAgICAgIHZhciBuZXdPYmplY3RzID0gbm5ldy5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBtb2RlbENsYXNzKGlkeC5nZXQoeCksIHBlcm1zLmdldCh4KSlcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vLy8gY2xhc3NpZnlpbmcgdXBkYXRlZFxuICAgICAgICAgICAgICAgIC8vdmFyIHVwZGF0ZWRPYmplY3RzID0gdXBkYXRlZC5tYXAoZnVuY3Rpb24oeCl7cmV0dXJuIG5ldyBtb2RlbENsYXNzKGlkeC5nZXQoeCkscGVybXMuZ2V0KHgpKX0pO1xuICAgICAgICAgICAgICAgIC8vdmFyIHVvID0gdXBkYXRlZE9iamVjdHMudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIC8vdXBkYXRlZE9iamVjdHMgPSBMYXp5KHVvKS5tYXAoZnVuY3Rpb24oeCl7cmV0dXJuIFt4LHRhYmxlW3guaWRdXX0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGluZyBzaW5nbGUgb2JqZWN0c1xuICAgICAgICAgICAgICAgIHZhciBjaGFuZ2VkID0gW107XG4vLyAgICAgICAgICAgICAgICB2YXIgREFURUZJRUxEUyA9IE1PREVMX0RBVEVGSUVMRFNbbW9kZWxOYW1lXTtcbi8vICAgICAgICAgICAgICAgIHZhciBCT09MRklFTERTID0gTU9ERUxfQk9PTEZJRUxEU1ttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgIHVwZGF0ZWQuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkSXRlbSA9IGl0YWIuZ2V0KHgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkQ29weSA9IG9sZEl0ZW0uY29weSgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3SXRlbSA9IG5ldyBtb2RlbENsYXNzKGlkeC5nZXQoeCkpO1xuICAgICAgICAgICAgICAgICAgICBMYXp5KG1vZGVsLmZpZWxkcykua2V5cygpLmVhY2goZnVuY3Rpb24oayl7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbGRJdGVtW2tdID0gbmV3SXRlbVtrXTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWQucHVzaChbb2xkSXRlbSwgb2xkQ29weV0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8vLyBzZW5kaW5nIHNpZ25hbCBmb3IgdXBkYXRlZCB2YWx1ZXNcbiAgICAgICAgICAgICAgICBpZiAoY2hhbmdlZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRzLmVtaXQoJ3VwZGF0ZWQtJyArIG1vZGVsTmFtZSwgY2hhbmdlZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vKioqKioqKiogVXBkYXRlIHVuaXZlcnNlICoqKioqKioqXG4gICAgICAgICAgICAgICAgdmFyIG5vID0gbmV3T2JqZWN0cy50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgTGF6eShubykuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICB0YWJsZVt4LmlkXSA9IHhcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyByZWJ1bGRpbmcgcmV2ZXJzZSBpbmRleGVzXG4gICAgICAgICAgICAgICAgTGF6eShtb2RlbENhY2hlW21vZGVsTmFtZV0ucmVmZXJlbmNlcykuZWFjaChmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIFJFVklEWFttb2RlbE5hbWUgKyAnLicgKyByZWZdID0gSURCW21vZGVsTmFtZV0uZ3JvdXBCeSgnXycgKyByZWYpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIHNlbmRpbmcgZXZlbnRzIGZvciBuZXcgdmFsdWVzXG4gICAgICAgICAgICAgICAgaWYgKG5vLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRzLmVtaXQoJ25ldy0nICsgbW9kZWxOYW1lLCBMYXp5KG5vKSwgZGF0YS50b3RhbFJlc3VsdHMpO1xuICAgICAgICAgICAgICAgIGlmIChkZWxldGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50cy5lbWl0KCdkZWxldGVkLScgKyBtb2RlbE5hbWUsIGRlbGV0ZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBzZW5kaW5nIGV2ZW50cyBmb3IgZGF0YSBhcnJpdmVkXG4gICAgICAgICAgICAgICAgZXZlbnRzLmVtaXQoJ3JlY2VpdmVkLScgKyBtb2RlbE5hbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoVE9PTkUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RPT05FJyk7XG4gICAgICAgICAgICBMYXp5KFRPT05FKS5lYWNoKGZ1bmN0aW9uICh2YWxzLCBtb2RlbE5hbWUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciB1ZHggPSBnZXRVbmxpbmtlZChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFRPTUFOWSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignVE9NQU5ZJyk7XG4gICAgICAgICAgICBMYXp5KFRPTUFOWSkuZWFjaChmdW5jdGlvbiAodmFscywgaW5kZXhOYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoaW5kZXhOYW1lIGluIEFTS0VEX1VOTElOS0VEKSkge1xuICAgICAgICAgICAgICAgICAgICBBU0tFRF9VTkxJTktFRFtpbmRleE5hbWVdID0gTGF6eShbXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIExhenkodmFscykuZWFjaChmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQVNLRURfVU5MSU5LRURbaW5kZXhOYW1lXS5zb3VyY2UucHVzaChpZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTUFOWVRPTUFOWSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignTUFOWVRPTUFOWScpO1xuICAgICAgICAgICAgTGF6eShNQU5ZVE9NQU5ZKS5lYWNoKGZ1bmN0aW9uICh2YWxzLCBpbmRleE5hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3QgPSBwYXJzZUludChpbmRleE5hbWUuc3BsaXQoJ3wnKVsxXSk7XG4gICAgICAgICAgICAgICAgaW5kZXhOYW1lID0gaW5kZXhOYW1lLnNwbGl0KCd8JylbMF07XG4gICAgICAgICAgICAgICAgaWYgKCEoaW5kZXhOYW1lIGluIEFTS0VEX00yTSkpIHtcbiAgICAgICAgICAgICAgICAgICAgQVNLRURfTTJNW2luZGV4TmFtZV0gPSBbe30sIHt9XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIE1JRFggPSBBU0tFRF9NMk1baW5kZXhOYW1lXVtmaXJzdF07XG4gICAgICAgICAgICAgICAgTGF6eSh2YWxzKS5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIE1JRFhbeCArICcnXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIE1JRFhbeF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0ybSkge1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290TTJNKG0ybSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFBFUk1JU1NJT05TKSB7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3RQZXJtaXNzaW9ucyhQRVJNSVNTSU9OUyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2FsbEJhY2spIHtcbiAgICAgICAgICAgIGNhbGxCYWNrKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50cy5lbWl0KCdnb3QtZGF0YScpO1xuICAgIH07XG4gICAgdGhpcy5nb3RQZXJtaXNzaW9ucyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIExhenkoZGF0YSkuZWFjaChmdW5jdGlvbiAodiwgcmVzb3VyY2VOYW1lKSB7XG4gICAgICAgICAgICBMYXp5KHZbMF0pLmVhY2goZnVuY3Rpb24gKHJvdywgaWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoKHJlc291cmNlTmFtZSBpbiBJREIpICYmIChpZCBpbiBJREJbcmVzb3VyY2VOYW1lXS5zb3VyY2UpKXtcbiAgICAgICAgICAgICAgICAgICAgSURCW3Jlc291cmNlTmFtZV0uZ2V0KGlkKS5fcGVybWlzc2lvbnMgPSBMYXp5KHJvdykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3gsIHRydWVdXG4gICAgICAgICAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoTGF6eSh2WzBdKS5zaXplKCkpe1xuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ3VwZGF0ZS1wZXJtaXNzaW9ucy0nICsgcmVzb3VyY2VOYW1lLCBMYXp5KHZbMF0pLmtleXMoKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5lbWl0KCd1cGRhdGUtcGVybWlzc2lvbnMnKTtcbiAgICB9O1xuXG5cbiAgICB0aGlzLmdvdE0yTSA9IGZ1bmN0aW9uKG0ybSl7XG4gICAgICAgIExhenkobTJtKS5lYWNoKGZ1bmN0aW9uKGRhdGEsIGluZGV4TmFtZSl7XG4gICAgICAgICAgICB2YXIgbTJtSW5kZXggPSBsaW5rZXIubTJtSW5kZXhbaW5kZXhOYW1lXTtcbiAgICAgICAgICAgIExhenkoZGF0YSkuZWFjaChmdW5jdGlvbihtKXtcbiAgICAgICAgICAgICAgICBMYXp5KG0pLmVhY2goZnVuY3Rpb24oZGF0YSx2ZXJiKXtcbiAgICAgICAgICAgICAgICAgICAgbTJtSW5kZXhbdmVyYl0oZGF0YSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGV2ZW50cy5lbWl0KCdyZWNlaXZlZC1tMm0nKTtcbiAgICAgICAgICAgIGV2ZW50cy5lbWl0KCdyZWNlaXZlZC1tMm0tJyArIGluZGV4TmFtZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMuZmV0Y2ggPSBmdW5jdGlvbiAobW9kZWxOYW1lLCBmaWx0ZXIsIHRvZ2V0aGVyLCBjYWxsQmFjaykgeyAgLy9cbiAgICAgICAgLy8gaWYgYSBjb25uZWN0aW9uIGlzIGN1cnJlbnRseSBydW5uaW5nLCB3YWl0IGZvciBjb25uZWN0aW9uLlxuICAgICAgICBpZiAobW9kZWxOYW1lIGluIHdhaXRpbmdDb25uZWN0aW9ucyl7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gobW9kZWxOYW1lLCBmaWx0ZXIsIHRvZ2V0aGVyLCBjYWxsQmFjayk7XG4gICAgICAgICAgICB9LDUwMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBmZXRjaGluZyBhc3luY2hyb21vdXMgbW9kZWwgZnJvbSBzZXJ2ZXJcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmRlc2NyaWJlKG1vZGVsTmFtZSwgZnVuY3Rpb24obW9kZWwpe1xuICAgICAgICAgICAgICAgIC8vIGlmIGRhdGEgY2FtZXMgZnJvbSByZWFsdGltZSBjb25uZWN0aW9uXG4gICAgICAgICAgICAgICAgaWYgKFcyUFJFU09VUkNFLmNvbm5lY3Rpb24ub3B0aW9ucy5yZWFsdGltZUVuZFBvaW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIGdldHRpbmcgZmlsdGVyIGZpbHRlcmVkIGJ5IGNhY2hpbmcgc3lzdGVtXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlciA9IGxpc3RDYWNoZS5maWx0ZXIobW9kZWwsZmlsdGVyKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBpZiBzb210aGluZyBpcyBtaXNzaW5nIG9uIG15IGxvY2FsIERCIFxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsdGVyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFzayBmb3IgbWlzc2luZ3MgYW5kIHBhcnNlIHNlcnZlciByZXNwb25zZSBpbiBvcmRlciB0byBlbnJpY2ggbXkgbG9jYWwgREIuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwbGFjaW5nIGxvY2sgZm9yIHRoaXMgbW9kZWxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRpbmdDb25uZWN0aW9uc1ttb2RlbE5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KG1vZGVsTmFtZSArICcvbGlzdCcsIHtmaWx0ZXIgOiBmaWx0ZXJ9LGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdERhdGEoZGF0YSxjYWxsQmFjaylcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbGVhc2UgbG9ja1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVsZWFzZSBsb2NrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHdhaXRpbmdDb25uZWN0aW9uc1ttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmaWx0ZXI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcG9zdChtb2RlbE5hbWUgKyAnL2xpc3QnLCBzZW5kRGF0YSxmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZmlsdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdPVF9BTEwuc291cmNlLnB1c2gobW9kZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShkYXRhLCBjYWxsQmFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmdldCA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgaWRzLCBjYWxsQmFjayl7XG4gICAgICAgIC8vIHNlYXJjaCBvYmplY3RzIGZyb20gSURCLiBJZiBzb21lIGlkIGlzIG1pc3NpbmcsIGl0IHJlc29sdmUgaXQgYnkgdGhlIHNlcnZlclxuICAgICAgICAvLyBpZiBhIHJlcXVlc3QgdG8gdGhlIHNhbWUgbW9kZWwgaXMgcGVuZGluZywgd2FpdCBmb3IgaXRzIGNvbXBsZXRpb25cbiAgICAgICAgXG4gICAgICAgIGlmIChpZHMuY29uc3RydWN0b3IgIT09IEFycmF5KXtcbiAgICAgICAgICAgIGlkcyA9IFtpZHNdO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIHNvbWUgZW50aXR5IGlzIG1pc3NpbmcgXG4gICAgICAgIFcyUFJFU09VUkNFLmZldGNoKG1vZGVsTmFtZSAsIHtpZDogaWRzfSwgbnVsbCxmdW5jdGlvbigpe1xuICAgICAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICAgICAgdmFyIGl0YWIgPSBJREJbbW9kZWxOYW1lXVxuICAgICAgICAgICAgZm9yICh2YXIgaWQgaW4gaWRzKXtcbiAgICAgICAgICAgICAgICByZXQucHVzaChpdGFiLnNvdXJjZVtpZHNbaWRdXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYWxsQmFjayhyZXQpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdGhpcy5nb3RNb2RlbCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGZvciAodmFyIG1vZGVsTmFtZSBpbiBkYXRhKSB7XG4gICAgICAgICAgICB2YXIgbW9kZWwgPSBkYXRhW21vZGVsTmFtZV07XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2VbJ2Rlc2NyaXB0aW9uOicgKyBtb2RlbE5hbWVdID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG4gICAgICAgICAgICBtb2RlbENhY2hlW21vZGVsTmFtZV0gPSBtYWtlTW9kZWxDbGFzcyhtb2RlbCk7XG4gICAgICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gSURCKSkge1xuICAgICAgICAgICAgICAgIElEQlttb2RlbE5hbWVdID0gTGF6eSh7fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5kZXNjcmliZSA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgY2FsbEJhY2spe1xuICAgICAgICB2YXIgcmV0ID0gbW9kZWxDYWNoZVttb2RlbE5hbWVdO1xuICAgICAgICBpZiAocmV0KSB7XG4gICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayhyZXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKCEobW9kZWxOYW1lIGluIHdhaXRpbmdDb25uZWN0aW9ucykpe1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gZmFpbGVkTW9kZWxzKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjYWNoZUtleSA9ICdkZXNjcmlwdGlvbjonICsgbW9kZWxOYW1lO1xuICAgICAgICAgICAgICAgIGlmIChjYWNoZUtleSBpbiBsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nb3RNb2RlbChKU09OLnBhcnNlKGxvY2FsU3RvcmFnZVtjYWNoZUtleV0pKTtcbiAgICAgICAgICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2sobW9kZWxDYWNoZVttb2RlbE5hbWVdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJHBvc3QobW9kZWxOYW1lICsgJy9kZXNjcmliZScsbnVsbCwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3RNb2RlbChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKG1vZGVsQ2FjaGVbbW9kZWxOYW1lXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2FpdGluZ0Nvbm5lY3Rpb25zW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ldmVudHMubW9kZWxOb3RGb3VuZC5oYW5kbGUobW9kZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxlZE1vZGVsc1ttb2RlbE5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyB3YWl0IGZvciBjb25uZWN0aW9uXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5kZXNjcmliZShtb2RlbE5hbWUsIGNhbGxCYWNrKTtcbiAgICAgICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ICAgICAgICBcbiAgICB9O1xuICAgIHRoaXMuYWRkTW9kZWxIYW5kbGVyID0gZnVuY3Rpb24gKG1vZGVsTmFtZSwgZGVjb3JhdG9yKSB7XG4gICAgICAgIHZhciBrZXkgPSB1dGlscy5oYXNoKGRlY29yYXRvcik7XG4gICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBidWlsZGVySGFuZGxlcnMpKSBidWlsZGVySGFuZGxlcnNbbW9kZWxOYW1lXSA9IG5ldyBIYW5kbGVyKCk7XG4gICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBidWlsZGVySGFuZGxlclVzZWQpKSBidWlsZGVySGFuZGxlclVzZWRbbW9kZWxOYW1lXSA9IHt9O1xuICAgICAgICBpZiAoa2V5IGluIGJ1aWxkZXJIYW5kbGVyVXNlZFttb2RlbE5hbWVdKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1aWxkZXJIYW5kbGVyVXNlZFttb2RlbE5hbWVdW2tleV0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb2RlbE5hbWUgaW4gbW9kZWxDYWNoZSkge1xuICAgICAgICAgICAgZGVjb3JhdG9yKG1vZGVsQ2FjaGVbbW9kZWxOYW1lXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidWlsZGVySGFuZGxlcnNbbW9kZWxOYW1lXS5hZGRIYW5kbGVyKGRlY29yYXRvcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuYWRkUGVyc2lzdGVudEF0dHJpYnV0ZXMgPSBmdW5jdGlvbihtb2RlbE5hbWUsIGF0dHJpYnV0ZXMpe1xuICAgICAgICB2YXIgYWRkUHJvcGVydHkgPSBmdW5jdGlvbihtb2RlbCwgYXR0cmlidXRlcykge1xuICAgICAgICAgIGF0dHJpYnV0ZXMuZm9yRWFjaChmdW5jdGlvbih2YWwpe1xuICAgICAgICAgICAgdmFyIGtleSA9ICdwQTonICsgbW9kZWwubW9kZWxOYW1lICsgJzonICsgdmFsO1xuICAgICAgICAgICAgdmFyIGthdHRyID0gJ19fJyArIHZhbDtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2RlbC5wcm90b3R5cGUsIHZhbCwge1xuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKCEoa2F0dHIgaW4gdGhpcykpe1xuICAgICAgICAgICAgICAgICAgdmFyIHYgPSBsb2NhbFN0b3JhZ2Vba2V5ICsgdGhpcy5pZF07XG4gICAgICAgICAgICAgICAgICB0aGlzW2thdHRyXSA9IHY/SlNPTi5wYXJzZSh2KTpudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1trYXR0cl07XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpe1xuICAgICAgICAgICAgICAgIHRoaXNba2F0dHJdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlW2tleSArIHRoaXMuaWRdID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCEobW9kZWxOYW1lIGluIHBlcnNpc3RlbnRBdHRyaWJ1dGVzKSkgeyBwZXJzaXN0ZW50QXR0cmlidXRlc1ttb2RlbE5hbWVdID0gW107IH1cbiAgICAgICAgdmFyIGF0dHJzID0gcGVyc2lzdGVudEF0dHJpYnV0ZXNbbW9kZWxOYW1lXTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIHZhciBuZXdBdHRycyA9IExhenkoYXR0cmlidXRlcykuZGlmZmVyZW5jZShhdHRycykudG9BcnJheSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIG5ld0F0dHJzID0gYXR0cnM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld0F0dHJzLmxlbmd0aCl7XG4gICAgICAgICAgICBpZiAobW9kZWxOYW1lIGluIG1vZGVsQ2FjaGUpe1xuICAgICAgICAgICAgICAgIGFkZFByb3BlcnR5KG1vZGVsQ2FjaGVbbW9kZWxOYW1lXSwgbmV3QXR0cnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMpe1xuICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGF0dHJzLG5ld0F0dHJzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5vbignbmV3LW1vZGVsJywgZnVuY3Rpb24obW9kZWwpe1xuICAgICAgICBpZiAobW9kZWwubW9kZWxOYW1lIGluIGJ1aWxkZXJIYW5kbGVycyl7XG4gICAgICAgICAgICBidWlsZGVySGFuZGxlcnNbbW9kZWwubW9kZWxOYW1lXS5oYW5kbGUobW9kZWxDYWNoZVttb2RlbC5tb2RlbE5hbWVdKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobW9kZWwubW9kZWxOYW1lIGluIHBlcnNpc3RlbnRBdHRyaWJ1dGVzKXtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzKG1vZGVsLm1vZGVsTmFtZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLmNvbm5lY3QgPSBmdW5jdGlvbihjYWxsQmFjayl7XG4gICAgICAgIGlmICh0aGlzLmlzQ29ubmVjdGVkKXtcbiAgICAgICAgICAgIGNhbGxCYWNrKHRoaXMuY29ubmVjdGlvbi5vcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdGlvbi5jb25uZWN0KGZ1bmN0aW9uKHN0YXR1cyl7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuaXNDb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNhbGxCYWNrKHN0YXR1cyk7XG4gICAgICAgICAgICB9KTsgICAgICAgICAgICBcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5xdWVyeSA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgZmlsdGVyLCB0b2dldGhlciwgY2FsbEJhY2spe1xuICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgdGhpcy5kZXNjcmliZShtb2RlbE5hbWUsZnVuY3Rpb24obW9kZWwpe1xuICAgICAgICAgICAgLy8gYXJyYXlmaXkgYWxsIGZpbHRlciB2YWx1ZXNcbiAgICAgICAgICAgIGZpbHRlciA9IExhenkoZmlsdGVyKS5tYXAoZnVuY3Rpb24odixrKXsgcmV0dXJuIFtrLEFycmF5LmlzQXJyYXkodik/djpbdl1dfSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgIHZhciBmaWx0ZXJGdW5jdGlvbiA9IHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICB2YXIgaWR4ID0gZ2V0SW5kZXgobW9kZWxOYW1lKTtcbiAgICAgICAgICAgIHRocy5mZXRjaChtb2RlbE5hbWUsZmlsdGVyLHRvZ2V0aGVyLCBmdW5jdGlvbihlKXtcbiAgICAgICAgICAgICAgICBjYWxsQmFjayhpZHguZmlsdGVyKGZpbHRlckZ1bmN0aW9uKS52YWx1ZXMoKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgfTtcbiAgICB0aGlzLmRlbGV0ZSA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgaWRzLCBjYWxsQmFjayl7XG4gICAgICAgIHJldHVybiB0aGlzLiRwb3N0KG1vZGVsTmFtZSArICcvZGVsZXRlJywgeyBpZCA6IGlkc30sIGNhbGxCYWNrKTtcbiAgICB9O1xufTtcblxuZnVuY3Rpb24gcmVXaGVlbE9STShlbmRQb2ludCwgbG9naW5GdW5jKXtcbiAgICB0aGlzLiRvcm0gPSBuZXcgYmFzZU9STShuZXcgdXRpbHMucmVXaGVlbENvbm5lY3Rpb24oZW5kUG9pbnQsIGxvZ2luRnVuYyksdGhpcyk7XG4gICAgdGhpcy5vbiA9IHRoaXMuJG9ybS5vbi5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy5lbWl0ID0gdGhpcy4kb3JtLmVtaXQuYmluZCh0aGlzLiRvcm0pO1xuICAgIHRoaXMudW5iaW5kID0gdGhpcy4kb3JtLnVuYmluZC5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy5hZGRNb2RlbEhhbmRsZXIgPSB0aGlzLiRvcm0uYWRkTW9kZWxIYW5kbGVyLmJpbmQodGhpcy4kb3JtKTtcbiAgICB0aGlzLmFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzID0gdGhpcy4kb3JtLmFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzLmJpbmQodGhpcy4kb3JtKTtcbiAgICB0aGlzLnV0aWxzID0gdXRpbHM7XG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmdldE1vZGVsID0gZnVuY3Rpb24obW9kZWxOYW1lKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHNlbGYuJG9ybS5jb25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgc2VsZi4kb3JtLmRlc2NyaWJlKG1vZGVsTmFtZSxhY2NlcHQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihtb2RlbE5hbWUsIGlkcyl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBzaW5nbGUgPSBmYWxzZTtcbiAgICB2YXIgbW9kTmFtZSA9IG1vZGVsTmFtZTtcbiAgICBpZiAoaWRzLmNvbnN0cnVjdG9yICE9PSBBcnJheSl7XG4gICAgICAgIHNpbmdsZSA9IHRydWU7XG4gICAgICAgIGlkcyA9IFtpZHNdXG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCl7XG4gICAgICAgIHRyeXtcbiAgICAgICAgICAgIHNlbGYuJG9ybS5jb25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKHNpbmdsZSl7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5nZXQobW9kTmFtZSwgaWRzLCBmdW5jdGlvbihpdGVtcyl7IFxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0KGl0ZW1zWzBdKTt9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi4kb3JtLmdldChtb2ROYW1lLCBpZHMsIGFjY2VwdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5xdWVyeSA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIGZpbHRlciwgcmVsYXRlZCl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCl7XG4gICAgICAgIHZhciB0b2dldGhlciA9IG51bGw7XG4gICAgICAgIGlmIChyZWxhdGVkICYmIChyZWxhdGVkLmNvbnN0cnVjdG9yID09PSBBcnJheSkgJiYgKHJlbGF0ZWQubGVuZ3RoKSl7XG4gICAgICAgICAgICB0b2dldGhlciA9IHJlbGF0ZWQ7XG4gICAgICAgIH0gZWxzZSBpZiAocmVsYXRlZCAmJiAocmVsYXRlZC5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSAmJiAocmVsYXRlZC5sZW5ndGgpKXtcbiAgICAgICAgICAgIHRvZ2V0aGVyID0gcmVsYXRlZC5zcGxpdCgnLCcpO1xuICAgICAgICB9XG4gICAgICAgIHRyeXtcbiAgICAgICAgICAgIGlmIChzZWxmLiRvcm0uaXNDb25uZWN0ZWQpe1xuICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5xdWVyeShtb2RlbE5hbWUsIGZpbHRlciwgdG9nZXRoZXIsIGFjY2VwdCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5jb25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5xdWVyeShtb2RlbE5hbWUsIGZpbHRlciwgdG9nZXRoZXIsIGFjY2VwdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9XG4gICAgfSlcbn07XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIGlkcyl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCl7XG4gICAgICAgIHRyeXtcbiAgICAgICAgICAgIGlmIChzZWxmLiRvcm0uY29ubmVjdGVkKXtcbiAgICAgICAgICAgICAgICBzZWxmLiRvcm0uZGVsZXRlKG1vZGVsTmFtZSwgaWRzLCBhY2NlcHQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLiRvcm0uY29ubmVjdChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBzZWxmLiRvcm0uZGVsZXRlKG1vZGVsTmFtZSwgaWRzLCBhY2NlcHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfVxuICAgIH0pXG59O1xuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5nZXRMb2dnZWRVc2VyID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuJG9ybS5jb25uZWN0aW9uLm9wdGlvbnMudXNlcl9pZClcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KCdhdXRoX3VzZXInLHRoaXMuJG9ybS5jb25uZWN0aW9uLm9wdGlvbnMudXNlcl9pZCk7XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KSB7XG4gICAgICAgICAgICB0aGlzLm9uKCdsb2dpbicsZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICAgIGFjY2VwdCh1c2VyKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUuJHNlbmRUb0VuZHBvaW50ID0gZnVuY3Rpb24gKHVybCwgZGF0YSl7XG4gICAgcmV0dXJuIHRoaXMuJG9ybS4kcG9zdCh1cmwsIGRhdGEpO1xufVxuXG4iXX0=
