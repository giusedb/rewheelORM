!function(t,e,n){"use strict";function i(){this.handlers=[],this.strHandlers={}}function r(){var t={},n={},i=0;this.on=function(e,r){e in t||(t[e]=new Array);var o=i++;return t[e].push(r),n[o]=r,o},this.emit=function(e){if(e in t){var n=Array.prototype.slice.call(arguments,1);t[e].forEach(function(t){t.apply(null,n)})}},this.unbind=function(i){var r=0;if(i in n){var o=n[i+""];e(t).each(function(t,e){var n=[];for(var i in t)t[i]===o&&(n.push(i),r++);n.reverse().forEach(function(e){t.splice(e,1)})})}return delete n[i],r},this.once=function(t,e){var n=this,i=this.on(t,function(){e.apply(this,arguments),n.unbind(i)})}}function o(){return new Proxy({},{get:function(t,e){return"string"==typeof e?"toString"===e?y:o():t[e]}})}function s(t,e){var i=new n(t);i.onopen=function(t){console.log("open : "+t),i.tenant(),e.emit("realtime-connection-open",t)},i.onmessage=function(t){if("message"==t.type)try{e.emit("realtime-message-json",JSON.parse(t.data))}catch(n){e.emit("realtime-message-text",JSON.parse(t.data))}else console.log("from realtime ",t)},i.onclose=function(){setTimeout(v.wsConnect,1e3),e.emit("realtime-connection-closed")},i.tenant=function(){i.send("TENANT:"+e.cachedStatus.application+":"+e.cachedStatus.token)},this.close=function(){i.close()}}function a(t,e){var n=new r;this.getLogin=e,this.endPoint=t.endsWith("/")?t:t+"/",this.on=n.on,this.unbind=n.unbind,this.emit=n.emit,this.once=n.once,this.cachedStatus={},this.isConnected=!1,this.isLoggedIn=!1}function c(){var t=!1;this.touch=function(){t=!0},this.touched=function(){var e=t;return t=!1,e}}function u(t,n,i,r){if(!n)var n=[];var o=[];this.ask=function(i,s){r&&i in r.source||e(n).contains(i)||(o.push(i),s||n.push(i),t.touch())},this.getAskedIndex=function(){return n},this.missings=function(){return e(o.splice(0,o.length)).unique().toArray()}}function l(t,n,i,r){var o=new c,s={},a={},l={},f={},h={};this.mainIndex=s,this.foreignKeys=a,this.m2m=l,this.m2mIndex=f,this.permissions=h,i.on("model-definition",function(t,n){var i=r.getIndexFor(t.name,"id");s[t.name]=new u(o,i,"mainIndex."+t.name,n),h[t.name]=new u(o,null,"permissions."+t.name),e(t.references).each(function(e){var n=t.name+"_"+e.id;a[n]=new u(o,r.getIndexFor(e.to,"id"),e.to+".id foreignKeys."+n)}),e(t.referencedBy).each(function(t){var e=t.by+"."+t.id;a[e]=new u(o,r.getIndexFor(t.by,t.id),t.by+"."+t.id+" foreignKeys."+e)}),e(t.manyToMany).each(function(t){t.indexName in l||(l[t.indexName]=[new u(o,null,"m2m."+t.indexName+"[0]"),new u(o,null,"m2m."+t.indexName+"[1]")]),t.indexName in f||(f[t.indexName]=new d(t,l[t.indexName]))})});var p=function(e,n,r,o){i.$post((n?v.reverse("/",e):e)+"s/list",{collection:r},function(n){i.gotData(n,o),delete t[e]})},m=function(n,i,r,o){e(i).each(l[n][r].ask.bind(l[n][r])),i=l[n][r].missings(),i.length?(t[n]=1,p(n,r,i,o)):o&&o()};this.getM2M=m;var g=function(){if(o.touched()){if(e(t).values().sum())return void o.touch();var r=!1;e(l).each(function(t,n){e(t).each(function(t,o){var a=t.missings();if(a=e(a).filter(Boolean).map(function(t){return parseInt(t)}).toArray(),a.length){var c=f[n],u=c["get"+(1-o)].bind(c);r=!0,p(n,o,a,function(t){var r=a.map(u);if(r.length){var c=n.split("/")[1-o];i.describe(c,function(){e(r).flatten().unique().each(function(t){s[c].ask(t,!0)})})}})}})}),e(s).each(function(t,o){var s=t.missings();if(s.length){r=!0;o in n?n[o].keys():e();i.fetch(o,{id:s},null,v.noop)}}),e(a).map(function(t,e){return[e,t.missings()]}).filter(function(t){return t[1].length}).each(function(t){r=!0;var e=t[1],n=t[0],o=n.split("."),s=o[0],a=o[1],c={};c[a]=e,i.fetch(s,c)}),e(e(h).map(function(t,e){return[e,t.missings()]}).filter(function(t){return t[1].length}).toObject()).each(function(n,o){r=!0,n.length&&(t[o]=1,i.$post(o+"/my_perms",{ids:e(n).unique().toArray()},function(e){i.gotPermissions(e.PERMISSIONS),delete t[o]}))})}};setInterval(g,50)}function f(){var t={},n={},i={},r=function(t,n,i){var r=[];if(i)for(var o in t)for(var s in n)r.push(e([t[o],n[s]]).flatten().toArray());else for(var o in t)for(var s in n)r.push([t[o],n[s]]);return r},o=function(t){for(var e=!1,n=t[0],i=1;i<t.length;++i)n=r(n,t[i],e),e=!0;return n},s=function(t){var n=o(e(t).values().toArray()),i=e(t).keys().toArray();return n.map(function(t){var e={};return i.forEach(function(n,i){e[n]=t[i]}),e})},a=function(t,n,i){var r=t.modelName,o=this.getIndexFor,s=(e(n).map(function(t,e){return[e,r+"."+e]}).toObject(),e(n).keys().map(function(t){return[t,o(r,t)]}).toObject());for(var a in n){var c=e(n[a]).difference(s[a]).toArray();if(c.length){var u=e([[a,c]]).toObject();return i||Array.prototype.push.apply(s[a],c),u}return null}},c=function(t,n){t.name in i||(i[t.name]=[]);var r=i[t.name],o=e(n).size();r.filter(v.makeFilter(t,n," && ",!0)).filter(function(t){e(t).size()>o})};this.filter=function(r,o){var u=r.modelName,l=e(o).size();switch(l){case 0:var f=t[u];return t[u]=!0,u in n&&delete n[u],u in i&&delete i[u],f?null:{};case 1:var d=a.call(this,r,o);return c.call(this,r,o),d}var h=this,p=e(o).keys().some(function(t){var e={};return e[t]=o[t],null==a.call(h,r,e,!0)});if(p)return null;u in i||(i[u]=[]);var m=s(o),g=i[u].filter(v.makeFilter(r,o," || ",!0));if(g.length){var y=[];for(var w in g)y.push.apply(y,m.filter(v.makeFilter(r,g[w]," && ",!0)));var b=e(m).difference(y).toArray()}else var b=m;if(b.length){i[u].push.apply(i[u],b);var b=e(o).keys().map(function(t){var n=e(b).pluck(t).unique().toArray();return[t,n.length?n:o[t]]}).toObject();return c(r,b),b}return null},this.getIndexFor=function(t,e){var i=t+"."+e;return i in n||(n[i]=[]),n[i]}}function d(t,n){var i=[];this.add=i.push.bind(i),this.add=function(t){e(i).find(t)||i.push(t)},this.get0=function(t){return n[1].ask(t),e(i).filter(function(e){return e[0]===t}).pluck("1").toArray()},this.get1=function(t){return n[0].ask(t),e(i).filter(function(e){return e[1]===t}).pluck("0").toArray()},this["get"+v.capitalize(t.indexName.split("/")[1])]=this.get1,this["get"+v.capitalize(t.indexName.split("/")[0])]=this.get0,this.del=function(t){for(var e=i.length,n=null,r=0;r<e;r++)if(i[r][0]===t[0]&&i[r][1]===t[1]){n=r;break}n&&i.splice(r,1),console.log("deleting ",t)}}function h(t,n,i,r){var o=Array.prototype.slice.call(arguments,4),s={};e(o).each(function(e){t.orm.on(e,function(){s={}})});var a={get:function(){return this.id in s||(s[this.id]=i.call(this)),s[this.id]}};r&&(a.set=function(t){t!==s[this.id]&&(r.call(this,t),this.id in s&&delete s[this.id])}),Object.defineProperty(t,n,a)}function p(t){this.resource=t._resource,this.formIdx=t.formIdx,this.fields=t.errors}function m(t,e){this.$orm=new b(new v.reWheelConnection(t,e),this),this.on=this.$orm.on.bind(this.$orm),this.emit=this.$orm.emit.bind(this.$orm),this.unbind=this.$orm.unbind.bind(this.$orm),this.once=this.$orm.once,this.addModelHandler=this.$orm.addModelHandler.bind(this.$orm),this.addPersistentAttributes=this.$orm.addPersistentAttributes.bind(this.$orm),this.utils=v,this.logout=this.$orm.connection.logout.bind(this.$orm.connection)}i.prototype.addHandler=function(t){var e=v.hash(t.toString());e in this.strHandlers||(this.strHandlers[e]=t,this.handlers.push(t))},i.prototype.handle=function(){var t=Array.prototype.slice.call(arguments,0);this.handlers.forEach(function(e){e.apply(null,t)})},i.prototype.handleBy=function(){var t=Array.prototype.slice.call(arguments,1),e=arguments[0];this.handlers.forEach(function(n){n.apply(e,t)})};var g=0,y=function(){return""},v={renameFunction:function(t,e){return new Function("return function (call) { return function "+t+" () { return call(this, arguments) }; };")()(Function.apply.bind(e))},cached:function(t,e){function n(){return this[e]||(this[e]=t.call(this,[arguments])),this[e]}return e||(e="_"+g++),n},log:function(){console.log(arguments)},xdr:function(t,n,i,r,o){return new Promise(function(i,s){var a;n||(n={}),XMLHttpRequest?(a=new XMLHttpRequest,a.onreadystatechange=function(){if(4===a.readyState){try{var t=JSON.parse(a.responseText)}catch(t){var t=null}var e={responseData:t,responseText:a.responseText,status:a.status,request:a};a.status>=200&&a.status<400?i(e):s(e)}}):XDomainRequest?(a=new XDomainRequest,a.onload=function(){i(a.responseText,a.statusText,a)}):s(new Error("CORS not supported")),a.open("POST",t,!0),a.onerror=s,a.setRequestHeader("Accept","application/json"),r&&(n.__token__=r),o?(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n=e(n).map(function(t,e){return e+"="+encodeURI(t.toString())}).toArray().join("&")):(a.setRequestHeader("Content-Type","text/plain"),n=e(n).size()?JSON.stringify(n):""),a.send(n)})},capitalize:function(t){return t[0].toUpperCase()+t.slice(1).toLowerCase()},hash:function(t){t=t.toString();for(var e=1,n=0;n<t.length;n++)e*=1+t.charCodeAt(n);return(e%34958374957).toString()},makeFilter:function(t,n,i,r){if(i||(i=" && "),0===e(n).size())return function(t){return!0};var o=e(n).map(function(n,i){return n||(n=[null]),Array.isArray(n)||(n=[n]),r||"reference"!==t.fields[i].type?"string"===t.fields[i].type&&(n=n.map(JSON.stringify)):(i="_"+i,n=e(n).map(function(t){return t&&t.constructor!==Number?t.id:t}).toArray()),"("+e(n).map(function(t){return"(x."+i+" === "+t+")"}).join(" || ")+")"}).toArray().join(i);return new Function("x","return "+o)},sameAs:function(t,e){for(var n in t)if(e[n]!=t[n])return!1;return!0},pluralize:function(t,e){return t+"s"},beforeCall:function(t,e){var n=function(){e().then(t)};return n},cleanStorage:function(){e(localStorage).keys().each(function(t){delete localStorage[t]})},cleanDescription:function(){e(localStorage).filter(function(t,n){return e(n).startsWith("description:")}).keys().each(function(t){delete localStorage[t]})},reverse:function(t,e){return e.split(t).reverse().join(t)},permutations:function(t){for(var e=[],n=t.length-1;n>=0;n--)for(var i=t.length-1;i>=0;i--)n!==i&&e.push([t[n],t[i]]);return e},waitFor:function(t,e){var n=function(){t()?e():setTimeout(n,500)};setTimeout(n,500)},bool:Boolean,noop:function(){},tzOffset:6e4*(new Date).getTimezoneOffset(),transFieldType:{date:function(t){return new Date(1e3*t+v.tzOffset)},datetime:function(t){return new Date(1e3*t+v.tzOffset)},string:function(t){return t.toString()},text:function(t){return t.toString()},integer:function(t){return parseInt(t)},float:function(t){return parseFloat(t)}},mock:o};const w="lastRWTConnectionStatus";a.prototype.$post=function(t,e,n){var i=this,r=new Promise(function(r,o){v.xdr(i.endPoint+t,e,i.cachedStatus.application,i.cachedStatus.token).then(function(o){i.emit("http-response",o.responseText,o.status,t,e),i.emit("http-response-"+o.status,o.responseText,t,e),o.responseData&&i.emit("http-response-"+o.status+"-json",o.responseData,t,e),n&&n(o.responseData||o.responseText),r(o.responseData||o.responseText)},function(n){n.responseData?(i.emit("error-json",n.responseData,n.status,t,e,n),i.emit("error-json-"+n.status,n.responseData,t,e,n)):(i.emit("error-http",n.responseText,n.status,t,e,n),i.emit("error-http-"+n.status,n.responseText,t,e,n)),o(n.responseData||n.responseText)})});return r},a.prototype.status=function(t,n){var i="token:"+this.endPoint,r=this;if(n&&(this.cachedStatus={},delete localStorage[i]),this.statusWaiting)return void v.waitFor(function(){return!r.statusWaiting},function(){r.status(t,n)});if(!e(this.cachedStatus).size()){var o={};return i in localStorage&&(o.__token__=localStorage[i]),this.statusWaiting=!0,void this.$post("api/status",o,function(e){r.updateStatus(e),localStorage[i]=e.token,t(e),r.statusWaiting=!1})}t(this.cachedStatus),t(this.cachedStatus)},a.prototype.updateStatus=function(t){var e=parseFloat(localStorage.lastBuild)||1;e<t.last_build&&(v.cleanDescription(),localStorage.lastBuild=t.last_build),this.isConnected=Boolean(t.token),this.isLoggedIn=Boolean(t.user_id);var n=this.cachedStatus;if(this.cachedStatus=t,!n.user_id&&t.user_id)this.emit("logged-in",t.user_id);else if(n.user_id&&!t.user_id)this.emit("logged-out");else if(this.isConnected&&!this.isLoggedIn&&(this.emit("login-required"),this.getLogin)){var i=this.getLogin();i.constructor===Object?this.login(i.username,i.password,i.callBack):i.constructor===Promise&&i.then(function(t){this.login(t.username,t.password,t.callBack)})}!n.realtimeEndPoint&&t.realtimeEndPoint?this.wsConnection=new s(t.realtimeEndPoint,this):n.realtimeEndPoint&&!t.realtimeEndPoint&&(this.wsConnection.close(),delete this.wsConnection),this.emit("update-connection-status",t,n),localStorage[w]=JSON.stringify(t)},a.prototype.login=function(t,e){var n=this;return new Promise(function(i,r){v.xdr(n.endPoint+"api/login",{username:t||"",password:e||""},null,n.cachedStatus.token,!0).then(function(t){n.updateStatus(t.responseData),i({status:"success",userid:n.cachedStatus.user_id})},function(t){i({error:t.responseData.error,status:"error"})})})},a.prototype.logout=function(){var t=this;return new Promise(function(e,n){t.$post("api/logout").then(function(n){t.updateStatus({}),delete localStorage[w],e()},n)})},a.prototype.connect=function(t){this.isLoggedIn?t(this.cachedStatus.user_id):(this.once("logged-in",function(e){t(e)}),this.status(t||v.noop))},v.reWheelConnection=a;var b=function(t,n){function r(t,e,n){this.klass=e,this.permissions=[],this.id=t;for(var i in n)this.push.apply(this,[i,n[i]])}if(t.constructor===String)var o=new a(t);else if(t.constructor===v.reWheelConnection)var o=t;this.connection=o,o.on("connected",function(){this.connected=!0}),this.on=o.on,this.emit=o.emit,this.unbind=o.unbind,this.once=o.once,this.$post=o.$post.bind(o),this.on("ws-connected",function(t){console.info("Websocket connected"),t.onMessageJson(s.gotData.bind(s)),t.onMessageText(function(t){console.info("WS message : "+t)})}),this.on("ws-disconnected",function(t){console.error("Websocket disconnected")}),this.on("error-json-404",function(t,e,n,i){console.error("JSON error ",JSON.stringify(t)),delete b[e.split("/")[0]]}),this.on("realtime-message-json",function(t){s.gotData(t)});var s=this,c={auth_group:e({})},u={},d={},m={},g={},y={},w={},b={},S=new f(e),N=new l(b,c,this,S);this.validationEvent=this.on("error-json-513",function(t,e,n,i){currentContext.savingErrorHanlder&&currentContext.savingErrorHanlder(new p(t))});var A=function(t){return t in c?c[t]:(c[t]=e({}),c[t])},_=function(t){return t in UNLINKED?UNLINKED[t]:(UNLINKED[t]={},UNLINKED[t])};r.prototype.save=function(t){var n={permissions:e(this.permissions).map(function(t){return[t[0].id,t[1]]}).toObject()};n.id=this.id;this.klass.modelName;s.$post(this.klass.modelName+"/set_permissions",n,function(e,n,i,r){t(e)})},r.prototype.push=function(t,n){var i=e(n),r=e(this.klass.allPermissions).map(function(t){return[t,i.contains(t)]}).toObject(),o=e(this.permissions).map(function(t){return t[0].id});o.contains(t)?this.permissions[o.indexOf(t)][1]=r:this.permissions.push([c.auth_group.get(t),r])};var x=function(t){t.fields.id.readable=!1,t.fields.id.writable=!1;var i=e(t.fields);t.privateArgs&&(i=i.merge(t.privateArgs)),s.emit("model-definition",t,A(t.name));var o="if (!row) { row = {}};\n";o+=t.references.map(function(t){return"this._"+t.id+" = row."+t.id+";"}).join(";\n"),o+=i.map(function(t,e){return"date"==t.type||"datetime"==t.type?"this."+e+" = row."+e+"?new Date(row."+e+" * 1000 - "+v.tzOffset+"):null;\n":"boolean"==t.type?"this."+e+" = (row."+e+' === "T") || (row.'+e+" === true);\n":"this."+e+" = row."+e+";\n"}).toString("\n"),o+="if (permissions) {this._permissions = permissions && Lazy(permissions).map(function (x) { return [x, true] }).toObject();}";var a=new Function("row","permissions",o);a.prototype.orm=n,a.ref_translations={},a.modelName=t.name,a.references=e(t.references).pluck("id").toArray(),a.inverse_references=t.referencedBy.map(function(t){return t.by+"_"+t.id+"_set"}),a.referents=t.referencedBy.map(function(t){return[t.by,t.id]}),a.fieldsOrder=t.fieldOrder,a.allPermissions=t.permissions,e(t.representation).size()&&(a.prototype.toString=new Function("return this."+e(t.representation).toString(' + " " + this.'))),a.prototype.toUpperCase=function(){return this.toString().toUpperCase()},a.prototype.toLowerCase=function(){return this.toString().toLowerCase()},a.prototype.delete=function(){return n.delete(this.constructor.modelName,[this.id])},Object.defineProperty(a.prototype,"permissions",{get:function(){return this._permissions?this._permissions:void N.permissions[this.constructor.modelName].ask(this.id)}}),a.prototype.all_perms=function(t){var n=this.id;s.$post(this.constructor.modelName+"/all_perms",{id:this.id},function(i){var o=i,u={},l=e(o).pluck("group_id").unique().map(function(t){return""+t}).difference(c.auth_group.keys()).toArray();e(o).groupBy(function(t){return t.group_id}).each(function(t,n){u[n]=e(t).pluck("name").toArray()});var f=function(e){t(new r(n,a,u))};l.length?s.get("auth_group",l,f):f()})},a.prototype.save=function(t){var n=this.asRaw(),i=a.fields,r=this.id,o=this.constructor.modelName;if(t)for(var c in t)n[c]=t[c];e(a.fieldsOrder).filter(function(t){return!i[t].writable}).each(function(t){t in n&&delete n[t]});var u=s.$post(o+(r?"/post":"/put"),n);return t&&t.constructor===Function&&(u.context.savingErrorHanlder=t),u},a.prototype.copy=function(){var t=new this.constructor(this.asRaw());return t._permissions=this._permissions,t};var l="return {\n"+e(t.references).map(function(t){return t.id+" : this._"+t.id}).concat(i.map(function(t,e){return"date"==t.type||"datetime"==t.type?e+" : (this."+e+"?(Math.round(this."+e+".getTime() - this."+e+".getTimezoneOffset() * 60000) / 1000):null)":"boolean"==t.type?e+" : this."+e+'?"T":"F"':e+" : this."+e})).toString(",\n")+"};";a.prototype.asRaw=new Function(l),a.saveMulti=function(t,n,i){var r=[],o=e(a.fields).filter(function(t){return!t.writable}).pluck("id").toArray();e(t).map(function(t){return t.asRaw()}).each(function(t){e(o).each(function(e){delete t[e]}),r.push(t)}),s.$post(a.modelName,"put",{multiple:r,formIdx:s.formIdx++},function(t){s.gotData(t);var i=c[a.modelName],r=e(t[a.modelName].results).pluck("id").map(function(t){return i.get(t)}).toArray();n&&n(r)},i)},"extra_verbs"in t&&e(t.extra_verbs).each(function(t){var n=t[0],i=t[1],r="data = {id : this.id";i.length&&(r+=", "+e(i).map(function(t){return t+" : "+t}).join(",")),r+="};",i.push("cb"),a.prototype[n]=new Function(i,r+'W2S.W2P_POST(this.constructor.modelName,"'+n+'", data,function(data,status,headers,x){try{\n   if (!headers("nomodel")) {window.W2S.gotData(data,cb);}\n   else {if (cb) {cb(data)}}\n} catch(e){\nif (cb) {cb(data);}\n}\n});\n')}),"privateArgs"in t&&(a.privateArgs=e(t.privateArgs).keys().map(function(t){return[t,!0]}).toObject(),a.prototype.savePA=function(t){var n=this,i={id:this.id},r=this.constructor.privateArgs,o=this.constructor.fields,a=(new this.constructor(t).asRaw(),e(r).keys().map(function(t){return[t,o[t]]}).toObject());e(t).each(function(t,e){e in r&&a[e].writable&&(i[e]=t)}),s.$post(this.constructor.modelName+"/savePA",i,function(){e(i).each(function(t,e){n[e]=t})})}),y[a.modelName]=a;for(var f in t.fields)t.fields[f].id=f;return a.fields=e(t.fields).concat(e(t.privateArgs)).concat(e(t.references).tap(function(t){t.type=t.type||"reference"})).indexBy("id").toObject(),e(a.fields).each(function(t){t.widget||("reference"===t.type?t.widget="choices":t.widget=t.type)}),e(t.references).each(function(t){var e=t.to,i="_"+t.id;h(a.prototype,t.id,function(){if(!(e in c)){var t=this;s.describe(e,function(n){N.mainIndex[e].ask(t[i],!0)})}var n=e in c&&this[i]&&c[e].get(this[i]);return!n&&e in N.mainIndex?(N.mainIndex[e].ask(this[i],!0),v.mock()):n},function(n){if(n&&n.constructor.modelName!=e)throw new TypeError("You can assign only "+e+" to "+t.id);this[i]=n.id},"new-"+e,"deleted-"+e,"updated-"+e,"new-model-"+e),a.prototype["get"+v.capitalize(t.id)]=function(){return n.get(e,this[i])}}),e(t.referencedBy).each(function(t){var e=t.by+"."+t.id,i=t.by+"_"+v.pluralize(t.id),r=t.by;a.prototype.hasOwnProperty(i)?console.error("Tryed to redefine property "+i+"s for "+a.modelName):h(a.prototype,i,function(){var t=r in c?u[e].get(this.id+""):null;return N.foreignKeys[e].ask(this.id,!0),t},null,"new-"+r,"updated-"+r,"deleted-"+r),a.prototype["get"+v.capitalize(v.pluralize(t.by))]=function(){var e={};return e[t.id]=[this.id],n.query(t.by,e)}}),t.manyToMany&&(e(t.manyToMany).each(function(t){var n=t.indexName,i=t.first?0:1,r=t.model,o=N.m2mIndex[n]["get"+(1-i)];h(a.prototype,t.model+"s",function(){var t=this,n=[],i=o(t.id),s=null;return i.length&&(s=A(r).get.bind(c[r])),i&&s&&(n=e(i).map(s).filter(v.bool).toArray()),n},null,"received-m2m-"+n,"received-"+r),a.prototype["get"+v.capitalize(v.pluralize(r))]=function(){var t=this;return new Promise(function(a,u){try{N.getM2M(n,[t.id],i,function(n){var i=o(t.id);i.length?s.fetch(r,{id:i},null,function(){var t=c[r].get.bind(c[r]);a(e(i).map(t).filter(v.bool).toArray())}):a([])})}catch(t){console.error(t),u(t)}})},a.fields[v.capitalize(r)]={id:v.capitalize(r),name:v.capitalize(r),writable:!0,readable:!0,type:"M2M",validators:[]}}),a.prototype.unlinkReference=function(t){var n=!1,i=this.id,r=[];"Array"==t.constructor.name&&(n=!0,r=t,t=r[0]);var o=t.constructor.modelName;if(n)var c=e(r).pluck("id").map(function(t){return[i,t]}).toArray();else var c=[[i,t.id]];s.$post(a.modelName+"/"+o+"s/delete",{collection:c})},a.prototype.linkReference=function(t){var n=!1,i=this.id,r=[];"Array"==t.constructor.name&&(n=!0,r=t,t=r[0]);var o=t.constructor.modelName,c=a.modelName+"/"+o;if(n){var u=[];if(c in INDEX_M2M&&(u=e(r).pluck("id").difference(e(INDEX_M2M[c][0].get(this.id))).toArray()),c=o+"/"+a.modelName,c in INDEX_M2M&&(u=e(r).pluck("id").difference(e(INDEX_M2M[c][0].get(this.id))).toArray()),u.length){var l=e(u).map(function(t){return[i,t]}).toArray();W2P_POST(a.modelName,o+"s/put",{collection:l},function(t){})}}else{if(c in N.m2mIndex&&e(N.m2mIndex[c]["get"+v.capitalize(o)](t.id)).find(this))return;s.$post(a.modelName+"/"+o+"s/put",{collection:[[this.id,t.id]]})}}),s.emit("new-model",a),s.emit("new-model-"+a.modelName),a};this.gotData=function(t,n){if(console.info("gotData"),"string"!=typeof t){"_extra"in t&&delete t._extra;var i=t.TOONE,r=t.TOMANY,o=t.MANYTOMANY,a=t.PERMISSIONS,l=t.PA;if(delete t.TOONE,delete t.TOMANY,delete t.MANYTOMANY,delete t.PERMISSIONS,delete t.PA,l||(l={}),t=e(t).filter(function(t,e){return!("deleted"in t)||e in y}).toObject(),"m2m"in t){var f=t.m2m;delete t.m2m}e(t).each(function(t,n){s.describe(n,function(i){var r=i;t.results&&t.results.length>0&&t.results[0].constructor==Array&&(t.results=e(t.results).map(function(t){return e(r.fieldsOrder).zip(t).toObject()}).toArray());var o=e(t.results),a=t.deleted;if(n in l){var f=l[n];e(o).each(function(t){t.id in f&&e(f[t.id]).each(function(e,n){t[n]=e})})}var d=A(n),h=d.source;a&&a.forEach(function(t){delete h[t]});var p=o.indexBy("id"),m=p.keys(),g=m.difference(d.keys().map(function(t){return parseInt(t)})),w=m.difference(g);w=w.filter(function(t){return!v.sameAs(p.get(t),d.get(t).asRaw())});var b=e(t.permissions?t.permissions:{}),S=g.map(function(t){return new r(p.get(t),b.get(t))}),N=[];w.each(function(t){var n=d.get(t),o=n.copy(),s=new r(p.get(t));e(i.fields).keys().each(function(t){n[t]=s[t]}),N.push([n,o])}),N.length&&s.emit("updated-"+n,N);var _=S.toArray();e(_).each(function(t){h[t.id]=t}),e(y[n].references).each(function(t){u[n+"."+t]=c[n].groupBy("_"+t)}),_.length&&s.emit("new-"+n,e(_),t.totalResults),a&&s.emit("deleted-"+n,a),s.emit("received-"+n)})}),i&&(console.error("TOONE"),e(i).each(function(t,e){console.log(e);_(e)})),r&&(console.error("TOMANY"),e(r).each(function(t,n){n in ASKED_UNLINKED||(ASKED_UNLINKED[n]=e([])),e(t).each(function(t){ASKED_UNLINKED[n].source.push(t)})})),o&&(console.error("MANYTOMANY"),e(o).each(function(t,n){var i=parseInt(n.split("|")[1]);n=n.split("|")[0],n in ASKED_M2M||(ASKED_M2M[n]=[{},{}]);var r=ASKED_M2M[n][i];e(t).each(function(t){r[t+""]=!0,r[t]=!0})})),f&&s.gotM2M(f),a&&s.gotPermissions(a),n&&n(t),s.emit("got-data")}else if(console.log("data "+t+" refused from gotData()"),n)return n(t)},this.gotPermissions=function(t){e(t).each(function(t,n){e(t[0]).each(function(t,i){n in c&&i in c[n].source&&(c[n].get(i)._permissions=e(t).map(function(t){return[t,!0]}).toObject())}),e(t[0]).size()&&s.emit("update-permissions-"+n,e(t[0]).keys().toArray())}),this.emit("update-permissions")},this.gotM2M=function(t){e(t).each(function(t,n){var i=N.m2mIndex[n];e(t).each(function(t){e(t).each(function(t,e){i[e](t)})}),s.emit("received-m2m"),s.emit("received-m2m-"+n)})},this.fetch=function(t,e,n,i){t in b?setTimeout(function(){s.fetch(t,e,n,i)},500):s.describe(t,function(n){return s.connection.cachedStatus.realtimeEndPoint?(e=S.filter(n,e),e?(b[t]=!0,s.$post(t+"/list",{filter:e}).then(function(e){s.gotData(e,i),delete b[t]},function(e){delete b[t]})):i&&i(),e):void this.$post(t+"/list",sendData,function(n){e||GOT_ALL.source.push(t),s.gotData(n,i)})}.bind(this))},this.get=function(t,e,n){e.constructor!==Array&&(e=[e]),s.fetch(t,{id:e},null,function(){var i=[],r=c[t];for(var o in e)i.push(r.source[e[o]]);n(i)})},this.gotModel=function(t){for(var n in t){var i=t[n];localStorage["description:"+n]=JSON.stringify(t),y[n]=x(i),n in c||(c[n]=e({}))}},this.describe=function(t,e){var n=y[t];if(n)e&&e(n);else if(t in b)setTimeout(function(){s.describe(t,e)},500);else{if(t in w)return;var i="description:"+t;i in localStorage?(this.gotModel(JSON.parse(localStorage[i])),e&&e(y[t])):(b[t]=!0,this.$post(t+"/describe",null,function(n){s.gotModel(n),e&&e(y[t]),delete b[t]},function(e){this.modelNotFound.handle(t),w[t]=!0}))}},this.addModelHandler=function(t,e){var n=v.hash(e);t in d||(d[t]=new i),t in m||(m[t]={}),n in m[t]||(m[t][n]=!0,t in y?e(y[t]):d[t].addHandler(e))},this.addPersistentAttributes=function(t,n){var i=function(t,e){e.forEach(function(e){var n="pA:"+t.modelName+":"+e,i="__"+e;Object.defineProperty(t.prototype,e,{get:function(){if(!(i in this)){var t=localStorage[n+this.id];this[i]=t?JSON.parse(t):null}return this[i]},set:function(t){this[i]=t,localStorage[n+this.id]=JSON.stringify(t)}})})};t in g||(g[t]=[]);var r=g[t];if(n)var o=e(n).difference(r).toArray();else var o=r;o.length&&(t in y&&i(y[t],o),n&&Array.prototype.push.apply(r,o))},this.on("new-model",function(t){t.modelName in d&&d[t.modelName].handle(y[t.modelName]),t.modelName in g&&s.addPersistentAttributes(t.modelName)}),this.query=function(t,n,i,r){var o=this;this.describe(t,function(s){n=e(n).map(function(t,e){return[e,Array.isArray(t)?t:[t]]}).toObject();var a=v.makeFilter(s,n),c=A(t);o.fetch(t,n,i,function(t){r(c.filter(a).values().toArray())})})},this.delete=function(t,e,n){return this.$post(t+"/delete",{id:e},n)},this.connect=function(t){this.connection.isLoggedIn?t():this.connection.connect(t)}};m.prototype.connect=function(){var t=this.$orm.connection;return new Promise(function(e,n){t.connect(e)})},m.prototype.login=function(t,e){return new Promise(function(n,i){this.$orm.connection.login(t,e,n)}.bind(this))},m.prototype.logout=function(t){return this.$orm.connection.logout()},m.prototype.getModel=function(t){var e=this;return new Promise(function(n,i){try{e.$orm.connect(function(){e.$orm.describe(t,n)})}catch(t){i(t)}})},m.prototype.get=function(t,e){var n=this,i=!1,r=t;return e.constructor!==Array&&(i=!0,e=[e]),new Promise(function(t,o){try{n.$orm.connect(function(){i?n.$orm.get(r,e,function(e){t(e[0])}):n.$orm.get(r,e,t)})}catch(t){o(t)}})},m.prototype.query=function(t,e,n){var i=this;return new Promise(function(r,o){var s=null;n&&n.constructor===Array&&n.length?s=n:n&&n.constructor===String&&n.length&&(s=n.split(","));try{i.$orm.connect(function(){i.$orm.query(t,e,s,r)})}catch(t){o(t)}})},m.prototype.delete=function(t,e){var n=this;return new Promise(function(i,r){try{n.$orm.connect(function(){n.$orm.delete(t,e,i)})}catch(t){r(t)}})},m.prototype.getLoggedUser=function(){var t=this;return this.$orm.connection.cachedStatus.user_id?this.get("auth_user",this.$orm.connection.cachedStatus.user_id):new Promise(function(e,n){t.once("logged-in",function(n){t.get("auth_user",n).then(e)})})},m.prototype.$sendToEndpoint=function(t,e){return this.$orm.$post(t,e)},m.prototype.login=function(t,e){return this.$orm.connection.login(t,e)},t.rwt=m}(window,Lazy,SockJS);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhbmRsZXJzLmpzIiwidXRpbHMuanMiLCJjb25uZWN0aW9uLmpzIiwidG91Y2hlci5qcyIsInZhY3V1bWNhY2hlci5qcyIsImF1dG9saW5rZXIuanMiLCJsaXN0Y2FjaGVyLmpzIiwibWFueXRvbWFueS5qcyIsImNhY2hlci5qcyIsIm9ybS5qcyJdLCJuYW1lcyI6WyJIYW5kbGVyIiwidGhpcyIsImhhbmRsZXJzIiwic3RySGFuZGxlcnMiLCJOYW1lZEV2ZW50TWFuYWdlciIsImV2ZW50cyIsImhhbmRsZXJJZCIsImlkeElkIiwib24iLCJuYW1lIiwiZnVuYyIsIkFycmF5IiwiaWQiLCJwdXNoIiwiZW1pdCIsImFyZ3MiLCJwcm90b3R5cGUiLCJzbGljZSIsImNhbGwiLCJhcmd1bWVudHMiLCJmb3JFYWNoIiwiZXZlbnQiLCJhcHBseSIsInVuYmluZCIsImhhbmRsZXIiLCJjb3VudCIsIkxhenkiLCJlYWNoIiwidiIsImsiLCJpZHgiLCJuIiwicmV2ZXJzZSIsIngiLCJzcGxpY2UiLCJvbmNlIiwiZXZlbnROYW1lIiwiaGFuZGxlckZ1bmN0aW9uIiwic2VsZiIsIm1vY2tPYmplY3QiLCJQcm94eSIsImdldCIsInRhcmdldCIsIm51bGxTdHJpbmciLCJSZWFsdGltZUNvbm5lY3Rpb24iLCJlbmRQb2ludCIsInJ3dENvbm5lY3Rpb24iLCJjb25uZWN0aW9uIiwiU29ja0pTIiwib25vcGVuIiwiY29uc29sZSIsImxvZyIsInRlbmFudCIsIm9ubWVzc2FnZSIsInR5cGUiLCJKU09OIiwicGFyc2UiLCJkYXRhIiwiZSIsIm9uY2xvc2UiLCJzZXRUaW1lb3V0IiwidXRpbHMiLCJ3c0Nvbm5lY3QiLCJzZW5kIiwiY2FjaGVkU3RhdHVzIiwiYXBwbGljYXRpb24iLCJ0b2tlbiIsImNsb3NlIiwicmVXaGVlbENvbm5lY3Rpb24iLCJnZXRMb2dpbiIsImVuZHNXaXRoIiwiaXNDb25uZWN0ZWQiLCJpc0xvZ2dlZEluIiwiVG91Y2hlciIsInRvdWNoZWQiLCJ0b3VjaCIsInQiLCJWYWN1dW1DYWNoZXIiLCJhc2tlZCIsInBrSW5kZXgiLCJtaXNzaW5nIiwiYXNrIiwibGF6eSIsInNvdXJjZSIsImNvbnRhaW5zIiwiZ2V0QXNrZWRJbmRleCIsIm1pc3NpbmdzIiwibGVuZ3RoIiwidW5pcXVlIiwidG9BcnJheSIsIkF1dG9MaW5rZXIiLCJhY3RpdmVzIiwiSURCIiwiVzJQUkVTT1VSQ0UiLCJsaXN0Q2FjaGUiLCJtYWluSW5kZXgiLCJmb3JlaWduS2V5cyIsIm0ybSIsIm0ybUluZGV4IiwicGVybWlzc2lvbnMiLCJtb2RlbCIsImluZGV4IiwiZ2V0SW5kZXhGb3IiLCJyZWZlcmVuY2VzIiwicmVmZXJlbmNlIiwiaW5kZXhOYW1lIiwidG8iLCJyZWZlcmVuY2VkQnkiLCJmaWVsZCIsImJ5IiwibWFueVRvTWFueSIsInJlbGF0aW9uIiwiTWFueVRvTWFueVJlbGF0aW9uIiwibTJtR2V0IiwiY29sbGVjdGlvbiIsImNhbGxCYWNrIiwiJHBvc3QiLCJnb3REYXRhIiwiZ2V0TTJNIiwiYmluZCIsImxpbmtVbmxpbmtlZCIsInZhbHVlcyIsInN1bSIsImNoYW5nZWQiLCJpbmRleGVzIiwiZmlsdGVyIiwiQm9vbGVhbiIsIm1hcCIsInBhcnNlSW50IiwiSU5ERVgiLCJnZXR0ZXIiLCJpZHMiLCJvdGhlckluZGV4Iiwic3BsaXQiLCJkZXNjcmliZSIsImZsYXR0ZW4iLCJtb2RlbE5hbWUiLCJrZXlzIiwiZmV0Y2giLCJub29wIiwibWFpblJlc291cmNlIiwiZmllbGROYW1lIiwidG9PYmplY3QiLCJyZXNvdXJjZU5hbWUiLCJnb3RQZXJtaXNzaW9ucyIsIlBFUk1JU1NJT05TIiwic2V0SW50ZXJ2YWwiLCJMaXN0Q2FjaGVyIiwiZ290QWxsIiwiY29tcG9zaXRlQXNrZWQiLCJjYXJ0ZXNpYW5Qcm9kdWN0MSIsInkiLCJpc0FycmF5IiwicmV0IiwiYSIsImIiLCJjYXJ0ZXNpYW5Qcm9kdWN0IiwiYXJyIiwiZXhwbG9kZUZpbHRlciIsInByb2R1Y3QiLCJyIiwiZmlsdGVyU2luZ2xlIiwidGVzdE9ubHkiLCJrZXkiLCJkaWZmZXJlbmNlIiwiY2xlYW5Db21wb3NpdGVzIiwiZmlsdGVyTGVuIiwic2l6ZSIsIm1ha2VGaWx0ZXIiLCJpdGVtIiwiZ290IiwidGhzIiwic2luZ2xlIiwic29tZSIsImYiLCJleHBsb2RlZCIsInBhcnRpYWxzIiwiYmFkIiwicGx1Y2siLCJpdGVtcyIsImFkZCIsImZpbmQiLCJnZXQwIiwiZ2V0MSIsImNhcGl0YWxpemUiLCJkZWwiLCJsIiwiY2FjaGVkUHJvcGVydHlCeUV2ZW50cyIsInByb3RvIiwicHJvcGVydHlOYW1lIiwic2V0dGVyIiwicmVzdWx0Iiwib3JtIiwicHJvcGVydHlEZWYiLCJ2YWx1ZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiVmFsaWRhdGlvbkVycm9yIiwicmVzb3VyY2UiLCJfcmVzb3VyY2UiLCJmb3JtSWR4IiwiZmllbGRzIiwiZXJyb3JzIiwicmVXaGVlbE9STSIsImxvZ2luRnVuYyIsIiRvcm0iLCJiYXNlT1JNIiwiYWRkTW9kZWxIYW5kbGVyIiwiYWRkUGVyc2lzdGVudEF0dHJpYnV0ZXMiLCJsb2dvdXQiLCJhZGRIYW5kbGVyIiwic3RySGFuZGxlciIsImhhc2giLCJ0b1N0cmluZyIsImhhbmRsZSIsImhhbmRsZUJ5IiwiY2FjaGVkS2V5SWR4IiwicmVuYW1lRnVuY3Rpb24iLCJmbiIsIkZ1bmN0aW9uIiwiY2FjaGVkIiwid3JhcHBlciIsInhkciIsInVybCIsImZvcm1FbmNvZGUiLCJQcm9taXNlIiwiYWNjZXB0IiwicmVqZWN0IiwicmVxIiwiWE1MSHR0cFJlcXVlc3QiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwicmVzcG9uc2VEYXRhIiwicmVzcG9uc2VUZXh0IiwicmVzcG9uc2UiLCJzdGF0dXMiLCJyZXF1ZXN0IiwiWERvbWFpblJlcXVlc3QiLCJvbmxvYWQiLCJzdGF0dXNUZXh0IiwiRXJyb3IiLCJvcGVuIiwib25lcnJvciIsInNldFJlcXVlc3RIZWFkZXIiLCJfX3Rva2VuX18iLCJlbmNvZGVVUkkiLCJqb2luIiwic3RyaW5naWZ5IiwicyIsInRvVXBwZXJDYXNlIiwidG9Mb3dlckNhc2UiLCJzdHIiLCJjaGFyQ29kZUF0IiwidW5pZmllciIsImRvbnRUcmFuc2xhdGVGaWx0ZXIiLCJ2YWxzIiwiY29uc3RydWN0b3IiLCJOdW1iZXIiLCJzYW1lQXMiLCJwbHVyYWxpemUiLCJiZWZvcmVDYWxsIiwiYmVmb3JlIiwiZGVjb3JhdG9yIiwidGhlbiIsImNsZWFuU3RvcmFnZSIsImxvY2FsU3RvcmFnZSIsImNsZWFuRGVzY3JpcHRpb24iLCJzdGFydHNXaXRoIiwiY2hyIiwicGVybXV0YXRpb25zIiwid2FpdEZvciIsIndhaXRlciIsImJvb2wiLCJ0ek9mZnNldCIsIkRhdGUiLCJnZXRUaW1lem9uZU9mZnNldCIsInRyYW5zRmllbGRUeXBlIiwiZGF0ZSIsImRhdGV0aW1lIiwic3RyaW5nIiwidGV4dCIsImludGVnZXIiLCJmbG9hdCIsInBhcnNlRmxvYXQiLCJtb2NrIiwiU1RBVFVTS0VZIiwicHJvbWlzZSIsInhociIsImZvcmNlIiwic3RhdHVzV2FpdGluZyIsInVwZGF0ZVN0YXR1cyIsImxhc3RCdWlsZCIsImxhc3RfYnVpbGQiLCJ1c2VyX2lkIiwib2xkU3RhdHVzIiwibG9naW5JbmZvIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwib2JqIiwicmVhbHRpbWVFbmRQb2ludCIsIndzQ29ubmVjdGlvbiIsInVzZXJpZCIsImVycm9yIiwib2siLCJjb25uZWN0Iiwib3B0aW9ucyIsImV4dE9STSIsIlBlcm1pc3Npb25UYWJsZSIsImtsYXNzIiwiU3RyaW5nIiwiY29ubmVjdGVkIiwid3MiLCJpbmZvIiwib25NZXNzYWdlSnNvbiIsIm9uTWVzc2FnZVRleHQiLCJtZXNzYWdlIiwic2VudERhdGEiLCJ3YWl0aW5nQ29ubmVjdGlvbnMiLCJhdXRoX2dyb3VwIiwiUkVWSURYIiwiYnVpbGRlckhhbmRsZXJzIiwiYnVpbGRlckhhbmRsZXJVc2VkIiwicGVyc2lzdGVudEF0dHJpYnV0ZXMiLCJtb2RlbENhY2hlIiwiZmFpbGVkTW9kZWxzIiwibGlua2VyIiwidmFsaWRhdGlvbkV2ZW50IiwiY3VycmVudENvbnRleHQiLCJzYXZpbmdFcnJvckhhbmxkZXIiLCJnZXRJbmRleCIsImdldFVubGlua2VkIiwiVU5MSU5LRUQiLCJzYXZlIiwiY2IiLCJteVBlcm1zIiwiZ3JvdXBfaWQiLCJwZXJtaXNzaW9uTGlzdCIsInAiLCJwZXJtcyIsImFsbFBlcm1pc3Npb25zIiwiaW5kZXhPZiIsIm1ha2VNb2RlbENsYXNzIiwicmVhZGFibGUiLCJ3cml0YWJsZSIsInByaXZhdGVBcmdzIiwibWVyZ2UiLCJmdW5jU3RyaW5nIiwiS2xhc3MiLCJyZWZfdHJhbnNsYXRpb25zIiwiaW52ZXJzZV9yZWZlcmVuY2VzIiwicmVmZXJlbnRzIiwiZmllbGRzT3JkZXIiLCJmaWVsZE9yZGVyIiwicmVwcmVzZW50YXRpb24iLCJkZWxldGUiLCJfcGVybWlzc2lvbnMiLCJhbGxfcGVybXMiLCJvYmplY3RfaWQiLCJncm91cGVkIiwidW5rbm93bl9ncm91cHMiLCJncm91cEJ5IiwibyIsImFzUmF3IiwiSUQiLCJhcmciLCJjb250ZXh0IiwiY29weSIsImFzciIsImNvbmNhdCIsInNhdmVNdWx0aSIsIm9iamVjdHMiLCJzY29wZSIsInJhdyIsImRlbGV0YWJsZSIsIm11bHRpcGxlIiwiZWxlbXMiLCJ0YWIiLCJvYmpzIiwicmVzdWx0cyIsImV4dHJhX3ZlcmJzIiwiZnVuY05hbWUiLCJkZGF0YSIsInNhdmVQQSIsIlQiLCJvbyIsIlBBIiwiRnMiLCJmaWVsZElkeCIsInRhcCIsImluZGV4QnkiLCJ3aWRnZXQiLCJyZWYiLCJleHRfcmVmIiwibG9jYWxfcmVmIiwiVHlwZUVycm9yIiwicmV2SW5kZXgiLCJoYXNPd25Qcm9wZXJ0eSIsIm9wdHMiLCJxdWVyeSIsImZpcnN0Iiwib21vZGVsTmFtZSIsInZhbGlkYXRvcnMiLCJ1bmxpbmtSZWZlcmVuY2UiLCJpbnN0YW5jZSIsImluc3RhbmNlcyIsIm9tb2RlbCIsImxpbmtSZWZlcmVuY2UiLCJyZWZzIiwiSU5ERVhfTTJNIiwiVzJQX1BPU1QiLCJfZXh0cmEiLCJUT09ORSIsIlRPTUFOWSIsIk1BTllUT01BTlkiLCJtb2RlbENsYXNzIiwiemlwIiwiZGVsZXRlZCIsIk1QQSIsInJlY29yZCIsIml0YWIiLCJ0YWJsZSIsImlrIiwibm5ldyIsInVwZGF0ZWQiLCJuZXdPYmplY3RzIiwib2xkSXRlbSIsIm9sZENvcHkiLCJuZXdJdGVtIiwibm8iLCJ0b3RhbFJlc3VsdHMiLCJBU0tFRF9VTkxJTktFRCIsIkFTS0VEX00yTSIsIk1JRFgiLCJnb3RNMk0iLCJyb3ciLCJtIiwidmVyYiIsInRvZ2V0aGVyIiwic2VuZERhdGEiLCJHT1RfQUxMIiwiZ290TW9kZWwiLCJjYWNoZUtleSIsIm1vZGVsTm90Rm91bmQiLCJhdHRyaWJ1dGVzIiwiYWRkUHJvcGVydHkiLCJ2YWwiLCJrYXR0ciIsInNldCIsImF0dHJzIiwibmV3QXR0cnMiLCJmaWx0ZXJGdW5jdGlvbiIsImdldE1vZGVsIiwibW9kTmFtZSIsInJlbGF0ZWQiLCJnZXRMb2dnZWRVc2VyIiwidXNlciIsIiRzZW5kVG9FbmRwb2ludCJdLCJtYXBwaW5ncyI6IjZCQUVBLFNBQUFBLEtBQ0FDLEtBQUFDLFlBQ0FELEtBQUFFLGVBeUJBLFFBQUFDLEtBQ0EsR0FBQUMsTUFDQUMsS0FDQUMsRUFBQSxDQUNBTixNQUFBTyxHQUFBLFNBQUFDLEVBQUFDLEdBQ0FELElBQUFKLEtBQ0FBLEVBQUFJLEdBQUEsR0FBQUUsT0FFQSxJQUFBQyxHQUFBTCxHQUdBLE9BRkFGLEdBQUFJLEdBQUFJLEtBQUFILEdBQ0FKLEVBQUFNLEdBQUFGLEVBQ0FFLEdBRUFYLEtBQUFhLEtBQUEsU0FBQUwsR0FDQSxHQUFBQSxJQUFBSixHQUFBLENBQ0EsR0FBQVUsR0FBQUosTUFBQUssVUFBQUMsTUFBQUMsS0FBQUMsVUFBQSxFQUNBZCxHQUFBSSxHQUFBVyxRQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLE1BQUEsS0FBQVAsT0FJQWQsS0FBQXNCLE9BQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBLENBQ0EsSUFBQUQsSUFBQWxCLEdBQUEsQ0FDQSxHQUFBSSxHQUFBSixFQUFBa0IsRUFBQSxHQUNBRSxHQUFBckIsR0FBQXNCLEtBQUEsU0FBQUMsRUFBQUMsR0FDQSxHQUFBQyxLQUNBLEtBQUEsR0FBQUMsS0FBQUgsR0FDQUEsRUFBQUcsS0FBQXJCLElBQ0FvQixFQUFBakIsS0FBQWtCLEdBQ0FOLElBR0FLLEdBQUFFLFVBQUFaLFFBQUEsU0FBQWEsR0FDQUwsRUFBQU0sT0FBQUQsRUFBQSxPQUtBLGFBREEzQixHQUFBa0IsR0FDQUMsR0FLQXhCLEtBQUFrQyxLQUFBLFNBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsR0FBQXJDLEtBQ0F1QixFQUFBdkIsS0FBQU8sR0FBQTRCLEVBQUEsV0FDQUMsRUFBQWYsTUFBQXJCLEtBQUFrQixXQUNBbUIsRUFBQWYsT0FBQUMsTUN2RUEsUUFBQWUsS0FDQSxNQUFBLElBQUFDLFdBQ0FDLElBQUEsU0FBQUMsRUFBQWpDLEdBQ0EsTUFBQSxnQkFBQUEsR0FDQSxhQUFBQSxFQUNBa0MsRUFFQUosSUFHQUcsRUFBQWpDLE1DWkEsUUFBQW1DLEdBQUFDLEVBQUFDLEdBSUEsR0FFQUMsR0FBQSxHQUFBQyxHQUFBSCxFQUNBRSxHQUFBRSxPQUFBLFNBQUFoQixHQUNBaUIsUUFBQUMsSUFBQSxVQUFBbEIsR0FDQWMsRUFBQUssU0FDQU4sRUFBQWhDLEtBQUEsMkJBQUFtQixJQUVBYyxFQUFBTSxVQUFBLFNBQUFwQixHQUNBLEdBQUEsV0FBQUEsRUFBQXFCLEtBRUEsSUFFQVIsRUFBQWhDLEtBQUEsd0JBQUF5QyxLQUFBQyxNQUFBdkIsRUFBQXdCLE9BRUEsTUFBQUMsR0FDQVosRUFBQWhDLEtBQUEsd0JBQUF5QyxLQUFBQyxNQUFBdkIsRUFBQXdCLFdBR0FQLFNBQUFDLElBQUEsaUJBQUFsQixJQUdBYyxFQUFBWSxRQUFBLFdBQ0FDLFdBQUFDLEVBQUFDLFVBQUEsS0FDQWhCLEVBQUFoQyxLQUFBLCtCQUVBaUMsRUFBQUssT0FBQSxXQUNBTCxFQUFBZ0IsS0FBQSxVQUFBakIsRUFBQWtCLGFBQUFDLFlBQUEsSUFBQW5CLEVBQUFrQixhQUFBRSxRQUVBakUsS0FBQWtFLE1BQUEsV0FDQXBCLEVBQUFvQixTQUlBLFFBQUFDLEdBQUF2QixFQUFBd0IsR0FVQSxHQUFBaEUsR0FBQSxHQUFBRCxFQUNBSCxNQUFBb0UsU0FBQUEsRUFDQXBFLEtBQUE0QyxTQUFBQSxFQUFBeUIsU0FBQSxLQUFBekIsRUFBQUEsRUFBQSxJQUNBNUMsS0FBQU8sR0FBQUgsRUFBQUcsR0FDQVAsS0FBQXNCLE9BQUFsQixFQUFBa0IsT0FDQXRCLEtBQUFhLEtBQUFULEVBQUFTLEtBQ0FiLEtBQUFrQyxLQUFBOUIsRUFBQThCLEtBQ0FsQyxLQUFBK0QsZ0JBQ0EvRCxLQUFBc0UsYUFBQSxFQUNBdEUsS0FBQXVFLFlBQUEsRUMzREEsUUFBQUMsS0FDQSxHQUFBQyxJQUFBLENBQ0F6RSxNQUFBMEUsTUFBQSxXQUNBRCxHQUFBLEdBRUF6RSxLQUFBeUUsUUFBQSxXQUNBLEdBQUFFLEdBQUFGLENBRUEsT0FEQUEsSUFBQSxFQUNBRSxHQ1BBLFFBQUFDLEdBQUFGLEVBQUFHLEVBQUFyRSxFQUFBc0UsR0FNQSxJQUFBRCxFQUNBLEdBQUFBLEtBRUEsSUFBQUUsS0FFQS9FLE1BQUFnRixJQUFBLFNBQUFyRSxFQUFBc0UsR0FDQUgsR0FBQW5FLElBQUFtRSxHQUFBSSxRQUdBekQsRUFBQW9ELEdBQUFNLFNBQUF4RSxLQUVBb0UsRUFBQW5FLEtBQUFELEdBQ0FzRSxHQUNBSixFQUFBakUsS0FBQUQsR0FDQStELEVBQUFBLFVBS0ExRSxLQUFBb0YsY0FBQSxXQUNBLE1BQUFQLElBR0E3RSxLQUFBcUYsU0FBQSxXQUNBLE1BQUE1RCxHQUFBc0QsRUFBQTlDLE9BQUEsRUFBQThDLEVBQUFPLFNBQUFDLFNBQUFDLFdDakNBLFFBQUFDLEdBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsR0FBQW5CLEdBQUEsR0FBQUYsR0FDQXNCLEtBQ0FDLEtBQ0FDLEtBQ0FDLEtBQ0FDLElBQ0FsRyxNQUFBOEYsVUFBQUEsRUFDQTlGLEtBQUErRixZQUFBQSxFQUNBL0YsS0FBQWdHLElBQUFBLEVBQ0FoRyxLQUFBaUcsU0FBQUEsRUFDQWpHLEtBQUFrRyxZQUFBQSxFQUVBTixFQUFBckYsR0FBQSxtQkFBQSxTQUFBNEYsRUFBQUMsR0FFQSxHQUFBdEIsR0FBQWUsRUFBQVEsWUFBQUYsRUFBQTNGLEtBQUEsS0FDQXNGLEdBQUFLLEVBQUEzRixNQUFBLEdBQUFvRSxHQUFBRixFQUFBSSxFQUFBLGFBQUFxQixFQUFBM0YsS0FBQTRGLEdBR0FGLEVBQUFDLEVBQUEzRixNQUFBLEdBQUFvRSxHQUFBRixFQUFBLEtBQUEsZUFBQXlCLEVBQUEzRixNQUdBaUIsRUFBQTBFLEVBQUFHLFlBQUE1RSxLQUFBLFNBQUE2RSxHQUNBLEdBQUFDLEdBQUFMLEVBQUEzRixLQUFBLElBQUErRixFQUFBNUYsRUFDQW9GLEdBQUFTLEdBQUEsR0FBQTVCLEdBQUFGLEVBQUFtQixFQUFBUSxZQUFBRSxFQUFBRSxHQUFBLE1BQUFGLEVBQUFFLEdBQUEsbUJBQUFELEtBR0EvRSxFQUFBMEUsRUFBQU8sY0FBQWhGLEtBQUEsU0FBQWlGLEdBQ0EsR0FBQUgsR0FBQUcsRUFBQUMsR0FBQSxJQUFBRCxFQUFBaEcsRUFDQW9GLEdBQUFTLEdBQUEsR0FBQTVCLEdBQUFGLEVBQUFtQixFQUFBUSxZQUFBTSxFQUFBQyxHQUFBRCxFQUFBaEcsSUFBQWdHLEVBQUFDLEdBQUEsSUFBQUQsRUFBQWhHLEdBQUEsZ0JBQUE2RixLQUVBL0UsRUFBQTBFLEVBQUFVLFlBQUFuRixLQUFBLFNBQUFvRixHQUNBQSxFQUFBTixZQUFBUixLQUNBQSxFQUFBYyxFQUFBTixZQUFBLEdBQUE1QixHQUFBRixFQUFBLEtBQUEsT0FBQW9DLEVBQUFOLFVBQUEsT0FBQSxHQUFBNUIsR0FBQUYsRUFBQSxLQUFBLE9BQUFvQyxFQUFBTixVQUFBLFNBQ0FNLEVBQUFOLFlBQUFQLEtBQ0FBLEVBQUFhLEVBQUFOLFdBQUEsR0FBQU8sR0FBQUQsRUFBQWQsRUFBQWMsRUFBQU4sZ0JBR0EsSUFBQVEsR0FBQSxTQUFBUixFQUFBMUUsRUFBQW1GLEVBQUFDLEdBQ0F0QixFQUFBdUIsT0FBQXJGLEVBQUE4QixFQUFBN0IsUUFBQSxJQUFBeUUsR0FBQUEsR0FBQSxVQUFBUyxXQUFBQSxHQUFBLFNBQUF6RCxHQUNBb0MsRUFBQXdCLFFBQUE1RCxFQUFBMEQsU0FDQXhCLEdBQUFjLE1BSUFhLEVBQUEsU0FBQWIsRUFBQVMsRUFBQW5GLEVBQUFvRixHQUVBekYsRUFBQXdGLEdBQUF2RixLQUFBc0UsRUFBQVEsR0FBQTFFLEdBQUFrRCxJQUFBc0MsS0FBQXRCLEVBQUFRLEdBQUExRSxLQUVBbUYsRUFBQWpCLEVBQUFRLEdBQUExRSxHQUFBdUQsV0FFQTRCLEVBQUEzQixRQUNBSSxFQUFBYyxHQUFBLEVBQ0FRLEVBQUFSLEVBQUExRSxFQUFBbUYsRUFBQUMsSUFFQUEsR0FBQUEsSUFHQWxILE1BQUFxSCxPQUFBQSxDQUVBLElBQUFFLEdBQUEsV0FFQSxHQUFBN0MsRUFBQUQsVUFBQSxDQUNBLEdBQUFoRCxFQUFBaUUsR0FBQThCLFNBQUFDLE1BRUEsV0FEQS9DLEdBQUFBLE9BR0EsSUFBQWdELElBQUEsQ0FDQWpHLEdBQUF1RSxHQUFBdEUsS0FBQSxTQUFBaUcsRUFBQW5CLEdBQ0EvRSxFQUFBa0csR0FBQWpHLEtBQUEsU0FBQTBFLEVBQUF0RSxHQUNBLEdBQUFtRixHQUFBYixFQUFBZixVQUlBLElBSEE0QixFQUFBeEYsRUFBQXdGLEdBQUFXLE9BQUFDLFNBQUFDLElBQUEsU0FBQTlGLEdBQ0EsTUFBQStGLFVBQUEvRixLQUNBd0QsVUFDQXlCLEVBQUEzQixPQUFBLENBQ0EsR0FBQTBDLEdBQUEvQixFQUFBTyxHQUNBeUIsRUFBQUQsRUFBQSxPQUFBLEVBQUFsRyxJQUFBd0YsS0FBQVUsRUFDQU4sSUFBQSxFQUNBVixFQUFBUixFQUFBMUUsRUFBQW1GLEVBQUEsU0FBQXpELEdBQ0EsR0FBQTBFLEdBQUFqQixFQUFBYSxJQUFBRyxFQUNBLElBQUFDLEVBQUE1QyxPQUFBLENBQ0EsR0FBQTZDLEdBQUEzQixFQUFBNEIsTUFBQSxLQUFBLEVBQUF0RyxFQUNBOEQsR0FBQXlDLFNBQUFGLEVBQUEsV0FFQTFHLEVBQUF5RyxHQUFBSSxVQUFBL0MsU0FBQTdELEtBQUEsU0FBQU0sR0FDQThELEVBQUFxQyxHQUFBbkQsSUFBQWhELEdBQUEsZUFRQVAsRUFBQXFFLEdBQUFwRSxLQUFBLFNBQUEwRSxFQUFBbUMsR0FDQSxHQUFBTCxHQUFBOUIsRUFBQWYsVUFDQSxJQUFBNkMsRUFBQTVDLE9BQUEsQ0FDQW9DLEdBQUEsQ0FDQWEsS0FBQTVDLEdBQUFBLEVBQUE0QyxHQUFBQyxPQUFBL0csR0FFQW1FLEdBQUE2QyxNQUFBRixHQUFBNUgsR0FBQXVILEdBQUEsS0FBQXRFLEVBQUE4RSxTQUlBakgsRUFBQXNFLEdBQ0ErQixJQUFBLFNBQUFuRyxFQUFBQyxHQUNBLE9BQUFBLEVBQUFELEVBQUEwRCxjQUNBdUMsT0FBQSxTQUFBakcsR0FDQSxNQUFBQSxHQUFBLEdBQUEyRCxTQUNBNUQsS0FBQSxTQUFBTSxHQUNBMEYsR0FBQSxDQUNBLElBQUFRLEdBQUFsRyxFQUFBLEdBQ0F3RSxFQUFBeEUsRUFBQSxHQUNBb0UsRUFBQUksRUFBQTRCLE1BQUEsS0FDQU8sRUFBQXZDLEVBQUEsR0FDQXdDLEVBQUF4QyxFQUFBLEdBQ0F3QixJQUNBQSxHQUFBZ0IsR0FBQVYsRUFDQXRDLEVBQUE2QyxNQUFBRSxFQUFBZixLQUdBbkcsRUFBQUEsRUFBQXlFLEdBQUE0QixJQUFBLFNBQUFuRyxFQUFBQyxHQUNBLE9BQUFBLEVBQUFELEVBQUEwRCxjQUNBdUMsT0FBQSxTQUFBakcsR0FDQSxNQUFBQSxHQUFBLEdBQUEyRCxTQUNBdUQsWUFBQW5ILEtBQUEsU0FBQXdHLEVBQUFZLEdBQ0FwQixHQUFBLEVBQ0FRLEVBQUE1QyxTQUNBSSxFQUFBb0QsR0FBQSxFQUNBbEQsRUFBQXVCLE1BQUEyQixFQUFBLGFBQUFaLElBQUF6RyxFQUFBeUcsR0FBQTNDLFNBQUFDLFdBQUEsU0FBQWhDLEdBQ0FvQyxFQUFBbUQsZUFBQXZGLEVBQUF3RixtQkFDQXRELEdBQUFvRCxTQUtBRyxhQUFBMUIsRUFBQSxJQ3JJQSxRQUFBMkIsS0FDQSxHQUFBQyxNQUNBdEUsS0FDQXVFLEtBQ0FDLEVBQUEsU0FBQXJILEVBQUFzSCxFQUFBQyxHQUNBLEdBQUFDLEtBQ0EsSUFBQUQsRUFDQSxJQUFBLEdBQUFFLEtBQUF6SCxHQUNBLElBQUEsR0FBQTBILEtBQUFKLEdBQ0FFLEVBQUE1SSxLQUFBYSxHQUFBTyxFQUFBeUgsR0FBQUgsRUFBQUksS0FBQXBCLFVBQUE5QyxlQUlBLEtBQUEsR0FBQWlFLEtBQUF6SCxHQUNBLElBQUEsR0FBQTBILEtBQUFKLEdBQ0FFLEVBQUE1SSxNQUFBb0IsRUFBQXlILEdBQUFILEVBQUFJLElBSUEsT0FBQUYsSUFFQUcsRUFBQSxTQUFBQyxHQUdBLElBQUEsR0FGQUwsSUFBQSxFQUNBQyxFQUFBSSxFQUFBLEdBQ0E1SCxFQUFBLEVBQUFBLEVBQUE0SCxFQUFBdEUsU0FBQXRELEVBQ0F3SCxFQUFBSCxFQUFBRyxFQUFBSSxFQUFBNUgsR0FBQXVILEdBQ0FBLEdBQUEsQ0FFQSxPQUFBQyxJQUVBSyxFQUFBLFNBQUFqQyxHQUNBLEdBQUFrQyxHQUFBSCxFQUFBbEksRUFBQW1HLEdBQUFKLFNBQUFoQyxXQUNBZ0QsRUFBQS9HLEVBQUFtRyxHQUFBWSxPQUFBaEQsU0FDQSxPQUFBc0UsR0FBQWhDLElBQUEsU0FBQTlGLEdBQ0EsR0FBQStILEtBSUEsT0FIQXZCLEdBQUFySCxRQUFBLFNBQUFzSSxFQUFBM0gsR0FDQWlJLEVBQUFOLEdBQUF6SCxFQUFBRixLQUVBaUksS0FJQUMsRUFBQSxTQUFBN0QsRUFBQXlCLEVBQUFxQyxHQUVBLEdBQUExQixHQUFBcEMsRUFBQW9DLFVBQ0FsQyxFQUFBckcsS0FBQXFHLFlBRUFzQixHQURBbEcsRUFBQW1HLEdBQUFFLElBQUEsU0FBQW5HLEVBQUF1SSxHQUFBLE9BQUFBLEVBQUEzQixFQUFBLElBQUEyQixLQUFBckIsV0FDQXBILEVBQUFtRyxHQUFBWSxPQUFBVixJQUFBLFNBQUFvQyxHQUFBLE9BQUFBLEVBQUE3RCxFQUFBa0MsRUFBQTJCLE1BQUFyQixXQUVBLEtBQUEsR0FBQTdHLEtBQUE0RixHQUFBLENBRUEsR0FBQXVDLEdBQUExSSxFQUFBbUcsRUFBQTVGLElBQUFtSSxXQUFBeEMsRUFBQTNGLElBQUF3RCxTQUNBLElBQUEyRSxFQUFBN0UsT0FBQSxDQUVBLEdBQUFrRSxHQUFBL0gsSUFBQU8sRUFBQW1JLEtBQUF0QixVQUtBLE9BSEFvQixJQUNBdkosTUFBQUssVUFBQUgsS0FBQVMsTUFBQXNHLEVBQUEzRixHQUFBbUksR0FFQVgsRUFHQSxNQUFBLFFBS0FZLEVBQUEsU0FBQWpFLEVBQUF5QixHQUtBekIsRUFBQTNGLE9BQUE0SSxLQUFBQSxFQUFBakQsRUFBQTNGLFNBQ0EsSUFBQTRGLEdBQUFnRCxFQUFBakQsRUFBQTNGLE1BRUE2SixFQUFBNUksRUFBQW1HLEdBQUEwQyxNQUNBbEUsR0FBQXdCLE9BQUFoRSxFQUFBMkcsV0FBQXBFLEVBQUF5QixFQUFBLFFBQUEsSUFBQUEsT0FBQSxTQUFBNEMsR0FBQS9JLEVBQUErSSxHQUFBRixPQUFBRCxJQUlBckssTUFBQTRILE9BQUEsU0FBQXpCLEVBQUF5QixHQUVBLEdBQUFXLEdBQUFwQyxFQUFBb0MsVUFHQThCLEVBQUE1SSxFQUFBbUcsR0FBQTBDLE1BQ0EsUUFBQUQsR0FDQSxJQUFBLEdBRUEsR0FBQUksR0FBQXRCLEVBQUFaLEVBVUEsT0FUQVksR0FBQVosSUFBQSxFQUNBQSxJQUFBMUQsVUFDQUEsR0FBQTBELEdBSUFBLElBQUFhLFVBQ0FBLEdBQUFiLEdBRUFrQyxFQUNBLE9BR0EsS0FBQSxHQUNBLEdBQUFqQixHQUFBUSxFQUFBL0ksS0FBQWpCLEtBQUFtRyxFQUFBeUIsRUFFQSxPQURBd0MsR0FBQW5KLEtBQUFqQixLQUFBbUcsRUFBQXlCLEdBQ0E0QixFQUdBLEdBQUFrQixHQUFBMUssS0FDQTJLLEVBQUFsSixFQUFBbUcsR0FBQVksT0FBQW9DLEtBQUEsU0FBQVYsR0FDQSxHQUFBVyxLQUVBLE9BREFBLEdBQUFYLEdBQUF0QyxFQUFBc0MsR0FDQSxNQUFBRixFQUFBL0ksS0FBQXlKLEVBQUF2RSxFQUFBMEUsR0FBQSxJQUVBLElBQUFGLEVBQUEsTUFBQSxLQUVBcEMsS0FBQWEsS0FBQUEsRUFBQWIsTUFFQSxJQUFBdUMsR0FBQWpCLEVBQUFqQyxHQUVBbUQsRUFBQTNCLEVBQUFiLEdBQUFYLE9BQUFoRSxFQUFBMkcsV0FBQXBFLEVBQUF5QixFQUFBLFFBQUEsR0FFQSxJQUFBbUQsRUFBQXpGLE9BQUEsQ0FDQSxHQUFBMEYsS0FFQSxLQUFBLEdBQUFoSixLQUFBK0ksR0FDQUMsRUFBQXBLLEtBQUFTLE1BQUEySixFQUFBRixFQUFBbEQsT0FBQWhFLEVBQUEyRyxXQUFBcEUsRUFBQTRFLEVBQUEvSSxHQUFBLFFBQUEsSUFHQSxJQUFBcUQsR0FBQTVELEVBQUFxSixHQUFBWCxXQUFBYSxHQUFBeEYsY0FFQSxJQUFBSCxHQUFBeUYsQ0FJQSxJQUFBekYsRUFBQUMsT0FBQSxDQUNBOEQsRUFBQWIsR0FBQTNILEtBQUFTLE1BQUErSCxFQUFBYixHQUFBbEQsRUFFQSxJQUFBQSxHQUFBNUQsRUFBQW1HLEdBQUFZLE9BQUFWLElBQUEsU0FBQW9DLEdBQ0EsR0FBQVYsR0FBQS9ILEVBQUE0RCxHQUFBNEYsTUFBQWYsR0FBQTNFLFNBQUFDLFNBQ0EsUUFBQTBFLEVBQUFWLEVBQUFsRSxPQUFBa0UsRUFBQTVCLEVBQUFzQyxNQUNBckIsVUFJQSxPQURBdUIsR0FBQWpFLEVBQUFkLEdBQ0FBLEVBRUEsTUFBQSxPQUdBckYsS0FBQXFHLFlBQUEsU0FBQWtDLEVBQUFLLEdBQ0EsR0FBQXBDLEdBQUErQixFQUFBLElBQUFLLENBSUEsT0FIQXBDLEtBQUEzQixLQUNBQSxFQUFBMkIsT0FFQTNCLEVBQUEyQixJQzVKQSxRQUFBTyxHQUFBRCxFQUFBZCxHQUNBLEdBQUFrRixLQUNBbEwsTUFBQW1MLElBQUFELEVBQUF0SyxLQUFBMEcsS0FBQTRELEdBQ0FsTCxLQUFBbUwsSUFBQSxTQUFBWCxHQUVBL0ksRUFBQXlKLEdBQUFFLEtBQUFaLElBQ0FVLEVBQUF0SyxLQUFBNEosSUFJQXhLLEtBQUFxTCxLQUFBLFNBQUExSyxHQUVBLE1BREFxRixHQUFBLEdBQUFoQixJQUFBckUsR0FDQWMsRUFBQXlKLEdBQUF0RCxPQUFBLFNBQUE1RixHQUNBLE1BQUFBLEdBQUEsS0FBQXJCLElBQ0FzSyxNQUFBLEtBQUF6RixXQUdBeEYsS0FBQXNMLEtBQUEsU0FBQTNLLEdBRUEsTUFEQXFGLEdBQUEsR0FBQWhCLElBQUFyRSxHQUNBYyxFQUFBeUosR0FBQXRELE9BQUEsU0FBQTVGLEdBQ0EsTUFBQUEsR0FBQSxLQUFBckIsSUFDQXNLLE1BQUEsS0FBQXpGLFdBRUF4RixLQUFBLE1BQUE0RCxFQUFBMkgsV0FBQXpFLEVBQUFOLFVBQUE0QixNQUFBLEtBQUEsS0FBQXBJLEtBQUFzTCxLQUNBdEwsS0FBQSxNQUFBNEQsRUFBQTJILFdBQUF6RSxFQUFBTixVQUFBNEIsTUFBQSxLQUFBLEtBQUFwSSxLQUFBcUwsS0FFQXJMLEtBQUF3TCxJQUFBLFNBQUFoQixHQUdBLElBQUEsR0FGQWlCLEdBQUFQLEVBQUE1RixPQUNBekQsRUFBQSxLQUNBNEgsRUFBQSxFQUFBQSxFQUFBZ0MsRUFBQWhDLElBQ0EsR0FBQXlCLEVBQUF6QixHQUFBLEtBQUFlLEVBQUEsSUFBQVUsRUFBQXpCLEdBQUEsS0FBQWUsRUFBQSxHQUFBLENBQ0EzSSxFQUFBNEgsQ0FDQSxPQUdBNUgsR0FDQXFKLEVBQUFqSixPQUFBd0gsRUFBQSxHQUVBeEcsUUFBQUMsSUFBQSxZQUFBc0gsSUN0Q0EsUUFBQWtCLEdBQUFDLEVBQUFDLEVBQUEzRCxFQUFBNEQsR0FDQSxHQUFBekwsR0FBQU0sTUFBQUssVUFBQUMsTUFBQUMsS0FBQUMsVUFBQSxHQUNBNEssSUFFQXJLLEdBQUFyQixHQUFBc0IsS0FBQSxTQUFBTixHQUNBdUssRUFBQUksSUFBQXhMLEdBQUFhLEVBQUEsV0FDQTBLLFFBR0EsSUFBQUUsSUFDQXhKLElBQUEsV0FJQSxNQUhBeEMsTUFBQVcsS0FBQW1MLEtBQ0FBLEVBQUE5TCxLQUFBVyxJQUFBc0gsRUFBQWhILEtBQUFqQixPQUVBOEwsRUFBQTlMLEtBQUFXLEtBR0FrTCxLQUNBRyxFQUFBLElBQUEsU0FBQUMsR0FDQUEsSUFBQUgsRUFBQTlMLEtBQUFXLE1BQ0FrTCxFQUFBNUssS0FBQWpCLEtBQUFpTSxHQUNBak0sS0FBQVcsS0FBQW1MLFVBQ0FBLEdBQUE5TCxLQUFBVyxPQUtBdUwsT0FBQUMsZUFBQVIsRUFBQUMsRUFBQUksR0MzQkEsUUFBQUksR0FBQTVJLEdBQ0F4RCxLQUFBcU0sU0FBQTdJLEVBQUE4SSxVQUNBdE0sS0FBQXVNLFFBQUEvSSxFQUFBK0ksUUFDQXZNLEtBQUF3TSxPQUFBaEosRUFBQWlKLE9BNDZCQSxRQUFBQyxHQUFBOUosRUFBQStKLEdBQ0EzTSxLQUFBNE0sS0FBQSxHQUFBQyxHQUFBLEdBQUFqSixHQUFBTyxrQkFBQXZCLEVBQUErSixHQUFBM00sTUFDQUEsS0FBQU8sR0FBQVAsS0FBQTRNLEtBQUFyTSxHQUFBK0csS0FBQXRILEtBQUE0TSxNQUNBNU0sS0FBQWEsS0FBQWIsS0FBQTRNLEtBQUEvTCxLQUFBeUcsS0FBQXRILEtBQUE0TSxNQUNBNU0sS0FBQXNCLE9BQUF0QixLQUFBNE0sS0FBQXRMLE9BQUFnRyxLQUFBdEgsS0FBQTRNLE1BQ0E1TSxLQUFBa0MsS0FBQWxDLEtBQUE0TSxLQUFBMUssS0FDQWxDLEtBQUE4TSxnQkFBQTlNLEtBQUE0TSxLQUFBRSxnQkFBQXhGLEtBQUF0SCxLQUFBNE0sTUFDQTVNLEtBQUErTSx3QkFBQS9NLEtBQUE0TSxLQUFBRyx3QkFBQXpGLEtBQUF0SCxLQUFBNE0sTUFDQTVNLEtBQUE0RCxNQUFBQSxFQUNBNUQsS0FBQWdOLE9BQUFoTixLQUFBNE0sS0FBQTlKLFdBQUFrSyxPQUFBMUYsS0FBQXRILEtBQUE0TSxLQUFBOUosWVRuN0JBL0MsRUFBQWdCLFVBQUFrTSxXQUFBLFNBQUExTCxHQUNBLEdBQUEyTCxHQUFBdEosRUFBQXVKLEtBQUE1TCxFQUFBNkwsV0FDQUYsS0FBQWxOLE1BQUFFLGNBQ0FGLEtBQUFFLFlBQUFnTixHQUFBM0wsRUFDQXZCLEtBQUFDLFNBQUFXLEtBQUFXLEtBR0F4QixFQUFBZ0IsVUFBQXNNLE9BQUEsV0FDQSxHQUFBdk0sR0FBQUosTUFBQUssVUFBQUMsTUFBQUMsS0FBQUMsVUFBQSxFQUNBbEIsTUFBQUMsU0FBQWtCLFFBQUEsU0FBQVYsR0FDQUEsRUFBQVksTUFBQSxLQUFBUCxNQUdBZixFQUFBZ0IsVUFBQXVNLFNBQUEsV0FDQSxHQUFBeE0sR0FBQUosTUFBQUssVUFBQUMsTUFBQUMsS0FBQUMsVUFBQSxHQUNBd0osRUFBQXhKLFVBQUEsRUFDQWxCLE1BQUFDLFNBQUFrQixRQUFBLFNBQUFWLEdBQ0FBLEVBQUFZLE1BQUFxSixFQUFBNUosS0N0QkEsSUFBQXlNLEdBQUEsRUFFQTdLLEVBQUEsV0FBQSxNQUFBLElBeU5Ba0IsR0FDQTRKLGVBQUEsU0FBQWhOLEVBQUFpTixHQUNBLE1BQUEsSUFBQUMsVUFBQSw0Q0FBQWxOLEVBQ0EsOENBQUFrTixTQUFBck0sTUFBQWlHLEtBQUFtRyxLQUVBRSxPQUFBLFNBQUFsTixFQUFBeUosR0FJQSxRQUFBMEQsS0FJQSxNQUhBNU4sTUFBQWtLLEtBQ0FsSyxLQUFBa0ssR0FBQXpKLEVBQUFRLEtBQUFqQixNQUFBa0IsYUFFQWxCLEtBQUFrSyxHQUVBLE1BVEFBLEtBQ0FBLEVBQUEsSUFBQXFELEtBUUFLLEdBSUExSyxJQUFBLFdBQ0FELFFBQUFDLElBQUFoQyxZQUdBMk0sSUFBQSxTQUFBQyxFQUFBdEssRUFBQVEsRUFBQUMsRUFBQThKLEdBSUEsTUFBQSxJQUFBQyxTQUFBLFNBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsRUFDQTNLLEtBQUFBLE1BRUE0SyxnQkFDQUQsRUFBQSxHQUFBQyxnQkFDQUQsRUFBQUUsbUJBQUEsV0FDQSxHQUFBLElBQUFGLEVBQUFHLFdBQUEsQ0FDQSxJQUNBLEdBQUFDLEdBQUFqTCxLQUFBQyxNQUFBNEssRUFBQUssY0FDQSxNQUFBL0UsR0FDQSxHQUFBOEUsR0FBQSxLQUVBLEdBQUFFLElBQUFGLGFBQUFBLEVBQUFDLGFBQUFMLEVBQUFLLGFBQUFFLE9BQUFQLEVBQUFPLE9BQUFDLFFBQUFSLEVBQ0FBLEdBQUFPLFFBQUEsS0FBQVAsRUFBQU8sT0FBQSxJQUNBVCxFQUFBUSxHQUVBUCxFQUFBTyxNQUlBRyxnQkFDQVQsRUFBQSxHQUFBUyxnQkFDQVQsRUFBQVUsT0FBQSxXQUNBWixFQUFBRSxFQUFBSyxhQUFBTCxFQUFBVyxXQUFBWCxLQUdBRCxFQUFBLEdBQUFhLE9BQUEsdUJBR0FaLEVBQUFhLEtBQUEsT0FBQWxCLEdBQUEsR0FDQUssRUFBQWMsUUFBQWYsRUFDQUMsRUFBQWUsaUJBQUEsU0FBQSxvQkFDQWpMLElBQUFULEVBQUEyTCxVQUFBbEwsR0FDQThKLEdBSUFJLEVBQUFlLGlCQUFBLGVBQUEscUNBQ0ExTCxFQUFBL0IsRUFBQStCLEdBQUFzRSxJQUFBLFNBQUFuRyxFQUFBQyxHQUNBLE1BQUFBLEdBQUEsSUFBQXdOLFVBQUF6TixFQUFBeUwsY0FDQTVILFVBQUE2SixLQUFBLE9BTkFsQixFQUFBZSxpQkFBQSxlQUFBLGNBQ0ExTCxFQUFBL0IsRUFBQStCLEdBQUE4RyxPQUFBaEgsS0FBQWdNLFVBQUE5TCxHQUFBLElBT0EySyxFQUFBckssS0FBQU4sTUFLQStILFdBQUEsU0FBQWdFLEdBQ0EsTUFBQUEsR0FBQSxHQUFBQyxjQUFBRCxFQUFBdk8sTUFBQSxHQUFBeU8sZUFHQXRDLEtBQUEsU0FBQXVDLEdBSUFBLEVBQUFBLEVBQUF0QyxVQUVBLEtBQUEsR0FEQTVELEdBQUEsRUFDQXhILEVBQUEsRUFBQUEsRUFBQTBOLEVBQUFwSyxPQUFBdEQsSUFDQXdILEdBQUEsRUFBQWtHLEVBQUFDLFdBQUEzTixFQUVBLFFBQUF3SCxFQUFBLGFBQUE0RCxZQUdBN0MsV0FBQSxTQUFBcEUsRUFBQXlCLEVBQUFnSSxFQUFBQyxHQUtBLEdBREFELElBQUFBLEVBQUEsUUFDQSxJQUFBbk8sRUFBQW1HLEdBQUEwQyxPQUNBLE1BQUEsVUFBQXRJLEdBQUEsT0FBQSxFQUVBLElBQUFrRCxHQUFBekQsRUFBQW1HLEdBQUFFLElBQUEsU0FBQWdJLEVBQUFuSixHQWdCQSxNQWZBbUosS0FBQUEsR0FBQSxPQUNBcFAsTUFBQTZJLFFBQUF1RyxLQUNBQSxHQUFBQSxJQUVBRCxHQUFBLGNBQUExSixFQUFBcUcsT0FBQTdGLEdBQUF0RCxLQVFBLFdBQUE4QyxFQUFBcUcsT0FBQTdGLEdBQUF0RCxPQUNBeU0sRUFBQUEsRUFBQWhJLElBQUF4RSxLQUFBZ00sYUFSQTNJLEVBQUEsSUFBQUEsRUFDQW1KLEVBQUFyTyxFQUFBcU8sR0FBQWhJLElBQUEsU0FBQTlGLEdBQ0EsTUFBQUEsSUFBQUEsRUFBQStOLGNBQUFDLE9BQ0FoTyxFQUFBckIsR0FFQXFCLElBQ0F3RCxXQUlBLElBQUEvRCxFQUFBcU8sR0FBQWhJLElBQUEsU0FBQTlGLEdBQ0EsTUFBQSxNQUFBMkUsRUFBQSxRQUFBM0UsRUFBQSxNQUNBcU4sS0FBQSxRQUFBLE1BQ0E3SixVQUFBNkosS0FBQU8sRUFDQSxPQUFBLElBQUFsQyxVQUFBLElBQUEsVUFBQXhJLElBR0ErSyxPQUFBLFNBQUFqTyxFQUFBc0gsR0FJQSxJQUFBLEdBQUExSCxLQUFBSSxHQUNBLEdBQUFzSCxFQUFBMUgsSUFBQUksRUFBQUosR0FDQSxPQUFBLENBR0EsUUFBQSxHQUdBc08sVUFBQSxTQUFBUixFQUFBdkosR0FJQSxNQUFBdUosR0FBQSxLQUdBUyxXQUFBLFNBQUExUCxFQUFBMlAsR0FDQSxHQUFBQyxHQUFBLFdBQ0FELElBQUFFLEtBQUE3UCxHQUVBLE9BQUE0UCxJQUdBRSxhQUFBLFdBSUE5TyxFQUFBK08sY0FBQWhJLE9BQUE5RyxLQUFBLFNBQUFFLFNBQ0E0TyxjQUFBNU8sTUFJQTZPLGlCQUFBLFdBQ0FoUCxFQUFBK08sY0FDQTVJLE9BQUEsU0FBQWpHLEVBQUFHLEdBQUEsTUFBQUwsR0FBQUssR0FBQTRPLFdBQUEsa0JBQ0FsSSxPQUNBOUcsS0FBQSxTQUFBSSxTQUFBME8sY0FBQTFPLE1BR0FDLFFBQUEsU0FBQTRPLEVBQUFqQixHQUNBLE1BQUFBLEdBQUF0SCxNQUFBdUksR0FBQTVPLFVBQUFzTixLQUFBc0IsSUFFQUMsYUFBQSxTQUFBaEgsR0FFQSxJQUFBLEdBREFKLE1BQ0F4SCxFQUFBNEgsRUFBQXRFLE9BQUEsRUFBQXRELEdBQUEsRUFBQUEsSUFDQSxJQUFBLEdBQUFzSCxHQUFBTSxFQUFBdEUsT0FBQSxFQUFBZ0UsR0FBQSxFQUFBQSxJQUNBdEgsSUFBQXNILEdBQ0FFLEVBQUE1SSxNQUFBZ0osRUFBQTVILEdBQUE0SCxFQUFBTixJQUdBLE9BQUFFLElBR0FxSCxRQUFBLFNBQUFwUSxFQUFBeUcsR0FDQSxHQUFBNEosR0FBQSxXQUNBclEsSUFDQXlHLElBRUF2RCxXQUFBbU4sRUFBQSxLQUdBbk4sWUFBQW1OLEVBQUEsTUFHQUMsS0FBQWxKLFFBRUFhLEtBQUEsYUFFQXNJLFNBQUEsS0FBQSxHQUFBQyxPQUFBQyxvQkFFQUMsZ0JBQ0FDLEtBQUEsU0FBQXBQLEdBQUEsTUFBQSxJQUFBaVAsTUFBQSxJQUFBalAsRUFBQTRCLEVBQUFvTixXQUNBSyxTQUFBLFNBQUFyUCxHQUFBLE1BQUEsSUFBQWlQLE1BQUEsSUFBQWpQLEVBQUE0QixFQUFBb04sV0FDQU0sT0FBQSxTQUFBdFAsR0FBQSxNQUFBQSxHQUFBb0wsWUFDQW1FLEtBQUEsU0FBQXZQLEdBQUEsTUFBQUEsR0FBQW9MLFlBQ0FvRSxRQUFBLFNBQUF4UCxHQUFBLE1BQUErRixVQUFBL0YsSUFDQXlQLE1BQUEsU0FBQXpQLEdBQUEsTUFBQTBQLFlBQUExUCxLQUVBMlAsS0FBQXJQLEVDdGFBLE1BQUFzUCxHQUFBLHlCQWdFQXpOLEdBQUFwRCxVQUFBb0csTUFBQSxTQUFBMkcsRUFBQXRLLEVBQUEwRCxHQVNBLEdBQUF3RCxHQUFBMUssS0FDQTZSLEVBQUEsR0FBQTdELFNBQUEsU0FBQUMsRUFBQUMsR0FDQXRLLEVBQUFpSyxJQUFBbkQsRUFBQTlILFNBQUFrTCxFQUFBdEssRUFBQWtILEVBQUEzRyxhQUFBQyxZQUFBMEcsRUFBQTNHLGFBQUFFLE9BQ0FxTSxLQUFBLFNBQUF3QixHQUNBcEgsRUFBQTdKLEtBQUEsZ0JBQUFpUixFQUFBdEQsYUFBQXNELEVBQUFwRCxPQUFBWixFQUFBdEssR0FDQWtILEVBQUE3SixLQUFBLGlCQUFBaVIsRUFBQXBELE9BQUFvRCxFQUFBdEQsYUFBQVYsRUFBQXRLLEdBQ0FzTyxFQUFBdkQsY0FDQTdELEVBQUE3SixLQUFBLGlCQUFBaVIsRUFBQXBELE9BQUEsUUFBQW9ELEVBQUF2RCxhQUFBVCxFQUFBdEssR0FFQTBELEdBQUFBLEVBQUE0SyxFQUFBdkQsY0FBQXVELEVBQUF0RCxjQUNBUCxFQUFBNkQsRUFBQXZELGNBQUF1RCxFQUFBdEQsZUFDQSxTQUFBc0QsR0FDQUEsRUFBQXZELGNBQ0E3RCxFQUFBN0osS0FBQSxhQUFBaVIsRUFBQXZELGFBQUF1RCxFQUFBcEQsT0FBQVosRUFBQXRLLEVBQUFzTyxHQUNBcEgsRUFBQTdKLEtBQUEsY0FBQWlSLEVBQUFwRCxPQUFBb0QsRUFBQXZELGFBQUFULEVBQUF0SyxFQUFBc08sS0FFQXBILEVBQUE3SixLQUFBLGFBQUFpUixFQUFBdEQsYUFBQXNELEVBQUFwRCxPQUFBWixFQUFBdEssRUFBQXNPLEdBQ0FwSCxFQUFBN0osS0FBQSxjQUFBaVIsRUFBQXBELE9BQUFvRCxFQUFBdEQsYUFBQVYsRUFBQXRLLEVBQUFzTyxJQUVBNUQsRUFBQTRELEVBQUF2RCxjQUFBdUQsRUFBQXRELGlCQUdBLE9BQUFxRCxJQVVBMU4sRUFBQXBELFVBQUEyTixPQUFBLFNBQUF4SCxFQUFBNkssR0FFQSxHQUFBN0gsR0FBQSxTQUFBbEssS0FBQTRDLFNBQ0E4SCxFQUFBMUssSUFLQSxJQUpBK1IsSUFDQS9SLEtBQUErRCxzQkFDQXlNLGNBQUF0RyxJQUVBbEssS0FBQWdTLGNBT0EsV0FMQXBPLEdBQUFpTixRQUFBLFdBQ0EsT0FBQW5HLEVBQUFzSCxlQUNBLFdBQ0F0SCxFQUFBZ0UsT0FBQXhILEVBQUE2SyxJQU1BLEtBQUF0USxFQUFBekIsS0FBQStELGNBQUF1RyxPQUdBLENBQ0EsR0FBQTlHLEtBWUEsT0FYQTBHLEtBQUFzRyxnQkFDQWhOLEVBQUEyTCxVQUFBcUIsYUFBQXRHLElBRUFsSyxLQUFBZ1MsZUFBQSxNQUNBaFMsTUFBQW1ILE1BQUEsYUFBQTNELEVBQUEsU0FBQWtMLEdBQ0FoRSxFQUFBdUgsYUFBQXZELEdBQ0E4QixhQUFBdEcsR0FBQXdFLEVBQUF6SyxNQUNBaUQsRUFBQXdILEdBQ0FoRSxFQUFBc0gsZUFBQSxJQVpBOUssRUFBQWxILEtBQUErRCxjQWlCQW1ELEVBQUFsSCxLQUFBK0QsZUFHQUksRUFBQXBELFVBQUFrUixhQUFBLFNBQUF2RCxHQUNBLEdBQUF3RCxHQUFBUixXQUFBbEIsYUFBQTBCLFlBQUEsQ0FDQUEsR0FBQXhELEVBQUF5RCxhQUNBdk8sRUFBQTZNLG1CQUNBRCxhQUFBMEIsVUFBQXhELEVBQUF5RCxZQUVBblMsS0FBQXNFLFlBQUF1RCxRQUFBNkcsRUFBQXpLLE9BQ0FqRSxLQUFBdUUsV0FBQXNELFFBQUE2RyxFQUFBMEQsUUFDQSxJQUFBQyxHQUFBclMsS0FBQStELFlBRUEsSUFEQS9ELEtBQUErRCxhQUFBMkssR0FDQTJELEVBQUFELFNBQUExRCxFQUFBMEQsUUFDQXBTLEtBQUFhLEtBQUEsWUFBQTZOLEVBQUEwRCxhQUNBLElBQUFDLEVBQUFELFVBQUExRCxFQUFBMEQsUUFDQXBTLEtBQUFhLEtBQUEsa0JBQ0EsSUFBQWIsS0FBQXNFLGNBQUF0RSxLQUFBdUUsYUFDQXZFLEtBQUFhLEtBQUEsa0JBQ0FiLEtBQUFvRSxVQUFBLENBQ0EsR0FBQWtPLEdBQUF0UyxLQUFBb0UsVUFDQWtPLEdBQUF2QyxjQUFBN0QsT0FDQWxNLEtBQUF1UyxNQUFBRCxFQUFBRSxTQUFBRixFQUFBRyxTQUFBSCxFQUFBcEwsVUFDQW9MLEVBQUF2QyxjQUFBL0IsU0FDQXNFLEVBQUFoQyxLQUFBLFNBQUFvQyxHQUNBMVMsS0FBQXVTLE1BQUFHLEVBQUFGLFNBQUFFLEVBQUFELFNBQUFDLEVBQUF4TCxhQU1BbUwsRUFBQU0sa0JBQUFqRSxFQUFBaUUsaUJBQ0EzUyxLQUFBNFMsYUFBQSxHQUFBalEsR0FBQStMLEVBQUFpRSxpQkFBQTNTLE1BRUFxUyxFQUFBTSxtQkFBQWpFLEVBQUFpRSxtQkFDQTNTLEtBQUE0UyxhQUFBMU8sY0FDQWxFLE1BQUE0UyxjQUVBNVMsS0FBQWEsS0FBQSwyQkFBQTZOLEVBQUEyRCxHQUNBN0IsYUFBQW9CLEdBQUF0TyxLQUFBZ00sVUFBQVosSUFHQXZLLEVBQUFwRCxVQUFBd1IsTUFBQSxTQUFBQyxFQUFBQyxHQVFBLEdBQUEvSCxHQUFBMUssSUFDQSxPQUFBLElBQUFnTyxTQUFBLFNBQUFDLEVBQUFDLEdBQ0F0SyxFQUFBaUssSUFBQW5ELEVBQUE5SCxTQUFBLGFBQUE0UCxTQUFBQSxHQUFBLEdBQUFDLFNBQUFBLEdBQUEsSUFBQSxLQUFBL0gsRUFBQTNHLGFBQUFFLE9BQUEsR0FDQXFNLEtBQUEsU0FBQXdCLEdBRUFwSCxFQUFBdUgsYUFBQUgsRUFBQXZELGNBRUFOLEdBQUFTLE9BQUEsVUFBQW1FLE9BQUFuSSxFQUFBM0csYUFBQXFPLFdBQ0EsU0FBQU4sR0FFQTdELEdBQUE2RSxNQUFBaEIsRUFBQXZELGFBQUF1RSxNQUFBcEUsT0FBQSxlQUtBdkssRUFBQXBELFVBQUFpTSxPQUFBLFdBQ0EsR0FBQXRDLEdBQUExSyxJQUNBLE9BQUEsSUFBQWdPLFNBQUEsU0FBQUMsRUFBQUMsR0FDQXhELEVBQUF2RCxNQUFBLGNBQ0FtSixLQUFBLFNBQUF5QyxHQUNBckksRUFBQXVILHVCQUNBekIsY0FBQW9CLEdBQ0EzRCxLQUNBQyxNQUlBL0osRUFBQXBELFVBQUFpUyxRQUFBLFNBQUE5TCxHQUNBbEgsS0FBQXVFLFdBQ0EyQyxFQUFBbEgsS0FBQStELGFBQUFxTyxVQUdBcFMsS0FBQWtDLEtBQUEsWUFBQSxTQUFBa1EsR0FDQWxMLEVBQUFrTCxLQUVBcFMsS0FBQTBPLE9BQUF4SCxHQUFBdEQsRUFBQThFLFFBSUE5RSxFQUFBTyxrQkFBQUEsQ09sT0EsSUFBQTBJLEdBQUEsU0FBQW9HLEVBQUFDLEdBZ0ZBLFFBQUFDLEdBQUF4UyxFQUFBeVMsRUFBQWxOLEdBRUFsRyxLQUFBb1QsTUFBQUEsRUFDQXBULEtBQUFrRyxlQUNBbEcsS0FBQVcsR0FBQUEsQ0FDQSxLQUFBLEdBQUFpQixLQUFBc0UsR0FDQWxHLEtBQUFZLEtBQUFTLE1BQUFyQixNQUFBNEIsRUFBQXNFLEVBQUF0RSxLQW5GQSxHQUFBcVIsRUFBQWxELGNBQUFzRCxPQUNBLEdBQUF2USxHQUFBLEdBQUFxQixHQUFBOE8sT0FDQSxJQUFBQSxFQUFBbEQsY0FBQW5NLEVBQUFPLGtCQUNBLEdBQUFyQixHQUFBbVEsQ0FFQWpULE1BQUE4QyxXQUFBQSxFQUNBQSxFQUFBdkMsR0FBQSxZQUFBLFdBQ0FQLEtBQUFzVCxXQUFBLElBRUF0VCxLQUFBTyxHQUFBdUMsRUFBQXZDLEdBQ0FQLEtBQUFhLEtBQUFpQyxFQUFBakMsS0FDQWIsS0FBQXNCLE9BQUF3QixFQUFBeEIsT0FDQXRCLEtBQUFrQyxLQUFBWSxFQUFBWixLQUNBbEMsS0FBQW1ILE1BQUFyRSxFQUFBcUUsTUFBQUcsS0FBQXhFLEdBR0E5QyxLQUFBTyxHQUFBLGVBQUEsU0FBQWdULEdBQ0F0USxRQUFBdVEsS0FBQSx1QkFFQUQsRUFBQUUsY0FBQTdOLEVBQUF3QixRQUFBRSxLQUFBMUIsSUFFQTJOLEVBQUFHLGNBQUEsU0FBQUMsR0FDQTFRLFFBQUF1USxLQUFBLGdCQUFBRyxPQUdBM1QsS0FBQU8sR0FBQSxrQkFBQSxTQUFBZ1QsR0FDQXRRLFFBQUE2UCxNQUFBLDRCQUVBOVMsS0FBQU8sR0FBQSxpQkFBQSxTQUFBdVMsRUFBQWhGLEVBQUE4RixFQUFBOUIsR0FDQTdPLFFBQUE2UCxNQUFBLGNBQUF4UCxLQUFBZ00sVUFBQXdELFVBQ0FlLEdBQUEvRixFQUFBMUYsTUFBQSxLQUFBLE1BRUFwSSxLQUFBTyxHQUFBLHdCQUFBLFNBQUFvVCxHQUNBL04sRUFBQXdCLFFBQUF1TSxJQUlBLElBQUEvTixHQUFBNUYsS0FDQTJGLEdBQUFtTyxXQUFBclMsT0FFQXNTLEtBQ0FDLEtBQ0FDLEtBQ0FDLEtBR0FDLEtBQ0FDLEtBQ0FQLEtBQ0FoTyxFQUFBLEdBQUFxRCxHQUFBekgsR0FDQTRTLEVBQUEsR0FBQTVPLEdBQUFvTyxFQUFBbE8sRUFBQTNGLEtBQUE2RixFQUlBN0YsTUFBQXNVLGdCQUFBdFUsS0FBQU8sR0FBQSxpQkFBQSxTQUFBaUQsRUFBQXNLLEVBQUE4RixFQUFBOUIsR0FDQXlDLGVBQUFDLG9CQUNBRCxlQUFBQyxtQkFBQSxHQUFBcEksR0FBQTVJLEtBSUEsSUFBQWlSLEdBQUEsU0FBQWpPLEdBQ0EsTUFBQUEsS0FBQWIsR0FDQUEsRUFBQWEsSUFFQWIsRUFBQWEsR0FBQS9FLE1BQ0FrRSxFQUFBYSxLQUdBa08sRUFBQSxTQUFBbE8sR0FDQSxNQUFBQSxLQUFBbU8sVUFDQUEsU0FBQW5PLElBRUFtTyxTQUFBbk8sTUFDQW1PLFNBQUFuTyxJQWFBMk0sR0FBQXBTLFVBQUE2VCxLQUFBLFNBQUFDLEdBRUEsR0FBQXJSLElBQ0EwQyxZQUFBekUsRUFBQXpCLEtBQUFrRyxhQUFBNEIsSUFBQSxTQUFBOUYsR0FDQSxPQUFBQSxFQUFBLEdBQUFyQixHQUFBcUIsRUFBQSxNQUNBNkcsV0FFQXJGLEdBQUE3QyxHQUFBWCxLQUFBVyxFQUNBWCxNQUFBb1QsTUFBQTdLLFNBQ0EzQyxHQUFBdUIsTUFBQW5ILEtBQUFvVCxNQUFBN0ssVUFBQSxtQkFBQS9FLEVBQUEsU0FBQXNSLEVBQUFyTCxFQUFBQyxFQUFBeUUsR0FDQTBHLEVBQUFDLE1BR0EzQixFQUFBcFMsVUFBQUgsS0FBQSxTQUFBbVUsRUFBQUMsR0FDQSxHQUFBQyxHQUFBeFQsRUFBQXVULEdBQ0FFLEVBQUF6VCxFQUFBekIsS0FBQW9ULE1BQUErQixnQkFBQXJOLElBQUEsU0FBQTlGLEdBQ0EsT0FBQUEsRUFBQWlULEVBQUE5UCxTQUFBbkQsTUFDQTZHLFdBQ0E0QyxFQUFBaEssRUFBQXpCLEtBQUFrRyxhQUFBNEIsSUFBQSxTQUFBOUYsR0FDQSxNQUFBQSxHQUFBLEdBQUFyQixJQUVBOEssR0FBQXRHLFNBQUE0UCxHQUNBL1UsS0FBQWtHLFlBQUF1RixFQUFBMkosUUFBQUwsSUFBQSxHQUFBRyxFQUVBbFYsS0FBQWtHLFlBQUF0RixNQUFBK0UsRUFBQW1PLFdBQUF0UixJQUFBdVMsR0FBQUcsSUFJQSxJQUFBRyxHQUFBLFNBQUFsUCxHQUVBQSxFQUFBcUcsT0FBQTdMLEdBQUEyVSxVQUFBLEVBQ0FuUCxFQUFBcUcsT0FBQTdMLEdBQUE0VSxVQUFBLENBQ0EsSUFBQS9JLEdBQUEvSyxFQUFBMEUsRUFBQXFHLE9BQ0FyRyxHQUFBcVAsY0FDQWhKLEVBQUFBLEVBQUFpSixNQUFBdFAsRUFBQXFQLGNBRUE1UCxFQUFBL0UsS0FBQSxtQkFBQXNGLEVBQUFzTyxFQUFBdE8sRUFBQTNGLE1BcUJBLElBQUFrVixHQUFBLDBCQUNBQSxJQUFBdlAsRUFBQUcsV0FBQXdCLElBQUEsU0FBQW5CLEdBQ0EsTUFBQSxTQUFBQSxFQUFBaEcsR0FBQSxVQUFBZ0csRUFBQWhHLEdBQUEsTUFDQTBPLEtBQUEsT0FHQXFHLEdBQUFsSixFQUFBMUUsSUFBQSxTQUFBOUYsRUFBQUosR0FDQSxNQUFBLFFBQUFJLEVBQUFxQixNQUFBLFlBQUFyQixFQUFBcUIsS0FDQSxRQUFBekIsRUFBQSxVQUFBQSxFQUFBLGlCQUFBQSxFQUFBLGFBQUFnQyxFQUFBb04sU0FBQSxZQUNBLFdBQUFoUCxFQUFBcUIsS0FDQSxRQUFBekIsRUFBQSxXQUFBQSxFQUFBLHFCQUFBQSxFQUFBLGdCQUVBLFFBQUFBLEVBQUEsVUFBQUEsRUFBQSxRQUVBd0wsU0FBQSxNQUVBc0ksR0FBQSw0SEFJQSxJQUFBQyxHQUFBLEdBQUFqSSxVQUFBLE1BQUEsY0FBQWdJLEVBRUFDLEdBQUE1VSxVQUFBZ0wsSUFBQW1ILEVBQ0F5QyxFQUFBQyxvQkFDQUQsRUFBQXBOLFVBQUFwQyxFQUFBM0YsS0FDQW1WLEVBQUFyUCxXQUFBN0UsRUFBQTBFLEVBQUFHLFlBQUEyRSxNQUFBLE1BQUF6RixVQUVBbVEsRUFBQUUsbUJBQUExUCxFQUFBTyxhQUFBb0IsSUFBQSxTQUFBOUYsR0FFQSxNQUFBQSxHQUFBNEUsR0FBQSxJQUFBNUUsRUFBQXJCLEdBQUEsU0FFQWdWLEVBQUFHLFVBQUEzUCxFQUFBTyxhQUFBb0IsSUFBQSxTQUFBOUYsR0FDQSxPQUFBQSxFQUFBNEUsR0FBQTVFLEVBQUFyQixNQUVBZ1YsRUFBQUksWUFBQTVQLEVBQUE2UCxXQUNBTCxFQUFBUixlQUFBaFAsRUFBQUQsWUFHQXpFLEVBQUEwRSxFQUFBOFAsZ0JBQUEzTCxTQUNBcUwsRUFBQTVVLFVBQUFxTSxTQUFBLEdBQUFNLFVBQUEsZUFBQWpNLEVBQUEwRSxFQUFBOFAsZ0JBQUE3SSxTQUFBLG9CQUVBdUksRUFBQTVVLFVBQUF5TyxZQUFBLFdBRUEsTUFBQXhQLE1BQUFvTixXQUFBb0MsZUFHQW1HLEVBQUE1VSxVQUFBME8sWUFBQSxXQUNBLE1BQUF6UCxNQUFBb04sV0FBQXFDLGVBR0FrRyxFQUFBNVUsVUFBQW1WLE9BQUEsV0FFQSxNQUFBaEQsR0FBQWdELE9BQUFsVyxLQUFBK1AsWUFBQXhILFdBQUF2SSxLQUFBVyxNQUlBdUwsT0FBQUMsZUFBQXdKLEVBQUE1VSxVQUFBLGVBQ0F5QixJQUFBLFdBQ0EsTUFBQXhDLE1BQUFtVyxhQUNBblcsS0FBQW1XLGlCQUVBOUIsR0FBQW5PLFlBQUFsRyxLQUFBK1AsWUFBQXhILFdBQUF2RCxJQUFBaEYsS0FBQVcsT0FLQWdWLEVBQUE1VSxVQUFBcVYsVUFBQSxTQUFBdkIsR0FDQSxHQUFBd0IsR0FBQXJXLEtBQUFXLEVBQ0FpRixHQUFBdUIsTUFBQW5ILEtBQUErUCxZQUFBeEgsVUFBQSxjQUFBNUgsR0FBQVgsS0FBQVcsSUFBQSxTQUFBNkMsR0FDQSxHQUFBMEMsR0FBQTFDLEVBQ0E4UyxLQUNBQyxFQUFBOVUsRUFBQXlFLEdBQUErRSxNQUFBLFlBQUExRixTQUFBdUMsSUFBQSxTQUFBOUYsR0FDQSxNQUFBLEdBQUFBLElBQ0FtSSxXQUFBeEUsRUFBQW1PLFdBQUF0TCxRQUFBaEQsU0FDQS9ELEdBQUF5RSxHQUFBc1EsUUFBQSxTQUFBeFUsR0FDQSxNQUFBQSxHQUFBK1MsV0FDQXJULEtBQUEsU0FBQUMsRUFBQUMsR0FDQTBVLEVBQUExVSxHQUFBSCxFQUFBRSxHQUFBc0osTUFBQSxRQUFBekYsV0FFQSxJQUFBdkUsR0FBQSxTQUFBZSxHQUNBNlMsRUFBQSxHQUFBMUIsR0FBQWtELEVBQUFWLEVBQUFXLElBRUFDLEdBQUFqUixPQUNBTSxFQUFBcEQsSUFBQSxhQUFBK1QsRUFBQXRWLEdBRUFBLE9BSUEwVSxFQUFBNVUsVUFBQTZULEtBQUEsU0FBQTlULEdBQ0EsR0FBQTJWLEdBQUF6VyxLQUFBMFcsUUFDQWxLLEVBQUFtSixFQUFBbkosT0FDQW1LLEVBQUEzVyxLQUFBVyxHQUNBNEgsRUFBQXZJLEtBQUErUCxZQUFBeEgsU0FDQSxJQUFBekgsRUFDQSxJQUFBLEdBQUE4VixLQUFBOVYsR0FDQTJWLEVBQUFHLEdBQUE5VixFQUFBOFYsRUFJQW5WLEdBQUFrVSxFQUFBSSxhQUFBbk8sT0FBQSxTQUFBNUYsR0FDQSxPQUFBd0ssRUFBQXhLLEdBQUF1VCxXQUNBN1QsS0FBQSxTQUFBa0gsR0FDQUEsSUFBQTZOLFVBQ0FBLEdBQUE3TixJQUdBLElBQUFpSixHQUFBak0sRUFBQXVCLE1BQUFvQixHQUFBb08sRUFBQSxRQUFBLFFBQUFGLEVBS0EsT0FKQTNWLElBQUFBLEVBQUFpUCxjQUFBckMsV0FFQW1FLEVBQUFnRixRQUFBckMsbUJBQUExVCxHQUVBK1EsR0FFQThELEVBQUE1VSxVQUFBK1YsS0FBQSxXQUNBLEdBQUFwRSxHQUFBLEdBQUExUyxNQUFBK1AsWUFBQS9QLEtBQUEwVyxRQUVBLE9BREFoRSxHQUFBeUQsYUFBQW5XLEtBQUFtVyxhQUNBekQsRUFJQSxJQUFBcUUsR0FBQSxhQUFBdFYsRUFBQTBFLEVBQUFHLFlBQUF3QixJQUFBLFNBQUFuQixHQUNBLE1BQUFBLEdBQUFoRyxHQUFBLFlBQUFnRyxFQUFBaEcsS0FDQXFXLE9BQUF4SyxFQUFBMUUsSUFBQSxTQUFBOUYsRUFBQUosR0FDQSxNQUFBLFFBQUFJLEVBQUFxQixNQUFBLFlBQUFyQixFQUFBcUIsS0FDQXpCLEVBQUEsWUFBQUEsRUFBQSxxQkFBQUEsRUFBQSxxQkFBQUEsRUFBQSw4Q0FDQSxXQUFBSSxFQUFBcUIsS0FDQXpCLEVBQUEsV0FBQUEsRUFBQSxXQUVBQSxFQUFBLFdBQUFBLEtBRUF3TCxTQUFBLE9BQUEsSUFDQXVJLEdBQUE1VSxVQUFBMlYsTUFBQSxHQUFBaEosVUFBQXFKLEdBRUFwQixFQUFBc0IsVUFBQSxTQUFBQyxFQUFBckMsRUFBQXNDLEdBQ0EsR0FBQUMsTUFDQUMsRUFBQTVWLEVBQUFrVSxFQUFBbkosUUFDQTVFLE9BQUEsU0FBQTVGLEdBQ0EsT0FBQUEsRUFBQXVULFdBRUF0SyxNQUFBLE1BQ0F6RixTQUNBL0QsR0FBQXlWLEdBQ0FwUCxJQUFBLFNBQUE5RixHQUNBLE1BQUFBLEdBQUEwVSxVQUVBaFYsS0FBQSxTQUFBTSxHQUNBUCxFQUFBNFYsR0FBQTNWLEtBQUEsU0FBQTRILFNBQ0F0SCxHQUFBc0gsS0FFQThOLEVBQUF4VyxLQUFBb0IsS0FFQTRELEVBQUF1QixNQUFBd08sRUFBQXBOLFVBQUEsT0FBQStPLFNBQUFGLEVBQUE3SyxRQUFBM0csRUFBQTJHLFdBQUEsU0FBQWdMLEdBQ0EzUixFQUFBd0IsUUFBQW1RLEVBQ0EsSUFBQUMsR0FBQTdSLEVBQUFnUSxFQUFBcE4sV0FDQWtQLEVBQUFoVyxFQUFBOFYsRUFBQTVCLEVBQUFwTixXQUFBbVAsU0FBQXpNLE1BQUEsTUFBQW5ELElBQUEsU0FBQTlGLEdBQ0EsTUFBQXdWLEdBQUFoVixJQUFBUixLQUNBd0QsU0FDQXFQLElBQ0FBLEVBQUE0QyxJQUVBTixJQUVBLGVBQUFoUixJQUNBMUUsRUFBQTBFLEVBQUF3UixhQUFBalcsS0FBQSxTQUFBTSxHQUNBLEdBQUE0VixHQUFBNVYsRUFBQSxHQUNBbEIsRUFBQWtCLEVBQUEsR0FDQTZWLEVBQUEsc0JBQ0EvVyxHQUFBd0UsU0FDQXVTLEdBQUEsS0FBQXBXLEVBQUFYLEdBQUFnSCxJQUFBLFNBQUE5RixHQUNBLE1BQUFBLEdBQUEsTUFBQUEsSUFDQXFOLEtBQUEsTUFDQXdJLEdBQUEsS0FDQS9XLEVBQUFGLEtBQUEsTUFDQStVLEVBQUE1VSxVQUFBNlcsR0FBQSxHQUFBbEssVUFBQTVNLEVBQUErVyxFQUFBLDRDQUFBRCxFQUFBLHdMQVVBLGVBQUF6UixLQUNBd1AsRUFBQUgsWUFBQS9ULEVBQUEwRSxFQUFBcVAsYUFBQWhOLE9BQUFWLElBQUEsU0FBQTlGLEdBQ0EsT0FBQUEsR0FBQSxLQUNBNkcsV0FDQThNLEVBQUE1VSxVQUFBK1csT0FBQSxTQUFBckIsR0FDQSxHQUFBc0IsR0FBQS9YLEtBQ0FnWSxHQUFBclgsR0FBQVgsS0FBQVcsSUFDQXNYLEVBQUFqWSxLQUFBK1AsWUFBQXlGLFlBQ0EwQyxFQUFBbFksS0FBQStQLFlBQUF2RCxPQUVBMkwsR0FEQSxHQUFBblksTUFBQStQLFlBQUEwRyxHQUFBQyxRQUNBalYsRUFBQXdXLEdBQUF6UCxPQUFBVixJQUFBLFNBQUE5RixHQUNBLE9BQUFBLEVBQUFrVyxFQUFBbFcsTUFDQTZHLFdBQ0FwSCxHQUFBZ1YsR0FBQS9VLEtBQUEsU0FBQUMsRUFBQUMsR0FDQUEsSUFBQXFXLElBQUFFLEVBQUF2VyxHQUFBMlQsV0FDQXlDLEVBQUFwVyxHQUFBRCxLQUdBaUUsRUFBQXVCLE1BQUFuSCxLQUFBK1AsWUFBQXhILFVBQUEsVUFBQXlQLEVBQUEsV0FDQXZXLEVBQUF1VyxHQUFBdFcsS0FBQSxTQUFBQyxFQUFBQyxHQUNBbVcsRUFBQW5XLEdBQUFELFFBTUF3UyxFQUFBd0IsRUFBQXBOLFdBQUFvTixDQUVBLEtBQUEsR0FBQTlLLEtBQUExRSxHQUFBcUcsT0FDQXJHLEVBQUFxRyxPQUFBM0IsR0FBQWxLLEdBQUFrSyxDQXVMQSxPQXJMQThLLEdBQUFuSixPQUFBL0ssRUFBQTBFLEVBQUFxRyxRQUFBd0ssT0FBQXZWLEVBQUEwRSxFQUFBcVAsY0FBQXdCLE9BQUF2VixFQUFBMEUsRUFBQUcsWUFBQThSLElBQUEsU0FBQXBXLEdBQ0FBLEVBQUFxQixLQUFBckIsRUFBQXFCLE1BQUEsZUFDQWdWLFFBQUEsTUFBQXhQLFdBRUFwSCxFQUFBa1UsRUFBQW5KLFFBQUE5SyxLQUFBLFNBQUFpRixHQUNBQSxFQUFBMlIsU0FDQSxjQUFBM1IsRUFBQXRELEtBQ0FzRCxFQUFBMlIsT0FBQSxVQUVBM1IsRUFBQTJSLE9BQUEzUixFQUFBdEQsUUFLQTVCLEVBQUEwRSxFQUFBRyxZQUFBNUUsS0FBQSxTQUFBNlcsR0FDQSxHQUFBQyxHQUFBRCxFQUFBOVIsR0FDQWdTLEVBQUEsSUFBQUYsRUFBQTVYLEVBQ0ErSyxHQUFBaUssRUFBQTVVLFVBQUF3WCxFQUFBNVgsR0FBQSxXQUNBLEtBQUE2WCxJQUFBN1MsSUFBQSxDQUNBLEdBQUErRSxHQUFBMUssSUFDQTRGLEdBQUF5QyxTQUFBbVEsRUFBQSxTQUFBeFcsR0FDQXFTLEVBQUF2TyxVQUFBMFMsR0FBQXhULElBQUEwRixFQUFBK04sSUFBQSxLQUdBLEdBQUEzTSxHQUFBME0sSUFBQTdTLElBQUEzRixLQUFBeVksSUFBQTlTLEVBQUE2UyxHQUFBaFcsSUFBQXhDLEtBQUF5WSxHQUNBLFFBQUEzTSxHQUFBME0sSUFBQW5FLEdBQUF2TyxXQUVBdU8sRUFBQXZPLFVBQUEwUyxHQUFBeFQsSUFBQWhGLEtBQUF5WSxJQUFBLEdBQ0E3VSxFQUFBK04sUUFFQTdGLEdBQ0EsU0FBQUcsR0FDQSxHQUFBQSxHQUNBQSxFQUFBOEQsWUFBQXhILFdBQUFpUSxFQUNBLEtBQUEsSUFBQUUsV0FBQSx1QkFBQUYsRUFBQSxPQUFBRCxFQUFBNVgsR0FHQVgsTUFBQXlZLEdBQUF4TSxFQUFBdEwsSUFDQSxPQUFBNlgsRUFBQSxXQUFBQSxFQUFBLFdBQUFBLEVBQUEsYUFBQUEsR0FHQTdDLEVBQUE1VSxVQUFBLE1BQUE2QyxFQUFBMkgsV0FBQWdOLEVBQUE1WCxLQUFBLFdBQ0EsTUFBQXVTLEdBQUExUSxJQUFBZ1csRUFBQXhZLEtBQUF5WSxPQUtBaFgsRUFBQTBFLEVBQUFPLGNBQUFoRixLQUFBLFNBQUE2VyxHQUNBLEdBQUEvUixHQUFBK1IsRUFBQTNSLEdBQUEsSUFBQTJSLEVBQUE1WCxHQUNBaUwsRUFBQTJNLEVBQUEzUixHQUFBLElBQUFoRCxFQUFBc00sVUFBQXFJLEVBQUE1WCxJQUNBZ1ksRUFBQUosRUFBQTNSLEVBQ0ErTyxHQUFBNVUsVUFBQTZYLGVBQUFoTixHQUNBM0ksUUFBQTZQLE1BQUEsOEJBQUFsSCxFQUFBLFNBQUErSixFQUFBcE4sV0FFQW1ELEVBQUFpSyxFQUFBNVUsVUFBQTZLLEVBQUEsV0FDQSxHQUFBcEMsR0FBQW1QLElBQUFoVCxHQUFBb08sRUFBQXZOLEdBQUFoRSxJQUFBeEMsS0FBQVcsR0FBQSxJQUFBLElBRUEsT0FEQTBULEdBQUF0TyxZQUFBUyxHQUFBeEIsSUFBQWhGLEtBQUFXLElBQUEsR0FDQTZJLEdBQ0EsS0FBQSxPQUFBbVAsRUFBQSxXQUFBQSxFQUFBLFdBQUFBLEdBRUFoRCxFQUFBNVUsVUFBQSxNQUFBNkMsRUFBQTJILFdBQUEzSCxFQUFBc00sVUFBQXFJLEVBQUEzUixNQUFBLFdBQ0EsR0FBQWlTLEtBRUEsT0FEQUEsR0FBQU4sRUFBQTVYLEtBQUFYLEtBQUFXLElBQ0F1UyxFQUFBNEYsTUFBQVAsRUFBQTNSLEdBQUFpUyxNQUtBMVMsRUFBQVUsYUFDQXBGLEVBQUEwRSxFQUFBVSxZQUFBbkYsS0FBQSxTQUFBNlcsR0FDQSxHQUFBL1IsR0FBQStSLEVBQUEvUixVQUNBdVMsRUFBQVIsRUFBQVEsTUFBQSxFQUFBLEVBQ0FDLEVBQUFULEVBQUFwUyxNQUVBOEIsRUFBQW9NLEVBQUFwTyxTQUFBTyxHQUFBLE9BQUEsRUFBQXVTLEdBRUFyTixHQUFBaUssRUFBQTVVLFVBQUF3WCxFQUFBcFMsTUFBQSxJQUFBLFdBQ0EsR0FBQXVFLEdBQUExSyxLQUNBd0osS0FDQXRCLEVBQUFELEVBQUF5QyxFQUFBL0osSUFDQTZCLEVBQUEsSUFPQSxPQU5BMEYsR0FBQTVDLFNBRUE5QyxFQUFBaVMsRUFBQXVFLEdBQUF4VyxJQUFBOEUsS0FBQTNCLEVBQUFxVCxLQUVBOVEsR0FBQTFGLElBQ0FnSCxFQUFBL0gsRUFBQXlHLEdBQUFKLElBQUF0RixHQUFBb0YsT0FBQWhFLEVBQUFtTixNQUFBdkwsV0FDQWdFLEdBQ0EsS0FBQSxnQkFBQWhELEVBQUEsWUFBQXdTLEdBRUFyRCxFQUFBNVUsVUFBQSxNQUFBNkMsRUFBQTJILFdBQUEzSCxFQUFBc00sVUFBQThJLEtBQUEsV0FDQSxHQUFBdE8sR0FBQTFLLElBQ0EsT0FBQSxJQUFBZ08sU0FBQSxTQUFBQyxFQUFBQyxHQUNBLElBQ0FtRyxFQUFBaE4sT0FBQWIsR0FBQWtFLEVBQUEvSixJQUFBb1ksRUFBQSxTQUFBdlYsR0FDQSxHQUFBMEUsR0FBQUQsRUFBQXlDLEVBQUEvSixHQUNBdUgsR0FBQTVDLE9BQ0FNLEVBQUE2QyxNQUFBdVEsR0FBQXJZLEdBQUF1SCxHQUFBLEtBQUEsV0FDQSxHQUFBMUYsR0FBQW1ELEVBQUFxVCxHQUFBeFcsSUFBQThFLEtBQUEzQixFQUFBcVQsR0FDQS9LLEdBQUF4TSxFQUFBeUcsR0FBQUosSUFBQXRGLEdBQUFvRixPQUFBaEUsRUFBQW1OLE1BQUF2TCxhQUdBeUksUUFHQSxNQUFBeEssR0FDQVIsUUFBQTZQLE1BQUFyUCxHQUNBeUssRUFBQXpLLE9BTUFrUyxFQUFBbkosT0FBQTVJLEVBQUEySCxXQUFBeU4sS0FDQXJZLEdBQUFpRCxFQUFBMkgsV0FBQXlOLEdBQ0F4WSxLQUFBb0QsRUFBQTJILFdBQUF5TixHQUNBekQsVUFBQSxFQUNBRCxVQUFBLEVBQ0FqUyxLQUFBLE1BQ0E0VixpQkFLQXRELEVBQUE1VSxVQUFBbVksZ0JBQUEsU0FBQUMsR0FDQSxHQUFBN0IsSUFBQSxFQUNBWCxFQUFBM1csS0FBQVcsR0FDQXlZLElBQ0EsVUFBQUQsRUFBQXBKLFlBQUF2UCxPQUNBOFcsR0FBQSxFQUNBOEIsRUFBQUQsRUFDQUEsRUFBQUMsRUFBQSxHQUVBLElBQUFDLEdBQUFGLEVBQUFwSixZQUFBeEgsU0FDQSxJQUFBK08sRUFDQSxHQUFBclEsR0FBQXhGLEVBQUEyWCxHQUFBbk8sTUFBQSxNQUFBbkQsSUFBQSxTQUFBOUYsR0FDQSxPQUFBMlUsRUFBQTNVLEtBQ0F3RCxjQUVBLElBQUF5QixLQUFBMFAsRUFBQXdDLEVBQUF4WSxJQUVBaUYsR0FBQXVCLE1BQUF3TyxFQUFBcE4sVUFBQSxJQUFBOFEsRUFBQSxZQUFBcFMsV0FBQUEsS0FHQTBPLEVBQUE1VSxVQUFBdVksY0FBQSxTQUFBSCxHQUNBLEdBQUE3QixJQUFBLEVBQ0FYLEVBQUEzVyxLQUFBVyxHQUNBeVksSUFDQSxVQUFBRCxFQUFBcEosWUFBQXZQLE9BQ0E4VyxHQUFBLEVBQ0E4QixFQUFBRCxFQUNBQSxFQUFBQyxFQUFBLEdBRUEsSUFBQUMsR0FBQUYsRUFBQXBKLFlBQUF4SCxVQUNBL0IsRUFBQW1QLEVBQUFwTixVQUFBLElBQUE4USxDQUNBLElBQUEvQixFQUFBLENBQ0EsR0FBQWlDLEtBUUEsSUFQQS9TLElBQUFnVCxhQUNBRCxFQUFBOVgsRUFBQTJYLEdBQUFuTyxNQUFBLE1BQUFkLFdBQUExSSxFQUFBK1gsVUFBQWhULEdBQUEsR0FBQWhFLElBQUF4QyxLQUFBVyxNQUFBNkUsV0FFQWdCLEVBQUE2UyxFQUFBLElBQUExRCxFQUFBcE4sVUFDQS9CLElBQUFnVCxhQUNBRCxFQUFBOVgsRUFBQTJYLEdBQUFuTyxNQUFBLE1BQUFkLFdBQUExSSxFQUFBK1gsVUFBQWhULEdBQUEsR0FBQWhFLElBQUF4QyxLQUFBVyxNQUFBNkUsV0FFQStULEVBQUFqVSxPQUFBLENBQ0EsR0FBQTJCLEdBQUF4RixFQUFBOFgsR0FBQXpSLElBQUEsU0FBQTlGLEdBQ0EsT0FBQTJVLEVBQUEzVSxLQUNBd0QsU0FDQWlVLFVBQUE5RCxFQUFBcE4sVUFBQThRLEVBQUEsU0FBQXBTLFdBQUFBLEdBQUEsU0FBQXpELFdBR0EsQ0FDQSxHQUFBZ0QsSUFBQTZOLEdBQUFwTyxVQUFBeEUsRUFBQTRTLEVBQUFwTyxTQUFBTyxHQUFBLE1BQUE1QyxFQUFBMkgsV0FBQThOLElBQUFGLEVBQUF4WSxLQUFBeUssS0FBQXBMLE1BQ0EsTUFFQTRGLEdBQUF1QixNQUFBd08sRUFBQXBOLFVBQUEsSUFBQThRLEVBQUEsU0FBQXBTLGFBQUFqSCxLQUFBVyxHQUFBd1ksRUFBQXhZLFVBSUFpRixFQUFBL0UsS0FBQSxZQUFBOFUsR0FDQS9QLEVBQUEvRSxLQUFBLGFBQUE4VSxFQUFBcE4sV0FDQW9OLEVBR0EzVixNQUFBb0gsUUFBQSxTQUFBNUQsRUFBQTBELEdBR0EsR0FEQWpFLFFBQUF1USxLQUFBLFdBQ0EsZ0JBQUFoUSxHQUFBLENBUUEsVUFBQUEsVUFBQUEsR0FBQWtXLE1BQ0EsSUFBQUMsR0FBQW5XLEVBQUFtVyxNQUNBQyxFQUFBcFcsRUFBQW9XLE9BQ0FDLEVBQUFyVyxFQUFBcVcsV0FDQTdRLEVBQUF4RixFQUFBd0YsWUFDQWlQLEVBQUF6VSxFQUFBeVUsRUFhQSxVQVpBelUsR0FBQW1XLFlBQ0FuVyxHQUFBb1csYUFDQXBXLEdBQUFxVyxpQkFDQXJXLEdBQUF3RixrQkFDQXhGLEdBQUF5VSxHQUNBQSxJQUFBQSxNQUdBelUsRUFBQS9CLEVBQUErQixHQUFBb0UsT0FBQSxTQUFBakcsRUFBQUMsR0FDQSxRQUFBLFdBQUFELEtBQUFDLElBQUF1UyxLQUNBdEwsV0FFQSxPQUFBckYsR0FBQSxDQUNBLEdBQUF3QyxHQUFBeEMsRUFBQXdDLFVBQ0F4QyxHQUFBLElBRUEvQixFQUFBK0IsR0FBQTlCLEtBQUEsU0FBQThCLEVBQUErRSxHQUNBM0MsRUFBQXlDLFNBQUFFLEVBQUEsU0FBQXBDLEdBQ0EsR0FBQTJULEdBQUEzVCxDQUNBM0MsR0FBQWtVLFNBQUFsVSxFQUFBa1UsUUFBQXBTLE9BQUEsR0FBQTlCLEVBQUFrVSxRQUFBLEdBQUEzSCxhQUFBclAsUUFDQThDLEVBQUFrVSxRQUFBalcsRUFBQStCLEVBQUFrVSxTQUFBNVAsSUFBQSxTQUFBOUYsR0FDQSxNQUFBUCxHQUFBcVksRUFBQS9ELGFBQUFnRSxJQUFBL1gsR0FBQTZHLGFBQ0FyRCxVQUVBLElBQUFrUyxHQUFBalcsRUFBQStCLEVBQUFrVSxTQUNBc0MsRUFBQXhXLEVBQUF3VyxPQUNBLElBQUF6UixJQUFBMFAsR0FBQSxDQUNBLEdBQUFnQyxHQUFBaEMsRUFBQTFQLEVBQ0E5RyxHQUFBaVcsR0FBQWhXLEtBQUEsU0FBQXdZLEdBQ0FBLEVBQUF2WixLQUFBc1osSUFDQXhZLEVBQUF3WSxFQUFBQyxFQUFBdlosS0FBQWUsS0FBQSxTQUFBQyxFQUFBQyxHQUNBc1ksRUFBQXRZLEdBQUFELE1BT0EsR0FBQXdZLEdBQUExRixFQUFBbE0sR0FDQTZSLEVBQUFELEVBQUFqVixNQUdBOFUsSUFDQUEsRUFBQTdZLFFBQUEsU0FBQWEsU0FDQW9ZLEdBQUFwWSxJQVFBLElBQUFILEdBQUE2VixFQUFBVyxRQUFBLE1BQ0FnQyxFQUFBeFksRUFBQTJHLE9BQ0E4UixFQUFBRCxFQUFBbFEsV0FBQWdRLEVBQUEzUixPQUFBVixJQUFBLFNBQUE5RixHQUNBLE1BQUErRixVQUFBL0YsTUFFQXVZLEVBQUFGLEVBQUFsUSxXQUFBbVEsRUFFQUMsR0FBQUEsRUFBQTNTLE9BQUEsU0FBQTVGLEdBQ0EsT0FBQTRCLEVBQUFxTSxPQUFBcE8sRUFBQVcsSUFBQVIsR0FBQW1ZLEVBQUEzWCxJQUFBUixHQUFBMFUsVUFHQSxJQUFBeEIsR0FBQXpULEVBQUErQixFQUFBMEMsWUFBQTFDLEVBQUEwQyxnQkFDQXNVLEVBQUFGLEVBQUF4UyxJQUFBLFNBQUE5RixHQUNBLE1BQUEsSUFBQThYLEdBQUFqWSxFQUFBVyxJQUFBUixHQUFBa1QsRUFBQTFTLElBQUFSLE1BUUEwRixJQUdBNlMsR0FBQTdZLEtBQUEsU0FBQU0sR0FDQSxHQUFBeVksR0FBQU4sRUFBQTNYLElBQUFSLEdBQ0EwWSxFQUFBRCxFQUFBM0QsT0FDQTZELEVBQUEsR0FBQWIsR0FBQWpZLEVBQUFXLElBQUFSLEdBQ0FQLEdBQUEwRSxFQUFBcUcsUUFBQWhFLE9BQUE5RyxLQUFBLFNBQUFFLEdBQ0E2WSxFQUFBN1ksR0FBQStZLEVBQUEvWSxLQUVBOEYsRUFBQTlHLE1BQUE2WixFQUFBQyxNQUlBaFQsRUFBQXBDLFFBQ0FNLEVBQUEvRSxLQUFBLFdBQUEwSCxFQUFBYixFQUdBLElBQUFrVCxHQUFBSixFQUFBaFYsU0FDQS9ELEdBQUFtWixHQUFBbFosS0FBQSxTQUFBTSxHQUNBb1ksRUFBQXBZLEVBQUFyQixJQUFBcUIsSUFHQVAsRUFBQTBTLEVBQUE1TCxHQUFBakMsWUFBQTVFLEtBQUEsU0FBQTZXLEdBQ0F4RSxFQUFBeEwsRUFBQSxJQUFBZ1EsR0FBQTVTLEVBQUE0QyxHQUFBaU8sUUFBQSxJQUFBK0IsS0FHQXFDLEVBQUF0VixRQUNBTSxFQUFBL0UsS0FBQSxPQUFBMEgsRUFBQTlHLEVBQUFtWixHQUFBcFgsRUFBQXFYLGNBQ0FiLEdBQ0FwVSxFQUFBL0UsS0FBQSxXQUFBMEgsRUFBQXlSLEdBR0FwVSxFQUFBL0UsS0FBQSxZQUFBMEgsT0FHQW9SLElBQ0ExVyxRQUFBNlAsTUFBQSxTQUNBclIsRUFBQWtZLEdBQUFqWSxLQUFBLFNBQUFvTyxFQUFBdkgsR0FDQXRGLFFBQUFDLElBQUFxRixFQUNBbU0sR0FBQW5NLE1BR0FxUixJQUNBM1csUUFBQTZQLE1BQUEsVUFDQXJSLEVBQUFtWSxHQUFBbFksS0FBQSxTQUFBb08sRUFBQXRKLEdBQ0FBLElBQUFzVSxrQkFDQUEsZUFBQXRVLEdBQUEvRSxPQUVBQSxFQUFBcU8sR0FBQXBPLEtBQUEsU0FBQWYsR0FDQW1hLGVBQUF0VSxHQUFBdEIsT0FBQXRFLEtBQUFELFFBSUFrWixJQUNBNVcsUUFBQTZQLE1BQUEsY0FDQXJSLEVBQUFvWSxHQUFBblksS0FBQSxTQUFBb08sRUFBQXRKLEdBQ0EsR0FBQXVTLEdBQUFoUixTQUFBdkIsRUFBQTRCLE1BQUEsS0FBQSxHQUNBNUIsR0FBQUEsRUFBQTRCLE1BQUEsS0FBQSxHQUNBNUIsSUFBQXVVLGFBQ0FBLFVBQUF2VSxXQUVBLElBQUF3VSxHQUFBRCxVQUFBdlUsR0FBQXVTLEVBQ0F0WCxHQUFBcU8sR0FBQXBPLEtBQUEsU0FBQU0sR0FDQWdaLEVBQUFoWixFQUFBLEtBQUEsRUFDQWdaLEVBQUFoWixJQUFBLE9BSUFnRSxHQUNBSixFQUFBcVYsT0FBQWpWLEdBRUFnRCxHQUNBcEQsRUFBQW1ELGVBQUFDLEdBR0E5QixHQUNBQSxFQUFBMUQsR0FFQW9DLEVBQUEvRSxLQUFBLGdCQXBLQSxJQURBb0MsUUFBQUMsSUFBQSxRQUFBTSxFQUFBLDJCQUNBMEQsRUFDQSxNQUFBQSxHQUFBMUQsSUFxS0F4RCxLQUFBK0ksZUFBQSxTQUFBdkYsR0FDQS9CLEVBQUErQixHQUFBOUIsS0FBQSxTQUFBQyxFQUFBbUgsR0FDQXJILEVBQUFFLEVBQUEsSUFBQUQsS0FBQSxTQUFBd1osRUFBQXZhLEdBQ0FtSSxJQUFBbkQsSUFBQWhGLElBQUFnRixHQUFBbUQsR0FBQTVELFNBQ0FTLEVBQUFtRCxHQUFBdEcsSUFBQTdCLEdBQUF3VixhQUFBMVUsRUFBQXlaLEdBQUFwVCxJQUFBLFNBQUE5RixHQUNBLE9BQUFBLEdBQUEsS0FDQTZHLGNBR0FwSCxFQUFBRSxFQUFBLElBQUEySSxRQUNBMUUsRUFBQS9FLEtBQUEsc0JBQUFpSSxFQUFBckgsRUFBQUUsRUFBQSxJQUFBNkcsT0FBQWhELGFBR0F4RixLQUFBYSxLQUFBLHVCQUlBYixLQUFBaWIsT0FBQSxTQUFBalYsR0FDQXZFLEVBQUF1RSxHQUFBdEUsS0FBQSxTQUFBOEIsRUFBQWdELEdBQ0EsR0FBQVAsR0FBQW9PLEVBQUFwTyxTQUFBTyxFQUNBL0UsR0FBQStCLEdBQUE5QixLQUFBLFNBQUF5WixHQUNBMVosRUFBQTBaLEdBQUF6WixLQUFBLFNBQUE4QixFQUFBNFgsR0FDQW5WLEVBQUFtVixHQUFBNVgsT0FHQW9DLEVBQUEvRSxLQUFBLGdCQUNBK0UsRUFBQS9FLEtBQUEsZ0JBQUEyRixNQUlBeEcsS0FBQXlJLE1BQUEsU0FBQUYsRUFBQVgsRUFBQXlULEVBQUFuVSxHQUVBcUIsSUFBQXNMLEdBQ0FsUSxXQUFBLFdBQ0FpQyxFQUFBNkMsTUFBQUYsRUFBQVgsRUFBQXlULEVBQUFuVSxJQUNBLEtBR0F0QixFQUFBeUMsU0FBQUUsRUFBQSxTQUFBcEMsR0FFQSxNQUFBUCxHQUFBOUMsV0FBQWlCLGFBQUE0TyxrQkFHQS9LLEVBQUEvQixFQUFBK0IsT0FBQXpCLEVBQUF5QixHQUdBQSxHQUdBaU0sRUFBQXRMLElBQUEsRUFDQTNDLEVBQUF1QixNQUFBb0IsRUFBQSxTQUFBWCxPQUFBQSxJQUNBMEksS0FBQSxTQUFBOU0sR0FDQW9DLEVBQUF3QixRQUFBNUQsRUFBQTBELFNBR0EyTSxHQUFBdEwsSUFDQSxTQUFBaUIsU0FFQXFLLEdBQUF0TCxNQUdBckIsR0FBQUEsSUFFQVUsT0FFQTVILE1BQUFtSCxNQUFBb0IsRUFBQSxRQUFBK1MsU0FBQSxTQUFBOVgsR0FDQW9FLEdBQ0EyVCxRQUFBclcsT0FBQXRFLEtBQUEySCxHQUVBM0MsRUFBQXdCLFFBQUE1RCxFQUFBMEQsTUFHQUksS0FBQXRILFFBSUFBLEtBQUF3QyxJQUFBLFNBQUErRixFQUFBTCxFQUFBaEIsR0FJQWdCLEVBQUE2SCxjQUFBclAsUUFDQXdILEdBQUFBLElBR0F0QyxFQUFBNkMsTUFBQUYsR0FBQTVILEdBQUF1SCxHQUFBLEtBQUEsV0FDQSxHQUFBc0IsTUFDQTJRLEVBQUF4VSxFQUFBNEMsRUFDQSxLQUFBLEdBQUE1SCxLQUFBdUgsR0FDQXNCLEVBQUE1SSxLQUFBdVosRUFBQWpWLE9BQUFnRCxFQUFBdkgsSUFFQXVHLEdBQUFzQyxNQUlBeEosS0FBQXdiLFNBQUEsU0FBQWhZLEdBQ0EsSUFBQSxHQUFBK0UsS0FBQS9FLEdBQUEsQ0FDQSxHQUFBMkMsR0FBQTNDLEVBQUErRSxFQUNBaUksY0FBQSxlQUFBakksR0FBQWpGLEtBQUFnTSxVQUFBOUwsR0FDQTJRLEVBQUE1TCxHQUFBOE0sRUFBQWxQLEdBQ0FvQyxJQUFBNUMsS0FDQUEsRUFBQTRDLEdBQUE5RyxTQUtBekIsS0FBQXFJLFNBQUEsU0FBQUUsRUFBQXJCLEdBQ0EsR0FBQXNDLEdBQUEySyxFQUFBNUwsRUFDQSxJQUFBaUIsRUFDQXRDLEdBQUFBLEVBQUFzQyxPQUVBLElBQUFqQixJQUFBc0wsR0FxQkFsUSxXQUFBLFdBQ0FpQyxFQUFBeUMsU0FBQUUsRUFBQXJCLElBQ0EsU0F2QkEsQ0FDQSxHQUFBcUIsSUFBQTZMLEdBQ0EsTUFFQSxJQUFBcUgsR0FBQSxlQUFBbFQsQ0FDQWtULEtBQUFqTCxlQUNBeFEsS0FBQXdiLFNBQUFsWSxLQUFBQyxNQUFBaU4sYUFBQWlMLEtBQ0F2VSxHQUFBQSxFQUFBaU4sRUFBQTVMLE1BRUFzTCxFQUFBdEwsSUFBQSxFQUNBdkksS0FBQW1ILE1BQUFvQixFQUFBLFlBQUEsS0FBQSxTQUFBL0UsR0FDQW9DLEVBQUE0VixTQUFBaFksR0FDQTBELEdBQUFBLEVBQUFpTixFQUFBNUwsVUFDQXNMLEdBQUF0TCxJQUNBLFNBQUEvRSxHQUNBeEQsS0FBQTBiLGNBQUFyTyxPQUFBOUUsR0FDQTZMLEVBQUE3TCxJQUFBLE9BV0F2SSxLQUFBOE0sZ0JBQUEsU0FBQXZFLEVBQUE4SCxHQUNBLEdBQUFuRyxHQUFBdEcsRUFBQXVKLEtBQUFrRCxFQUNBOUgsS0FBQXlMLEtBQUFBLEVBQUF6TCxHQUFBLEdBQUF4SSxJQUNBd0ksSUFBQTBMLEtBQUFBLEVBQUExTCxPQUNBMkIsSUFBQStKLEdBQUExTCxLQUdBMEwsRUFBQTFMLEdBQUEyQixJQUFBLEVBRUEzQixJQUFBNEwsR0FDQTlELEVBQUE4RCxFQUFBNUwsSUFFQXlMLEVBQUF6TCxHQUFBMEUsV0FBQW9ELEtBR0FyUSxLQUFBK00sd0JBQUEsU0FBQXhFLEVBQUFvVCxHQUNBLEdBQUFDLEdBQUEsU0FBQXpWLEVBQUF3VixHQUNBQSxFQUFBeGEsUUFBQSxTQUFBMGEsR0FDQSxHQUFBM1IsR0FBQSxNQUFBL0QsRUFBQW9DLFVBQUEsSUFBQXNULEVBQ0FDLEVBQUEsS0FBQUQsQ0FDQTNQLFFBQUFDLGVBQUFoRyxFQUFBcEYsVUFBQThhLEdBQ0FyWixJQUFBLFdBQ0EsS0FBQXNaLElBQUE5YixPQUFBLENBQ0EsR0FBQTJCLEdBQUE2TyxhQUFBdEcsRUFBQWxLLEtBQUFXLEdBQ0FYLE1BQUE4YixHQUFBbmEsRUFBQTJCLEtBQUFDLE1BQUE1QixHQUFBLEtBRUEsTUFBQTNCLE1BQUE4YixJQUVBQyxJQUFBLFNBQUE5UCxHQUNBak0sS0FBQThiLEdBQUE3UCxFQUNBdUUsYUFBQXRHLEVBQUFsSyxLQUFBVyxJQUFBMkMsS0FBQWdNLFVBQUFyRCxRQUtBMUQsS0FBQTJMLEtBQUFBLEVBQUEzTCxNQUNBLElBQUF5VCxHQUFBOUgsRUFBQTNMLEVBQ0EsSUFBQW9ULEVBQ0EsR0FBQU0sR0FBQXhhLEVBQUFrYSxHQUFBeFIsV0FBQTZSLEdBQUF4VyxjQUVBLElBQUF5VyxHQUFBRCxDQUVBQyxHQUFBM1csU0FDQWlELElBQUE0TCxJQUNBeUgsRUFBQXpILEVBQUE1TCxHQUFBMFQsR0FFQU4sR0FDQWpiLE1BQUFLLFVBQUFILEtBQUFTLE1BQUEyYSxFQUFBQyxLQUlBamMsS0FBQU8sR0FBQSxZQUFBLFNBQUE0RixHQUNBQSxFQUFBb0MsWUFBQXlMLElBQ0FBLEVBQUE3TixFQUFBb0MsV0FBQThFLE9BQUE4RyxFQUFBaE8sRUFBQW9DLFlBRUFwQyxFQUFBb0MsWUFBQTJMLElBQ0F0TyxFQUFBbUgsd0JBQUE1RyxFQUFBb0MsYUFJQXZJLEtBQUE4WSxNQUFBLFNBQUF2USxFQUFBWCxFQUFBeVQsRUFBQW5VLEdBQ0EsR0FBQXdELEdBQUExSyxJQUNBQSxNQUFBcUksU0FBQUUsRUFBQSxTQUFBcEMsR0FFQXlCLEVBQUFuRyxFQUFBbUcsR0FBQUUsSUFBQSxTQUFBbkcsRUFBQUMsR0FBQSxPQUFBQSxFQUFBbEIsTUFBQTZJLFFBQUE1SCxHQUFBQSxHQUFBQSxNQUFBa0gsVUFDQSxJQUFBcVQsR0FBQXRZLEVBQUEyRyxXQUFBcEUsRUFBQXlCLEdBQ0EvRixFQUFBNFMsRUFBQWxNLEVBQ0FtQyxHQUFBakMsTUFBQUYsRUFBQVgsRUFBQXlULEVBQUEsU0FBQTVYLEdBQ0F5RCxFQUFBckYsRUFBQStGLE9BQUFzVSxHQUFBMVUsU0FBQWhDLGdCQUlBeEYsS0FBQWtXLE9BQUEsU0FBQTNOLEVBQUFMLEVBQUFoQixHQUNBLE1BQUFsSCxNQUFBbUgsTUFBQW9CLEVBQUEsV0FBQTVILEdBQUF1SCxHQUFBaEIsSUFHQWxILEtBQUFnVCxRQUFBLFNBQUE5TCxHQUNBbEgsS0FBQThDLFdBQUF5QixXQUNBMkMsSUFFQWxILEtBQUE4QyxXQUFBa1EsUUFBQTlMLElBaUJBd0YsR0FBQTNMLFVBQUFpUyxRQUFBLFdBQ0EsR0FBQWxRLEdBQUE5QyxLQUFBNE0sS0FBQTlKLFVBQ0EsT0FBQSxJQUFBa0wsU0FBQSxTQUFBOUcsRUFBQWdILEdBQ0FwTCxFQUFBa1EsUUFBQTlMLE1BSUF3RixFQUFBM0wsVUFBQXdSLE1BQUEsU0FBQUMsRUFBQUMsR0FDQSxNQUFBLElBQUF6RSxTQUFBLFNBQUFDLEVBQUFDLEdBQ0FsTyxLQUFBNE0sS0FBQTlKLFdBQUF5UCxNQUFBQyxFQUFBQyxFQUFBeEUsSUFDQTNHLEtBQUF0SCxRQUlBME0sRUFBQTNMLFVBQUFpTSxPQUFBLFNBQUFjLEdBQ0EsTUFBQTlOLE1BQUE0TSxLQUFBOUosV0FBQWtLLFVBR0FOLEVBQUEzTCxVQUFBb2IsU0FBQSxTQUFBNVQsR0FDQSxHQUFBbEcsR0FBQXJDLElBQ0EsT0FBQSxJQUFBZ08sU0FBQSxTQUFBQyxFQUFBQyxHQUNBLElBQ0E3TCxFQUFBdUssS0FBQW9HLFFBQUEsV0FDQTNRLEVBQUF1SyxLQUFBdkUsU0FBQUUsRUFBQTBGLEtBRUEsTUFBQXhLLEdBQ0F5SyxFQUFBekssT0FLQWlKLEVBQUEzTCxVQUFBeUIsSUFBQSxTQUFBK0YsRUFBQUwsR0FDQSxHQUFBN0YsR0FBQXJDLEtBQ0EySyxHQUFBLEVBQ0F5UixFQUFBN1QsQ0FLQSxPQUpBTCxHQUFBNkgsY0FBQXJQLFFBQ0FpSyxHQUFBLEVBQ0F6QyxHQUFBQSxJQUVBLEdBQUE4RixTQUFBLFNBQUFDLEVBQUFDLEdBQ0EsSUFDQTdMLEVBQUF1SyxLQUFBb0csUUFBQSxXQUNBckksRUFDQXRJLEVBQUF1SyxLQUFBcEssSUFBQTRaLEVBQUFsVSxFQUFBLFNBQUFnRCxHQUNBK0MsRUFBQS9DLEVBQUEsTUFHQTdJLEVBQUF1SyxLQUFBcEssSUFBQTRaLEVBQUFsVSxFQUFBK0YsS0FHQSxNQUFBeEssR0FDQXlLLEVBQUF6SyxPQUtBaUosRUFBQTNMLFVBQUErWCxNQUFBLFNBQUF2USxFQUFBWCxFQUFBeVUsR0FDQSxHQUFBaGEsR0FBQXJDLElBQ0EsT0FBQSxJQUFBZ08sU0FBQSxTQUFBQyxFQUFBQyxHQUNBLEdBQUFtTixHQUFBLElBQ0FnQixJQUFBQSxFQUFBdE0sY0FBQXJQLE9BQUEyYixFQUFBL1csT0FDQStWLEVBQUFnQixFQUNBQSxHQUFBQSxFQUFBdE0sY0FBQXNELFFBQUFnSixFQUFBL1csU0FDQStWLEVBQUFnQixFQUFBalUsTUFBQSxLQUVBLEtBQ0EvRixFQUFBdUssS0FBQW9HLFFBQUEsV0FDQTNRLEVBQUF1SyxLQUFBa00sTUFBQXZRLEVBQUFYLEVBQUF5VCxFQUFBcE4sS0FFQSxNQUFBeEssR0FDQXlLLEVBQUF6SyxPQUtBaUosRUFBQTNMLFVBQUFtVixPQUFBLFNBQUEzTixFQUFBTCxHQUNBLEdBQUE3RixHQUFBckMsSUFDQSxPQUFBLElBQUFnTyxTQUFBLFNBQUFDLEVBQUFDLEdBQ0EsSUFDQTdMLEVBQUF1SyxLQUFBb0csUUFBQSxXQUNBM1EsRUFBQXVLLEtBQUFzSixPQUFBM04sRUFBQUwsRUFBQStGLEtBRUEsTUFBQXhLLEdBQ0F5SyxFQUFBekssT0FLQWlKLEVBQUEzTCxVQUFBdWIsY0FBQSxXQUNBLEdBQUFqYSxHQUFBckMsSUFDQSxPQUFBQSxNQUFBNE0sS0FBQTlKLFdBQUFpQixhQUFBcU8sUUFDQXBTLEtBQUF3QyxJQUFBLFlBQUF4QyxLQUFBNE0sS0FBQTlKLFdBQUFpQixhQUFBcU8sU0FFQSxHQUFBcEUsU0FBQSxTQUFBQyxFQUFBQyxHQUNBN0wsRUFBQUgsS0FBQSxZQUFBLFNBQUFxYSxHQUNBbGEsRUFBQUcsSUFBQSxZQUFBK1osR0FBQWpNLEtBQUFyQyxRQU1BdkIsRUFBQTNMLFVBQUF5YixnQkFBQSxTQUFBMU8sRUFBQXRLLEdBQ0EsTUFBQXhELE1BQUE0TSxLQUFBekYsTUFBQTJHLEVBQUF0SyxJQUdBa0osRUFBQTNMLFVBQUF3UixNQUFBLFNBQUFDLEVBQUFDLEdBQ0EsTUFBQXpTLE1BQUE0TSxLQUFBOUosV0FBQXlQLE1BQUFDLEVBQUFDIiwiZmlsZSI6InJ3dC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIEhhbmRsZXIoKXtcbiAgICB0aGlzLmhhbmRsZXJzID0gW107XG4gICAgdGhpcy5zdHJIYW5kbGVycyA9IHt9O1xufTtcblxuSGFuZGxlci5wcm90b3R5cGUuYWRkSGFuZGxlciA9IGZ1bmN0aW9uIChoYW5kbGVyKXtcbiAgICB2YXIgc3RySGFuZGxlciA9IHV0aWxzLmhhc2goaGFuZGxlci50b1N0cmluZygpKTtcbiAgICBpZiAoIShzdHJIYW5kbGVyIGluIHRoaXMuc3RySGFuZGxlcnMpKXtcbiAgICAgICAgdGhpcy5zdHJIYW5kbGVyc1tzdHJIYW5kbGVyXSA9IGhhbmRsZXI7XG4gICAgICAgIHRoaXMuaGFuZGxlcnMucHVzaChoYW5kbGVyKTtcbiAgICB9XG59O1xuSGFuZGxlci5wcm90b3R5cGUuaGFuZGxlID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKTtcbiAgICB0aGlzLmhhbmRsZXJzLmZvckVhY2goZnVuY3Rpb24oZnVuYyl7XG4gICAgICAgIGZ1bmMuYXBwbHkobnVsbCxhcmdzKTtcbiAgICB9KVxufTtcbkhhbmRsZXIucHJvdG90eXBlLmhhbmRsZUJ5ID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtcbiAgICB2YXIgdGhzID0gYXJndW1lbnRzWzBdO1xuICAgIHRoaXMuaGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbihmdW5jKXtcbiAgICAgICAgZnVuYy5hcHBseSh0aHMsYXJncyk7XG4gICAgfSlcbn07XG5cblxuZnVuY3Rpb24gTmFtZWRFdmVudE1hbmFnZXIgKCl7XG4gICAgdmFyIGV2ZW50cyA9IHt9O1xuICAgIHZhciBoYW5kbGVySWQgPSB7fTtcbiAgICB2YXIgaWR4SWQgPSAwO1xuICAgIHRoaXMub24gPSBmdW5jdGlvbihuYW1lLCBmdW5jKXtcbiAgICAgICAgaWYgKCEobmFtZSBpbiBldmVudHMpKXtcbiAgICAgICAgICAgIGV2ZW50c1tuYW1lXSA9IG5ldyBBcnJheSgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpZCA9IGlkeElkICsrO1xuICAgICAgICBldmVudHNbbmFtZV0ucHVzaChmdW5jKTtcbiAgICAgICAgaGFuZGxlcklkW2lkXSA9IGZ1bmM7XG4gICAgICAgIHJldHVybiBpZDtcbiAgICB9O1xuICAgIHRoaXMuZW1pdCA9IGZ1bmN0aW9uKG5hbWUpe1xuICAgICAgICBpZiAobmFtZSBpbiBldmVudHMpe1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7XG4gICAgICAgICAgICBldmVudHNbbmFtZV0uZm9yRWFjaChmdW5jdGlvbihldmVudCl7XG4gICAgICAgICAgICAgICAgZXZlbnQuYXBwbHkobnVsbCxhcmdzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB0aGlzLnVuYmluZCA9IGZ1bmN0aW9uKGhhbmRsZXIpe1xuICAgICAgICB2YXIgY291bnQgPSAwO1xuICAgICAgICBpZiAoaGFuZGxlciBpbiBoYW5kbGVySWQpe1xuICAgICAgICAgICAgdmFyIGZ1bmMgPSBoYW5kbGVySWRbaGFuZGxlciArICcnXTtcbiAgICAgICAgICAgIExhenkoZXZlbnRzKS5lYWNoKGZ1bmN0aW9uKHYsayl7XG4gICAgICAgICAgICAgICAgdmFyIGlkeCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIG4gaW4gdil7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2W25dID09PSBmdW5jKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkeC5wdXNoKG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZHgucmV2ZXJzZSgpLmZvckVhY2goZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgICAgIHYuc3BsaWNlKHgsMSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgaGFuZGxlcklkW2hhbmRsZXJdO1xuICAgICAgICByZXR1cm4gY291bnQ7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDYWxsIGV2ZW50IG9uY2VcbiAgICAgKi9cbiAgICB0aGlzLm9uY2UgPSBmdW5jdGlvbihldmVudE5hbWUsIGhhbmRsZXJGdW5jdGlvbikge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5vbihldmVudE5hbWUsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBoYW5kbGVyRnVuY3Rpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIHNlbGYudW5iaW5kKGhhbmRsZXIpO1xuICAgICAgICB9KVxuICAgIH1cbn1cbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGNhY2hlZEtleUlkeCA9IDA7XG5cbnZhciBudWxsU3RyaW5nID0gZnVuY3Rpb24oKSB7IHJldHVybiAnJ307XG5cbmZ1bmN0aW9uIG1vY2tPYmplY3QoKXtcbiAgICByZXR1cm4gbmV3IFByb3h5KHt9LCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24odGFyZ2V0LCBuYW1lKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIG5hbWUgID09PSAnc3RyaW5nJyl7XG4gICAgICAgICAgICAgICAgaWYgKG5hbWUgPT09ICd0b1N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxTdHJpbmc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vY2tPYmplY3QoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRbbmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxufVxuXG4vKlxudmFyICRQT1NUID0gZnVuY3Rpb24odXJsLCBkYXRhLCBjYWxsQmFjaywgZXJyb3JCYWNrLGhlYWRlcnMpe1xuICAgIHZhciBvcHRzID0ge1xuICAgICAgICBhY2NlcHRzIDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB1cmwgOiB1cmwsXG4gICAgICAgIGRhdGEgOiBKU09OLnN0cmluZ2lmeShkYXRhKSxcbiAgICAgICAgZGF0YVR5cGUgOiAnanNvbicsXG4gICAgICAgIHN1Y2Nlc3MgOiBjYWxsQmFjayxcbiAgICAgICAgZXJyb3IgOiBlcnJvckJhY2ssXG4gICAgICAgIG1ldGhvZCA6ICdQT1NUJyxcbiAgICAgICAgY29udGVudFR5cGUgOiAnYXBwbGljYXRpb24vanNvbidcbiAgICB9O1xuICAgIGlmIChoZWFkZXJzKXtcbiAgICAgICAgb3B0cy5oZWFkZXJzID0gaGVhZGVycztcbiAgICAgICAgb3B0cy5jcm9zc0RvbWFpbiA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiAkLmFqYXgob3B0cyk7XG59XG5cblxuZnVuY3Rpb24gcmVXaGVlbENvbm5lY3Rpb24oZW5kUG9pbnQsIGdldExvZ2luKXtcbiAgICAvLyBtYWluIFxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLmdldExvZ2luID0gZ2V0TG9naW47XG4gICAgdGhpcy5ldmVudHMgPSBuZXcgTmFtZWRFdmVudE1hbmFnZXIoKVxuICAgIHRoaXMuJFBPU1QgPSAkUE9TVC5iaW5kKHRoaXMpO1xuICAgIHRoaXMub3B0aW9ucyA9IHtlbmRQb2ludCA6IGVuZFBvaW50fTtcbiAgICB0aGlzLm9uID0gdGhpcy5ldmVudHMub24uYmluZCh0aGlzKTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS51cGRhdGVTdGF0dXMgPSBmdW5jdGlvbihzdGF0dXMsIGNhbGxCYWNrLCBlcnJvcikge1xuICAgIGlmIChzdGF0dXMpIHtcbiAgICAgICAgdmFyIGlzTG9nZ2VkID0gKHN0YXR1cy51c2VyX2lkICYmICF0aGlzLm9wdGlvbnMudXNlcl9pZCApO1xuICAgICAgICBmb3IgKHZhciB4IGluIHN0YXR1cyl7IHRoaXMub3B0aW9uc1t4XSA9IHN0YXR1c1t4XTsgfVxuICAgICAgICBsb2NhbFN0b3JhZ2UubGFzdFJXVFN0YXR1cyA9IEpTT04uc3RyaW5naWZ5KHN0YXR1cyk7XG4gICAgICAgIGlmIChpc0xvZ2dlZCkge1xuICAgICAgICAgICAgdGhpcy5ldmVudHMuZW1pdCgnbG9naW4nLCB0aGlzLm9wdGlvbnMudXNlcl9pZCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCF0aGlzLm9wdGlvbnMudXNlcl9pZCAmJiB0aGlzLmdldExvZ2luKXtcbiAgICAgICAgdmFyIGxvZ0luZm8gPSB0aGlzLmdldExvZ2luKGVycm9yKTtcbiAgICAgICAgaWYgKGxvZ0luZm8uY29uc3RydWN0b3IgPT09IE9iamVjdCl7XG4gICAgICAgICAgICB0aGlzLmxvZ2luKGxvZ0luZm8udXNlcm5hbWUsIGxvZ0luZm8ucGFzc3dvcmQpXG4gICAgICAgICAgICAudGhlbigoZnVuY3Rpb24oc3RhdHVzKXtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1cyhzdGF0dXMsIGNhbGxCYWNrKTtcbiAgICAgICAgICAgIH0pLmJpbmQodGhpcykpO1xuICAgICAgICB9IGVsc2UgaWYgKGxvZ0luZm8uY29uc3RydWN0b3IgPT09IFByb21pc2UpIHtcbiAgICAgICAgICAgIGxvZ0luZm8udGhlbigoZnVuY3Rpb24ob2JqKXtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IHRoaXMubG9naW4ob2JqLnVzZXJuYW1lLG9iai5wYXNzd29yZCk7XG4gICAgICAgICAgICAgICAgdmFyIG1hbmFnZUVycm9yID0gKGZ1bmN0aW9uKGJhZCl7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzKG51bGwsY2FsbEJhY2ssYmFkLmVycm9yKTtcbiAgICAgICAgICAgICAgICB9KS5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmIChjYWxsQmFjayl7XG4gICAgICAgICAgICAgICAgICAgIHgudGhlbihjYWxsQmFjayxtYW5hZ2VFcnJvcik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgeC50aGVuKG51bGwsIG1hbmFnZUVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHRoaXMub3B0aW9ucyk7XG4gICAgfSAgICBcbn1cblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLnN0YXR1cyA9IGZ1bmN0aW9uKGNhbGxCYWNrLCBmb3JjZSl7XG4gICAgaWYgKCgnbGFzdFJXVFN0YXR1cycgaW4gbG9jYWxTdG9yYWdlKSAmJiAhZm9yY2UpIHtcbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgdmFyIHN0YXR1cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmxhc3RSV1RTdGF0dXMpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0dXMoc3RhdHVzLGNhbGxCYWNrKTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdGF0dXMoY2FsbEJhY2ssIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYWxsQmFjayAmJiBjYWxsQmFjayhzdGF0dXMpO1xuICAgIH1cbiAgICBpZiAodGhpcy5fc3RhdHVzX2NhbGxpbmcpe1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzZWxmLnN0YXR1cyhjYWxsQmFjayk7XG4gICAgICAgIH0sNTApO1xuICAgIH1cbiAgICBpZiAodGhpcy5vcHRpb25zICYmIHRoaXMub3B0aW9ucy50aW1lc3RhbXApe1xuICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayh0aGlzLm9wdGlvbnMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3N0YXR1c19jYWxsaW5nID0gdHJ1ZTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdGhpcy4kcG9zdCgnYXBpL3N0YXR1cycsbnVsbCxmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmxhc3RSV1RTdGF0dXMgPSBKU09OLnN0cmluZ2lmeShzdGF0dXMpO1xuICAgICAgICAgICAgc2VsZi5fc3RhdHVzX2NhbGxpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHNlbGYudXBkYXRlU3RhdHVzKHN0YXR1cyxjYWxsQmFjayk7XG4gICAgICAgIH0pOyAgICAgICAgXG4gICAgfVxufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLiRwb3N0ID0gZnVuY3Rpb24odXJsLCBkYXRhLGNhbGxCYWNrKXtcbiAgICB2YXIgdGhzID0gdGhpcztcbiAgICBpZiAodGhpcy5vcHRpb25zICYmIHRoaXMub3B0aW9ucy50b2tlbil7XG4gICAgICAgIGlmICghZGF0YSl7XG4gICAgICAgICAgICBkYXRhID0ge307XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRoaXMub3B0aW9ucy50b2tlbil7XG4gICAgICAgIHZhciBoZWFkZXJzID0geyBcbiAgICAgICAgICAgIHRva2VuIDogdGhpcy5vcHRpb25zLnRva2VuLFxuICAgICAgICAgICAgYXBwbGljYXRpb24gOiB0aGlzLm9wdGlvbnMuYXBwbGljYXRpb25cbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgaGVhZGVycyA9IG51bGw7XG4gICAgfVxuXG4gICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQscmVqZWN0KXtcbiAgICAgICAgdXRpbHMueGRyKHRocy5vcHRpb25zLmVuZFBvaW50ICsgdXJsLCBkYXRhLCB0aHMub3B0aW9ucy5hcHBsaWNhdGlvbiwgdGhzLm9wdGlvbnMudG9rZW4pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbih4aHIpe1xuICAgICAgICAgICAgICAgIHRocy5ldmVudHMuZW1pdCgnaHR0cC1yZXNwb25zZScsIHhoci5yZXNwb25zZVRleHQsIHhoci5zdGF0dXMsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdodHRwLXJlc3BvbnNlLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VUZXh0LCB1cmwsIGRhdGEpO1xuICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VEYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdodHRwLXJlc3BvbnNlLScgKyB4aHIuc3RhdHVzICsgJy1qc29uJywgeGhyLnJlc3BvbnNlRGF0YSwgdXJsLCBkYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxCYWNrKSB7IGNhbGxCYWNrKCB4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQgKX07XG4gICAgICAgICAgICAgICAgYWNjZXB0KHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbih4aHIpIHtcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlRGF0YSl7XG4gICAgICAgICAgICAgICAgICAgIHRocy5ldmVudHMuZW1pdCgnZXJyb3ItanNvbicsIHhoci5yZXNwb25zZURhdGEsIHhoci5zdGF0dXMsIHVybCwgZGF0YSwgeGhyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1qc29uLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VEYXRhLHVybCwgZGF0YSwgeGhyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1odHRwJyx4aHIucmVzcG9uc2VUZXh0LCB4aHIuc3RhdHVzLHVybCxkYXRhLHhocik7XG4gICAgICAgICAgICAgICAgICAgIHRocy5ldmVudHMuZW1pdCgnZXJyb3ItaHR0cC0nICsgeGhyLnN0YXR1cywgeGhyLnJlc3BvbnNlVGV4dCx1cmwsZGF0YSx4aHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZWplY3QoeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICByZXR1cm4gcHJvbWlzZTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCl7XG4gICAgdmFyIHVybCA9IHRoaXMub3B0aW9ucy5lbmRQb2ludCArICdhcGkvbG9naW4nO1xuICAgIHZhciBjb25uZWN0aW9uID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LHJlamVjdCl7XG4gICAgICAgIHV0aWxzLnhkcih1cmwseyB1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkIDogcGFzc3dvcmR9LCBudWxsLGNvbm5lY3Rpb24ub3B0aW9ucy50b2tlbiwgdHJ1ZSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgY29ubmVjdGlvbi51cGRhdGVTdGF0dXMoeGhyLnJlc3BvbnNlRGF0YSk7XG4gICAgICAgICAgICAgICAgYWNjZXB0KHN0YXR1cyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbih4aHIpe1xuICAgICAgICAgICAgICAgIHJlamVjdCh4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uKGNhbGxCYWNrKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHdzY29ubmVjdCA9IGZ1bmN0aW9uKHNlbGYpe1xuICAgICAgICBzZWxmLndzQ29ubmVjdGlvbiA9IG5ldyB1dGlscy53c0Nvbm5lY3Qoc2VsZi5vcHRpb25zKTtcbiAgICAgICAgc2VsZi53c0Nvbm5lY3Rpb24ub25Db25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzZWxmLmV2ZW50cy5lbWl0KCd3cy1jb25uZWN0ZWQnLCBzZWxmLndzQ29ubmVjdGlvbik7XG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLndzQ29ubmVjdGlvbi5vbkRpc2Nvbm5lY3QoZnVuY3Rpb24oKXsgXG4gICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zICYmIHNlbGYub3B0aW9ucy5yZWFsdGltZUVuZFBvaW50KXtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIHdzY29ubmVjdChzZWxmKTsgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfSwxMDAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0aGlzLnN0YXR1cygoZnVuY3Rpb24oc3RhdHVzKXtcbiAgICAgICAgaWYgKCd0b2tlbicgaW4gc2VsZi5vcHRpb25zKXtcbiAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHN0YXR1cyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY29ubmVjdGluZyB0byAnICsgc2VsZi5vcHRpb25zLmVuZFBvaW50KTtcbiAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMudXNlcm5hbWUgJiYgc2VsZi5vcHRpb25zLnBhc3N3b3JkKXtcbiAgICAgICAgICAgICAgICBzZWxmLmxvZ2luKFxuICAgICAgICAgICAgICAgICAgICBzZWxmLm9wdGlvbnMudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNlbGYub3B0aW9ucy5wYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZW5ld2luZyBjb25uZWN0aW9uJylcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5vcHRpb25zLnRva2VuICYmIHNlbGYub3B0aW9ucy5yZWFsdGltZUVuZFBvaW50ICYmICghc2VsZi53c0Nvbm5lY3Rpb24pKXtcbiAgICAgICAgICAgIHdzY29ubmVjdChzZWxmKTtcbiAgICAgICAgfVxuICAgIH0pLmJpbmQodGhpcykpO1xufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLmxvZ091dCA9IGZ1bmN0aW9uKHVybCwgY2FsbEJhY2spe1xuICAgIHJldHVybiB0aGlzLiRwb3N0KCdhcGkvbG9nb3V0Jyx7fSwoZnVuY3Rpb24oc3RhdHVzKSB7XG4gICAgICAgIGlmICgnbGFzdFJXVFN0YXR1cycgaW4gbG9jYWxTdG9yYWdlKSB7XG4gICAgICAgICAgICBkZWxldGUgbG9jYWxTdG9yYWdlLmxhc3RSV1RTdGF0dXM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vcHRpb25zID0ge2VuZFBvaW50OiB0aGlzLm9wdGlvbnMuZW5kUG9pbnR9O1xuICAgICAgICBpZiAodGhpcy53c0Nvbm5lY3Rpb24pIHsgXG4gICAgICAgICAgICB0aGlzLndzQ29ubmVjdGlvbi5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy53c0Nvbm5lY3Rpb24gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmwpIHsgbG9jYXRpb24gPSB1cmw7IH1cbiAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2soKTtcbiAgICB9KS5iaW5kKHRoaXMpKTtcbn1cbiovXG52YXIgdXRpbHMgPSB7XG4gICAgcmVuYW1lRnVuY3Rpb24gOiBmdW5jdGlvbiAobmFtZSwgZm4pIHtcbiAgICAgICAgcmV0dXJuIChuZXcgRnVuY3Rpb24oXCJyZXR1cm4gZnVuY3Rpb24gKGNhbGwpIHsgcmV0dXJuIGZ1bmN0aW9uIFwiICsgbmFtZSArXG4gICAgICAgICAgICBcIiAoKSB7IHJldHVybiBjYWxsKHRoaXMsIGFyZ3VtZW50cykgfTsgfTtcIikoKSkoRnVuY3Rpb24uYXBwbHkuYmluZChmbikpO1xuICAgIH0sXG4gICAgY2FjaGVkIDogZnVuY3Rpb24oZnVuYywga2V5KXtcbiAgICAgICAgaWYgKCFrZXkpeyAgICBcbiAgICAgICAgICAgIGtleSA9ICdfJyArIGNhY2hlZEtleUlkeCsrO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHdyYXBwZXIoKXtcbiAgICAgICAgICAgIGlmICghdGhpc1trZXldKXtcbiAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSBmdW5jLmNhbGwodGhpcyxbYXJndW1lbnRzXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpc1trZXldO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gd3JhcHBlcjtcbiAgICB9LFxuLy8gICAgJFBPU1QgOiAkUE9TVCxcbi8vICAgIHJlV2hlZWxDb25uZWN0aW9uOiByZVdoZWVsQ29ubmVjdGlvbixcbiAgICBsb2c6IGZ1bmN0aW9uKCl7IFxuICAgICAgICBjb25zb2xlLmxvZyhhcmd1bWVudHMpO1xuICAgIH0sXG5cbiAgICB4ZHI6IGZ1bmN0aW9uICh1cmwsIGRhdGEsIGFwcGxpY2F0aW9uLHRva2VuLCBmb3JtRW5jb2RlKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlIGFuIEhUVFAgUmVxdWVzdCBhbmQgcmV0dXJuIGl0cyBwcm9taXNlLlxuICAgICAgICAgKi9cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgcmVxO1xuICAgICAgICAgICAgaWYgKCFkYXRhKSB7IGRhdGEgPSB7fTt9XG5cbiAgICAgICAgICAgIGlmKFhNTEh0dHBSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgcmVxID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgcmVxLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVxLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VEYXRhID0gSlNPTi5wYXJzZShyZXEucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0ge3Jlc3BvbnNlRGF0YTogcmVzcG9uc2VEYXRhLCByZXNwb25zZVRleHQ6IHJlcS5yZXNwb25zZVRleHQsc3RhdHVzOiByZXEuc3RhdHVzLCByZXF1ZXN0OiByZXF9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcS5zdGF0dXMgPj0gMjAwICYmIHJlcS5zdGF0dXMgPCA0MDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZihYRG9tYWluUmVxdWVzdCl7XG4gICAgICAgICAgICAgICAgcmVxID0gbmV3IFhEb21haW5SZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgcmVxLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBhY2NlcHQocmVxLnJlc3BvbnNlVGV4dCxyZXEuc3RhdHVzVGV4dCwgcmVxKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdDT1JTIG5vdCBzdXBwb3J0ZWQnKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlcS5vcGVuKCdQT1NUJywgdXJsLCB0cnVlKTtcbiAgICAgICAgICAgIHJlcS5vbmVycm9yID0gcmVqZWN0O1xuICAgICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICAgICAgICAgIGlmICh0b2tlbikgeyBkYXRhLl9fdG9rZW5fXyA9IHRva2VuIH1cbiAgICAgICAgICAgIGlmICghZm9ybUVuY29kZSl7XG4gICAgICAgICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsJ3RleHQvcGxhaW4nKTtcbiAgICAgICAgICAgICAgICBkYXRhID0gTGF6eShkYXRhKS5zaXplKCk/SlNPTi5zdHJpbmdpZnkoZGF0YSk6Jyc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTtcbiAgICAgICAgICAgICAgICBkYXRhID0gTGF6eShkYXRhKS5tYXAoZnVuY3Rpb24odixrKXtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBrICsgJz0nICsgZW5jb2RlVVJJKHYudG9TdHJpbmcoKSk7ICBcbiAgICAgICAgICAgICAgICB9KS50b0FycmF5KCkuam9pbignJicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVxLnNlbmQoZGF0YSk7XG4gICAgLy8gICAgICAgIHJlcS5zZW5kKG51bGwpO1xuICAgICAgICB9KVxuICAgIH0sXG4gICAgXG4gICAgY2FwaXRhbGl6ZSA6IGZ1bmN0aW9uIChzKSB7XG4gICAgICAgIHJldHVybiBzWzBdLnRvVXBwZXJDYXNlKCkgKyBzLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG4gICAgfSxcblxuICAgIGhhc2ggOiBmdW5jdGlvbihzdHIpe1xuICAgICAgICAvKipcbiAgICAgICAgICogSGFzaGVkIGZ1bmN0aW9uXG4gICAgICAgICAqL1xuICAgICAgICBzdHIgPSBzdHIudG9TdHJpbmcoKTtcbiAgICAgICAgdmFyIHJldCA9IDE7XG4gICAgICAgIGZvciAodmFyIHggPSAwO3g8c3RyLmxlbmd0aDt4Kyspe1xuICAgICAgICAgICAgcmV0ICo9ICgxICsgc3RyLmNoYXJDb2RlQXQoeCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAocmV0ICUgMzQ5NTgzNzQ5NTcpLnRvU3RyaW5nKCk7XG4gICAgfSxcblxuICAgIG1ha2VGaWx0ZXIgOiBmdW5jdGlvbiAobW9kZWwsIGZpbHRlciwgdW5pZmllciwgZG9udFRyYW5zbGF0ZUZpbHRlcikge1xuICAgICAgICAvKipcbiAgICAgICAgICogTWFrZSBmaWx0ZXIgZm9yIEFycmF5LmZpbHRlciBmdW5jdGlvbiBhcyBhbiBhbmQgb2Ygb3JcbiAgICAgICAgICovXG4gICAgICAgIGlmICghdW5pZmllcikgeyB1bmlmaWVyID0gJyAmJiAnO31cbiAgICAgICAgaWYgKExhenkoZmlsdGVyKS5zaXplKCkgPT09IDApe1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHgpeyByZXR1cm4gdHJ1ZSB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBzb3VyY2UgPSBMYXp5KGZpbHRlcikubWFwKGZ1bmN0aW9uKHZhbHMsIGZpZWxkKXtcbiAgICAgICAgICAgIGlmICghdmFscykgeyB2YWxzID0gW251bGxdfVxuICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHMpKXtcbiAgICAgICAgICAgICAgICB2YWxzID0gW3ZhbHNdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFkb250VHJhbnNsYXRlRmlsdGVyICYmIChtb2RlbC5maWVsZHNbZmllbGRdLnR5cGUgPT09ICdyZWZlcmVuY2UnKSkge1xuICAgICAgICAgICAgICAgIGZpZWxkID0gJ18nICsgZmllbGQ7XG4gICAgICAgICAgICAgICAgdmFscyA9IExhenkodmFscykubWFwKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICBpZiAoeCAmJiAoeC5jb25zdHJ1Y3RvciAhPT0gTnVtYmVyKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geC5pZDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHg7XG4gICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChtb2RlbC5maWVsZHNbZmllbGRdLnR5cGUgPT09ICdzdHJpbmcnKXtcbiAgICAgICAgICAgICAgICB2YWxzID0gdmFscy5tYXAoSlNPTi5zdHJpbmdpZnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICcoJyArICBMYXp5KHZhbHMpLm1hcChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICByZXR1cm4gJyh4LicgKyBmaWVsZCArICcgPT09ICcgKyB4ICsgJyknO1xuICAgICAgICAgICAgfSkuam9pbignIHx8ICcpICArJyknO1xuICAgICAgICB9KS50b0FycmF5KCkuam9pbih1bmlmaWVyKTtcbiAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcInhcIiwgXCJyZXR1cm4gXCIgKyBzb3VyY2UpO1xuICAgIH0sXG5cbiAgICBzYW1lQXMgOiBmdW5jdGlvbiAoeCwgeSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogRGVlcCBlcXVhbFxuICAgICAgICAgKi9cbiAgICAgICAgZm9yICh2YXIgayBpbiB4KSB7XG4gICAgICAgICAgICBpZiAoeVtrXSAhPSB4W2tdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgXG4gICAgcGx1cmFsaXplIDogZnVuY3Rpb24oc3RyLCBtb2RlbCl7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMZXhpY2FsbHkgcmV0dXJucyBlbmdsaXNoIHBsdXJhbCBmb3JtXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gc3RyICsgJ3MnO1xuICAgIH0sXG5cbiAgICBiZWZvcmVDYWxsIDogZnVuY3Rpb24oZnVuYywgYmVmb3JlKXtcbiAgICAgICAgdmFyIGRlY29yYXRvciA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBiZWZvcmUoKS50aGVuKGZ1bmMpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBkZWNvcmF0b3I7XG4gICAgfSxcblxuICAgIGNsZWFuU3RvcmFnZSA6IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDbGVhbiBsb2NhbFN0b3JhZ2Ugb2JqZWN0XG4gICAgICAgICAqL1xuICAgICAgICBMYXp5KGxvY2FsU3RvcmFnZSkua2V5cygpLmVhY2goZnVuY3Rpb24oayl7XG4gICAgICAgICAgICBkZWxldGUgbG9jYWxTdG9yYWdlW2tdO1xuICAgICAgICB9KVxuICAgIH0sXG5cbiAgICBjbGVhbkRlc2NyaXB0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgTGF6eShsb2NhbFN0b3JhZ2UpXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uKHYsIG4pIHsgcmV0dXJuIExhenkobikuc3RhcnRzV2l0aCgnZGVzY3JpcHRpb246Jyl9KVxuICAgICAgICAgICAgLmtleXMoKVxuICAgICAgICAgICAgLmVhY2goZnVuY3Rpb24obikgeyBkZWxldGUgbG9jYWxTdG9yYWdlW25dIH0pO1xuICAgIH0sXG4gICAgXG4gICAgcmV2ZXJzZSA6IGZ1bmN0aW9uIChjaHIsIHN0cikge1xuICAgICAgICByZXR1cm4gc3RyLnNwbGl0KGNocikucmV2ZXJzZSgpLmpvaW4oY2hyKTtcbiAgICB9LFxuICAgIHBlcm11dGF0aW9uczogZnVuY3Rpb24oYXJyKXtcbiAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICBmb3IgKHZhciB4ID0gYXJyLmxlbmd0aC0xOyB4ID49IDA7eC0tKXtcbiAgICAgICAgICAgIGZvciAodmFyIHkgPSBhcnIubGVuZ3RoLTE7IHkgPj0gMDsgeS0tKXtcbiAgICAgICAgICAgICAgICBpZiAoeCAhPT0geSlcbiAgICAgICAgICAgICAgICAgICAgcmV0LnB1c2goW2Fyclt4XSwgYXJyW3ldXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9LFxuXG4gICAgd2FpdEZvcjogZnVuY3Rpb24oZnVuYywgY2FsbEJhY2spIHtcbiAgICAgICAgdmFyIHdhaXRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKGZ1bmMoKSkge1xuICAgICAgICAgICAgICAgIGNhbGxCYWNrKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQod2FpdGVyLDUwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2V0VGltZW91dCh3YWl0ZXIsIDUwMCk7XG4gICAgfSxcblxuICAgIGJvb2w6IEJvb2xlYW4sXG5cbiAgICBub29wIDogZnVuY3Rpb24oKXt9LFxuXG4gICAgdHpPZmZzZXQ6IG5ldyBEYXRlKCkuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwMDAwLFxuXG4gICAgdHJhbnNGaWVsZFR5cGU6IHtcbiAgICAgICAgZGF0ZTogZnVuY3Rpb24oeCkgeyByZXR1cm4gbmV3IERhdGUoeCAqIDEwMDAgKyB1dGlscy50ek9mZnNldCApIH0sXG4gICAgICAgIGRhdGV0aW1lOiBmdW5jdGlvbih4KSB7IHJldHVybiBuZXcgRGF0ZSh4ICogMTAwMCArIHV0aWxzLnR6T2Zmc2V0ICkgfSxcbiAgICAgICAgc3RyaW5nOiBmdW5jdGlvbih4KSB7IHJldHVybiB4LnRvU3RyaW5nKCk7IH0sXG4gICAgICAgIHRleHQ6IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHgudG9TdHJpbmcoKTsgfSxcbiAgICAgICAgaW50ZWdlcjogZnVuY3Rpb24oeCkgeyByZXR1cm4gcGFyc2VJbnQoeCk7IH0sXG4gICAgICAgIGZsb2F0OiBmdW5jdGlvbih4KSB7IHJldHVybiBwYXJzZUZsb2F0KHgpOyB9XG4gICAgfSwgXG4gICAgbW9jayA6IG1vY2tPYmplY3Rcbn07XG5cblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBTVEFUVVNLRVkgPSAnbGFzdFJXVENvbm5lY3Rpb25TdGF0dXMnO1xuXG5mdW5jdGlvbiBSZWFsdGltZUNvbm5lY3Rpb24oZW5kUG9pbnQsIHJ3dENvbm5lY3Rpb24pe1xuICAgIC8qKlxuICAgICAqIENvbm5lY3RzIGEgd2Vic29ja2V0IHdpdGggcmVXaGVlbCBjb25uZWN0aW9uXG4gICAgICovXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgdmFyIGNvbm5lY3Rpb24gPSBuZXcgU29ja0pTKGVuZFBvaW50KTtcbiAgICBjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdvcGVuIDogJyArIHgpO1xuICAgICAgICBjb25uZWN0aW9uLnRlbmFudCgpO1xuICAgICAgICByd3RDb25uZWN0aW9uLmVtaXQoJ3JlYWx0aW1lLWNvbm5lY3Rpb24tb3BlbicseCk7XG4gICAgfTtcbiAgICBjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIGlmICh4LnR5cGUgPT0gJ21lc3NhZ2UnKSB7XG4gICAgICAgICAgICAvLyQubm90aWZ5KHguZGF0YSk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vVE9ETyBzZXQgZnJvbVJlYWx0aW1lXG4gICAgICAgICAgICAgICAgcnd0Q29ubmVjdGlvbi5lbWl0KCdyZWFsdGltZS1tZXNzYWdlLWpzb24nLCBKU09OLnBhcnNlKHguZGF0YSkpO1xuICAgICAgICAgICAgICAgIC8vVE9ETyB1bnNldCBmcm9tUmVhbHRpbWVcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgICAgIHJ3dENvbm5lY3Rpb24uZW1pdCgncmVhbHRpbWUtbWVzc2FnZS10ZXh0JywgSlNPTi5wYXJzZSh4LmRhdGEpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmcm9tIHJlYWx0aW1lICcseCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbm5lY3Rpb24ub25jbG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2V0VGltZW91dCh1dGlscy53c0Nvbm5lY3QsMTAwMCk7XG4gICAgICAgIHJ3dENvbm5lY3Rpb24uZW1pdCgncmVhbHRpbWUtY29ubmVjdGlvbi1jbG9zZWQnKTtcbiAgICB9O1xuICAgIGNvbm5lY3Rpb24udGVuYW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25uZWN0aW9uLnNlbmQoJ1RFTkFOVDonICsgcnd0Q29ubmVjdGlvbi5jYWNoZWRTdGF0dXMuYXBwbGljYXRpb24gKyAnOicgKyByd3RDb25uZWN0aW9uLmNhY2hlZFN0YXR1cy50b2tlbik7XG4gICAgfVxuICAgIHRoaXMuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgY29ubmVjdGlvbi5jbG9zZSgpO1xuICAgIH1cbn0gICAgXG5cbmZ1bmN0aW9uIHJlV2hlZWxDb25uZWN0aW9uKGVuZFBvaW50LCBnZXRMb2dpbil7XG4gICAgLyoqXG4gICAgICogQ29ubmVjdGlvbiBiYXNpYyBmb3IgcmVXaGVlbFxuICAgICAqIEBwYXJhbSBlbmRQb2ludDogc3RyaW5nIGJhc2UgdXJsIGZvciBhbGwgY29tdW5pY2F0aW9uXG4gICAgICogQHBhcmFtIGdldExvZ2luOiBmdW5jdGlvbiB0byBiZSBjYWxsZWQgaW4gY2FzZSBvZiBtaXNzaW5nIGxvZ2luLlxuICAgICAqICB0aGlzIGZ1bmN0aW9uIGNvdWxkIHJldHVybiA6XG4gICAgICogIC0gICBhIHsgdXNlcm5hbWUgOiA8dXNlcm5hbWU+ICwgcGFzc3dvcmQ6IDxwYXNzd29yZD59IG9yXG4gICAgICogIC0gICBiIFByb21pc2UgLT4geyB1c2VybmFtZSA6IDx1c2VybmFtZT4gLCBwYXNzd29yZDogPHBhc3N3b3JkPn1cbiAgICAgKi9cbiAgICAvLyBtYWluIGluaXRpYWxpemF0aW9uXG4gICAgdmFyIGV2ZW50cyA9IG5ldyBOYW1lZEV2ZW50TWFuYWdlcigpO1xuICAgIHRoaXMuZ2V0TG9naW4gPSBnZXRMb2dpbjtcbiAgICB0aGlzLmVuZFBvaW50ID0gZW5kUG9pbnQuZW5kc1dpdGgoJy8nKT8gZW5kUG9pbnQ6IChlbmRQb2ludCArICcvJyk7XG4gICAgdGhpcy5vbiA9IGV2ZW50cy5vbjtcbiAgICB0aGlzLnVuYmluZCA9IGV2ZW50cy51bmJpbmQ7XG4gICAgdGhpcy5lbWl0ID0gZXZlbnRzLmVtaXQ7XG4gICAgdGhpcy5vbmNlID0gZXZlbnRzLm9uY2U7XG4gICAgdGhpcy5jYWNoZWRTdGF0dXMgPSB7fTtcbiAgICB0aGlzLmlzQ29ubmVjdGVkID0gZmFsc2U7XG4gICAgdGhpcy5pc0xvZ2dlZEluID0gZmFsc2U7XG4gICAgLy8gcmVnaXN0ZXJpbmcgdXBkYXRlIHN0YXR1c1xuICAgIHZhciB0aHMgPSB0aGlzO1xufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLiRwb3N0ID0gZnVuY3Rpb24odXJsLCBkYXRhLGNhbGxCYWNrKXtcbiAgICAvKipcbiAgICAgKiBBSkFYIGNhbGwgZm9yIGZldGNoIGFsbCBkYXRhIGZyb20gc2VydmVyXG4gICAgICogQHBhcmFtIHVybDogbGFzdCB1cmwgcGFydCBmb3IgYWpheCBjYWxsXG4gICAgICogQHBhcmFtIGRhdGE6IGRhdGEgb2JqZWN0IHRvIGJlIHNlbnRcbiAgICAgKiBAcGFyYW0gY2FsbEJhY2s6IGZ1bmN0aW9uKHhocikgd2lsbCBiZSBjYWxsZWQgd2hlbiBkYXRhIGFycml2ZXNcbiAgICAgKiBAcmV0dXJucyBQcm9taXNlPHhocj4gc2FtZSBvZiBjYWxsQmFja1xuICAgICAqL1xuICAgIC8vIGluaXRpYWxpemF0aW9uXG4gICAgdmFyIHRocyA9IHRoaXM7XG4gICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQscmVqZWN0KXtcbiAgICAgICAgdXRpbHMueGRyKHRocy5lbmRQb2ludCArIHVybCwgZGF0YSwgdGhzLmNhY2hlZFN0YXR1cy5hcHBsaWNhdGlvbiwgdGhzLmNhY2hlZFN0YXR1cy50b2tlbilcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgdGhzLmVtaXQoJ2h0dHAtcmVzcG9uc2UnLCB4aHIucmVzcG9uc2VUZXh0LCB4aHIuc3RhdHVzLCB1cmwsIGRhdGEpO1xuICAgICAgICAgICAgICAgIHRocy5lbWl0KCdodHRwLXJlc3BvbnNlLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VUZXh0LCB1cmwsIGRhdGEpO1xuICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VEYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmVtaXQoJ2h0dHAtcmVzcG9uc2UtJyArIHhoci5zdGF0dXMgKyAnLWpzb24nLCB4aHIucmVzcG9uc2VEYXRhLCB1cmwsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY2FsbEJhY2spIHsgY2FsbEJhY2soIHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCApfTtcbiAgICAgICAgICAgICAgICBhY2NlcHQoeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHhocikge1xuICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VEYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmVtaXQoJ2Vycm9yLWpzb24nLCB4aHIucmVzcG9uc2VEYXRhLCB4aHIuc3RhdHVzLCB1cmwsIGRhdGEsIHhocik7XG4gICAgICAgICAgICAgICAgICAgIHRocy5lbWl0KCdlcnJvci1qc29uLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VEYXRhLHVybCwgZGF0YSwgeGhyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdGhzLmVtaXQoJ2Vycm9yLWh0dHAnLHhoci5yZXNwb25zZVRleHQsIHhoci5zdGF0dXMsdXJsLGRhdGEseGhyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmVtaXQoJ2Vycm9yLWh0dHAtJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZVRleHQsdXJsLGRhdGEseGhyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVqZWN0KHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgcmV0dXJuIHByb21pc2U7XG59O1xuXG4vKipcbiAqIENoZWNrIGN1cnJlbnQgc3RhdHVzIGFuZCBjYWxsYmFjayBmb3IgcmVzdWx0cy5cbiAqIEl0IGNhY2hlcyByZXN1bHRzIGZvciBmdXJ0aGVyLlxuICogQHBhcmFtIGNhbGxiYWNrOiAoc3RhdHVzIG9iamVjdClcbiAqIEBwYXJhbSBmb3JjZTogYm9vbGVhbiBpZiB0cnVlIGVtcHRpZXMgY2FjaGUgIFxuICogQHJldHVybiB2b2lkXG4gKi9cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5zdGF0dXMgPSBmdW5jdGlvbihjYWxsQmFjaywgZm9yY2UpIHtcbiAgICAvLyBpZiBmb3JjZSwgY2xlYXIgYWxsIGNhY2hlZCB2YWx1ZXNcbiAgICB2YXIga2V5ID0gJ3Rva2VuOicgKyB0aGlzLmVuZFBvaW50O1xuICAgIHZhciB0aHMgPSB0aGlzO1xuICAgIGlmIChmb3JjZSkge1xuICAgICAgICB0aGlzLmNhY2hlZFN0YXR1cyA9IHt9O1xuICAgICAgICBkZWxldGUgbG9jYWxTdG9yYWdlW2tleV07XG4gICAgfVxuICAgIGlmICh0aGlzLnN0YXR1c1dhaXRpbmcpIHtcbiAgICAgICAgLy8gd2FpdCBmb3Igc3RhdHVzXG4gICAgICAgIHV0aWxzLndhaXRGb3IoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gIXRocy5zdGF0dXNXYWl0aW5nO1xuICAgICAgICB9LCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgdGhzLnN0YXR1cyhjYWxsQmFjayxmb3JjZSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIHRyeSBmb3IgdmFsdWUgcmVzb2x1dGlvblxuICAgIC8vIGZpcnN0IG9uIG1lbW9yeVxuICAgIGlmIChMYXp5KHRoaXMuY2FjaGVkU3RhdHVzKS5zaXplKCkpe1xuICAgICAgICBjYWxsQmFjayh0aGlzLmNhY2hlZFN0YXR1cylcbiAgICAvLyB0aGVuIGluIGxvY2FsU3RvcmFnZVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBkYXRhID0ge307XG4gICAgICAgIGlmIChrZXkgaW4gbG9jYWxTdG9yYWdlKSB7XG4gICAgICAgICAgICBkYXRhLl9fdG9rZW5fXyA9IGxvY2FsU3RvcmFnZVtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RhdHVzV2FpdGluZyA9IHRydWU7XG4gICAgICAgIHRoaXMuJHBvc3QoJ2FwaS9zdGF0dXMnLGRhdGEsIGZ1bmN0aW9uKHN0YXR1cyl7XG4gICAgICAgICAgICB0aHMudXBkYXRlU3RhdHVzKHN0YXR1cyk7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Vba2V5XSA9IHN0YXR1cy50b2tlbjtcbiAgICAgICAgICAgIGNhbGxCYWNrKHN0YXR1cyk7XG4gICAgICAgICAgICB0aHMuc3RhdHVzV2FpdGluZyA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gZG9lc24ndCBjYWxsIGNhbGxiYWNrXG4gICAgICAgIHJldHVyblxuICAgIH1cbiAgICBjYWxsQmFjayh0aGlzLmNhY2hlZFN0YXR1cyk7XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUudXBkYXRlU3RhdHVzID0gZnVuY3Rpb24oc3RhdHVzKXtcbiAgICB2YXIgbGFzdEJ1aWxkID0gcGFyc2VGbG9hdChsb2NhbFN0b3JhZ2UubGFzdEJ1aWxkKSB8fCAxO1xuICAgIGlmIChsYXN0QnVpbGQgPCBzdGF0dXMubGFzdF9idWlsZCl7XG4gICAgICAgIHV0aWxzLmNsZWFuRGVzY3JpcHRpb24oKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLmxhc3RCdWlsZCA9IHN0YXR1cy5sYXN0X2J1aWxkO1xuICAgIH1cbiAgICB0aGlzLmlzQ29ubmVjdGVkID0gQm9vbGVhbihzdGF0dXMudG9rZW4pO1xuICAgIHRoaXMuaXNMb2dnZWRJbiA9IEJvb2xlYW4oc3RhdHVzLnVzZXJfaWQpO1xuICAgIHZhciBvbGRTdGF0dXMgPSB0aGlzLmNhY2hlZFN0YXR1cztcbiAgICB0aGlzLmNhY2hlZFN0YXR1cyA9IHN0YXR1cztcbiAgICBpZiAoIW9sZFN0YXR1cy51c2VyX2lkICYmIHN0YXR1cy51c2VyX2lkKXtcbiAgICAgICAgdGhpcy5lbWl0KCdsb2dnZWQtaW4nLHN0YXR1cy51c2VyX2lkKTtcbiAgICB9IGVsc2UgaWYgKG9sZFN0YXR1cy51c2VyX2lkICYmICFzdGF0dXMudXNlcl9pZCl7XG4gICAgICAgIHRoaXMuZW1pdCgnbG9nZ2VkLW91dCcpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5pc0Nvbm5lY3RlZCAmJiAhdGhpcy5pc0xvZ2dlZEluKXtcbiAgICAgICAgdGhpcy5lbWl0KCdsb2dpbi1yZXF1aXJlZCcpO1xuICAgICAgICBpZiAodGhpcy5nZXRMb2dpbil7XG4gICAgICAgICAgICB2YXIgbG9naW5JbmZvID0gdGhpcy5nZXRMb2dpbigpO1xuICAgICAgICAgICAgaWYgKGxvZ2luSW5mby5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KXtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ2luKGxvZ2luSW5mby51c2VybmFtZSwgbG9naW5JbmZvLnBhc3N3b3JkLCBsb2dpbkluZm8uY2FsbEJhY2spO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChsb2dpbkluZm8uY29uc3RydWN0b3IgPT09IFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICBsb2dpbkluZm8udGhlbihmdW5jdGlvbihvYmope1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2luKG9iai51c2VybmFtZSwgb2JqLnBhc3N3b3JkLCBvYmouY2FsbEJhY2spO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gcmVhbHRpbWUgY29ubmVjdGlvbiBpcyBzZXR0ZWRcbiAgICBpZiAoIW9sZFN0YXR1cy5yZWFsdGltZUVuZFBvaW50ICYmIHN0YXR1cy5yZWFsdGltZUVuZFBvaW50KSB7XG4gICAgICAgIHRoaXMud3NDb25uZWN0aW9uID0gbmV3IFJlYWx0aW1lQ29ubmVjdGlvbihzdGF0dXMucmVhbHRpbWVFbmRQb2ludCwgdGhpcyk7XG4gICAgLy8gcmVhbHRpbWUgY29ubmVjdGlvbiBpcyBjbG9zZWRcbiAgICB9IGVsc2UgaWYgKG9sZFN0YXR1cy5yZWFsdGltZUVuZFBvaW50ICYmICFzdGF0dXMucmVhbHRpbWVFbmRQb2ludCkge1xuICAgICAgICB0aGlzLndzQ29ubmVjdGlvbi5jbG9zZSgpO1xuICAgICAgICBkZWxldGUgdGhpcy53c0Nvbm5lY3Rpb247XG4gICAgfVxuICAgIHRoaXMuZW1pdCgndXBkYXRlLWNvbm5lY3Rpb24tc3RhdHVzJywgc3RhdHVzLCBvbGRTdGF0dXMpO1xuICAgIGxvY2FsU3RvcmFnZVtTVEFUVVNLRVldID0gSlNPTi5zdHJpbmdpZnkoc3RhdHVzKTtcbn1cblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcbiAgICAvKipcbiAgICAgKiBtYWtlIGxvZ2luIGFuZCByZXR1cm4gYSBwcm9taXNlLiBJZiBsb2dpbiBzdWNjZWQsIHByb21pc2Ugd2lsbCBiZSBhY2NlcHRlZFxuICAgICAqIElmIGxvZ2luIGZhaWxzIHByb21pc2Ugd2lsbCBiZSByZWplY3RlZCB3aXRoIGVycm9yXG4gICAgICogQHBhcmFtIHVzZXJuYW1lOiB1c2VybmFtZVxuICAgICAqIEBwYXJhbSBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgKiBAcmV0dXJuIFByb21pc2UgKHVzZXIgb2JqZWN0KVxuICAgICAqL1xuICAgIHZhciB0aHMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCl7XG4gICAgICAgIHV0aWxzLnhkcih0aHMuZW5kUG9pbnQgKyAnYXBpL2xvZ2luJywge3VzZXJuYW1lOiB1c2VybmFtZSB8fCAnJywgcGFzc3dvcmQ6IHBhc3N3b3JkIHx8ICcnfSxudWxsLHRocy5jYWNoZWRTdGF0dXMudG9rZW4sIHRydWUpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbih4aHIpe1xuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBzdGF0dXNcbiAgICAgICAgICAgICAgICB0aHMudXBkYXRlU3RhdHVzKHhoci5yZXNwb25zZURhdGEpO1xuICAgICAgICAgICAgICAgIC8vIGNhbGwgd2l0aCB1c2VyIGlkXG4gICAgICAgICAgICAgICAgYWNjZXB0KHtzdGF0dXMgOiAnc3VjY2VzcycsIHVzZXJpZDogdGhzLmNhY2hlZFN0YXR1cy51c2VyX2lkfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbih4aHIpIHtcbiAgICAgICAgICAgICAgICAvLyBpZiBlcnJvciBjYWxsIGVycm9yIG1hbmFnZXIgd2l0aCBlcnJvclxuICAgICAgICAgICAgICAgIGFjY2VwdCh7ZXJyb3I6IHhoci5yZXNwb25zZURhdGEuZXJyb3IsIHN0YXR1czogJ2Vycm9yJ30pO1xuICAgICAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUubG9nb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRocyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCxyZWplY3QpIHtcbiAgICAgICAgdGhzLiRwb3N0KCdhcGkvbG9nb3V0JylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKG9rKXtcbiAgICAgICAgICAgICAgICB0aHMudXBkYXRlU3RhdHVzKHt9KTtcbiAgICAgICAgICAgICAgICBkZWxldGUgbG9jYWxTdG9yYWdlW1NUQVRVU0tFWV07XG4gICAgICAgICAgICAgICAgYWNjZXB0KClcbiAgICAgICAgICAgIH0sIHJlamVjdCk7XG4gICAgfSk7XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uKGNhbGxCYWNrKSB7XG4gICAgaWYgKHRoaXMuaXNMb2dnZWRJbikge1xuICAgICAgICBjYWxsQmFjayh0aGlzLmNhY2hlZFN0YXR1cy51c2VyX2lkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyB3YWl0IGZvciBsb2dpblxuICAgICAgICB0aGlzLm9uY2UoJ2xvZ2dlZC1pbicsZnVuY3Rpb24odXNlcl9pZCl7XG4gICAgICAgICAgICBjYWxsQmFjayh1c2VyX2lkKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc3RhdHVzKGNhbGxCYWNrIHx8IHV0aWxzLm5vb3ApO1xuICAgIH1cbn1cblxudXRpbHMucmVXaGVlbENvbm5lY3Rpb24gPSByZVdoZWVsQ29ubmVjdGlvbjsiLCIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIFRvdWNoZXIoKXtcbiAgICB2YXIgdG91Y2hlZCA9IGZhbHNlXG4gICAgdGhpcy50b3VjaCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHRvdWNoZWQgPSB0cnVlO1xuICAgIH07XG4gICAgdGhpcy50b3VjaGVkID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIHQgPSB0b3VjaGVkO1xuICAgICAgICB0b3VjaGVkID0gZmFsc2U7XG4gICAgICAgIHJldHVybiB0O1xuICAgIH1cbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuXG5mdW5jdGlvbiBWYWN1dW1DYWNoZXIodG91Y2gsIGFza2VkLCBuYW1lLCBwa0luZGV4KXtcbi8qXG4gICAgaWYgKG5hbWUpe1xuICAgICAgICBjb25zb2xlLmluZm8oJ2NyZWF0ZWQgVmFjdXVtQ2FjaGVyIGFzICcgKyBuYW1lKTtcbiAgICB9XG4qL1xuICAgIGlmICghYXNrZWQpe1xuICAgICAgICB2YXIgYXNrZWQgPSBbXTtcbiAgICB9XG4gICAgdmFyIG1pc3NpbmcgPSBbXTtcbiAgICBcbiAgICB0aGlzLmFzayA9IGZ1bmN0aW9uIChpZCxsYXp5KXtcbiAgICAgICAgaWYgKHBrSW5kZXggJiYgKGlkIGluIHBrSW5kZXguc291cmNlKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghTGF6eShhc2tlZCkuY29udGFpbnMoaWQpKXtcbi8vICAgICAgICAgICAgY29uc29sZS5pbmZvKCdhc2tpbmcgKCcgKyBpZCArICcpIGZyb20gJyArIG5hbWUpO1xuICAgICAgICAgICAgbWlzc2luZy5wdXNoKGlkKTtcbiAgICAgICAgICAgIGlmICghbGF6eSlcbiAgICAgICAgICAgICAgICBhc2tlZC5wdXNoKGlkKTtcbiAgICAgICAgICAgIHRvdWNoLnRvdWNoKCk7XG4gICAgICAgIH0gXG4vLyAgICAgICAgZWxzZSBjb25zb2xlLndhcm4oJygnICsgaWQgKyAnKSB3YXMganVzdCBhc2tlZCBvbiAnICsgbmFtZSk7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0QXNrZWRJbmRleCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBhc2tlZDtcbiAgICB9XG5cbiAgICB0aGlzLm1pc3NpbmdzID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIExhenkobWlzc2luZy5zcGxpY2UoMCxtaXNzaW5nLmxlbmd0aCkpLnVuaXF1ZSgpLnRvQXJyYXkoKTtcbiAgICB9XG59XG4iLCJmdW5jdGlvbiBBdXRvTGlua2VyKGFjdGl2ZXMsIElEQiwgVzJQUkVTT1VSQ0UsIGxpc3RDYWNoZSl7XG4gICAgdmFyIHRvdWNoID0gbmV3IFRvdWNoZXIoKTtcbiAgICB2YXIgbWFpbkluZGV4ID0ge307XG4gICAgdmFyIGZvcmVpZ25LZXlzID0ge307XG4gICAgdmFyIG0ybSA9IHt9O1xuICAgIHZhciBtMm1JbmRleCA9IHt9O1xuICAgIHZhciBwZXJtaXNzaW9ucyA9IHt9O1xuICAgIHRoaXMubWFpbkluZGV4ID0gbWFpbkluZGV4O1xuICAgIHRoaXMuZm9yZWlnbktleXMgPSBmb3JlaWduS2V5cztcbiAgICB0aGlzLm0ybSA9IG0ybTtcbiAgICB0aGlzLm0ybUluZGV4ID0gbTJtSW5kZXg7XG4gICAgdGhpcy5wZXJtaXNzaW9ucyA9IHBlcm1pc3Npb25zO1xuXG4gICAgVzJQUkVTT1VSQ0Uub24oJ21vZGVsLWRlZmluaXRpb24nLGZ1bmN0aW9uKG1vZGVsLCBpbmRleCl7XG4gICAgICAgIC8vIGRlZmluaW5nIGFsbCBpbmRleGVzIGZvciBwcmltYXJ5IGtleVxuICAgICAgICB2YXIgcGtJbmRleCA9IGxpc3RDYWNoZS5nZXRJbmRleEZvcihtb2RlbC5uYW1lLCAnaWQnKTtcbiAgICAgICAgbWFpbkluZGV4W21vZGVsLm5hbWVdID0gbmV3IFZhY3V1bUNhY2hlcih0b3VjaCwgcGtJbmRleCwgJ21haW5JbmRleC4nICsgbW9kZWwubmFtZSwgaW5kZXgpO1xuICAgICAgICBcbiAgICAgICAgLy8gY3JlYXRpbmcgcGVybWlzc2lvbiBpbmRleGVzXG4gICAgICAgIHBlcm1pc3Npb25zW21vZGVsLm5hbWVdID0gbmV3IFZhY3V1bUNhY2hlcih0b3VjaCxudWxsLCAncGVybWlzc2lvbnMuJyArIG1vZGVsLm5hbWUpO1xuXG4gICAgICAgIC8vIGNyZWF0aW5nIGluZGV4ZXMgZm9yIGZvcmVpZ24ga2V5c1xuICAgICAgICBMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLmVhY2goZnVuY3Rpb24ocmVmZXJlbmNlKXtcbiAgICAgICAgICAgIHZhciBpbmRleE5hbWUgPSBtb2RlbC5uYW1lICsgJ18nICsgcmVmZXJlbmNlLmlkO1xuICAgICAgICAgICAgZm9yZWlnbktleXNbaW5kZXhOYW1lXSA9IG5ldyBWYWN1dW1DYWNoZXIodG91Y2gsIGxpc3RDYWNoZS5nZXRJbmRleEZvcihyZWZlcmVuY2UudG8sICdpZCcpLCByZWZlcmVuY2UudG8gKyAnLmlkIGZvcmVpZ25LZXlzLicgKyBpbmRleE5hbWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gY3JlYXRpbmcgcmV2ZXJzZSBmb3JlaWduIGtleXNcbiAgICAgICAgTGF6eShtb2RlbC5yZWZlcmVuY2VkQnkpLmVhY2goZnVuY3Rpb24oZmllbGQpe1xuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IGZpZWxkLmJ5ICsgJy4nICsgZmllbGQuaWQ7XG4gICAgICAgICAgICBmb3JlaWduS2V5c1tpbmRleE5hbWVdID0gbmV3IFZhY3V1bUNhY2hlcih0b3VjaCwgbGlzdENhY2hlLmdldEluZGV4Rm9yKGZpZWxkLmJ5LGZpZWxkLmlkKSwgZmllbGQuYnkgKyAnLicgKyBmaWVsZC5pZCArICcgZm9yZWlnbktleXMuJyArIGluZGV4TmFtZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBMYXp5KG1vZGVsLm1hbnlUb01hbnkpLmVhY2goZnVuY3Rpb24ocmVsYXRpb24pe1xuICAgICAgICAgICAgaWYgKCEocmVsYXRpb24uaW5kZXhOYW1lIGluIG0ybSkpXG4gICAgICAgICAgICAgICAgbTJtW3JlbGF0aW9uLmluZGV4TmFtZV0gPSBbbmV3IFZhY3V1bUNhY2hlcih0b3VjaCxudWxsLCdtMm0uJyArIHJlbGF0aW9uLmluZGV4TmFtZSArICdbMF0nKSwgbmV3IFZhY3V1bUNhY2hlcih0b3VjaCxudWxsLCdtMm0uJyArIHJlbGF0aW9uLmluZGV4TmFtZSsnWzFdJyldO1xuICAgICAgICAgICAgaWYgKCEocmVsYXRpb24uaW5kZXhOYW1lIGluIG0ybUluZGV4KSlcbiAgICAgICAgICAgICAgICBtMm1JbmRleFtyZWxhdGlvbi5pbmRleE5hbWVdID0gbmV3IE1hbnlUb01hbnlSZWxhdGlvbihyZWxhdGlvbixtMm1bcmVsYXRpb24uaW5kZXhOYW1lXSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHZhciBtMm1HZXQgPSBmdW5jdGlvbihpbmRleE5hbWUsIG4sIGNvbGxlY3Rpb24sIGNhbGxCYWNrKXtcbiAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QoKG4gPyB1dGlscy5yZXZlcnNlKCcvJywgaW5kZXhOYW1lKSA6IGluZGV4TmFtZSkgKyAncycgKyAnL2xpc3QnLCB7Y29sbGVjdGlvbjogY29sbGVjdGlvbn0sIGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShkYXRhLCBjYWxsQmFjayk7XG4gICAgICAgICAgICBkZWxldGUgYWN0aXZlc1tpbmRleE5hbWVdXG4gICAgICAgIH0pOyAgICAgICAgXG4gICAgfTtcblxuICAgIHZhciBnZXRNMk0gPSBmdW5jdGlvbihpbmRleE5hbWUsIGNvbGxlY3Rpb24sIG4sIGNhbGxCYWNrKXtcbiAgICAgICAgLy8gYXNrIGFsbCBpdGVtcyBpbiBjb2xsZWN0aW9uIHRvIG0ybSBpbmRleFxuICAgICAgICBMYXp5KGNvbGxlY3Rpb24pLmVhY2gobTJtW2luZGV4TmFtZV1bbl0uYXNrLmJpbmQobTJtW2luZGV4TmFtZV1bbl0pKTtcbiAgICAgICAgLy8gcmVuZXdpbmcgY29sbGVjdGlvbiB3aXRob3V0IGFza2VkXG4gICAgICAgIGNvbGxlY3Rpb24gPSBtMm1baW5kZXhOYW1lXVtuXS5taXNzaW5ncygpO1xuICAgICAgICAvLyBjYWxsaW5nIHJlbW90ZSBmb3IgbTJtIGNvbGxlY3Rpb24gaWYgYW55XG4gICAgICAgIGlmIChjb2xsZWN0aW9uLmxlbmd0aCl7XG4gICAgICAgICAgICBhY3RpdmVzW2luZGV4TmFtZV0gPSAxO1xuICAgICAgICAgICAgbTJtR2V0KGluZGV4TmFtZSwgbiwgY29sbGVjdGlvbiwgY2FsbEJhY2spO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2soKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5nZXRNMk0gPSBnZXRNMk07XG5cbiAgICB2YXIgbGlua1VubGlua2VkID0gZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gcGVyZm9ybSBhIERhdGFCYXNlIHN5bmNocm9uaXphdGlvbiB3aXRoIHNlcnZlciBsb29raW5nIGZvciB1bmtub3duIGRhdGFcbiAgICAgICAgaWYgKCF0b3VjaC50b3VjaGVkKCkpIHJldHVybjtcbiAgICAgICAgaWYgKExhenkoYWN0aXZlcykudmFsdWVzKCkuc3VtKCkpIHtcbiAgICAgICAgICAgIHRvdWNoLnRvdWNoKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgTGF6eShtMm0pLmVhY2goZnVuY3Rpb24oaW5kZXhlcywgaW5kZXhOYW1lKXtcbiAgICAgICAgICAgIExhenkoaW5kZXhlcykuZWFjaChmdW5jdGlvbiAoaW5kZXgsbikge1xuICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gaW5kZXgubWlzc2luZ3MoKTtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uID0gTGF6eShjb2xsZWN0aW9uKS5maWx0ZXIoQm9vbGVhbikubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh4KVxuICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICBpZiAoY29sbGVjdGlvbi5sZW5ndGgpe1xuICAgICAgICAgICAgICAgICAgICB2YXIgSU5ERVggPSBtMm1JbmRleFtpbmRleE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0dGVyID0gSU5ERVhbJ2dldCcgKyAoMSAtIG4pXS5iaW5kKElOREVYKTtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG0ybUdldChpbmRleE5hbWUsIG4sIGNvbGxlY3Rpb24sIGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkcyA9IGNvbGxlY3Rpb24ubWFwKGdldHRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG90aGVySW5kZXggPSBpbmRleE5hbWUuc3BsaXQoJy8nKVsxIC0gbl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUob3RoZXJJbmRleCxmdW5jdGlvbigpe1xuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExhenkoaWRzKS5mbGF0dGVuKCkudW5pcXVlKCkuZWFjaChtYWluSW5kZXhbb3RoZXJJbmRleF0uYXNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGF6eShpZHMpLmZsYXR0ZW4oKS51bmlxdWUoKS5lYWNoKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFpbkluZGV4W290aGVySW5kZXhdLmFzayh4LHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBMYXp5KG1haW5JbmRleCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIG1vZGVsTmFtZSkge1xuICAgICAgICAgICAgdmFyIGlkcyA9IGluZGV4Lm1pc3NpbmdzKCk7XG4gICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBpZGIgPSBtb2RlbE5hbWUgaW4gSURCID8gSURCW21vZGVsTmFtZV0ua2V5cygpIDogTGF6eSgpO1xuICAgICAgICAgICAgICAgIC8vbG9nKCdsaW5raW5nLicgKyBtb2RlbE5hbWUgKyAnID0gJyArIFcyUFJFU09VUkNFLmxpbmtpbmcuc291cmNlW21vZGVsTmFtZV0pO1xuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmZldGNoKG1vZGVsTmFtZSwge2lkOiBpZHN9LG51bGwsdXRpbHMubm9vcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBGb3JlaWduIGtleXNcbiAgICAgICAgTGF6eShmb3JlaWduS2V5cylcbiAgICAgICAgLm1hcChmdW5jdGlvbih2LGspe1xuICAgICAgICAgICAgcmV0dXJuIFtrLCB2Lm1pc3NpbmdzKCldXG4gICAgICAgIH0pLmZpbHRlcihmdW5jdGlvbih2KXtcbiAgICAgICAgICAgIHJldHVybiB2WzFdLmxlbmd0aFxuICAgICAgICB9KS5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBpZHMgPSB4WzFdO1xuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IHhbMF07XG4gICAgICAgICAgICB2YXIgaW5kZXggPSBpbmRleE5hbWUuc3BsaXQoJy4nKTtcbiAgICAgICAgICAgIHZhciBtYWluUmVzb3VyY2UgPSBpbmRleFswXTtcbiAgICAgICAgICAgIHZhciBmaWVsZE5hbWUgPSBpbmRleFsxXTtcbiAgICAgICAgICAgIHZhciBmaWx0ZXIgPSB7fTtcbiAgICAgICAgICAgIGZpbHRlcltmaWVsZE5hbWVdID0gaWRzO1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gobWFpblJlc291cmNlLCBmaWx0ZXIpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIExhenkoTGF6eShwZXJtaXNzaW9ucykubWFwKGZ1bmN0aW9uKHYsayl7XG4gICAgICAgICAgICByZXR1cm4gW2ssIHYubWlzc2luZ3MoKV1cbiAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICByZXR1cm4gdlsxXS5sZW5ndGhcbiAgICAgICAgfSkudG9PYmplY3QoKSkuZWFjaChmdW5jdGlvbiAoaWRzLCByZXNvdXJjZU5hbWUpIHtcbiAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGlkcy5sZW5ndGgpe1xuICAgICAgICAgICAgICAgIGFjdGl2ZXNbcmVzb3VyY2VOYW1lXSA9IDE7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QocmVzb3VyY2VOYW1lICsgJy9teV9wZXJtcycsIHtpZHM6IExhenkoaWRzKS51bmlxdWUoKS50b0FycmF5KCl9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3RQZXJtaXNzaW9ucyhkYXRhLlBFUk1JU1NJT05TKTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGFjdGl2ZXNbcmVzb3VyY2VOYW1lXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2V0SW50ZXJ2YWwobGlua1VubGlua2VkLDUwKTtcbn07XG5cblxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIExpc3RDYWNoZXIoKXtcbiAgICB2YXIgZ290QWxsID0ge307XG4gICAgdmFyIGFza2VkID0ge307IC8vIG1hcCBvZiBhcnJheVxuICAgIHZhciBjb21wb3NpdGVBc2tlZCA9IHt9O1xuICAgIHZhciBjYXJ0ZXNpYW5Qcm9kdWN0MSA9IGZ1bmN0aW9uKHgseSxpc0FycmF5KXtcbiAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICBpZiAoaXNBcnJheSkge1xuICAgICAgICAgICAgZm9yICh2YXIgYSBpbiB4KXtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBiIGluIHkpe1xuICAgICAgICAgICAgICAgICAgICByZXQucHVzaChMYXp5KFt4W2FdLHlbYl1dKS5mbGF0dGVuKCkudG9BcnJheSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb3IgKHZhciBhIGluIHgpe1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGIgaW4geSl7XG4gICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKFt4W2FdLHlbYl1dKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9O1xuICAgIHZhciBjYXJ0ZXNpYW5Qcm9kdWN0ID0gZnVuY3Rpb24oYXJyKXtcbiAgICAgICAgdmFyIGlzQXJyYXkgPSBmYWxzZTtcbiAgICAgICAgdmFyIHJldCA9IGFyclswXTsgXG4gICAgICAgIGZvciAodmFyIHggPSAxOyB4IDwgYXJyLmxlbmd0aDsgKyt4KXtcbiAgICAgICAgICAgIHJldCA9IGNhcnRlc2lhblByb2R1Y3QxKHJldCwgYXJyW3hdLCBpc0FycmF5KTtcbiAgICAgICAgICAgIGlzQXJyYXkgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuICAgIHZhciBleHBsb2RlRmlsdGVyID0gZnVuY3Rpb24oZmlsdGVyKSB7XG4gICAgICAgIHZhciBwcm9kdWN0ID0gY2FydGVzaWFuUHJvZHVjdChMYXp5KGZpbHRlcikudmFsdWVzKCkudG9BcnJheSgpKTtcbiAgICAgICAgdmFyIGtleXMgPSBMYXp5KGZpbHRlcikua2V5cygpLnRvQXJyYXkoKTtcbiAgICAgICAgcmV0dXJuIHByb2R1Y3QubWFwKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgdmFyIHIgPSB7fTtcbiAgICAgICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbihhLG4pe1xuICAgICAgICAgICAgICAgIHJbYV0gPSB4W25dO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgfTtcbiAgICB2YXIgZmlsdGVyU2luZ2xlID0gZnVuY3Rpb24obW9kZWwsIGZpbHRlciwgdGVzdE9ubHkpe1xuICAgICAgICAvLyBMYXp5IGF1dG8gY3JlYXRlIGluZGV4ZXNcbiAgICAgICAgdmFyIG1vZGVsTmFtZSA9IG1vZGVsLm1vZGVsTmFtZTtcbiAgICAgICAgdmFyIGdldEluZGV4Rm9yID0gdGhpcy5nZXRJbmRleEZvcjtcbiAgICAgICAgdmFyIGtleXMgPSBMYXp5KGZpbHRlcikubWFwKGZ1bmN0aW9uKHYsa2V5KXsgcmV0dXJuIFtrZXksIG1vZGVsTmFtZSArICcuJyArIGtleV07IH0pLnRvT2JqZWN0KCk7XG4gICAgICAgIHZhciBpbmRleGVzID0gTGF6eShmaWx0ZXIpLmtleXMoKS5tYXAoZnVuY3Rpb24oa2V5KXsgcmV0dXJuIFtrZXksIGdldEluZGV4Rm9yKG1vZGVsTmFtZSwga2V5KV19KS50b09iamVjdCgpOyBcbiAgICAgICAgLy8gZmFrZSBmb3IgKGl0IHdpbGwgY3ljbGUgb25jZSlcbiAgICAgICAgZm9yICh2YXIgeCBpbiBmaWx0ZXIpe1xuICAgICAgICAgICAgLy8gZ2V0IGFza2VkIGluZGV4IGFuZCBjaGVjayBwcmVzZW5jZVxuICAgICAgICAgICAgdmFyIGRpZmZlcmVuY2UgPSBMYXp5KGZpbHRlclt4XSkuZGlmZmVyZW5jZShpbmRleGVzW3hdKS50b0FycmF5KCk7XG4gICAgICAgICAgICBpZiAoZGlmZmVyZW5jZS5sZW5ndGgpe1xuICAgICAgICAgICAgICAgIC8vIGdlbmVyYXRlIG5ldyBmaWx0ZXJcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gTGF6eShbW3gsIGRpZmZlcmVuY2VdXSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgICAgICAvLyByZW1lbWJlciBhc2tlZFxuICAgICAgICAgICAgICAgIGlmICghdGVzdE9ubHkpXG4gICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGluZGV4ZXNbeF0sIGRpZmZlcmVuY2UpO1xuLy8gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NpbmdsZSBmaWx0ZXIgOiAnICsgSlNPTi5zdHJpbmdpZnkoZmlsdGVyKSArICdcXG5PdXQgOicgKyBKU09OLnN0cmluZ2lmeShyZXQpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzaW5nbGUgZmlsdGVyIDogJyArIEpTT04uc3RyaW5naWZ5KGZpbHRlcikgKyAnXFxuT3V0IDogbnVsbCcpO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHZhciBjbGVhbkNvbXBvc2l0ZXMgPSBmdW5jdGlvbihtb2RlbCxmaWx0ZXIpe1xuICAgICAgICAvKipcbiAgICAgICAgICogY2xlYW4gY29tcG9zaXRlQXNrZWRcbiAgICAgICAgICovXG4gICAgICAgIC8vIGxhenkgY3JlYXRlIGNvbmRpdGlvbmFsIGFza2VkIGluZGV4XG4gICAgICAgIGlmICghKG1vZGVsLm5hbWUgaW4gY29tcG9zaXRlQXNrZWQpKSB7IGNvbXBvc2l0ZUFza2VkW21vZGVsLm5hbWVdID0gW10gfTtcbiAgICAgICAgdmFyIGluZGV4ID0gY29tcG9zaXRlQXNrZWRbbW9kZWwubmFtZV07XG4gICAgICAgIC8vIHNlYXJjaCBmb3IgYWxsIGVsZW1lbnRzIHdobyBoYXZlIHNhbWUgcGFydGlhbFxuICAgICAgICB2YXIgZmlsdGVyTGVuID0gTGF6eShmaWx0ZXIpLnNpemUoKTtcbiAgICAgICAgdmFyIGl0ZW1zID0gaW5kZXguZmlsdGVyKHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIGZpbHRlciwgJyAmJiAnLHRydWUpKS5maWx0ZXIoZnVuY3Rpb24oaXRlbSl7IExhenkoaXRlbSkuc2l6ZSgpID4gZmlsdGVyTGVuIH0pO1xuLy8gICAgICAgIGNvbnNvbGUubG9nKCdkZWxldGluZyA6JyArIEpTT04uc3RyaW5naWZ5KGl0ZW1zKSk7XG4gICAgfTtcblxuICAgIHRoaXMuZmlsdGVyID0gZnVuY3Rpb24obW9kZWwsIGZpbHRlcil7XG4vLyAgICAgICAgY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLS0tLVxcbmZpbHRlciA6ICcgKyBKU09OLnN0cmluZ2lmeShmaWx0ZXIpKTtcbiAgICAgICAgdmFyIG1vZGVsTmFtZSA9IG1vZGVsLm1vZGVsTmFtZTtcblxuICAgICAgICAvLyBpZiB5b3UgZmV0Y2ggYWxsIG9iamVjdHMgZnJvbSBzZXJ2ZXIsIHRoaXMgbW9kZWwgaGFzIHRvIGJlIG1hcmtlZCBhcyBnb3QgYWxsO1xuICAgICAgICB2YXIgZmlsdGVyTGVuICA9IExhenkoZmlsdGVyKS5zaXplKCk7XG4gICAgICAgIHN3aXRjaCAoZmlsdGVyTGVuKSB7XG4gICAgICAgICAgICBjYXNlIDAgOiB7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIG51bGwgb3IgYWxsXG4gICAgICAgICAgICAgICAgdmFyIGdvdCA9IGdvdEFsbFttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgIGdvdEFsbFttb2RlbE5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAobW9kZWxOYW1lIGluIGFza2VkKXtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGFza2VkW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ291dCA6IG51bGwgKGdvdCBhbGwpJyk7XG4gICAgICAgICAgICAgICAgLy8gY29uZGl0aW9uYWwgY2xlYW5cbiAgICAgICAgICAgICAgICBpZiAobW9kZWxOYW1lIGluIGNvbXBvc2l0ZUFza2VkKXsgXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ290KVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIDEgOiB7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IGZpbHRlclNpbmdsZS5jYWxsKHRoaXMsIG1vZGVsLCBmaWx0ZXIpO1xuICAgICAgICAgICAgICAgIGNsZWFuQ29tcG9zaXRlcy5jYWxsKHRoaXMsIG1vZGVsLCBmaWx0ZXIpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRocyA9IHRoaXM7XG4gICAgICAgIHZhciBzaW5nbGUgPSBMYXp5KGZpbHRlcikua2V5cygpLnNvbWUoZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgICAgICB2YXIgZiA9IHt9O1xuICAgICAgICAgICAgZltrZXldID0gZmlsdGVyW2tleV07XG4gICAgICAgICAgICByZXR1cm4gZmlsdGVyU2luZ2xlLmNhbGwodGhzLCBtb2RlbCwgZiwgdHJ1ZSkgPT0gbnVsbDtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChzaW5nbGUpIHsgcmV0dXJuIG51bGwgfVxuICAgICAgICAvLyBsYXp5IGNyZWF0ZSBjb21wb3NpdGVBc2tlZFxuICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gY29tcG9zaXRlQXNrZWQpKXsgY29tcG9zaXRlQXNrZWRbbW9kZWxOYW1lXSA9IFtdOyB9XG4gICAgICAgIC8vIGV4cGxvZGUgZmlsdGVyXG4gICAgICAgIHZhciBleHBsb2RlZCA9IGV4cGxvZGVGaWx0ZXIoZmlsdGVyKTtcbiAgICAgICAgLy8gY29sbGVjdCBwYXJ0aWFsc1xuICAgICAgICB2YXIgcGFydGlhbHMgPSBjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdLmZpbHRlcih1dGlscy5tYWtlRmlsdGVyKG1vZGVsLCBmaWx0ZXIsICcgfHwgJyx0cnVlKSk7XG4gICAgICAgIC8vIGNvbGxlY3QgbWlzc2luZ3MgKGV4cGxvZGVkIC0gcGFydGlhbHMpXG4gICAgICAgIGlmIChwYXJ0aWFscy5sZW5ndGgpe1xuICAgICAgICAgICAgdmFyIGJhZCAgPSBbXTtcbiAgICAgICAgICAgIC8vIHBhcnRpYWwgZGlmZmVyZW5jZVxuICAgICAgICAgICAgZm9yICh2YXIgeCBpbiBwYXJ0aWFscyl7XG4gICAgICAgICAgICAgICAgYmFkLnB1c2guYXBwbHkoYmFkLGV4cGxvZGVkLmZpbHRlcih1dGlscy5tYWtlRmlsdGVyKG1vZGVsLCBwYXJ0aWFsc1t4XSwnICYmICcsIHRydWUpKSk7XG4gICAgICAgICAgICB9XG4vLyAgICAgICAgICAgIGNvbnNvbGUubG9nKCdleHBsb2RlZCAtIHBhcnRpYWwgOiAnICsgSlNPTi5zdHJpbmdpZnkoYmFkKSk7XG4gICAgICAgICAgICB2YXIgbWlzc2luZ3MgPSBMYXp5KGV4cGxvZGVkKS5kaWZmZXJlbmNlKGJhZCkudG9BcnJheSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIG1pc3NpbmdzID0gZXhwbG9kZWQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBmaWx0ZXIgcGFydGlhbHNcbiAgICAgICAgaWYgKG1pc3NpbmdzLmxlbmd0aCl7XG4gICAgICAgICAgICBjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdLnB1c2guYXBwbHkoY29tcG9zaXRlQXNrZWRbbW9kZWxOYW1lXSxtaXNzaW5ncyk7XG4gICAgICAgICAgICAvLyBhZ2dyZWdhdGUgbWlzc2luZ3NcbiAgICAgICAgICAgIHZhciBtaXNzaW5ncyA9IExhenkoZmlsdGVyKS5rZXlzKCkubWFwKGZ1bmN0aW9uKGtleSl7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IExhenkobWlzc2luZ3MpLnBsdWNrKGtleSkudW5pcXVlKCkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBba2V5LCByZXQubGVuZ3RoP3JldDpmaWx0ZXJba2V5XV07XG4gICAgICAgICAgICB9KS50b09iamVjdCgpO1xuLy8gICAgICAgICAgICBjb25zb2xlLmxvZygnb3V0IDogJyArIEpTT04uc3RyaW5naWZ5KG1pc3NpbmdzKSk7XG4gICAgICAgICAgICAvLyBjbGVhbiBjb25kaXRpb25hbFxuICAgICAgICAgICAgY2xlYW5Db21wb3NpdGVzKG1vZGVsLCBtaXNzaW5ncyk7XG4gICAgICAgICAgICByZXR1cm4gbWlzc2luZ3M7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0SW5kZXhGb3IgPSBmdW5jdGlvbihtb2RlbE5hbWUsIGZpZWxkTmFtZSl7XG4gICAgICAgIHZhciBpbmRleE5hbWUgPSBtb2RlbE5hbWUgKyAnLicgKyBmaWVsZE5hbWU7XG4gICAgICAgIGlmICghKGluZGV4TmFtZSBpbiBhc2tlZCkpe1xuICAgICAgICAgICAgYXNrZWRbaW5kZXhOYW1lXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhc2tlZFtpbmRleE5hbWVdO1xuICAgIH1cbn07IiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBNYW55VG9NYW55UmVsYXRpb24ocmVsYXRpb24sbTJtKXtcbiAgICB2YXIgaXRlbXMgPSBbXTtcbiAgICB0aGlzLmFkZCA9IGl0ZW1zLnB1c2guYmluZChpdGVtcyk7XG4gICAgdGhpcy5hZGQgPSBmdW5jdGlvbihpdGVtKXtcbiAgLy8gICAgICBjb25zb2xlLmxvZygnYWRkaW5nICcgKyBpdGVtKTtcbiAgICAgICAgaWYgKCEoTGF6eShpdGVtcykuZmluZChpdGVtKSkpe1xuICAgICAgICAgICAgaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZ2V0MCA9IGZ1bmN0aW9uKGlkKXtcbiAgICAgICAgbTJtWzFdLmFzayhpZCk7XG4gICAgICAgIHJldHVybiBMYXp5KGl0ZW1zKS5maWx0ZXIoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICByZXR1cm4geFswXSA9PT0gaWQ7XG4gICAgICAgIH0pLnBsdWNrKFwiMVwiKS50b0FycmF5KCk7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0MSA9IGZ1bmN0aW9uKGlkKXtcbiAgICAgICAgbTJtWzBdLmFzayhpZCk7XG4gICAgICAgIHJldHVybiBMYXp5KGl0ZW1zKS5maWx0ZXIoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICByZXR1cm4geFsxXSA9PT0gaWQ7XG4gICAgICAgIH0pLnBsdWNrKFwiMFwiKS50b0FycmF5KCk7XG4gICAgfTtcbiAgICB0aGlzWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZShyZWxhdGlvbi5pbmRleE5hbWUuc3BsaXQoJy8nKVsxXSldID0gdGhpcy5nZXQxO1xuICAgIHRoaXNbJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKHJlbGF0aW9uLmluZGV4TmFtZS5zcGxpdCgnLycpWzBdKV0gPSB0aGlzLmdldDA7XG5cbiAgICB0aGlzLmRlbCA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICB2YXIgbCA9IGl0ZW1zLmxlbmd0aDtcbiAgICAgICAgdmFyIGlkeCA9IG51bGw7XG4gICAgICAgIGZvciAodmFyIGEgPSAwOyBhIDwgbDsgYSsrKXsgXG4gICAgICAgICAgICBpZiAoKGl0ZW1zW2FdWzBdID09PSBpdGVtWzBdKSAmJiAoaXRlbXNbYV1bMV0gPT09IGl0ZW1bMV0pKXtcbiAgICAgICAgICAgICAgICBpZHggPSBhO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpZHgpe1xuICAgICAgICAgICAgaXRlbXMuc3BsaWNlKGEsIDEpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKCdkZWxldGluZyAnLCBpdGVtKTtcbiAgICB9O1xufSIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gY2FjaGVkUHJvcGVydHlCeUV2ZW50cyhwcm90bywgcHJvcGVydHlOYW1lLGdldHRlciwgc2V0dGVyKXtcbiAgICB2YXIgZXZlbnRzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDQpO1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICBcbiAgICBMYXp5KGV2ZW50cykuZWFjaChmdW5jdGlvbihldmVudCl7XG4gICAgICAgIHByb3RvLm9ybS5vbihldmVudCxmdW5jdGlvbigpe1xuICAgICAgICAgICAgcmVzdWx0ID0ge307XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHZhciBwcm9wZXJ0eURlZiA9IHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBjYWNoZWQoKXtcbiAgICAgICAgICAgIGlmICghKHRoaXMuaWQgaW4gcmVzdWx0KSl7XG4gICAgICAgICAgICAgICAgcmVzdWx0W3RoaXMuaWRdID0gZ2V0dGVyLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0W3RoaXMuaWRdO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBpZiAoc2V0dGVyKXtcbiAgICAgICAgcHJvcGVydHlEZWZbJ3NldCddID0gZnVuY3Rpb24odmFsdWUpe1xuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSByZXN1bHRbdGhpcy5pZF0pe1xuICAgICAgICAgICAgICAgIHNldHRlci5jYWxsKHRoaXMsdmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlkIGluIHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSByZXN1bHRbdGhpcy5pZF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm90bywgcHJvcGVydHlOYW1lLHByb3BlcnR5RGVmKTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gVmFsaWRhdGlvbkVycm9yKGRhdGEpe1xuICAgIHRoaXMucmVzb3VyY2UgPSBkYXRhLl9yZXNvdXJjZTtcbiAgICB0aGlzLmZvcm1JZHggPSBkYXRhLmZvcm1JZHg7XG4gICAgdGhpcy5maWVsZHMgPSBkYXRhLmVycm9ycztcbn1cbnZhciBiYXNlT1JNID0gZnVuY3Rpb24ob3B0aW9ucywgZXh0T1JNKXtcbiAgICBcbiAgICAvLyBjcmVhdGluZyByZXdoZWVsIGNvbm5lY3Rpb25cbiAgICBpZiAob3B0aW9ucy5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKXtcbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBuZXcgcmVXaGVlbENvbm5lY3Rpb24ob3B0aW9ucyk7XG4gICAgfSBlbHNlIGlmIChvcHRpb25zLmNvbnN0cnVjdG9yID09PSB1dGlscy5yZVdoZWVsQ29ubmVjdGlvbil7XG4gICAgICAgIHZhciBjb25uZWN0aW9uID0gb3B0aW9ucztcbiAgICB9XG4gICAgdGhpcy5jb25uZWN0aW9uID0gY29ubmVjdGlvbjtcbiAgICBjb25uZWN0aW9uLm9uKCdjb25uZWN0ZWQnLCBmdW5jdGlvbigpeyBcbiAgICAgICAgdGhpcy5jb25uZWN0ZWQgPSB0cnVlO1xuICAgIH0pO1xuICAgIHRoaXMub24gPSBjb25uZWN0aW9uLm9uO1xuICAgIHRoaXMuZW1pdCA9IGNvbm5lY3Rpb24uZW1pdDtcbiAgICB0aGlzLnVuYmluZCA9IGNvbm5lY3Rpb24udW5iaW5kO1xuICAgIHRoaXMub25jZSA9IGNvbm5lY3Rpb24ub25jZTtcbiAgICB0aGlzLiRwb3N0ID0gY29ubmVjdGlvbi4kcG9zdC5iaW5kKGNvbm5lY3Rpb24pO1xuXG4gICAgLy8gaGFuZGxpbmcgd2Vic29ja2V0IGV2ZW50c1xuICAgIHRoaXMub24oJ3dzLWNvbm5lY3RlZCcsZnVuY3Rpb24od3Mpe1xuICAgICAgICBjb25zb2xlLmluZm8oJ1dlYnNvY2tldCBjb25uZWN0ZWQnKTtcbiAgICAgICAgLy8gYWxsIGpzb24gZGF0YSBoYXMgdG8gYmUgcGFyc2VkIGJ5IGdvdERhdGFcbiAgICAgICAgd3Mub25NZXNzYWdlSnNvbihXMlBSRVNPVVJDRS5nb3REYXRhLmJpbmQoVzJQUkVTT1VSQ0UpKTtcbiAgICAgICAgLy9cbiAgICAgICAgd3Mub25NZXNzYWdlVGV4dChmdW5jdGlvbihtZXNzYWdlKXtcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnV1MgbWVzc2FnZSA6ICcgKyBtZXNzYWdlKVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICB0aGlzLm9uKCd3cy1kaXNjb25uZWN0ZWQnLCBmdW5jdGlvbih3cyl7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dlYnNvY2tldCBkaXNjb25uZWN0ZWQnKVxuICAgIH0pO1xuICAgIHRoaXMub24oJ2Vycm9yLWpzb24tNDA0JyxmdW5jdGlvbihlcnJvcix1cmwsIHNlbnREYXRhLCB4aHIpeyBcbiAgICAgICAgY29uc29sZS5lcnJvcignSlNPTiBlcnJvciAnLCBKU09OLnN0cmluZ2lmeShlcnJvcikpO1xuICAgICAgICBkZWxldGUgd2FpdGluZ0Nvbm5lY3Rpb25zW3VybC5zcGxpdCgnLycpWzBdXTtcbiAgICB9KTtcbiAgICB0aGlzLm9uKCdyZWFsdGltZS1tZXNzYWdlLWpzb24nLCBmdW5jdGlvbihtZXNzYWdlKXtcbiAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShtZXNzYWdlKTtcbiAgICB9KTtcblxuICAgIC8vIGluaXRpYWxpemF0aW9uXG4gICAgdmFyIFcyUFJFU09VUkNFID0gdGhpcztcbiAgICB2YXIgSURCID0ge2F1dGhfZ3JvdXAgOiBMYXp5KHt9KX07IC8vIHRhYmxlTmFtZSAtPiBkYXRhIGFzIEFycmF5XG4gICAgdmFyIElEWCA9IHt9OyAvLyB0YWJsZU5hbWUgLT4gTGF6eShpbmRleEJ5KCdpZCcpKSAtPiBJREJbZGF0YV1cbiAgICB2YXIgUkVWSURYID0ge307IC8vIHRhYmxlTmFtZSAtPiBmaWVsZE5hbWUgLT4gTGF6eS5ncm91cEJ5KCkgLT4gSURCW0RBVEFdXG4gICAgdmFyIGJ1aWxkZXJIYW5kbGVycyA9IHt9O1xuICAgIHZhciBidWlsZGVySGFuZGxlclVzZWQgPSB7fTtcbiAgICB2YXIgcGVyc2lzdGVudEF0dHJpYnV0ZXMgPSB7fTtcbiAgICB2YXIgZXZlbnRIYW5kbGVycyA9IHt9O1xuICAgIHZhciBwZXJtaXNzaW9uV2FpdGluZyA9IHt9O1xuICAgIHZhciBtb2RlbENhY2hlID0ge307XG4gICAgdmFyIGZhaWxlZE1vZGVscyA9IHt9O1xuICAgIHZhciB3YWl0aW5nQ29ubmVjdGlvbnMgPSB7fSAvLyBhY3R1YWwgY29ubmVjdGlvbiB3aG8gaSdtIHdhaXRpbmcgZm9yXG4gICAgdmFyIGxpc3RDYWNoZSA9IG5ldyBMaXN0Q2FjaGVyKExhenkpO1xuICAgIHZhciBsaW5rZXIgPSBuZXcgQXV0b0xpbmtlcih3YWl0aW5nQ29ubmVjdGlvbnMsSURCLCB0aGlzLCBsaXN0Q2FjaGUpO1xuLyogICAgd2luZG93LmxsID0gbGlua2VyO1xuICAgIHdpbmRvdy5sYyA9IGxpc3RDYWNoZTtcbiovXG4gICAgdGhpcy52YWxpZGF0aW9uRXZlbnQgPSB0aGlzLm9uKCdlcnJvci1qc29uLTUxMycsIGZ1bmN0aW9uKGRhdGEsIHVybCwgc2VudERhdGEsIHhocil7XG4gICAgICAgIGlmIChjdXJyZW50Q29udGV4dC5zYXZpbmdFcnJvckhhbmxkZXIpe1xuICAgICAgICAgICAgY3VycmVudENvbnRleHQuc2F2aW5nRXJyb3JIYW5sZGVyKG5ldyBWYWxpZGF0aW9uRXJyb3IoZGF0YSkpO1xuICAgICAgICB9XG4gICAgfSlcblxuICAgIHZhciBnZXRJbmRleCA9IGZ1bmN0aW9uIChpbmRleE5hbWUpIHtcbiAgICAgICAgaWYgKGluZGV4TmFtZSBpbiBJREIpXG4gICAgICAgICAgICByZXR1cm4gSURCW2luZGV4TmFtZV07XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgSURCW2luZGV4TmFtZV0gPSBMYXp5KHt9KTtcbiAgICAgICAgICAgIHJldHVybiBJREJbaW5kZXhOYW1lXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdmFyIGdldFVubGlua2VkID0gZnVuY3Rpb24gKGluZGV4TmFtZSkge1xuICAgICAgICBpZiAoaW5kZXhOYW1lIGluIFVOTElOS0VEKVxuICAgICAgICAgICAgcmV0dXJuIFVOTElOS0VEW2luZGV4TmFtZV07XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgVU5MSU5LRURbaW5kZXhOYW1lXSA9IHt9O1xuICAgICAgICAgICAgcmV0dXJuIFVOTElOS0VEW2luZGV4TmFtZV07XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gUGVybWlzc2lvblRhYmxlKGlkLCBrbGFzcywgcGVybWlzc2lvbnMpIHtcbiAgICAgICAgLy8gY3JlYXRlIFBlcm1pc3Npb25UYWJsZSBjbGFzc1xuICAgICAgICB0aGlzLmtsYXNzID0ga2xhc3M7XG4gICAgICAgIHRoaXMucGVybWlzc2lvbnMgPSBbXTtcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICBmb3IgKHZhciBrIGluIHBlcm1pc3Npb25zKSB7XG4gICAgICAgICAgICB0aGlzLnB1c2guYXBwbHkodGhpcywgW2ssIHBlcm1pc3Npb25zW2tdXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgUGVybWlzc2lvblRhYmxlLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgIC8vIHNhdmUgT2JqZWN0IHRvIHNlcnZlclxuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIHBlcm1pc3Npb25zOiBMYXp5KHRoaXMucGVybWlzc2lvbnMpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbeFswXS5pZCwgeFsxXV1cbiAgICAgICAgICAgIH0pLnRvT2JqZWN0KClcbiAgICAgICAgfTtcbiAgICAgICAgZGF0YS5pZCA9IHRoaXMuaWQ7XG4gICAgICAgIHZhciBtb2RlbE5hbWUgPSB0aGlzLmtsYXNzLm1vZGVsTmFtZTtcbiAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QodGhpcy5rbGFzcy5tb2RlbE5hbWUgKyAnL3NldF9wZXJtaXNzaW9ucycsIGRhdGEsIGZ1bmN0aW9uIChteVBlcm1zLCBhLCBiLCByZXEpIHtcbiAgICAgICAgICAgIGNiKG15UGVybXMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFBlcm1pc3Npb25UYWJsZS5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIChncm91cF9pZCwgcGVybWlzc2lvbkxpc3QpIHtcbiAgICAgICAgdmFyIHAgPSBMYXp5KHBlcm1pc3Npb25MaXN0KTtcbiAgICAgICAgdmFyIHBlcm1zID0gTGF6eSh0aGlzLmtsYXNzLmFsbFBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHJldHVybiBbeCwgcC5jb250YWlucyh4KV1cbiAgICAgICAgfSkudG9PYmplY3QoKTtcbiAgICAgICAgdmFyIGwgPSBMYXp5KHRoaXMucGVybWlzc2lvbnMpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuIHhbMF0uaWRcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChsLmNvbnRhaW5zKGdyb3VwX2lkKSlcbiAgICAgICAgICAgIHRoaXMucGVybWlzc2lvbnNbbC5pbmRleE9mKGdyb3VwX2lkKV1bMV0gPSBwZXJtcztcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdGhpcy5wZXJtaXNzaW9ucy5wdXNoKFtJREIuYXV0aF9ncm91cC5nZXQoZ3JvdXBfaWQpLCBwZXJtc10pO1xuICAgIH07XG5cbiAgICAvLyBjcmVhdGVzIGR5bmFtaWNhbCBtb2RlbHNcbiAgICB2YXIgbWFrZU1vZGVsQ2xhc3MgPSBmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgdmFyIF9tb2RlbCA9IG1vZGVsO1xuICAgICAgICBtb2RlbC5maWVsZHMuaWQucmVhZGFibGUgPSBmYWxzZTtcbiAgICAgICAgbW9kZWwuZmllbGRzLmlkLndyaXRhYmxlID0gZmFsc2U7XG4gICAgICAgIHZhciBmaWVsZHMgPSBMYXp5KG1vZGVsLmZpZWxkcyk7XG4gICAgICAgIGlmIChtb2RlbC5wcml2YXRlQXJncykge1xuICAgICAgICAgICAgZmllbGRzID0gZmllbGRzLm1lcmdlKG1vZGVsLnByaXZhdGVBcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCdtb2RlbC1kZWZpbml0aW9uJywgbW9kZWwsIGdldEluZGV4KG1vZGVsLm5hbWUpKTtcbiAgICAgICAgLy8gZ2V0dGluZyBmaWVsZHMgb2YgdHlwZSBkYXRlIGFuZCBkYXRldGltZVxuLypcbiAgICAgICAgdmFyIERBVEVGSUVMRFMgPSBmaWVsZHMuZmlsdGVyKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4gKHgudHlwZSA9PSAnZGF0ZScpIHx8ICh4LnR5cGUgPT0gJ2RhdGV0aW1lJylcbiAgICAgICAgfSkubWFwKGZ1bmN0aW9uICh4LCB2KSB7XG4gICAgICAgICAgICByZXR1cm4gW3YsIHRydWVdXG4gICAgICAgIH0pLnRvT2JqZWN0KCk7XG5cbiAgICAgICAgLy8gZ2V0dGluZyBib29sZWFuIGZpZWxkc1xuICAgICAgICB2YXIgQk9PTEZJRUxEUyA9IGZpZWxkcy5maWx0ZXIoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHJldHVybiAoeC50eXBlID09ICdib29sZWFuJylcbiAgICAgICAgfSkubWFwKGZ1bmN0aW9uICh4LCB2KSB7XG4gICAgICAgICAgICByZXR1cm4gW3YsIHRydWVdXG4gICAgICAgIH0pLnRvT2JqZWN0KCk7XG5cbiAgICAgICAgLy8gYm9vbGVhbnMgYW5kIGRhdGV0aW1lcyBzdG9yYWdlIGV4dGVybmFsIFxuICAgICAgICBNT0RFTF9EQVRFRklFTERTW21vZGVsLm5hbWVdID0gREFURUZJRUxEUztcbiAgICAgICAgTU9ERUxfQk9PTEZJRUxEU1ttb2RlbC5uYW1lXSA9IEJPT0xGSUVMRFM7XG4qL1xuICAgICAgICAvLyBpbml0aWFsaXphdGlvblxuICAgICAgICB2YXIgZnVuY1N0cmluZyA9IFwiaWYgKCFyb3cpIHsgcm93ID0ge319O1xcblwiO1xuICAgICAgICBmdW5jU3RyaW5nICs9IG1vZGVsLnJlZmVyZW5jZXMubWFwKGZ1bmN0aW9uKGZpZWxkKXtcbiAgICAgICAgICAgIHJldHVybiAndGhpcy5fJyArIGZpZWxkLmlkICsgJyA9IHJvdy4nICsgZmllbGQuaWQgKyAnOyc7XG4gICAgICAgIH0pLmpvaW4oJztcXG4nKTtcbiAgICAgICAgXG4gICAgICAgIC8vIGRhdGVmaWVsZCBjb252ZXJzaW9uXG4gICAgICAgIGZ1bmNTdHJpbmcgKz0gZmllbGRzLm1hcChmdW5jdGlvbiAoeCxrKSB7XG4gICAgICAgICAgICBpZiAoKHgudHlwZSA9PSAnZGF0ZScpIHx8ICh4LnR5cGUgPT0gJ2RhdGV0aW1lJykpe1xuICAgICAgICAgICAgICAgIHJldHVybiAndGhpcy4nICsgayArICcgPSByb3cuJyArIGsgKyAnP25ldyBEYXRlKHJvdy4nICsgayArICcgKiAxMDAwIC0gJyArIHV0aWxzLnR6T2Zmc2V0ICsgJyk6bnVsbDtcXG4nOyBcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoeC50eXBlID09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgIHJldHVybiAndGhpcy4nICsgayArICcgPSAocm93LicgKyBrICsgJyA9PT0gXCJUXCIpIHx8IChyb3cuJyArIGsgKyAnID09PSB0cnVlKTtcXG4nO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ3RoaXMuJyArIGsgKyAnID0gcm93LicgKyBrICsgJztcXG4nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS50b1N0cmluZygnXFxuJyk7ICsgJ1xcbic7XG5cbiAgICAgICAgZnVuY1N0cmluZyArPSBcImlmIChwZXJtaXNzaW9ucykge3RoaXMuX3Blcm1pc3Npb25zID0gcGVybWlzc2lvbnMgJiYgTGF6eShwZXJtaXNzaW9ucykubWFwKGZ1bmN0aW9uICh4KSB7IHJldHVybiBbeCwgdHJ1ZV0gfSkudG9PYmplY3QoKTt9XCJcblxuICAgICAgICBcbiAgICAgICAgLy8gbWFzdGVyIGNsYXNzIGZ1bmN0aW9uXG4gICAgICAgIHZhciBLbGFzcyA9IG5ldyBGdW5jdGlvbigncm93JywgJ3Blcm1pc3Npb25zJyxmdW5jU3RyaW5nKVxuXG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS5vcm0gPSBleHRPUk07XG4gICAgICAgIEtsYXNzLnJlZl90cmFuc2xhdGlvbnMgPSB7fTtcbiAgICAgICAgS2xhc3MubW9kZWxOYW1lID0gbW9kZWwubmFtZTtcbiAgICAgICAgS2xhc3MucmVmZXJlbmNlcyA9IExhenkobW9kZWwucmVmZXJlbmNlcykucGx1Y2soJ2lkJykudG9BcnJheSgpO1xuXG4gICAgICAgIEtsYXNzLmludmVyc2VfcmVmZXJlbmNlcyA9IG1vZGVsLnJlZmVyZW5jZWRCeS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIC8vIG1hbmFnaW5nIHJlZmVyZW5jZXMgd2hlcmUgXG4gICAgICAgICAgICByZXR1cm4geC5ieSArICdfJyArIHguaWQgKyAnX3NldCdcbiAgICAgICAgfSk7XG4gICAgICAgIEtsYXNzLnJlZmVyZW50cyA9IG1vZGVsLnJlZmVyZW5jZWRCeS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHJldHVybiBbeC5ieSwgeC5pZF1cbiAgICAgICAgfSk7XG4gICAgICAgIEtsYXNzLmZpZWxkc09yZGVyID0gbW9kZWwuZmllbGRPcmRlcjtcbiAgICAgICAgS2xhc3MuYWxsUGVybWlzc2lvbnMgPSBtb2RlbC5wZXJtaXNzaW9ucztcblxuICAgICAgICAvLyByZWRlZmluaW5nIHRvU3RyaW5nIG1ldGhvZFxuICAgICAgICBpZiAoTGF6eShtb2RlbC5yZXByZXNlbnRhdGlvbikuc2l6ZSgpKXtcbiAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZS50b1N0cmluZyA9IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMuJyArIExhenkobW9kZWwucmVwcmVzZW50YXRpb24pLnRvU3RyaW5nKCcgKyBcIiBcIiArIHRoaXMuJykpO1xuICAgICAgICB9XG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS50b1VwcGVyQ2FzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIHJlZGVmaW5lIHRvIFVwcGVyQ2FzZVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICB9O1xuICAgICAgXG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS50b0xvd2VyQ2FzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBkZWxldGUgaW5zdGFuY2UgZnJvbSBzZXJ2ZXJcbiAgICAgICAgICAgIHJldHVybiBleHRPUk0uZGVsZXRlKHRoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lLCBbdGhpcy5pZF0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHBlcm1pc3Npb24gZ2V0dGVyIHByb3BlcnR5XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLbGFzcy5wcm90b3R5cGUsICdwZXJtaXNzaW9ucycsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9wZXJtaXNzaW9ucylcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Blcm1pc3Npb25zO1xuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsaW5rZXIucGVybWlzc2lvbnNbdGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWVdLmFzayh0aGlzLmlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBnZXR0aW5nIGZ1bGwgcGVybWlzc2lvbiB0YWJsZSBmb3IgYW4gb2JqZWN0XG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS5hbGxfcGVybXMgPSBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgICAgIHZhciBvYmplY3RfaWQgPSB0aGlzLmlkO1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QodGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUgKyAnL2FsbF9wZXJtcycsIHtpZDogdGhpcy5pZH0sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBlcm1pc3Npb25zID0gZGF0YTtcbiAgICAgICAgICAgICAgICB2YXIgZ3JvdXBlZCA9IHt9O1xuICAgICAgICAgICAgICAgIHZhciB1bmtub3duX2dyb3VwcyA9IExhenkocGVybWlzc2lvbnMpLnBsdWNrKCdncm91cF9pZCcpLnVuaXF1ZSgpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJycgKyB4XG4gICAgICAgICAgICAgICAgfSkuZGlmZmVyZW5jZShJREIuYXV0aF9ncm91cC5rZXlzKCkpLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICBMYXp5KHBlcm1pc3Npb25zKS5ncm91cEJ5KGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4Lmdyb3VwX2lkXG4gICAgICAgICAgICAgICAgfSkuZWFjaChmdW5jdGlvbiAodiwgaykge1xuICAgICAgICAgICAgICAgICAgICBncm91cGVkW2tdID0gTGF6eSh2KS5wbHVjaygnbmFtZScpLnRvQXJyYXkoKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBjYWxsID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgY2IobmV3IFBlcm1pc3Npb25UYWJsZShvYmplY3RfaWQsIEtsYXNzLCBncm91cGVkKSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAodW5rbm93bl9ncm91cHMubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nZXQoJ2F1dGhfZ3JvdXAnLHVua25vd25fZ3JvdXBzLGNhbGwpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgY2FsbCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgS2xhc3MucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdmFyIG8gPSB0aGlzLmFzUmF3KCk7XG4gICAgICAgICAgICB2YXIgZmllbGRzID0gS2xhc3MuZmllbGRzO1xuICAgICAgICAgICAgdmFyIElEID0gdGhpcy5pZDtcbiAgICAgICAgICAgIHZhciBtb2RlbE5hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZTtcbiAgICAgICAgICAgIGlmIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYXJnIGluIGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgb1thcmddID0gYXJnc1thcmddO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGVsaW1pbmF0ZSB1bndyaXRhYmxlc1xuICAgICAgICAgICAgTGF6eShLbGFzcy5maWVsZHNPcmRlcikuZmlsdGVyKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgIHJldHVybiAhZmllbGRzW3hdLndyaXRhYmxlO1xuICAgICAgICAgICAgfSkuZWFjaChmdW5jdGlvbihmaWVsZE5hbWUpe1xuICAgICAgICAgICAgICAgIGlmIChmaWVsZE5hbWUgaW4gbykge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgb1tmaWVsZE5hbWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBXMlBSRVNPVVJDRS4kcG9zdChtb2RlbE5hbWUgKyAoSUQgPyAnL3Bvc3QnIDogJy9wdXQnKSwgbyk7XG4gICAgICAgICAgICBpZiAoYXJncyAmJiAoYXJncy5jb25zdHJ1Y3RvciA9PT0gRnVuY3Rpb24pKXtcbiAgICAgICAgICAgICAgICAvLyBwbGFjaW5nIGNhbGxiYWNrIGluIGEgY29tbW9uIHBsYWNlXG4gICAgICAgICAgICAgICAgcHJvbWlzZS5jb250ZXh0LnNhdmluZ0Vycm9ySGFubGRlciA9IGFyZ3M7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZVxuICAgICAgICB9O1xuICAgICAgICBLbGFzcy5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvYmogPSBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLmFzUmF3KCkpO1xuICAgICAgICAgICAgb2JqLl9wZXJtaXNzaW9ucyA9IHRoaXMuX3Blcm1pc3Npb25zO1xuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBidWlsZGluZyBzZXJpYWxpemF0aW9uIGZ1bmN0aW9uXG4gICAgICAgIHZhciBhc3IgPSAncmV0dXJuIHtcXG4nICsgTGF6eShtb2RlbC5yZWZlcmVuY2VzKS5tYXAoZnVuY3Rpb24oZmllbGQpe1xuICAgICAgICAgICAgcmV0dXJuIGZpZWxkLmlkICsgJyA6IHRoaXMuXycgKyBmaWVsZC5pZDtcbiAgICAgICAgfSkuY29uY2F0KGZpZWxkcy5tYXAoZnVuY3Rpb24gKHgsaykge1xuICAgICAgICAgICAgaWYgKCh4LnR5cGUgPT0gJ2RhdGUnKSB8fCAoeC50eXBlID09ICdkYXRldGltZScpKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gayArICcgOiAodGhpcy4nICsgayArICc/KE1hdGgucm91bmQodGhpcy4nICsgayArICcuZ2V0VGltZSgpIC0gdGhpcy4nICsgayArICcuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwMDAwKSAvIDEwMDApOm51bGwpJzsgXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHgudHlwZSA9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gayArICcgOiB0aGlzLicgKyBrICsgJz9cIlRcIjpcIkZcIic7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBrICsgJyA6IHRoaXMuJyArIGs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKS50b1N0cmluZygnLFxcbicpICsgJ307JztcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLmFzUmF3ID0gbmV3IEZ1bmN0aW9uKGFzcik7XG5cbiAgICAgICAgS2xhc3Muc2F2ZU11bHRpID0gZnVuY3Rpb24gKG9iamVjdHMsIGNiLCBzY29wZSkge1xuICAgICAgICAgICAgdmFyIHJhdyA9IFtdO1xuICAgICAgICAgICAgdmFyIGRlbGV0YWJsZSA9IExhenkoS2xhc3MuZmllbGRzKVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICF4LndyaXRhYmxlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAucGx1Y2soJ2lkJylcbiAgICAgICAgICAgICAgICAudG9BcnJheSgpO1xuICAgICAgICAgICAgTGF6eShvYmplY3RzKVxuICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHguYXNSYXcoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgTGF6eShkZWxldGFibGUpLmVhY2goZnVuY3Rpb24gKHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB4W3ldO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmF3LnB1c2goeCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdChLbGFzcy5tb2RlbE5hbWUsICdwdXQnLCB7bXVsdGlwbGU6IHJhdywgZm9ybUlkeCA6IFcyUFJFU09VUkNFLmZvcm1JZHgrK30sIGZ1bmN0aW9uIChlbGVtcykge1xuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdERhdGEoZWxlbXMpO1xuICAgICAgICAgICAgICAgIHZhciB0YWIgPSBJREJbS2xhc3MubW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICB2YXIgb2JqcyA9IExhenkoZWxlbXNbS2xhc3MubW9kZWxOYW1lXS5yZXN1bHRzKS5wbHVjaygnaWQnKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhYi5nZXQoeClcbiAgICAgICAgICAgICAgICB9KS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgaWYgKGNiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNiKG9ianMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHNjb3BlKTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCdleHRyYV92ZXJicycgaW4gbW9kZWwpXG4gICAgICAgICAgICBMYXp5KG1vZGVsLmV4dHJhX3ZlcmJzKS5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZ1bmNOYW1lID0geFswXTtcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IHhbMV07XG4gICAgICAgICAgICAgICAgdmFyIGRkYXRhID0gJ2RhdGEgPSB7aWQgOiB0aGlzLmlkJztcbiAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIGRkYXRhICs9ICcsICcgKyBMYXp5KGFyZ3MpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4ICsgJyA6ICcgKyB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkuam9pbignLCcpO1xuICAgICAgICAgICAgICAgIGRkYXRhICs9ICd9Oyc7XG4gICAgICAgICAgICAgICAgYXJncy5wdXNoKCdjYicpO1xuICAgICAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZVtmdW5jTmFtZV0gPSBuZXcgRnVuY3Rpb24oYXJncywgZGRhdGEgKyAnVzJTLlcyUF9QT1NUKHRoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lLFwiJyArIGZ1bmNOYW1lICsgJ1wiLCBkYXRhLGZ1bmN0aW9uKGRhdGEsc3RhdHVzLGhlYWRlcnMseCl7JyArXG4gICAgICAgICAgICAgICAgICAgICd0cnl7XFxuJyArXG4gICAgICAgICAgICAgICAgICAgICcgICBpZiAoIWhlYWRlcnMoXCJub21vZGVsXCIpKSB7d2luZG93LlcyUy5nb3REYXRhKGRhdGEsY2IpO31cXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJyAgIGVsc2Uge2lmIChjYikge2NiKGRhdGEpfX1cXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJ30gY2F0Y2goZSl7XFxuJyArXG4gICAgICAgICAgICAgICAgICAgICdpZiAoY2IpIHtjYihkYXRhKTt9XFxuJyArXG4gICAgICAgICAgICAgICAgICAgICd9XFxuJyArXG4gICAgICAgICAgICAgICAgICAgICd9KTtcXG4nXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBpZiAoJ3ByaXZhdGVBcmdzJyBpbiBtb2RlbCkge1xuICAgICAgICAgICAgS2xhc3MucHJpdmF0ZUFyZ3MgPSBMYXp5KG1vZGVsLnByaXZhdGVBcmdzKS5rZXlzKCkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFt4LCB0cnVlXTtcbiAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgICAgICBLbGFzcy5wcm90b3R5cGUuc2F2ZVBBID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgICAgICAgICB2YXIgVCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIG9vID0ge2lkOiB0aGlzLmlkfTtcbiAgICAgICAgICAgICAgICB2YXIgUEEgPSB0aGlzLmNvbnN0cnVjdG9yLnByaXZhdGVBcmdzO1xuICAgICAgICAgICAgICAgIHZhciBGcyA9IHRoaXMuY29uc3RydWN0b3IuZmllbGRzO1xuICAgICAgICAgICAgICAgIHZhciB0ID0gbmV3IHRoaXMuY29uc3RydWN0b3IobykuYXNSYXcoKTtcbiAgICAgICAgICAgICAgICB2YXIgZmllbGRJZHggPSBMYXp5KFBBKS5rZXlzKCkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbeCwgRnNbeF1dXG4gICAgICAgICAgICAgICAgfSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgICAgICBMYXp5KG8pLmVhY2goZnVuY3Rpb24gKHYsIGspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChrIGluIFBBKSAmJiBmaWVsZElkeFtrXS53cml0YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb29ba10gPSB2O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QodGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUgKyAnL3NhdmVQQScsIG9vLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIExhenkob28pLmVhY2goZnVuY3Rpb24gKHYsIGspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFRba10gPSB2O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBtb2RlbENhY2hlW0tsYXNzLm1vZGVsTmFtZV0gPSBLbGFzcztcbiAgICAgICAgLy8gYWRkaW5nIGlkIHRvIGZpZWxkc1xuICAgICAgICBmb3IgKHZhciBmIGluIG1vZGVsLmZpZWxkcykge1xuICAgICAgICAgICAgbW9kZWwuZmllbGRzW2ZdLmlkID0gZjtcbiAgICAgICAgfVxuICAgICAgICBLbGFzcy5maWVsZHMgPSBMYXp5KG1vZGVsLmZpZWxkcykuY29uY2F0KExhenkobW9kZWwucHJpdmF0ZUFyZ3MpKS5jb25jYXQoTGF6eShtb2RlbC5yZWZlcmVuY2VzKS50YXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHgudHlwZSA9IHgudHlwZSB8fCAncmVmZXJlbmNlJ1xuICAgICAgICB9KSkuaW5kZXhCeSgnaWQnKS50b09iamVjdCgpO1xuICAgICAgICAvLyBzZXR0aW5nIHdpZGdldHMgZm9yIGZpZWxkc1xuICAgICAgICBMYXp5KEtsYXNzLmZpZWxkcykuZWFjaChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICBpZiAoIWZpZWxkLndpZGdldCl7XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09ICdyZWZlcmVuY2UnKXtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQud2lkZ2V0ID0gJ2Nob2ljZXMnXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQud2lkZ2V0ID0gZmllbGQudHlwZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBidWlsZGluZyByZWZlcmVuY2VzIHRvIChtYW55IHRvIG9uZSkgZmllbGRzXG4gICAgICAgIExhenkobW9kZWwucmVmZXJlbmNlcykuZWFjaChmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgICAgICB2YXIgZXh0X3JlZiA9IHJlZi50bztcbiAgICAgICAgICAgIHZhciBsb2NhbF9yZWYgPSAnXycgKyByZWYuaWQ7XG4gICAgICAgICAgICBjYWNoZWRQcm9wZXJ0eUJ5RXZlbnRzKEtsYXNzLnByb3RvdHlwZSwgcmVmLmlkLGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShleHRfcmVmIGluIElEQikpe1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUoZXh0X3JlZixmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtlci5tYWluSW5kZXhbZXh0X3JlZl0uYXNrKHRoc1tsb2NhbF9yZWZdLHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IChleHRfcmVmIGluIElEQikgJiYgdGhpc1tsb2NhbF9yZWZdICYmIElEQltleHRfcmVmXS5nZXQodGhpc1tsb2NhbF9yZWZdKTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCAmJiAoZXh0X3JlZiBpbiBsaW5rZXIubWFpbkluZGV4KSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBhc2tpbmcgdG8gbGlua2VyXG4gICAgICAgICAgICAgICAgICAgIGxpbmtlci5tYWluSW5kZXhbZXh0X3JlZl0uYXNrKHRoaXNbbG9jYWxfcmVmXSx0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHV0aWxzLm1vY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUuY29uc3RydWN0b3IubW9kZWxOYW1lICE9IGV4dF9yZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1lvdSBjYW4gYXNzaWduIG9ubHkgJyArIGV4dF9yZWYgKyAnIHRvICcgKyByZWYuaWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNbbG9jYWxfcmVmXSA9IHZhbHVlLmlkO1xuICAgICAgICAgICAgfSwgJ25ldy0nICsgZXh0X3JlZiwgJ2RlbGV0ZWQtJyArIGV4dF9yZWYsJ3VwZGF0ZWQtJyArIGV4dF9yZWYsICduZXctbW9kZWwtJyArIGV4dF9yZWYpO1xuXG5cbiAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZVsnZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUocmVmLmlkKV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4dE9STS5nZXQoZXh0X3JlZix0aGlzW2xvY2FsX3JlZl0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9idWlsZGluZyByZWZlcmVuY2VzIHRvIChvbmUgdG8gbWFueSkgZmllbGRzXG4gICAgICAgIExhenkobW9kZWwucmVmZXJlbmNlZEJ5KS5lYWNoKGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgICAgICAgIHZhciBpbmRleE5hbWUgPSByZWYuYnkgKyAnLicgKyByZWYuaWQ7XG4gICAgICAgICAgICB2YXIgcHJvcGVydHlOYW1lID0gcmVmLmJ5ICsgJ18nICsgdXRpbHMucGx1cmFsaXplKHJlZi5pZCk7XG4gICAgICAgICAgICB2YXIgcmV2SW5kZXggPSByZWYuYnk7XG4gICAgICAgICAgICBpZiAoS2xhc3MucHJvdG90eXBlLmhhc093blByb3BlcnR5KHByb3BlcnR5TmFtZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdUcnllZCB0byByZWRlZmluZSBwcm9wZXJ0eSAnICsgcHJvcGVydHlOYW1lICsgJ3MnICsgJyBmb3IgJyArIEtsYXNzLm1vZGVsTmFtZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNhY2hlZFByb3BlcnR5QnlFdmVudHMoS2xhc3MucHJvdG90eXBlLCBwcm9wZXJ0eU5hbWUsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJldCA9IChyZXZJbmRleCBpbiBJREIpID8gUkVWSURYW2luZGV4TmFtZV0uZ2V0KHRoaXMuaWQgKyAnJyk6bnVsbDtcbiAgICAgICAgICAgICAgICAgICAgbGlua2VyLmZvcmVpZ25LZXlzW2luZGV4TmFtZV0uYXNrKHRoaXMuaWQsdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICAgICAgfSwgbnVsbCwgJ25ldy0nICsgcmV2SW5kZXgsICd1cGRhdGVkLScgKyByZXZJbmRleCwgJ2RlbGV0ZWQtJyArIHJldkluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZVsnZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUodXRpbHMucGx1cmFsaXplKHJlZi5ieSkpXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3B0cyA9IHt9O1xuICAgICAgICAgICAgICAgIG9wdHNbcmVmLmlkXSA9IFt0aGlzLmlkXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXh0T1JNLnF1ZXJ5KHJlZi5ieSxvcHRzKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vYnVpbGRpbmcgcmVmZXJlbmNlIHRvIChtYW55IHRvIG1hbnkpIGZpZWxkc1xuICAgICAgICBpZiAobW9kZWwubWFueVRvTWFueSkge1xuICAgICAgICAgICAgTGF6eShtb2RlbC5tYW55VG9NYW55KS5lYWNoKGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gcmVmLmluZGV4TmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3QgPSByZWYuZmlyc3Q/IDAgOiAxO1xuICAgICAgICAgICAgICAgIHZhciBvbW9kZWxOYW1lID0gcmVmLm1vZGVsO1xuLy8gICAgICAgICAgICAgICAgdmFyIG9tb2RlbCA9IGdldEluZGV4KG9tb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciBnZXR0ZXIgPSBsaW5rZXIubTJtSW5kZXhbaW5kZXhOYW1lXVsnZ2V0JyArICgxIC0gZmlyc3QpXTtcblxuICAgICAgICAgICAgICAgIGNhY2hlZFByb3BlcnR5QnlFdmVudHMoS2xhc3MucHJvdG90eXBlLCByZWYubW9kZWwgKyAncycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkcyA9IGdldHRlcih0aHMuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdldCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9XMlBSRVNPVVJDRS5mZXRjaChvbW9kZWxOYW1lLCB7aWQgOiBpZHN9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXQgPSBnZXRJbmRleChvbW9kZWxOYW1lKS5nZXQuYmluZChJREJbb21vZGVsTmFtZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRzICYmIGdldClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXQgPSBMYXp5KGlkcykubWFwKGdldCkuZmlsdGVyKHV0aWxzLmJvb2wpLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICAgICAgICAgIH0sIG51bGwsICdyZWNlaXZlZC1tMm0tJyArIGluZGV4TmFtZSwgJ3JlY2VpdmVkLScgKyBvbW9kZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZVsnZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUodXRpbHMucGx1cmFsaXplKG9tb2RlbE5hbWUpKV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3Qpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rZXIuZ2V0TTJNKGluZGV4TmFtZSwgW3Rocy5pZF0sIGZpcnN0LGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWRzID0gZ2V0dGVyKHRocy5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmZldGNoKG9tb2RlbE5hbWUsIHtpZCA6IGlkc30sbnVsbCxmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnZXQgPSBJREJbb21vZGVsTmFtZV0uZ2V0LmJpbmQoSURCW29tb2RlbE5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQoTGF6eShpZHMpLm1hcChnZXQpLmZpbHRlcih1dGlscy5ib29sKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQoW10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAgICAgS2xhc3MuZmllbGRzW3V0aWxzLmNhcGl0YWxpemUob21vZGVsTmFtZSldID0ge1xuICAgICAgICAgICAgICAgICAgICBpZDogdXRpbHMuY2FwaXRhbGl6ZShvbW9kZWxOYW1lKSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogdXRpbHMuY2FwaXRhbGl6ZShvbW9kZWxOYW1lKSxcbiAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHJlYWRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTTJNJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdG9yczogW11cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlLnVubGlua1JlZmVyZW5jZSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHZhciBtdWx0aXBsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBJRCA9IHRoaXMuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5jb25zdHJ1Y3Rvci5uYW1lID09ICdBcnJheScpIHtcbiAgICAgICAgICAgICAgICAgICAgbXVsdGlwbGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZXMgPSBpbnN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBpbnN0YW5jZXNbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBvbW9kZWwgPSBpbnN0YW5jZS5jb25zdHJ1Y3Rvci5tb2RlbE5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKG11bHRpcGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gTGF6eShpbnN0YW5jZXMpLnBsdWNrKCdpZCcpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtJRCwgeF1cbiAgICAgICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gW1tJRCwgaW5zdGFuY2UuaWRdXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QoS2xhc3MubW9kZWxOYW1lICsgJy8nICsgb21vZGVsICsgJ3MvZGVsZXRlJywge2NvbGxlY3Rpb246IGNvbGxlY3Rpb259KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZS5saW5rUmVmZXJlbmNlID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG11bHRpcGxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIElEID0gdGhpcy5pZDtcbiAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2VzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLmNvbnN0cnVjdG9yLm5hbWUgPT0gJ0FycmF5Jykge1xuICAgICAgICAgICAgICAgICAgICBtdWx0aXBsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlcyA9IGluc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZSA9IGluc3RhbmNlc1swXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG9tb2RlbCA9IGluc3RhbmNlLmNvbnN0cnVjdG9yLm1vZGVsTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gS2xhc3MubW9kZWxOYW1lICsgJy8nICsgb21vZGVsO1xuICAgICAgICAgICAgICAgIGlmIChtdWx0aXBsZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVmcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXhOYW1lIGluIElOREVYX00yTSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcyA9IExhenkoaW5zdGFuY2VzKS5wbHVjaygnaWQnKS5kaWZmZXJlbmNlKExhenkoSU5ERVhfTTJNW2luZGV4TmFtZV1bMF0uZ2V0KHRoaXMuaWQpKSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGluZGV4TmFtZSA9IG9tb2RlbCArICcvJyArIEtsYXNzLm1vZGVsTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4TmFtZSBpbiBJTkRFWF9NMk0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnMgPSBMYXp5KGluc3RhbmNlcykucGx1Y2soJ2lkJykuZGlmZmVyZW5jZShMYXp5KElOREVYX00yTVtpbmRleE5hbWVdWzBdLmdldCh0aGlzLmlkKSkpLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocmVmcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gTGF6eShyZWZzKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW0lELCB4XVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgVzJQX1BPU1QoS2xhc3MubW9kZWxOYW1lLCBvbW9kZWwgKyAncy9wdXQnLCB7Y29sbGVjdGlvbjogY29sbGVjdGlvbn0sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoaW5kZXhOYW1lIGluIGxpbmtlci5tMm1JbmRleCkgJiYgTGF6eShsaW5rZXIubTJtSW5kZXhbaW5kZXhOYW1lXVsnZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUob21vZGVsKV0oaW5zdGFuY2UuaWQpKS5maW5kKHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QoS2xhc3MubW9kZWxOYW1lICsgJy8nICsgb21vZGVsICsgJ3MvcHV0Jywge2NvbGxlY3Rpb246IFtbdGhpcy5pZCwgaW5zdGFuY2UuaWRdXX0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgnbmV3LW1vZGVsJywgS2xhc3MpO1xuICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCduZXctbW9kZWwtJyArIEtsYXNzLm1vZGVsTmFtZSk7XG4gICAgICAgIHJldHVybiBLbGFzcztcbiAgICB9O1xuXG4gICAgdGhpcy5nb3REYXRhID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxCYWNrKSB7XG4gICAgICAgIC8vIHJlY2VpdmUgYWxsIGRhdGEgZnJvbSBldmVyeSBlbmQgcG9pbnRcbiAgICAgICAgY29uc29sZS5pbmZvKCdnb3REYXRhJyk7XG4gICAgICAgIGlmICh0eXBlb2YoZGF0YSkgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkYXRhICcgKyBkYXRhICsgJyByZWZ1c2VkIGZyb20gZ290RGF0YSgpJyk7XG4gICAgICAgICAgICBpZiAoY2FsbEJhY2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbEJhY2soZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gY2xlYW4gZGF0YSBmcm9tIHJlbGF0aW9ucyBhbmQgcGVybWlzc2lvbnMgZm9yIHVzaW5nIGl0IGFmdGVyIG1vZGVsIHBhcnNpbmdcbiAgICAgICAgaWYgKCdfZXh0cmEnIGluIGRhdGEpeyBkZWxldGUgZGF0YS5fZXh0cmEgfVxuICAgICAgICB2YXIgVE9PTkUgPSBkYXRhLlRPT05FO1xuICAgICAgICB2YXIgVE9NQU5ZID0gZGF0YS5UT01BTlk7XG4gICAgICAgIHZhciBNQU5ZVE9NQU5ZID0gZGF0YS5NQU5ZVE9NQU5ZO1xuICAgICAgICB2YXIgUEVSTUlTU0lPTlMgPSBkYXRhLlBFUk1JU1NJT05TO1xuICAgICAgICB2YXIgUEEgPSBkYXRhLlBBO1xuICAgICAgICBkZWxldGUgZGF0YS5UT09ORTtcbiAgICAgICAgZGVsZXRlIGRhdGEuVE9NQU5ZO1xuICAgICAgICBkZWxldGUgZGF0YS5NQU5ZVE9NQU5ZO1xuICAgICAgICBkZWxldGUgZGF0YS5QRVJNSVNTSU9OUztcbiAgICAgICAgZGVsZXRlIGRhdGEuUEE7XG4gICAgICAgIGlmICghUEEpIHsgUEEgPSB7fTsgfVxuXG4gICAgICAgIC8vIGNsZWFuaW5nIGZyb20gdXNlbGVzcyBkZWxldGVkIGRhdGFcbiAgICAgICAgZGF0YSA9IExhenkoZGF0YSkuZmlsdGVyKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICByZXR1cm4gKCEoJ2RlbGV0ZWQnIGluIHYpIHx8ICgoayBpbiBtb2RlbENhY2hlKSkpO1xuICAgICAgICB9KS50b09iamVjdCgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCdtMm0nIGluIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBtMm0gPSBkYXRhLm0ybTtcbiAgICAgICAgICAgIGRlbGV0ZSBkYXRhWydtMm0nXTtcbiAgICAgICAgfVxuICAgICAgICBMYXp5KGRhdGEpLmVhY2goZnVuY3Rpb24gKGRhdGEsIG1vZGVsTmFtZSkge1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUobW9kZWxOYW1lLCBmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWxDbGFzcyA9IG1vZGVsO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLnJlc3VsdHMgJiYgKGRhdGEucmVzdWx0cy5sZW5ndGggPiAwKSAmJiAoZGF0YS5yZXN1bHRzWzBdLmNvbnN0cnVjdG9yID09IEFycmF5KSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMgPSBMYXp5KGRhdGEucmVzdWx0cykubWFwKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIExhenkobW9kZWxDbGFzcy5maWVsZHNPcmRlcikuemlwKHgpLnRvT2JqZWN0KClcbiAgICAgICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IExhenkoZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICB2YXIgZGVsZXRlZCA9IGRhdGEuZGVsZXRlZDtcbiAgICAgICAgICAgICAgICBpZiAobW9kZWxOYW1lIGluIFBBKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBNUEEgPSBQQVttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICBMYXp5KHJlc3VsdHMpLmVhY2goZnVuY3Rpb24gKHJlY29yZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlY29yZC5pZCBpbiBNUEEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMYXp5KE1QQVtyZWNvcmQuaWRdKS5lYWNoKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY29yZFtrXSA9IHY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gaW5kZXhpbmcgcmVmZXJlbmNlcyBieSBpdHMgSURcbiAgICAgICAgICAgICAgICB2YXIgaXRhYiA9IGdldEluZGV4KG1vZGVsTmFtZSk7XG4gICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gaXRhYi5zb3VyY2U7XG5cbiAgICAgICAgICAgICAgICAvLyBvYmplY3QgZGVsZXRpb25cbiAgICAgICAgICAgICAgICBpZiAoZGVsZXRlZCl7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZWQuZm9yRWFjaChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YWJsZVt4XTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4vKlxuICAgICAgICAgICAgICAgIExhenkoZGVsZXRlZCkuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFibGVbeF07XG4gICAgICAgICAgICAgICAgfSk7XG4qL1xuICAgICAgICAgICAgICAgIHZhciBpZHggPSByZXN1bHRzLmluZGV4QnkoJ2lkJyk7XG4gICAgICAgICAgICAgICAgdmFyIGlrID0gaWR4LmtleXMoKTtcbiAgICAgICAgICAgICAgICB2YXIgbm5ldyA9IGlrLmRpZmZlcmVuY2UoaXRhYi5rZXlzKCkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh4KVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZCA9IGlrLmRpZmZlcmVuY2Uobm5ldyk7XG4gICAgICAgICAgICAgICAgLy8gcmVtb3Zpbmcgb2xkIGlkZW50aWNhbCB2YWx1ZXNcbiAgICAgICAgICAgICAgICB1cGRhdGVkID0gdXBkYXRlZC5maWx0ZXIoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICF1dGlscy5zYW1lQXMoaWR4LmdldCh4KSwgaXRhYi5nZXQoeCkuYXNSYXcoKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gY2xhc3NpZnkgcmVjb3Jkc1xuICAgICAgICAgICAgICAgIHZhciBwZXJtcyA9IGRhdGEucGVybWlzc2lvbnMgPyBMYXp5KGRhdGEucGVybWlzc2lvbnMpIDogTGF6eSh7fSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld09iamVjdHMgPSBubmV3Lm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IG1vZGVsQ2xhc3MoaWR4LmdldCh4KSwgcGVybXMuZ2V0KHgpKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8vLyBjbGFzc2lmeWluZyB1cGRhdGVkXG4gICAgICAgICAgICAgICAgLy92YXIgdXBkYXRlZE9iamVjdHMgPSB1cGRhdGVkLm1hcChmdW5jdGlvbih4KXtyZXR1cm4gbmV3IG1vZGVsQ2xhc3MoaWR4LmdldCh4KSxwZXJtcy5nZXQoeCkpfSk7XG4gICAgICAgICAgICAgICAgLy92YXIgdW8gPSB1cGRhdGVkT2JqZWN0cy50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgLy91cGRhdGVkT2JqZWN0cyA9IExhenkodW8pLm1hcChmdW5jdGlvbih4KXtyZXR1cm4gW3gsdGFibGVbeC5pZF1dfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIC8vIFVwZGF0aW5nIHNpbmdsZSBvYmplY3RzXG4gICAgICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBbXTtcbi8vICAgICAgICAgICAgICAgIHZhciBEQVRFRklFTERTID0gTU9ERUxfREFURUZJRUxEU1ttb2RlbE5hbWVdO1xuLy8gICAgICAgICAgICAgICAgdmFyIEJPT0xGSUVMRFMgPSBNT0RFTF9CT09MRklFTERTW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgdXBkYXRlZC5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRJdGVtID0gaXRhYi5nZXQoeCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRDb3B5ID0gb2xkSXRlbS5jb3B5KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtID0gbmV3IG1vZGVsQ2xhc3MoaWR4LmdldCh4KSk7XG4gICAgICAgICAgICAgICAgICAgIExhenkobW9kZWwuZmllbGRzKS5rZXlzKCkuZWFjaChmdW5jdGlvbihrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZEl0ZW1ba10gPSBuZXdJdGVtW2tdO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZC5wdXNoKFtvbGRJdGVtLCBvbGRDb3B5XSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLy8vIHNlbmRpbmcgc2lnbmFsIGZvciB1cGRhdGVkIHZhbHVlc1xuICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VkLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCd1cGRhdGVkLScgKyBtb2RlbE5hbWUsIGNoYW5nZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyoqKioqKioqIFVwZGF0ZSB1bml2ZXJzZSAqKioqKioqKlxuICAgICAgICAgICAgICAgIHZhciBubyA9IG5ld09iamVjdHMudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIExhenkobm8pLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVbeC5pZF0gPSB4XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gcmVidWxkaW5nIHJldmVyc2UgaW5kZXhlc1xuICAgICAgICAgICAgICAgIExhenkobW9kZWxDYWNoZVttb2RlbE5hbWVdLnJlZmVyZW5jZXMpLmVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgICAgICAgICAgICAgICBSRVZJRFhbbW9kZWxOYW1lICsgJy4nICsgcmVmXSA9IElEQlttb2RlbE5hbWVdLmdyb3VwQnkoJ18nICsgcmVmKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBzZW5kaW5nIGV2ZW50cyBmb3IgbmV3IHZhbHVlc1xuICAgICAgICAgICAgICAgIGlmIChuby5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ25ldy0nICsgbW9kZWxOYW1lLCBMYXp5KG5vKSwgZGF0YS50b3RhbFJlc3VsdHMpO1xuICAgICAgICAgICAgICAgIGlmIChkZWxldGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ2RlbGV0ZWQtJyArIG1vZGVsTmFtZSwgZGVsZXRlZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHNlbmRpbmcgZXZlbnRzIGZvciBkYXRhIGFycml2ZWRcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCdyZWNlaXZlZC0nICsgbW9kZWxOYW1lKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKFRPT05FKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdUT09ORScpO1xuICAgICAgICAgICAgTGF6eShUT09ORSkuZWFjaChmdW5jdGlvbiAodmFscywgbW9kZWxOYW1lKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cobW9kZWxOYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgdWR4ID0gZ2V0VW5saW5rZWQobW9kZWxOYW1lKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChUT01BTlkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RPTUFOWScpO1xuICAgICAgICAgICAgTGF6eShUT01BTlkpLmVhY2goZnVuY3Rpb24gKHZhbHMsIGluZGV4TmFtZSkge1xuICAgICAgICAgICAgICAgIGlmICghKGluZGV4TmFtZSBpbiBBU0tFRF9VTkxJTktFRCkpIHtcbiAgICAgICAgICAgICAgICAgICAgQVNLRURfVU5MSU5LRURbaW5kZXhOYW1lXSA9IExhenkoW10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBMYXp5KHZhbHMpLmVhY2goZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIEFTS0VEX1VOTElOS0VEW2luZGV4TmFtZV0uc291cmNlLnB1c2goaWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE1BTllUT01BTlkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ01BTllUT01BTlknKTtcbiAgICAgICAgICAgIExhenkoTUFOWVRPTUFOWSkuZWFjaChmdW5jdGlvbiAodmFscywgaW5kZXhOYW1lKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0ID0gcGFyc2VJbnQoaW5kZXhOYW1lLnNwbGl0KCd8JylbMV0pO1xuICAgICAgICAgICAgICAgIGluZGV4TmFtZSA9IGluZGV4TmFtZS5zcGxpdCgnfCcpWzBdO1xuICAgICAgICAgICAgICAgIGlmICghKGluZGV4TmFtZSBpbiBBU0tFRF9NMk0pKSB7XG4gICAgICAgICAgICAgICAgICAgIEFTS0VEX00yTVtpbmRleE5hbWVdID0gW3t9LCB7fV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBNSURYID0gQVNLRURfTTJNW2luZGV4TmFtZV1bZmlyc3RdO1xuICAgICAgICAgICAgICAgIExhenkodmFscykuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICBNSURYW3ggKyAnJ10gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBNSURYW3hdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtMm0pIHtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdE0yTShtMm0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChQRVJNSVNTSU9OUykge1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290UGVybWlzc2lvbnMoUEVSTUlTU0lPTlMpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNhbGxCYWNrKSB7XG4gICAgICAgICAgICBjYWxsQmFjayhkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCdnb3QtZGF0YScpO1xuICAgIH07XG4gICAgdGhpcy5nb3RQZXJtaXNzaW9ucyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIExhenkoZGF0YSkuZWFjaChmdW5jdGlvbiAodiwgcmVzb3VyY2VOYW1lKSB7XG4gICAgICAgICAgICBMYXp5KHZbMF0pLmVhY2goZnVuY3Rpb24gKHJvdywgaWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoKHJlc291cmNlTmFtZSBpbiBJREIpICYmIChpZCBpbiBJREJbcmVzb3VyY2VOYW1lXS5zb3VyY2UpKXtcbiAgICAgICAgICAgICAgICAgICAgSURCW3Jlc291cmNlTmFtZV0uZ2V0KGlkKS5fcGVybWlzc2lvbnMgPSBMYXp5KHJvdykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3gsIHRydWVdXG4gICAgICAgICAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoTGF6eSh2WzBdKS5zaXplKCkpe1xuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ3VwZGF0ZS1wZXJtaXNzaW9ucy0nICsgcmVzb3VyY2VOYW1lLCBMYXp5KHZbMF0pLmtleXMoKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5lbWl0KCd1cGRhdGUtcGVybWlzc2lvbnMnKTtcbiAgICB9O1xuXG5cbiAgICB0aGlzLmdvdE0yTSA9IGZ1bmN0aW9uKG0ybSl7XG4gICAgICAgIExhenkobTJtKS5lYWNoKGZ1bmN0aW9uKGRhdGEsIGluZGV4TmFtZSl7XG4gICAgICAgICAgICB2YXIgbTJtSW5kZXggPSBsaW5rZXIubTJtSW5kZXhbaW5kZXhOYW1lXTtcbiAgICAgICAgICAgIExhenkoZGF0YSkuZWFjaChmdW5jdGlvbihtKXtcbiAgICAgICAgICAgICAgICBMYXp5KG0pLmVhY2goZnVuY3Rpb24oZGF0YSx2ZXJiKXtcbiAgICAgICAgICAgICAgICAgICAgbTJtSW5kZXhbdmVyYl0oZGF0YSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ3JlY2VpdmVkLW0ybScpO1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgncmVjZWl2ZWQtbTJtLScgKyBpbmRleE5hbWUpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLmZldGNoID0gZnVuY3Rpb24gKG1vZGVsTmFtZSwgZmlsdGVyLCB0b2dldGhlciwgY2FsbEJhY2spIHsgIC8vXG4gICAgICAgIC8vIGlmIGEgY29ubmVjdGlvbiBpcyBjdXJyZW50bHkgcnVubmluZywgd2FpdCBmb3IgY29ubmVjdGlvbi5cbiAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiB3YWl0aW5nQ29ubmVjdGlvbnMpe1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmZldGNoKG1vZGVsTmFtZSwgZmlsdGVyLCB0b2dldGhlciwgY2FsbEJhY2spO1xuICAgICAgICAgICAgfSw1MDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZmV0Y2hpbmcgYXN5bmNocm9tb3VzIG1vZGVsIGZyb20gc2VydmVyXG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5kZXNjcmliZShtb2RlbE5hbWUsIChmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgICAgICAgICAgLy8gaWYgZGF0YSBjYW1lcyBmcm9tIHJlYWx0aW1lIGNvbm5lY3Rpb25cbiAgICAgICAgICAgICAgICBpZiAoVzJQUkVTT1VSQ0UuY29ubmVjdGlvbi5jYWNoZWRTdGF0dXMucmVhbHRpbWVFbmRQb2ludCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBnZXR0aW5nIGZpbHRlciBmaWx0ZXJlZCBieSBjYWNoaW5nIHN5c3RlbVxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXIgPSBsaXN0Q2FjaGUuZmlsdGVyKG1vZGVsLGZpbHRlcik7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgc29tdGhpbmcgaXMgbWlzc2luZyBvbiBteSBsb2NhbCBEQiBcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbHRlcil7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhc2sgZm9yIG1pc3NpbmdzIGFuZCBwYXJzZSBzZXJ2ZXIgcmVzcG9uc2UgaW4gb3JkZXIgdG8gZW5yaWNoIG15IGxvY2FsIERCLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGxhY2luZyBsb2NrIGZvciB0aGlzIG1vZGVsXG4gICAgICAgICAgICAgICAgICAgICAgICB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdChtb2RlbE5hbWUgKyAnL2xpc3QnLCB7ZmlsdGVyIDogZmlsdGVyfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShkYXRhLGNhbGxCYWNrKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZWxlYXNlIGxvY2tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHdhaXRpbmdDb25uZWN0aW9uc1ttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJldCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbGVhc2UgbG9ja1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2FpdGluZ0Nvbm5lY3Rpb25zW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmaWx0ZXI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcG9zdChtb2RlbE5hbWUgKyAnL2xpc3QnLCBzZW5kRGF0YSxmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZmlsdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdPVF9BTEwuc291cmNlLnB1c2gobW9kZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShkYXRhLCBjYWxsQmFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmdldCA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgaWRzLCBjYWxsQmFjayl7XG4gICAgICAgIC8vIHNlYXJjaCBvYmplY3RzIGZyb20gSURCLiBJZiBzb21lIGlkIGlzIG1pc3NpbmcsIGl0IHJlc29sdmUgaXQgYnkgdGhlIHNlcnZlclxuICAgICAgICAvLyBpZiBhIHJlcXVlc3QgdG8gdGhlIHNhbWUgbW9kZWwgaXMgcGVuZGluZywgd2FpdCBmb3IgaXRzIGNvbXBsZXRpb25cbiAgICAgICAgXG4gICAgICAgIGlmIChpZHMuY29uc3RydWN0b3IgIT09IEFycmF5KXtcbiAgICAgICAgICAgIGlkcyA9IFtpZHNdO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIHNvbWUgZW50aXR5IGlzIG1pc3NpbmcgXG4gICAgICAgIFcyUFJFU09VUkNFLmZldGNoKG1vZGVsTmFtZSAsIHtpZDogaWRzfSwgbnVsbCxmdW5jdGlvbigpe1xuICAgICAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICAgICAgdmFyIGl0YWIgPSBJREJbbW9kZWxOYW1lXVxuICAgICAgICAgICAgZm9yICh2YXIgaWQgaW4gaWRzKXtcbiAgICAgICAgICAgICAgICByZXQucHVzaChpdGFiLnNvdXJjZVtpZHNbaWRdXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYWxsQmFjayhyZXQpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdGhpcy5nb3RNb2RlbCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGZvciAodmFyIG1vZGVsTmFtZSBpbiBkYXRhKSB7XG4gICAgICAgICAgICB2YXIgbW9kZWwgPSBkYXRhW21vZGVsTmFtZV07XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2VbJ2Rlc2NyaXB0aW9uOicgKyBtb2RlbE5hbWVdID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG4gICAgICAgICAgICBtb2RlbENhY2hlW21vZGVsTmFtZV0gPSBtYWtlTW9kZWxDbGFzcyhtb2RlbCk7XG4gICAgICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gSURCKSkge1xuICAgICAgICAgICAgICAgIElEQlttb2RlbE5hbWVdID0gTGF6eSh7fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5kZXNjcmliZSA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgY2FsbEJhY2spe1xuICAgICAgICB2YXIgcmV0ID0gbW9kZWxDYWNoZVttb2RlbE5hbWVdO1xuICAgICAgICBpZiAocmV0KSB7XG4gICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayhyZXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKCEobW9kZWxOYW1lIGluIHdhaXRpbmdDb25uZWN0aW9ucykpe1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gZmFpbGVkTW9kZWxzKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjYWNoZUtleSA9ICdkZXNjcmlwdGlvbjonICsgbW9kZWxOYW1lO1xuICAgICAgICAgICAgICAgIGlmIChjYWNoZUtleSBpbiBsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nb3RNb2RlbChKU09OLnBhcnNlKGxvY2FsU3RvcmFnZVtjYWNoZUtleV0pKTtcbiAgICAgICAgICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2sobW9kZWxDYWNoZVttb2RlbE5hbWVdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJHBvc3QobW9kZWxOYW1lICsgJy9kZXNjcmliZScsbnVsbCwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3RNb2RlbChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKG1vZGVsQ2FjaGVbbW9kZWxOYW1lXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2FpdGluZ0Nvbm5lY3Rpb25zW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2RlbE5vdEZvdW5kLmhhbmRsZShtb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbGVkTW9kZWxzW21vZGVsTmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHdhaXQgZm9yIGNvbm5lY3Rpb25cbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmRlc2NyaWJlKG1vZGVsTmFtZSwgY2FsbEJhY2spO1xuICAgICAgICAgICAgICAgIH0sIDUwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gICAgICAgIFxuICAgIH07XG4gICAgdGhpcy5hZGRNb2RlbEhhbmRsZXIgPSBmdW5jdGlvbiAobW9kZWxOYW1lLCBkZWNvcmF0b3IpIHtcbiAgICAgICAgdmFyIGtleSA9IHV0aWxzLmhhc2goZGVjb3JhdG9yKTtcbiAgICAgICAgaWYgKCEobW9kZWxOYW1lIGluIGJ1aWxkZXJIYW5kbGVycykpIGJ1aWxkZXJIYW5kbGVyc1ttb2RlbE5hbWVdID0gbmV3IEhhbmRsZXIoKTtcbiAgICAgICAgaWYgKCEobW9kZWxOYW1lIGluIGJ1aWxkZXJIYW5kbGVyVXNlZCkpIGJ1aWxkZXJIYW5kbGVyVXNlZFttb2RlbE5hbWVdID0ge307XG4gICAgICAgIGlmIChrZXkgaW4gYnVpbGRlckhhbmRsZXJVc2VkW21vZGVsTmFtZV0pe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVpbGRlckhhbmRsZXJVc2VkW21vZGVsTmFtZV1ba2V5XSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBtb2RlbENhY2hlKSB7XG4gICAgICAgICAgICBkZWNvcmF0b3IobW9kZWxDYWNoZVttb2RlbE5hbWVdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1aWxkZXJIYW5kbGVyc1ttb2RlbE5hbWVdLmFkZEhhbmRsZXIoZGVjb3JhdG9yKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5hZGRQZXJzaXN0ZW50QXR0cmlidXRlcyA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgYXR0cmlidXRlcyl7XG4gICAgICAgIHZhciBhZGRQcm9wZXJ0eSA9IGZ1bmN0aW9uKG1vZGVsLCBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbCl7XG4gICAgICAgICAgICB2YXIga2V5ID0gJ3BBOicgKyBtb2RlbC5tb2RlbE5hbWUgKyAnOicgKyB2YWw7XG4gICAgICAgICAgICB2YXIga2F0dHIgPSAnX18nICsgdmFsO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZGVsLnByb3RvdHlwZSwgdmFsLCB7XG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZiAoIShrYXR0ciBpbiB0aGlzKSl7XG4gICAgICAgICAgICAgICAgICB2YXIgdiA9IGxvY2FsU3RvcmFnZVtrZXkgKyB0aGlzLmlkXTtcbiAgICAgICAgICAgICAgICAgIHRoaXNba2F0dHJdID0gdj9KU09OLnBhcnNlKHYpOm51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW2thdHRyXTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgICAgICAgICAgdGhpc1trYXR0cl0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Vba2V5ICsgdGhpcy5pZF0gPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gcGVyc2lzdGVudEF0dHJpYnV0ZXMpKSB7IHBlcnNpc3RlbnRBdHRyaWJ1dGVzW21vZGVsTmFtZV0gPSBbXTsgfVxuICAgICAgICB2YXIgYXR0cnMgPSBwZXJzaXN0ZW50QXR0cmlidXRlc1ttb2RlbE5hbWVdO1xuICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgdmFyIG5ld0F0dHJzID0gTGF6eShhdHRyaWJ1dGVzKS5kaWZmZXJlbmNlKGF0dHJzKS50b0FycmF5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgbmV3QXR0cnMgPSBhdHRycztcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3QXR0cnMubGVuZ3RoKXtcbiAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gbW9kZWxDYWNoZSl7XG4gICAgICAgICAgICAgICAgYWRkUHJvcGVydHkobW9kZWxDYWNoZVttb2RlbE5hbWVdLCBuZXdBdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcyl7XG4gICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoYXR0cnMsbmV3QXR0cnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICB0aGlzLm9uKCduZXctbW9kZWwnLCBmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgIGlmIChtb2RlbC5tb2RlbE5hbWUgaW4gYnVpbGRlckhhbmRsZXJzKXtcbiAgICAgICAgICAgIGJ1aWxkZXJIYW5kbGVyc1ttb2RlbC5tb2RlbE5hbWVdLmhhbmRsZShtb2RlbENhY2hlW21vZGVsLm1vZGVsTmFtZV0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb2RlbC5tb2RlbE5hbWUgaW4gcGVyc2lzdGVudEF0dHJpYnV0ZXMpe1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuYWRkUGVyc2lzdGVudEF0dHJpYnV0ZXMobW9kZWwubW9kZWxOYW1lKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5xdWVyeSA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgZmlsdGVyLCB0b2dldGhlciwgY2FsbEJhY2spe1xuICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgdGhpcy5kZXNjcmliZShtb2RlbE5hbWUsZnVuY3Rpb24obW9kZWwpe1xuICAgICAgICAgICAgLy8gYXJyYXlmaXkgYWxsIGZpbHRlciB2YWx1ZXNcbiAgICAgICAgICAgIGZpbHRlciA9IExhenkoZmlsdGVyKS5tYXAoZnVuY3Rpb24odixrKXsgcmV0dXJuIFtrLEFycmF5LmlzQXJyYXkodik/djpbdl1dfSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgIHZhciBmaWx0ZXJGdW5jdGlvbiA9IHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICB2YXIgaWR4ID0gZ2V0SW5kZXgobW9kZWxOYW1lKTtcbiAgICAgICAgICAgIHRocy5mZXRjaChtb2RlbE5hbWUsZmlsdGVyLHRvZ2V0aGVyLCBmdW5jdGlvbihlKXtcbiAgICAgICAgICAgICAgICBjYWxsQmFjayhpZHguZmlsdGVyKGZpbHRlckZ1bmN0aW9uKS52YWx1ZXMoKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgfTtcbiAgICB0aGlzLmRlbGV0ZSA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgaWRzLCBjYWxsQmFjayl7XG4gICAgICAgIHJldHVybiB0aGlzLiRwb3N0KG1vZGVsTmFtZSArICcvZGVsZXRlJywgeyBpZCA6IGlkc30sIGNhbGxCYWNrKTtcbiAgICB9O1xuXG4gICAgdGhpcy5jb25uZWN0ID0gZnVuY3Rpb24gKGNhbGxCYWNrKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbm5lY3Rpb24uaXNMb2dnZWRJbikge1xuICAgICAgICAgICAgY2FsbEJhY2soKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdGlvbi5jb25uZWN0KGNhbGxCYWNrKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmZ1bmN0aW9uIHJlV2hlZWxPUk0oZW5kUG9pbnQsIGxvZ2luRnVuYyl7XG4gICAgdGhpcy4kb3JtID0gbmV3IGJhc2VPUk0obmV3IHV0aWxzLnJlV2hlZWxDb25uZWN0aW9uKGVuZFBvaW50LCBsb2dpbkZ1bmMpLHRoaXMpO1xuICAgIHRoaXMub24gPSB0aGlzLiRvcm0ub24uYmluZCh0aGlzLiRvcm0pO1xuICAgIHRoaXMuZW1pdCA9IHRoaXMuJG9ybS5lbWl0LmJpbmQodGhpcy4kb3JtKTtcbiAgICB0aGlzLnVuYmluZCA9IHRoaXMuJG9ybS51bmJpbmQuYmluZCh0aGlzLiRvcm0pO1xuICAgIHRoaXMub25jZSA9IHRoaXMuJG9ybS5vbmNlO1xuICAgIHRoaXMuYWRkTW9kZWxIYW5kbGVyID0gdGhpcy4kb3JtLmFkZE1vZGVsSGFuZGxlci5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy5hZGRQZXJzaXN0ZW50QXR0cmlidXRlcyA9IHRoaXMuJG9ybS5hZGRQZXJzaXN0ZW50QXR0cmlidXRlcy5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy51dGlscyA9IHV0aWxzO1xuICAgIHRoaXMubG9nb3V0ID0gdGhpcy4kb3JtLmNvbm5lY3Rpb24ubG9nb3V0LmJpbmQodGhpcy4kb3JtLmNvbm5lY3Rpb24pO1xufVxuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgY29ubmVjdGlvbiA9IHRoaXMuJG9ybS5jb25uZWN0aW9uO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24oY2FsbEJhY2sscmVqZWN0KXtcbiAgICAgICAgY29ubmVjdGlvbi5jb25uZWN0KGNhbGxCYWNrKTtcbiAgICB9KSk7XG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihhY2NlcHQscmVqZWN0KXtcbiAgICAgICAgdGhpcy4kb3JtLmNvbm5lY3Rpb24ubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkLCBhY2NlcHQpOyAgICBcbiAgICB9KS5iaW5kKHRoaXMpKTtcbiAgICBcbn07XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmxvZ291dCA9IGZ1bmN0aW9uKHVybCl7XG4gICAgcmV0dXJuIHRoaXMuJG9ybS5jb25uZWN0aW9uLmxvZ291dCgpO1xufVxuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5nZXRNb2RlbCA9IGZ1bmN0aW9uKG1vZGVsTmFtZSl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBzZWxmLiRvcm0uY29ubmVjdChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5kZXNjcmliZShtb2RlbE5hbWUsYWNjZXB0KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gY2F0Y2goZSkge1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9XG4gICAgfSlcbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24obW9kZWxOYW1lLCBpZHMpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgc2luZ2xlID0gZmFsc2U7XG4gICAgdmFyIG1vZE5hbWUgPSBtb2RlbE5hbWU7XG4gICAgaWYgKGlkcy5jb25zdHJ1Y3RvciAhPT0gQXJyYXkpe1xuICAgICAgICBzaW5nbGUgPSB0cnVlO1xuICAgICAgICBpZHMgPSBbaWRzXVxuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3Qpe1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICBzZWxmLiRvcm0uY29ubmVjdChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGlmIChzaW5nbGUpe1xuICAgICAgICAgICAgICAgICAgICBzZWxmLiRvcm0uZ2V0KG1vZE5hbWUsIGlkcywgZnVuY3Rpb24oaXRlbXMpeyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VwdChpdGVtc1swXSk7fVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5nZXQobW9kTmFtZSwgaWRzLCBhY2NlcHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxucmVXaGVlbE9STS5wcm90b3R5cGUucXVlcnkgPSBmdW5jdGlvbiAobW9kZWxOYW1lLCBmaWx0ZXIsIHJlbGF0ZWQpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3Qpe1xuICAgICAgICB2YXIgdG9nZXRoZXIgPSBudWxsO1xuICAgICAgICBpZiAocmVsYXRlZCAmJiAocmVsYXRlZC5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpICYmIChyZWxhdGVkLmxlbmd0aCkpe1xuICAgICAgICAgICAgdG9nZXRoZXIgPSByZWxhdGVkO1xuICAgICAgICB9IGVsc2UgaWYgKHJlbGF0ZWQgJiYgKHJlbGF0ZWQuY29uc3RydWN0b3IgPT09IFN0cmluZykgJiYgKHJlbGF0ZWQubGVuZ3RoKSl7XG4gICAgICAgICAgICB0b2dldGhlciA9IHJlbGF0ZWQuc3BsaXQoJywnKTtcbiAgICAgICAgfVxuICAgICAgICB0cnl7XG4gICAgICAgICAgICBzZWxmLiRvcm0uY29ubmVjdChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5xdWVyeShtb2RlbE5hbWUsIGZpbHRlciwgdG9nZXRoZXIsIGFjY2VwdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KVxufTtcblxucmVXaGVlbE9STS5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKG1vZGVsTmFtZSwgaWRzKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgc2VsZi4kb3JtLmNvbm5lY3QoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBzZWxmLiRvcm0uZGVsZXRlKG1vZGVsTmFtZSwgaWRzLCBhY2NlcHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9XG4gICAgfSlcbn07XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmdldExvZ2dlZFVzZXIgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgaWYgKHRoaXMuJG9ybS5jb25uZWN0aW9uLmNhY2hlZFN0YXR1cy51c2VyX2lkKVxuICAgICAgICByZXR1cm4gdGhpcy5nZXQoJ2F1dGhfdXNlcicsdGhpcy4kb3JtLmNvbm5lY3Rpb24uY2FjaGVkU3RhdHVzLnVzZXJfaWQpO1xuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3QpIHtcbiAgICAgICAgICAgIHNlbGYub25jZSgnbG9nZ2VkLWluJyxmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5nZXQoJ2F1dGhfdXNlcicsIHVzZXIpLnRoZW4oYWNjZXB0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLiRzZW5kVG9FbmRwb2ludCA9IGZ1bmN0aW9uICh1cmwsIGRhdGEpe1xuICAgIHJldHVybiB0aGlzLiRvcm0uJHBvc3QodXJsLCBkYXRhKTtcbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpe1xuICAgIHJldHVybiB0aGlzLiRvcm0uY29ubmVjdGlvbi5sb2dpbih1c2VybmFtZSxwYXNzd29yZCk7XG59XG4iXX0=
