!function(t,e,n){"use strict";function i(){this.handlers=[],this.strHandlers={}}function r(){var t={},n={},i=0;this.on=function(e,r){e in t||(t[e]=new Array);var o=i++;return t[e].push(r),n[o]=r,o},this.emit=function(e){if(e in t){var n=Array.prototype.slice.call(arguments,1);t[e].forEach(function(t){t.apply(null,n)})}},this.unbind=function(i){var r=0;if(i in n){var o=n[i+""];e(t).each(function(t,e){var n=[];for(var i in t)t[i]===o&&(n.push(i),r++);n.reverse().forEach(function(e){t.splice(e,1)})})}return delete n[i],r},this.once=function(t,e){var n=this,i=this.on(t,function(){e.apply(this,arguments),n.unbind(i)})}}function o(){return new Proxy({},{get:function(t,e){return"string"==typeof e?"toString"===e?y:v.mock:t[e]}})}function s(t,e){var i=new n(t);i.onopen=function(t){console.log("open : "+t),i.tenant(),e.emit("realtime-connection-open",t)},i.onmessage=function(t){if("message"==t.type)try{e.emit("realtime-message-json",JSON.parse(t.data))}catch(n){e.emit("realtime-message-text",JSON.parse(t.data))}else console.log("from realtime ",t)},i.onclose=function(){setTimeout(v.wsConnect,1e3),e.emit("realtime-connection-closed")},i.tenant=function(){i.send("TENANT:"+e.cachedStatus.application+":"+e.cachedStatus.token)},this.close=function(){i.close()}}function a(t,e){var n=new r;this.getLogin=e,this.endPoint=t.endsWith("/")?t:t+"/",this.on=n.on,this.unbind=n.unbind,this.emit=n.emit,this.once=n.once,this.cachedStatus={},this.isConnected=!1,this.isLoggedIn=!1}function c(){var t=!1;this.touch=function(){t=!0},this.touched=function(){var e=t;return t=!1,e}}function u(t,n,i,r){if(!n)var n=[];var o=[];this.ask=function(i,s){r&&i in r.source||e(n).contains(i)||(o.push(i),s||n.push(i),t.touch())},this.getAskedIndex=function(){return n},this.missings=function(){return e(o.splice(0,o.length)).unique().toArray()}}function l(t,n,i,r){var o=new c,s={},a={},l={},f={},h={};this.mainIndex=s,this.foreignKeys=a,this.m2m=l,this.m2mIndex=f,this.permissions=h,i.on("model-definition",function(t,n){var i=r.getIndexFor(t.name,"id");s[t.name]=new u(o,i,"mainIndex."+t.name,n),h[t.name]=new u(o,null,"permissions."+t.name),e(t.references).each(function(e){var n=t.name+"_"+e.id;a[n]=new u(o,r.getIndexFor(e.to,"id"),e.to+".id foreignKeys."+n)}),e(t.referencedBy).each(function(t){var e=t.by+"."+t.id;a[e]=new u(o,r.getIndexFor(t.by,t.id),t.by+"."+t.id+" foreignKeys."+e)}),e(t.manyToMany).each(function(t){t.indexName in l||(l[t.indexName]=[new u(o,null,"m2m."+t.indexName+"[0]"),new u(o,null,"m2m."+t.indexName+"[1]")]),t.indexName in f||(f[t.indexName]=new d(t,l[t.indexName]))})});var p=function(e,n,r,o){i.$post((n?v.reverse("/",e):e)+"s/list",{collection:r},function(n){i.gotData(n,o),delete t[e]})},m=function(n,i,r,o){e(i).each(l[n][r].ask.bind(l[n][r])),i=l[n][r].missings(),i.length?(t[n]=1,p(n,r,i,o)):o&&o()};this.getM2M=m;var g=function(){if(o.touched()){if(e(t).values().sum())return void o.touch();var r=!1;e(l).each(function(t,n){e(t).each(function(t,o){var a=t.missings();if(a=e(a).filter(Boolean).map(function(t){return parseInt(t)}).toArray(),a.length){var c=f[n],u=c["get"+(1-o)].bind(c);r=!0,p(n,o,a,function(t){var r=a.map(u);if(r.length){var c=n.split("/")[1-o];i.describe(c,function(){e(r).flatten().unique().each(function(t){s[c].ask(t,!0)})})}})}})}),e(s).each(function(t,o){var s=t.missings();if(s.length){r=!0;o in n?n[o].keys():e();i.fetch(o,{id:s},null,v.noop)}}),e(a).map(function(t,e){return[e,t.missings()]}).filter(function(t){return t[1].length}).each(function(t){r=!0;var e=t[1],n=t[0],o=n.split("."),s=o[0],a=o[1],c={};c[a]=e,i.fetch(s,c)}),e(e(h).map(function(t,e){return[e,t.missings()]}).filter(function(t){return t[1].length}).toObject()).each(function(n,o){r=!0,n.length&&(t[o]=1,i.$post(o+"/my_perms",{ids:e(n).unique().toArray()},function(e){i.gotPermissions(e.PERMISSIONS),delete t[o]}))})}};setInterval(g,50)}function f(){var t={},n={},i={},r=function(t,n,i){var r=[];if(i)for(var o in t)for(var s in n)r.push(e([t[o],n[s]]).flatten().toArray());else for(var o in t)for(var s in n)r.push([t[o],n[s]]);return r},o=function(t){for(var e=!1,n=t[0],i=1;i<t.length;++i)n=r(n,t[i],e),e=!0;return n},s=function(t){var n=o(e(t).values().toArray()),i=e(t).keys().toArray();return n.map(function(t){var e={};return i.forEach(function(n,i){e[n]=t[i]}),e})},a=function(t,n,i){var r=t.modelName,o=this.getIndexFor,s=(e(n).map(function(t,e){return[e,r+"."+e]}).toObject(),e(n).keys().map(function(t){return[t,o(r,t)]}).toObject());for(var a in n){var c=e(n[a]).difference(s[a]).toArray();if(c.length){var u=e([[a,c]]).toObject();return i||Array.prototype.push.apply(s[a],c),u}return null}},c=function(t,n){t.name in i||(i[t.name]=[]);var r=i[t.name],o=e(n).size();r.filter(v.makeFilter(t,n," && ",!0)).filter(function(t){e(t).size()>o})};this.filter=function(r,o){var u=r.modelName,l=e(o).size();switch(l){case 0:var f=t[u];return t[u]=!0,u in n&&delete n[u],u in i&&delete i[u],f?null:{};case 1:var d=a.call(this,r,o);return c.call(this,r,o),d}var h=this,p=e(o).keys().some(function(t){var e={};return e[t]=o[t],null==a.call(h,r,e,!0)});if(p)return null;u in i||(i[u]=[]);var m=s(o),g=i[u].filter(v.makeFilter(r,o," || ",!0));if(g.length){var y=[];for(var w in g)y.push.apply(y,m.filter(v.makeFilter(r,g[w]," && ",!0)));var b=e(m).difference(y).toArray()}else var b=m;if(b.length){i[u].push.apply(i[u],b);var b=e(o).keys().map(function(t){var n=e(b).pluck(t).unique().toArray();return[t,n.length?n:o[t]]}).toObject();return c(r,b),b}return null},this.getIndexFor=function(t,e){var i=t+"."+e;return i in n||(n[i]=[]),n[i]}}function d(t,n){var i=[];this.add=i.push.bind(i),this.add=function(t){e(i).find(t)||i.push(t)},this.get0=function(t){return n[1].ask(t),e(i).filter(function(e){return e[0]===t}).pluck("1").toArray()},this.get1=function(t){return n[0].ask(t),e(i).filter(function(e){return e[1]===t}).pluck("0").toArray()},this["get"+v.capitalize(t.indexName.split("/")[1])]=this.get1,this["get"+v.capitalize(t.indexName.split("/")[0])]=this.get0,this.del=function(t){for(var e=i.length,n=null,r=0;r<e;r++)if(i[r][0]===t[0]&&i[r][1]===t[1]){n=r;break}n&&i.splice(r,1),console.log("deleting ",t)}}function h(t,n,i,r){var o=Array.prototype.slice.call(arguments,4),s={};e(o).each(function(e){t.orm.on(e,function(){s={}})});var a={get:function(){return this.id in s||(s[this.id]=i.call(this)),s[this.id]}};r&&(a.set=function(t){isFinite(t)?(r.call(this,t),this.id in s&&delete s[this.id]):this.id in s&&delete s[this.id]}),Object.defineProperty(t,n,a)}function p(t){this.resource=t._resource,this.formIdx=t.formIdx,this.fields=t.errors}function m(t,e){this.$orm=new b(new v.reWheelConnection(t,e),this),this.on=this.$orm.on.bind(this.$orm),this.emit=this.$orm.emit.bind(this.$orm),this.unbind=this.$orm.unbind.bind(this.$orm),this.once=this.$orm.once,this.addModelHandler=this.$orm.addModelHandler.bind(this.$orm),this.addPersistentAttributes=this.$orm.addPersistentAttributes.bind(this.$orm),this.utils=v,this.logout=this.$orm.connection.logout.bind(this.$orm.connection)}i.prototype.addHandler=function(t){var e=v.hash(t.toString());e in this.strHandlers||(this.strHandlers[e]=t,this.handlers.push(t))},i.prototype.handle=function(){var t=Array.prototype.slice.call(arguments,0);this.handlers.forEach(function(e){e.apply(null,t)})},i.prototype.handleBy=function(){var t=Array.prototype.slice.call(arguments,1),e=arguments[0];this.handlers.forEach(function(n){n.apply(e,t)})};var g=0,y=function(){return""},v={renameFunction:function(t,e){return new Function("return function (call) { return function "+t+" () { return call(this, arguments) }; };")()(Function.apply.bind(e))},cached:function(t,e){function n(){return this[e]||(this[e]=t.call(this,[arguments])),this[e]}return e||(e="_"+g++),n},log:function(){console.log(arguments)},xdr:function(t,n,i,r,o){return new Promise(function(i,s){var a;n||(n={}),XMLHttpRequest?(a=new XMLHttpRequest,a.onreadystatechange=function(){if(4===a.readyState){try{var t=JSON.parse(a.responseText)}catch(t){var t=null}var e={responseData:t,responseText:a.responseText,status:a.status,request:a};a.status>=200&&a.status<400?i(e):s(e)}}):XDomainRequest?(a=new XDomainRequest,a.onload=function(){i(a.responseText,a.statusText,a)}):s(new Error("CORS not supported")),a.open("POST",t,!0),a.onerror=s,a.setRequestHeader("Accept","application/json"),r&&(n.__token__=r),o?(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n=e(n).map(function(t,e){return e+"="+encodeURI(t.toString())}).toArray().join("&")):(a.setRequestHeader("Content-Type","text/plain"),n=e(n).size()?JSON.stringify(n):""),a.send(n)})},capitalize:function(t){return t[0].toUpperCase()+t.slice(1).toLowerCase()},hash:function(t){t=t.toString();for(var e=1,n=0;n<t.length;n++)e*=1+t.charCodeAt(n);return(e%34958374957).toString()},makeFilter:function(t,n,i,r){if(i||(i=" && "),0===e(n).size())return function(t){return!0};var o=e(n).map(function(n,i){return n||(n=[null]),Array.isArray(n)||(n=[n]),r||"reference"!==t.fields[i].type?"string"===t.fields[i].type&&(n=n.map(JSON.stringify)):(i="_"+i,n=e(n).map(function(t){return t&&t.constructor!==Number?t.id:t}).toArray()),"("+e(n).map(function(t){return t?t===orm.utils.mock&&console.error("makeFilter with Mock Object"):console.error("makeFilter x is null"),"(x."+i+" === "+t+")"}).join(" || ")+")"}).toArray().join(i);return new Function("x","return "+o)},sameAs:function(t,e){for(var n in t)if(e[n]!=t[n])return!1;return!0},pluralize:function(t,e){return t+"s"},beforeCall:function(t,e){var n=function(){e().then(t)};return n},cleanStorage:function(){e(localStorage).keys().each(function(t){delete localStorage[t]})},cleanDescription:function(){e(localStorage).filter(function(t,n){return e(n).startsWith("description:")}).keys().each(function(t){delete localStorage[t]})},reverse:function(t,e){return e.split(t).reverse().join(t)},permutations:function(t){for(var e=[],n=t.length-1;n>=0;n--)for(var i=t.length-1;i>=0;i--)n!==i&&e.push([t[n],t[i]]);return e},waitFor:function(t,e){var n=function(){t()?e():setTimeout(n,500)};setTimeout(n,500)},bool:Boolean,noop:function(){},tzOffset:6e4*(new Date).getTimezoneOffset(),transFieldType:{date:function(t){return new Date(1e3*t+v.tzOffset)},datetime:function(t){return new Date(1e3*t+v.tzOffset)},string:function(t){return t.toString()},text:function(t){return t.toString()},integer:function(t){return parseInt(t)},float:function(t){return parseFloat(t)}},mock:o()},w="lastRWTConnectionStatus";a.prototype.$post=function(t,e,n){var i=this,r=new Promise(function(r,o){v.xdr(i.endPoint+t,e,i.cachedStatus.application,i.cachedStatus.token).then(function(o){i.emit("http-response",o.responseText,o.status,t,e),i.emit("http-response-"+o.status,o.responseText,t,e),o.responseData&&i.emit("http-response-"+o.status+"-json",o.responseData,t,e),n&&n(o.responseData||o.responseText),r(o.responseData||o.responseText)},function(n){n.responseData?(i.emit("error-json",n.responseData,n.status,t,e,n),i.emit("error-json-"+n.status,n.responseData,t,e,n)):(i.emit("error-http",n.responseText,n.status,t,e,n),i.emit("error-http-"+n.status,n.responseText,t,e,n)),o(n.responseData||n.responseText)})});return r},a.prototype.status=function(t,n){var i="token:"+this.endPoint,r=this;if(n&&(this.cachedStatus={},delete localStorage[i]),this.statusWaiting)return void v.waitFor(function(){return!r.statusWaiting},function(){r.status(t,n)});if(!e(this.cachedStatus).size()){var o={};return i in localStorage&&(o.__token__=localStorage[i]),this.statusWaiting=!0,void this.$post("api/status",o,function(e){r.updateStatus(e),localStorage[i]=e.token,t(e),r.statusWaiting=!1})}t(this.cachedStatus),t(this.cachedStatus)},a.prototype.updateStatus=function(t){var e=parseFloat(localStorage.lastBuild)||1;e<t.last_build&&(v.cleanDescription(),localStorage.lastBuild=t.last_build),this.isConnected=Boolean(t.token),this.isLoggedIn=Boolean(t.user_id);var n=this.cachedStatus;if(this.cachedStatus=t,!n.user_id&&t.user_id)this.emit("logged-in",t.user_id);else if(n.user_id&&!t.user_id)this.emit("logged-out");else if(this.isConnected&&!this.isLoggedIn&&(this.emit("login-required"),this.getLogin)){var i=this.getLogin();i.constructor===Object?this.login(i.username,i.password,i.callBack):i.constructor===Promise&&i.then(function(t){this.login(t.username,t.password,t.callBack)})}!n.realtimeEndPoint&&t.realtimeEndPoint?this.wsConnection=new s(t.realtimeEndPoint,this):n.realtimeEndPoint&&!t.realtimeEndPoint&&(this.wsConnection.close(),delete this.wsConnection),this.emit("update-connection-status",t,n),localStorage[w]=JSON.stringify(t)},a.prototype.login=function(t,e){var n=this;return new Promise(function(i,r){v.xdr(n.endPoint+"api/login",{username:t||"",password:e||""},null,n.cachedStatus.token,!0).then(function(t){n.updateStatus(t.responseData),i({status:"success",userid:n.cachedStatus.user_id})},function(t){i({error:t.responseData.error,status:"error"})})})},a.prototype.logout=function(){var t=this;return new Promise(function(e,n){t.$post("api/logout").then(function(n){t.updateStatus({}),delete localStorage[w],e()},n)})},a.prototype.connect=function(t){this.isLoggedIn?t(this.cachedStatus.user_id):(this.once("logged-in",function(e){t(e)}),this.status(t||v.noop))},v.reWheelConnection=a;var b=function(t,n){function r(t,e,n){this.klass=e,this.permissions=[],this.id=t;for(var i in n)this.push.apply(this,[i,n[i]])}if(t.constructor===String)var o=new a(t);else if(t.constructor===v.reWheelConnection)var o=t;this.connection=o,o.on("connected",function(){this.connected=!0}),this.on=o.on,this.emit=o.emit,this.unbind=o.unbind,this.once=o.once,this.$post=o.$post.bind(o),this.on("ws-connected",function(t){console.info("Websocket connected"),t.onMessageJson(s.gotData.bind(s)),t.onMessageText(function(t){console.info("WS message : "+t)})}),this.on("ws-disconnected",function(t){console.error("Websocket disconnected")}),this.on("error-json-404",function(t,e,n,i){console.error("JSON error ",JSON.stringify(t)),delete b[e.split("/")[0]]}),this.on("realtime-message-json",function(t){s.gotData(t)});var s=this,c={auth_group:e({})},u={},d={},m={},g={},y={},w={},b={},S=new f(e),A=new l(b,c,this,S);window.IDB=c,this.validationEvent=this.on("error-json-513",function(t,e,n,i){currentContext.savingErrorHanlder&&currentContext.savingErrorHanlder(new p(t))});var k=function(t){return t in c?c[t]:(c[t]=e({}),c[t])};r.prototype.save=function(t){var n={permissions:e(this.permissions).map(function(t){return[t[0].id,t[1]]}).toObject()};n.id=this.id;this.klass.modelName;s.$post(this.klass.modelName+"/set_permissions",n,function(e,n,i,r){t(e)})},r.prototype.push=function(t,n){var i=e(n),r=e(this.klass.allPermissions).map(function(t){return[t,i.contains(t)]}).toObject(),o=e(this.permissions).map(function(t){return t[0].id});o.contains(t)?this.permissions[o.indexOf(t)][1]=r:this.permissions.push([c.auth_group.get(t),r])};var N=function(t){t.fields.id.readable=!1,t.fields.id.writable=!1;var i=e(t.fields);t.privateArgs&&(i=i.merge(t.privateArgs)),s.emit("model-definition",t,k(t.name));var o="if (!row) { row = {}};\n";o+=t.references.map(function(t){return"this._"+t.id+" = row."+t.id+";"}).join(";\n"),o+=i.map(function(t,e){return"date"==t.type||"datetime"==t.type?"this."+e+" = row."+e+"?new Date(row."+e+" * 1000 - "+v.tzOffset+"):null;\n":"boolean"==t.type?"this."+e+" = (row."+e+' === "T") || (row.'+e+" === true);\n":"this."+e+" = row."+e+";\n"}).toString("\n"),o+="if (permissions) {this._permissions = permissions && Lazy(permissions).map(function (x) { return [x, true] }).toObject();}";var a=new Function("row","permissions",o);a.prototype.orm=n,a.ref_translations={},a.modelName=t.name,a.references=e(t.references).pluck("id").toArray(),a.inverse_references=t.referencedBy.map(function(t){return t.by+"_"+t.id+"_set"}),a.referents=t.referencedBy.map(function(t){return[t.by,t.id]}),a.fieldsOrder=t.fieldOrder,a.allPermissions=t.permissions,e(t.representation).size()&&(a.prototype.toString=new Function("return this."+e(t.representation).toString(' + " " + this.'))),a.prototype.toUpperCase=function(){return this.toString().toUpperCase()},a.prototype.toLowerCase=function(){return this.toString().toLowerCase()},a.prototype.delete=function(){return n.delete(this.constructor.modelName,[this.id])},Object.defineProperty(a.prototype,"permissions",{get:function(){return this._permissions?this._permissions:void A.permissions[this.constructor.modelName].ask(this.id)}}),a.prototype.all_perms=function(t){var n=this.id;s.$post(this.constructor.modelName+"/all_perms",{id:this.id},function(i){var o=i,u={},l=e(o).pluck("group_id").unique().map(function(t){return""+t}).difference(c.auth_group.keys()).toArray();e(o).groupBy(function(t){return t.group_id}).each(function(t,n){u[n]=e(t).pluck("name").toArray()});var f=function(e){t(new r(n,a,u))};l.length?s.get("auth_group",l,f):f()})},a.prototype.save=function(t){var n=this.asRaw(),i=a.fields,r=this.id,o=this.constructor.modelName;if(t)for(var c in t)n[c]=t[c];e(a.fieldsOrder).filter(function(t){return!i[t].writable}).each(function(t){t in n&&delete n[t]}),r&&(n.id=r);var u=s.$post(o+(r?"/post":"/put"),n);return t&&t.constructor===Function&&(u.context.savingErrorHanlder=t),u},a.prototype.copy=function(){var t=new this.constructor(this.asRaw());return t._permissions=this._permissions,t};var l="return {\n"+e(t.references).map(function(t){return t.id+" : this._"+t.id}).concat(i.map(function(t,e){return"date"==t.type||"datetime"==t.type?e+" : (this."+e+"?(Math.round(this."+e+".getTime() - this."+e+".getTimezoneOffset() * 60000) / 1000):null)":"boolean"==t.type?e+" : this."+e+'?"T":"F"':e+" : this."+e})).toString(",\n")+"};";a.prototype.asRaw=new Function(l),a.saveMulti=function(t,n,i){var r=[],o=e(a.fields).filter(function(t){return!t.writable}).pluck("id").toArray();e(t).map(function(t){return t.asRaw()}).each(function(t){e(o).each(function(e){delete t[e]}),r.push(t)}),s.$post(a.modelName,"put",{multiple:r,formIdx:s.formIdx++},function(t){s.gotData(t);var i=c[a.modelName],r=e(t[a.modelName].results).pluck("id").map(function(t){return i.get(t)}).toArray();n&&n(r)},i)},"extra_verbs"in t&&e(t.extra_verbs).each(function(t){var n=t[0],i=t[1],r="var data = {id : this.id";i.length&&(r+=", "+e(i).map(function(t){return t+" : "+t}).join(",")),r+="};\n",i=["post","gotData"].concat(i),i.push("cb");var o=r+' retrun post("'+a.modelName+"/"+n+'", data,cb);',s=new Function(i,o);a.prototype[n]=function(){var t=[post,gotData].concat(arguments);s.apply(this,t)}}),"privateArgs"in t&&(a.privateArgs=e(t.privateArgs).keys().map(function(t){return[t,!0]}).toObject(),a.prototype.savePA=function(t){var n=this,i={id:this.id},r=this.constructor.privateArgs,o=this.constructor.fields,a=(new this.constructor(t).asRaw(),e(r).keys().map(function(t){return[t,o[t]]}).toObject());e(t).each(function(t,e){e in r&&a[e].writable&&(i[e]=t)}),s.$post(this.constructor.modelName+"/savePA",i,function(){e(i).each(function(t,e){n[e]=t})})}),y[a.modelName]=a;for(var f in t.fields)t.fields[f].id=f;return a.fields=e(t.fields).concat(e(t.privateArgs)).concat(e(t.references).tap(function(t){t.type=t.type||"reference"})).indexBy("id").toObject(),e(a.fields).each(function(t){t.widget||("reference"===t.type?t.widget="choices":t.widget=t.type)}),e(t.references).each(function(t){var e=t.to,i="_"+t.id;h(a.prototype,t.id,function(){if(!this[i])return null;if(!(e in c)){var t=this;s.describe(e,function(n){A.mainIndex[e].ask(t[i],!0)})}var n=e in c&&this[i]&&c[e].get(this[i]);return!n&&e in A.mainIndex?("number"==typeof this[i]?A.mainIndex[e].ask(this[i],!0):console.warn("null reference for "+i+"("+this.id+") resource "+a.modelName),v.mock):n},function(n){if(n){if(n.constructor!==v.mock&&n.constructor.modelName!==e)throw new TypeError("You can assign only "+e+" to "+t.id);this[i]=n.id}else this[i]=null},"new-"+e,"deleted-"+e,"updated-"+e,"new-model-"+e),a.prototype["get"+v.capitalize(t.id)]=function(){return n.get(e,this[i])}}),e(t.referencedBy).each(function(t){var e=t.by+"."+t.id,i=t.by+"_"+v.pluralize(t.id),r=t.by;a.prototype.hasOwnProperty(i)?console.error("Tryed to redefine property "+i+"s for "+a.modelName):h(a.prototype,i,function(){var t=r in c?u[e].get(this.id+""):null;return A.foreignKeys[e].ask(this.id,!0),t},null,"new-"+r,"updated-"+r,"deleted-"+r),a.prototype["get"+v.capitalize(v.pluralize(t.by))]=function(){var e={};return e[t.id]=[this.id],n.get(t.by,e)}}),t.manyToMany&&(e(t.manyToMany).each(function(t){var n=t.indexName,i=t.first?0:1,r=t.model,o=A.m2mIndex[n]["get"+(1-i)];h(a.prototype,t.model+"s",function(){var t=this,n=[],i=o(t.id),s=null;return i.length&&(s=k(r).get.bind(c[r])),i&&s&&(n=e(i).map(s).filter(v.bool).toArray()),n},null,"received-m2m-"+n,"received-"+r),a.prototype["get"+v.capitalize(v.pluralize(r))]=function(){var t=this;return new Promise(function(a,u){try{A.getM2M(n,[t.id],i,function(n){var i=o(t.id);i.length?s.fetch(r,{id:i},null,function(){var t=c[r].get.bind(c[r]);a(e(i).map(t).filter(v.bool).toArray())}):a([])})}catch(t){console.error(t),u(t)}})},a.fields[v.capitalize(r)]={id:v.capitalize(r),name:v.capitalize(r),writable:!0,readable:!0,type:"M2M",validators:[]}}),a.prototype.unlinkReference=function(t){var n=!1,i=this.id,r=[];"Array"==t.constructor.name&&(n=!0,r=t,t=r[0]);var o=t.constructor.modelName;if(n)var c=e(r).pluck("id").map(function(t){return[i,t]}).toArray();else var c=[[i,t.id]];s.$post(a.modelName+"/"+o+"s/delete",{collection:c})},a.prototype.linkReference=function(t){var n=!1,i=this.id,r=[];"Array"==t.constructor.name&&(n=!0,r=t,t=r[0]);var o=t.constructor.modelName,c=a.modelName+"/"+o;if(n){var u=[];if(c in INDEX_M2M&&(u=e(r).pluck("id").difference(e(INDEX_M2M[c][0].get(this.id))).toArray()),c=o+"/"+a.modelName,c in INDEX_M2M&&(u=e(r).pluck("id").difference(e(INDEX_M2M[c][0].get(this.id))).toArray()),u.length){var l=e(u).map(function(t){return[i,t]}).toArray();W2P_POST(a.modelName,o+"s/put",{collection:l},function(t){})}}else{if(c in A.m2mIndex&&e(A.m2mIndex[c]["get"+v.capitalize(o)](t.id)).find(this))return;s.$post(a.modelName+"/"+o+"s/put",{collection:[[this.id,t.id]]})}}),s.emit("new-model",a),s.emit("new-model-"+a.modelName),a};this.gotData=function(t,n){if(console.info("gotData"),"string"!=typeof t){"_extra"in t&&delete t._extra;var i=(t.TOONE,t.TOMANY,t.MANYTOMANY,t.PERMISSIONS),r=t.PA;if(delete t.TOONE,delete t.TOMANY,delete t.MANYTOMANY,delete t.PERMISSIONS,delete t.PA,r||(r={}),t=e(t).filter(function(t,e){return!("deleted"in t)||e in y}).toObject(),"m2m"in t){var o=t.m2m;delete t.m2m}e(t).each(function(t,n){s.describe(n,function(i){var o=i;t.results&&t.results.length>0&&t.results[0].constructor==Array&&(t.results=e(t.results).map(function(t){return e(o.fieldsOrder).zip(t).toObject()}).toArray());var a=e(t.results),l=t.deleted;if(n in r){var f=r[n];e(a).each(function(t){t.id in f&&e(f[t.id]).each(function(e,n){t[n]=e})})}var d=k(n),h=d.source;l&&l.forEach(function(t){delete h[t]});var p=a.indexBy("id"),m=p.keys(),g=m.difference(d.keys().map(function(t){return parseInt(t)})),w=m.difference(g);w=w.filter(function(t){return!v.sameAs(p.get(t),d.get(t).asRaw())}).toArray();var b=e(t.permissions?t.permissions:{}),S=g.map(function(t){return new o(p.get(t),b.get(t))}),A=[];e(i.references).map(function(t){return[t,1]}).toObject();w.forEach(function(t){var n=h[t],r=n.copy(),o=p.get(t);e(i.fields).each(function(t,e){switch(t.type){case"reference":n["_"+e]=o[e],n[e]=NaN;break;case"date":n[e]=new Date(1e3*o[e]);break;case"datetime":n[e]=new Date(1e3*o[e]);break;case"boolean":switch(o[e]){case null:n[e]=null;break;case"T":n[e]=!0;break;case"F":n[e]=!1;break;case!0:n[e]=!0;break;case!1:n[e]=!1}break;default:n[e]=o[e]}}),A.push([o,r])}),A.length&&s.emit("updated-"+n,A);var N=S.toArray();e(N).each(function(t){h[t.id]=t}),e(y[n].references).each(function(t){u[n+"."+t]=c[n].groupBy("_"+t)}),N.length&&s.emit("new-"+n,e(N),t.totalResults),l&&s.emit("deleted-"+n,l),s.emit("received-"+n)})}),o&&s.gotM2M(o),i&&s.gotPermissions(i),n&&n(t),s.emit("got-data")}else if(console.log("data "+t+" refused from gotData()"),n)return n(t)},this.gotPermissions=function(t){e(t).each(function(t,n){e(t[0]).each(function(t,i){n in c&&i in c[n].source&&(c[n].get(i)._permissions=e(t).map(function(t){return[t,!0]}).toObject())}),e(t[0]).size()&&s.emit("update-permissions-"+n,e(t[0]).keys().toArray())}),this.emit("update-permissions")},this.gotM2M=function(t){e(t).each(function(t,n){var i=A.m2mIndex[n];e(t).each(function(t){e(t).each(function(t,e){i[e](t)})}),s.emit("received-m2m"),s.emit("received-m2m-"+n)})},this.fetch=function(t,e,n,i){t in b?setTimeout(function(){s.fetch(t,e,n,i)},500):s.describe(t,function(n){return s.connection.cachedStatus.realtimeEndPoint?(e=S.filter(n,e),e?(b[t]=!0,s.$post(t+"/list",{filter:e}).then(function(e){s.gotData(e,i),delete b[t]},function(e){delete b[t]})):i&&i(),e):void this.$post(t+"/list",sendData,function(n){e||GOT_ALL.source.push(t),s.gotData(n,i)})}.bind(this))},this.get=function(t,e,n){e.constructor!==Array&&(e=[e]),s.fetch(t,{id:e},null,function(){var i=[],r=c[t];for(var o in e)i.push(r.source[e[o]]);n(i)})},this.gotModel=function(t){for(var n in t){var i=t[n];localStorage["description:"+n]=JSON.stringify(t),y[n]=N(i),n in c||(c[n]=e({}))}},this.describe=function(t,e){var n=y[t];if(n)e&&e(n);else if(t in b)setTimeout(function(){s.describe(t,e)},500);else{if(t in w)return;var i="description:"+t;i in localStorage?(this.gotModel(JSON.parse(localStorage[i])),e&&e(y[t])):(b[t]=!0,this.$post(t+"/describe",null,function(n){s.gotModel(n),e&&e(y[t]),delete b[t]},function(e){this.modelNotFound.handle(t),w[t]=!0}))}},this.addModelHandler=function(t,e){var n=v.hash(e);t in d||(d[t]=new i),t in m||(m[t]={}),n in m[t]||(m[t][n]=!0,t in y?e(y[t]):d[t].addHandler(e))},this.addPersistentAttributes=function(t,n){var i=function(t,e){e.forEach(function(e){var n="pA:"+t.modelName+":"+e,i="__"+e;Object.defineProperty(t.prototype,e,{get:function(){if(!(i in this)){var t=localStorage[n+this.id];this[i]=t?JSON.parse(t):null}return this[i]},set:function(t){this[i]=t,localStorage[n+this.id]=JSON.stringify(t)}})})};t in g||(g[t]=[]);var r=g[t];if(n)var o=e(n).difference(r).toArray();else var o=r;o.length&&(t in y&&i(y[t],o),n&&Array.prototype.push.apply(r,o))},this.on("new-model",function(t){t.modelName in d&&d[t.modelName].handle(y[t.modelName]),t.modelName in g&&s.addPersistentAttributes(t.modelName)}),this.query=function(t,n,i,r){var o=this;this.describe(t,function(s){n=e(n).map(function(t,e){return[e,Array.isArray(t)?t:[t]]}).toObject();var a=v.makeFilter(s,n),c=k(t);o.fetch(t,n,i,function(t){r(c.filter(a).values().toArray())})})},this.delete=function(t,e,n){return this.$post(t+"/delete",{id:e},n)},this.connect=function(t){this.connection.isLoggedIn?t():this.connection.connect(t)}};m.prototype.connect=function(){var t=this.$orm.connection;return new Promise(function(e,n){t.connect(e)})},m.prototype.login=function(t,e){return new Promise(function(n,i){this.$orm.connection.login(t,e,n)}.bind(this))},m.prototype.logout=function(t){return this.$orm.connection.logout()},m.prototype.getModel=function(t){var e=this;return new Promise(function(n,i){try{e.$orm.connect(function(){e.$orm.describe(t,n)})}catch(t){i(t)}})},m.prototype.get=function(t,e){var n,i=this,r=!1;return"number"==typeof e?(r=!0,n={id:[e]}):Array.isArray(e)?n={id:e}:"object"==typeof e?n=e:null===e&&(n={}),new Promise(function(e,o){try{i.$orm.connect(function(){i.$orm.query(t,n,null,function(t){e(r?t.length?t[0]:null:t)})})}catch(t){o(t)}})},m.prototype.delete=function(t,e){var n=this;return new Promise(function(i,r){try{n.$orm.connect(function(){n.$orm.delete(t,e,i)})}catch(t){r(t)}})},m.prototype.getLoggedUser=function(){var t=this;return this.$orm.connection.cachedStatus.user_id?this.get("auth_user",this.$orm.connection.cachedStatus.user_id):new Promise(function(e,n){t.once("logged-in",function(n){t.get("auth_user",n).then(e)})})},m.prototype.$sendToEndpoint=function(t,e){return this.$orm.$post(t,e)},m.prototype.login=function(t,e){return this.$orm.connection.login(t,e)},t.rwt=m}(window,Lazy,SockJS);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhbmRsZXJzLmpzIiwidXRpbHMuanMiLCJjb25uZWN0aW9uLmpzIiwidG91Y2hlci5qcyIsInZhY3V1bWNhY2hlci5qcyIsImF1dG9saW5rZXIuanMiLCJsaXN0Y2FjaGVyLmpzIiwibWFueXRvbWFueS5qcyIsImNhY2hlci5qcyIsIm9ybS5qcyJdLCJuYW1lcyI6WyJIYW5kbGVyIiwidGhpcyIsImhhbmRsZXJzIiwic3RySGFuZGxlcnMiLCJOYW1lZEV2ZW50TWFuYWdlciIsImV2ZW50cyIsImhhbmRsZXJJZCIsImlkeElkIiwib24iLCJuYW1lIiwiZnVuYyIsIkFycmF5IiwiaWQiLCJwdXNoIiwiZW1pdCIsImFyZ3MiLCJwcm90b3R5cGUiLCJzbGljZSIsImNhbGwiLCJhcmd1bWVudHMiLCJmb3JFYWNoIiwiZXZlbnQiLCJhcHBseSIsInVuYmluZCIsImhhbmRsZXIiLCJjb3VudCIsIkxhenkiLCJlYWNoIiwidiIsImsiLCJpZHgiLCJuIiwicmV2ZXJzZSIsIngiLCJzcGxpY2UiLCJvbmNlIiwiZXZlbnROYW1lIiwiaGFuZGxlckZ1bmN0aW9uIiwic2VsZiIsIm1vY2tPYmplY3QiLCJQcm94eSIsImdldCIsInRhcmdldCIsIm51bGxTdHJpbmciLCJ1dGlscyIsIm1vY2siLCJSZWFsdGltZUNvbm5lY3Rpb24iLCJlbmRQb2ludCIsInJ3dENvbm5lY3Rpb24iLCJjb25uZWN0aW9uIiwiU29ja0pTIiwib25vcGVuIiwiY29uc29sZSIsImxvZyIsInRlbmFudCIsIm9ubWVzc2FnZSIsInR5cGUiLCJKU09OIiwicGFyc2UiLCJkYXRhIiwiZSIsIm9uY2xvc2UiLCJzZXRUaW1lb3V0Iiwid3NDb25uZWN0Iiwic2VuZCIsImNhY2hlZFN0YXR1cyIsImFwcGxpY2F0aW9uIiwidG9rZW4iLCJjbG9zZSIsInJlV2hlZWxDb25uZWN0aW9uIiwiZ2V0TG9naW4iLCJlbmRzV2l0aCIsImlzQ29ubmVjdGVkIiwiaXNMb2dnZWRJbiIsIlRvdWNoZXIiLCJ0b3VjaGVkIiwidG91Y2giLCJ0IiwiVmFjdXVtQ2FjaGVyIiwiYXNrZWQiLCJwa0luZGV4IiwibWlzc2luZyIsImFzayIsImxhenkiLCJzb3VyY2UiLCJjb250YWlucyIsImdldEFza2VkSW5kZXgiLCJtaXNzaW5ncyIsImxlbmd0aCIsInVuaXF1ZSIsInRvQXJyYXkiLCJBdXRvTGlua2VyIiwiYWN0aXZlcyIsIklEQiIsIlcyUFJFU09VUkNFIiwibGlzdENhY2hlIiwibWFpbkluZGV4IiwiZm9yZWlnbktleXMiLCJtMm0iLCJtMm1JbmRleCIsInBlcm1pc3Npb25zIiwibW9kZWwiLCJpbmRleCIsImdldEluZGV4Rm9yIiwicmVmZXJlbmNlcyIsInJlZmVyZW5jZSIsImluZGV4TmFtZSIsInRvIiwicmVmZXJlbmNlZEJ5IiwiZmllbGQiLCJieSIsIm1hbnlUb01hbnkiLCJyZWxhdGlvbiIsIk1hbnlUb01hbnlSZWxhdGlvbiIsIm0ybUdldCIsImNvbGxlY3Rpb24iLCJjYWxsQmFjayIsIiRwb3N0IiwiZ290RGF0YSIsImdldE0yTSIsImJpbmQiLCJsaW5rVW5saW5rZWQiLCJ2YWx1ZXMiLCJzdW0iLCJjaGFuZ2VkIiwiaW5kZXhlcyIsImZpbHRlciIsIkJvb2xlYW4iLCJtYXAiLCJwYXJzZUludCIsIklOREVYIiwiZ2V0dGVyIiwiaWRzIiwib3RoZXJJbmRleCIsInNwbGl0IiwiZGVzY3JpYmUiLCJmbGF0dGVuIiwibW9kZWxOYW1lIiwia2V5cyIsImZldGNoIiwibm9vcCIsIm1haW5SZXNvdXJjZSIsImZpZWxkTmFtZSIsInRvT2JqZWN0IiwicmVzb3VyY2VOYW1lIiwiZ290UGVybWlzc2lvbnMiLCJQRVJNSVNTSU9OUyIsInNldEludGVydmFsIiwiTGlzdENhY2hlciIsImdvdEFsbCIsImNvbXBvc2l0ZUFza2VkIiwiY2FydGVzaWFuUHJvZHVjdDEiLCJ5IiwiaXNBcnJheSIsInJldCIsImEiLCJiIiwiY2FydGVzaWFuUHJvZHVjdCIsImFyciIsImV4cGxvZGVGaWx0ZXIiLCJwcm9kdWN0IiwiciIsImZpbHRlclNpbmdsZSIsInRlc3RPbmx5Iiwia2V5IiwiZGlmZmVyZW5jZSIsImNsZWFuQ29tcG9zaXRlcyIsImZpbHRlckxlbiIsInNpemUiLCJtYWtlRmlsdGVyIiwiaXRlbSIsImdvdCIsInRocyIsInNpbmdsZSIsInNvbWUiLCJmIiwiZXhwbG9kZWQiLCJwYXJ0aWFscyIsImJhZCIsInBsdWNrIiwiaXRlbXMiLCJhZGQiLCJmaW5kIiwiZ2V0MCIsImdldDEiLCJjYXBpdGFsaXplIiwiZGVsIiwibCIsImNhY2hlZFByb3BlcnR5QnlFdmVudHMiLCJwcm90byIsInByb3BlcnR5TmFtZSIsInNldHRlciIsInJlc3VsdCIsIm9ybSIsInByb3BlcnR5RGVmIiwidmFsdWUiLCJpc0Zpbml0ZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiVmFsaWRhdGlvbkVycm9yIiwicmVzb3VyY2UiLCJfcmVzb3VyY2UiLCJmb3JtSWR4IiwiZmllbGRzIiwiZXJyb3JzIiwicmVXaGVlbE9STSIsImxvZ2luRnVuYyIsIiRvcm0iLCJiYXNlT1JNIiwiYWRkTW9kZWxIYW5kbGVyIiwiYWRkUGVyc2lzdGVudEF0dHJpYnV0ZXMiLCJsb2dvdXQiLCJhZGRIYW5kbGVyIiwic3RySGFuZGxlciIsImhhc2giLCJ0b1N0cmluZyIsImhhbmRsZSIsImhhbmRsZUJ5IiwiY2FjaGVkS2V5SWR4IiwicmVuYW1lRnVuY3Rpb24iLCJmbiIsIkZ1bmN0aW9uIiwiY2FjaGVkIiwid3JhcHBlciIsInhkciIsInVybCIsImZvcm1FbmNvZGUiLCJQcm9taXNlIiwiYWNjZXB0IiwicmVqZWN0IiwicmVxIiwiWE1MSHR0cFJlcXVlc3QiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwicmVzcG9uc2VEYXRhIiwicmVzcG9uc2VUZXh0IiwicmVzcG9uc2UiLCJzdGF0dXMiLCJyZXF1ZXN0IiwiWERvbWFpblJlcXVlc3QiLCJvbmxvYWQiLCJzdGF0dXNUZXh0IiwiRXJyb3IiLCJvcGVuIiwib25lcnJvciIsInNldFJlcXVlc3RIZWFkZXIiLCJfX3Rva2VuX18iLCJlbmNvZGVVUkkiLCJqb2luIiwic3RyaW5naWZ5IiwicyIsInRvVXBwZXJDYXNlIiwidG9Mb3dlckNhc2UiLCJzdHIiLCJjaGFyQ29kZUF0IiwidW5pZmllciIsImRvbnRUcmFuc2xhdGVGaWx0ZXIiLCJ2YWxzIiwiY29uc3RydWN0b3IiLCJOdW1iZXIiLCJlcnJvciIsInNhbWVBcyIsInBsdXJhbGl6ZSIsImJlZm9yZUNhbGwiLCJiZWZvcmUiLCJkZWNvcmF0b3IiLCJ0aGVuIiwiY2xlYW5TdG9yYWdlIiwibG9jYWxTdG9yYWdlIiwiY2xlYW5EZXNjcmlwdGlvbiIsInN0YXJ0c1dpdGgiLCJjaHIiLCJwZXJtdXRhdGlvbnMiLCJ3YWl0Rm9yIiwid2FpdGVyIiwiYm9vbCIsInR6T2Zmc2V0IiwiRGF0ZSIsImdldFRpbWV6b25lT2Zmc2V0IiwidHJhbnNGaWVsZFR5cGUiLCJkYXRlIiwiZGF0ZXRpbWUiLCJzdHJpbmciLCJ0ZXh0IiwiaW50ZWdlciIsImZsb2F0IiwicGFyc2VGbG9hdCIsIlNUQVRVU0tFWSIsInByb21pc2UiLCJ4aHIiLCJmb3JjZSIsInN0YXR1c1dhaXRpbmciLCJ1cGRhdGVTdGF0dXMiLCJsYXN0QnVpbGQiLCJsYXN0X2J1aWxkIiwidXNlcl9pZCIsIm9sZFN0YXR1cyIsImxvZ2luSW5mbyIsImxvZ2luIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsIm9iaiIsInJlYWx0aW1lRW5kUG9pbnQiLCJ3c0Nvbm5lY3Rpb24iLCJ1c2VyaWQiLCJvayIsImNvbm5lY3QiLCJvcHRpb25zIiwiZXh0T1JNIiwiUGVybWlzc2lvblRhYmxlIiwia2xhc3MiLCJTdHJpbmciLCJjb25uZWN0ZWQiLCJ3cyIsImluZm8iLCJvbk1lc3NhZ2VKc29uIiwib25NZXNzYWdlVGV4dCIsIm1lc3NhZ2UiLCJzZW50RGF0YSIsIndhaXRpbmdDb25uZWN0aW9ucyIsImF1dGhfZ3JvdXAiLCJSRVZJRFgiLCJidWlsZGVySGFuZGxlcnMiLCJidWlsZGVySGFuZGxlclVzZWQiLCJwZXJzaXN0ZW50QXR0cmlidXRlcyIsIm1vZGVsQ2FjaGUiLCJmYWlsZWRNb2RlbHMiLCJsaW5rZXIiLCJ3aW5kb3ciLCJ2YWxpZGF0aW9uRXZlbnQiLCJjdXJyZW50Q29udGV4dCIsInNhdmluZ0Vycm9ySGFubGRlciIsImdldEluZGV4Iiwic2F2ZSIsImNiIiwibXlQZXJtcyIsImdyb3VwX2lkIiwicGVybWlzc2lvbkxpc3QiLCJwIiwicGVybXMiLCJhbGxQZXJtaXNzaW9ucyIsImluZGV4T2YiLCJtYWtlTW9kZWxDbGFzcyIsInJlYWRhYmxlIiwid3JpdGFibGUiLCJwcml2YXRlQXJncyIsIm1lcmdlIiwiZnVuY1N0cmluZyIsIktsYXNzIiwicmVmX3RyYW5zbGF0aW9ucyIsImludmVyc2VfcmVmZXJlbmNlcyIsInJlZmVyZW50cyIsImZpZWxkc09yZGVyIiwiZmllbGRPcmRlciIsInJlcHJlc2VudGF0aW9uIiwiZGVsZXRlIiwiX3Blcm1pc3Npb25zIiwiYWxsX3Blcm1zIiwib2JqZWN0X2lkIiwiZ3JvdXBlZCIsInVua25vd25fZ3JvdXBzIiwiZ3JvdXBCeSIsIm8iLCJhc1JhdyIsIklEIiwiYXJnIiwiY29udGV4dCIsImNvcHkiLCJhc3IiLCJjb25jYXQiLCJzYXZlTXVsdGkiLCJvYmplY3RzIiwic2NvcGUiLCJyYXciLCJkZWxldGFibGUiLCJtdWx0aXBsZSIsImVsZW1zIiwidGFiIiwib2JqcyIsInJlc3VsdHMiLCJleHRyYV92ZXJicyIsImZ1bmNOYW1lIiwiZGRhdGEiLCJjb2RlIiwicG9zdCIsInNhdmVQQSIsIlQiLCJvbyIsIlBBIiwiRnMiLCJmaWVsZElkeCIsInRhcCIsImluZGV4QnkiLCJ3aWRnZXQiLCJyZWYiLCJleHRfcmVmIiwibG9jYWxfcmVmIiwid2FybiIsIlR5cGVFcnJvciIsInJldkluZGV4IiwiaGFzT3duUHJvcGVydHkiLCJvcHRzIiwiZmlyc3QiLCJvbW9kZWxOYW1lIiwidmFsaWRhdG9ycyIsInVubGlua1JlZmVyZW5jZSIsImluc3RhbmNlIiwiaW5zdGFuY2VzIiwib21vZGVsIiwibGlua1JlZmVyZW5jZSIsInJlZnMiLCJJTkRFWF9NMk0iLCJXMlBfUE9TVCIsIl9leHRyYSIsIlRPT05FIiwiVE9NQU5ZIiwiTUFOWVRPTUFOWSIsIm1vZGVsQ2xhc3MiLCJ6aXAiLCJkZWxldGVkIiwiTVBBIiwicmVjb3JkIiwiaXRhYiIsInRhYmxlIiwiaWsiLCJubmV3IiwidXBkYXRlZCIsIm5ld09iamVjdHMiLCJvbGRJdGVtIiwib2xkQ29weSIsIm5ld0l0ZW0iLCJOYU4iLCJubyIsInRvdGFsUmVzdWx0cyIsImdvdE0yTSIsInJvdyIsIm0iLCJ2ZXJiIiwidG9nZXRoZXIiLCJzZW5kRGF0YSIsIkdPVF9BTEwiLCJnb3RNb2RlbCIsImNhY2hlS2V5IiwibW9kZWxOb3RGb3VuZCIsImF0dHJpYnV0ZXMiLCJhZGRQcm9wZXJ0eSIsInZhbCIsImthdHRyIiwic2V0IiwiYXR0cnMiLCJuZXdBdHRycyIsInF1ZXJ5IiwiZmlsdGVyRnVuY3Rpb24iLCJnZXRNb2RlbCIsImdldExvZ2dlZFVzZXIiLCJ1c2VyIiwiJHNlbmRUb0VuZHBvaW50Il0sIm1hcHBpbmdzIjoiNkJBRUEsU0FBQUEsS0FDQUMsS0FBQUMsWUFDQUQsS0FBQUUsZUF5QkEsUUFBQUMsS0FDQSxHQUFBQyxNQUNBQyxLQUNBQyxFQUFBLENBQ0FOLE1BQUFPLEdBQUEsU0FBQUMsRUFBQUMsR0FDQUQsSUFBQUosS0FDQUEsRUFBQUksR0FBQSxHQUFBRSxPQUVBLElBQUFDLEdBQUFMLEdBR0EsT0FGQUYsR0FBQUksR0FBQUksS0FBQUgsR0FDQUosRUFBQU0sR0FBQUYsRUFDQUUsR0FFQVgsS0FBQWEsS0FBQSxTQUFBTCxHQUNBLEdBQUFBLElBQUFKLEdBQUEsQ0FDQSxHQUFBVSxHQUFBSixNQUFBSyxVQUFBQyxNQUFBQyxLQUFBQyxVQUFBLEVBQ0FkLEdBQUFJLEdBQUFXLFFBQUEsU0FBQUMsR0FDQUEsRUFBQUMsTUFBQSxLQUFBUCxPQUlBZCxLQUFBc0IsT0FBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQUEsQ0FDQSxJQUFBRCxJQUFBbEIsR0FBQSxD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QTdCLEVBQUEsR0FBQSxLQUVBQSxPQUlBLE1BQUFDLEdBQ0F5SyxFQUFBekssT0EwQkFpSixFQUFBN0wsVUFBQW1WLE9BQUEsU0FBQTFOLEVBQUFMLEdBQ0EsR0FBQTlGLEdBQUFyQyxJQUNBLE9BQUEsSUFBQWtPLFNBQUEsU0FBQUMsRUFBQUMsR0FDQSxJQUNBL0wsRUFBQXlLLEtBQUFtRyxRQUFBLFdBQ0E1USxFQUFBeUssS0FBQW9KLE9BQUExTixFQUFBTCxFQUFBZ0csS0FFQSxNQUFBeEssR0FDQXlLLEVBQUF6SyxPQUtBaUosRUFBQTdMLFVBQUFzYixjQUFBLFdBQ0EsR0FBQWhhLEdBQUFyQyxJQUNBLE9BQUFBLE1BQUE4TSxLQUFBOUosV0FBQWdCLGFBQUFzTyxRQUNBdFMsS0FBQXdDLElBQUEsWUFBQXhDLEtBQUE4TSxLQUFBOUosV0FBQWdCLGFBQUFzTyxTQUVBLEdBQUFwRSxTQUFBLFNBQUFDLEVBQUFDLEdBQ0EvTCxFQUFBSCxLQUFBLFlBQUEsU0FBQW9hLEdBQ0FqYSxFQUFBRyxJQUFBLFlBQUE4WixHQUFBN0wsS0FBQXRDLFFBTUF2QixFQUFBN0wsVUFBQXdiLGdCQUFBLFNBQUF2TyxFQUFBdEssR0FDQSxNQUFBMUQsTUFBQThNLEtBQUExRixNQUFBNEcsRUFBQXRLLElBR0FrSixFQUFBN0wsVUFBQTBSLE1BQUEsU0FBQUMsRUFBQUMsR0FDQSxNQUFBM1MsTUFBQThNLEtBQUE5SixXQUFBeVAsTUFBQUMsRUFBQUMiLCJmaWxlIjoicnd0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gSGFuZGxlcigpe1xuICAgIHRoaXMuaGFuZGxlcnMgPSBbXTtcbiAgICB0aGlzLnN0ckhhbmRsZXJzID0ge307XG59O1xuXG5IYW5kbGVyLnByb3RvdHlwZS5hZGRIYW5kbGVyID0gZnVuY3Rpb24gKGhhbmRsZXIpe1xuICAgIHZhciBzdHJIYW5kbGVyID0gdXRpbHMuaGFzaChoYW5kbGVyLnRvU3RyaW5nKCkpO1xuICAgIGlmICghKHN0ckhhbmRsZXIgaW4gdGhpcy5zdHJIYW5kbGVycykpe1xuICAgICAgICB0aGlzLnN0ckhhbmRsZXJzW3N0ckhhbmRsZXJdID0gaGFuZGxlcjtcbiAgICAgICAgdGhpcy5oYW5kbGVycy5wdXNoKGhhbmRsZXIpO1xuICAgIH1cbn07XG5IYW5kbGVyLnByb3RvdHlwZS5oYW5kbGUgPSBmdW5jdGlvbigpe1xuICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApO1xuICAgIHRoaXMuaGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbihmdW5jKXtcbiAgICAgICAgZnVuYy5hcHBseShudWxsLGFyZ3MpO1xuICAgIH0pXG59O1xuSGFuZGxlci5wcm90b3R5cGUuaGFuZGxlQnkgPSBmdW5jdGlvbigpe1xuICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO1xuICAgIHZhciB0aHMgPSBhcmd1bWVudHNbMF07XG4gICAgdGhpcy5oYW5kbGVycy5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmMpe1xuICAgICAgICBmdW5jLmFwcGx5KHRocyxhcmdzKTtcbiAgICB9KVxufTtcblxuXG5mdW5jdGlvbiBOYW1lZEV2ZW50TWFuYWdlciAoKXtcbiAgICB2YXIgZXZlbnRzID0ge307XG4gICAgdmFyIGhhbmRsZXJJZCA9IHt9O1xuICAgIHZhciBpZHhJZCA9IDA7XG4gICAgdGhpcy5vbiA9IGZ1bmN0aW9uKG5hbWUsIGZ1bmMpe1xuICAgICAgICBpZiAoIShuYW1lIGluIGV2ZW50cykpe1xuICAgICAgICAgICAgZXZlbnRzW25hbWVdID0gbmV3IEFycmF5KCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlkID0gaWR4SWQgKys7XG4gICAgICAgIGV2ZW50c1tuYW1lXS5wdXNoKGZ1bmMpO1xuICAgICAgICBoYW5kbGVySWRbaWRdID0gZnVuYztcbiAgICAgICAgcmV0dXJuIGlkO1xuICAgIH07XG4gICAgdGhpcy5lbWl0ID0gZnVuY3Rpb24obmFtZSl7XG4gICAgICAgIGlmIChuYW1lIGluIGV2ZW50cyl7XG4gICAgICAgICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtcbiAgICAgICAgICAgIGV2ZW50c1tuYW1lXS5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgICAgICAgICBldmVudC5hcHBseShudWxsLGFyZ3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMudW5iaW5kID0gZnVuY3Rpb24oaGFuZGxlcil7XG4gICAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICAgIGlmIChoYW5kbGVyIGluIGhhbmRsZXJJZCl7XG4gICAgICAgICAgICB2YXIgZnVuYyA9IGhhbmRsZXJJZFtoYW5kbGVyICsgJyddO1xuICAgICAgICAgICAgTGF6eShldmVudHMpLmVhY2goZnVuY3Rpb24odixrKXtcbiAgICAgICAgICAgICAgICB2YXIgaWR4ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbiBpbiB2KXtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZbbl0gPT09IGZ1bmMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWR4LnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlkeC5yZXZlcnNlKCkuZm9yRWFjaChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICAgICAgdi5zcGxpY2UoeCwxKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZSBoYW5kbGVySWRbaGFuZGxlcl07XG4gICAgICAgIHJldHVybiBjb3VudDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENhbGwgZXZlbnQgb25jZVxuICAgICAqL1xuICAgIHRoaXMub25jZSA9IGZ1bmN0aW9uKGV2ZW50TmFtZSwgaGFuZGxlckZ1bmN0aW9uKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGhhbmRsZXIgPSB0aGlzLm9uKGV2ZW50TmFtZSwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGhhbmRsZXJGdW5jdGlvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgc2VsZi51bmJpbmQoaGFuZGxlcik7XG4gICAgICAgIH0pXG4gICAgfVxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgY2FjaGVkS2V5SWR4ID0gMDtcblxudmFyIG51bGxTdHJpbmcgPSBmdW5jdGlvbigpIHsgcmV0dXJuICcnfTtcblxuZnVuY3Rpb24gbW9ja09iamVjdCgpe1xuICAgIHJldHVybiBuZXcgUHJveHkoe30sIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbih0YXJnZXQsIG5hbWUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgbmFtZSAgPT09ICdzdHJpbmcnKXtcbiAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gJ3RvU3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFN0cmluZztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXRpbHMubW9jaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRbbmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxufVxuXG4vKlxudmFyICRQT1NUID0gZnVuY3Rpb24odXJsLCBkYXRhLCBjYWxsQmFjaywgZXJyb3JCYWNrLGhlYWRlcnMpe1xuICAgIHZhciBvcHRzID0ge1xuICAgICAgICBhY2NlcHRzIDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB1cmwgOiB1cmwsXG4gICAgICAgIGRhdGEgOiBKU09OLnN0cmluZ2lmeShkYXRhKSxcbiAgICAgICAgZGF0YVR5cGUgOiAnanNvbicsXG4gICAgICAgIHN1Y2Nlc3MgOiBjYWxsQmFjayxcbiAgICAgICAgZXJyb3IgOiBlcnJvckJhY2ssXG4gICAgICAgIG1ldGhvZCA6ICdQT1NUJyxcbiAgICAgICAgY29udGVudFR5cGUgOiAnYXBwbGljYXRpb24vanNvbidcbiAgICB9O1xuICAgIGlmIChoZWFkZXJzKXtcbiAgICAgICAgb3B0cy5oZWFkZXJzID0gaGVhZGVycztcbiAgICAgICAgb3B0cy5jcm9zc0RvbWFpbiA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiAkLmFqYXgob3B0cyk7XG59XG5cblxuZnVuY3Rpb24gcmVXaGVlbENvbm5lY3Rpb24oZW5kUG9pbnQsIGdldExvZ2luKXtcbiAgICAvLyBtYWluIFxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLmdldExvZ2luID0gZ2V0TG9naW47XG4gICAgdGhpcy5ldmVudHMgPSBuZXcgTmFtZWRFdmVudE1hbmFnZXIoKVxuICAgIHRoaXMuJFBPU1QgPSAkUE9TVC5iaW5kKHRoaXMpO1xuICAgIHRoaXMub3B0aW9ucyA9IHtlbmRQb2ludCA6IGVuZFBvaW50fTtcbiAgICB0aGlzLm9uID0gdGhpcy5ldmVudHMub24uYmluZCh0aGlzKTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS51cGRhdGVTdGF0dXMgPSBmdW5jdGlvbihzdGF0dXMsIGNhbGxCYWNrLCBlcnJvcikge1xuICAgIGlmIChzdGF0dXMpIHtcbiAgICAgICAgdmFyIGlzTG9nZ2VkID0gKHN0YXR1cy51c2VyX2lkICYmICF0aGlzLm9wdGlvbnMudXNlcl9pZCApO1xuICAgICAgICBmb3IgKHZhciB4IGluIHN0YXR1cyl7IHRoaXMub3B0aW9uc1t4XSA9IHN0YXR1c1t4XTsgfVxuICAgICAgICBsb2NhbFN0b3JhZ2UubGFzdFJXVFN0YXR1cyA9IEpTT04uc3RyaW5naWZ5KHN0YXR1cyk7XG4gICAgICAgIGlmIChpc0xvZ2dlZCkge1xuICAgICAgICAgICAgdGhpcy5ldmVudHMuZW1pdCgnbG9naW4nLCB0aGlzLm9wdGlvbnMudXNlcl9pZCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCF0aGlzLm9wdGlvbnMudXNlcl9pZCAmJiB0aGlzLmdldExvZ2luKXtcbiAgICAgICAgdmFyIGxvZ0luZm8gPSB0aGlzLmdldExvZ2luKGVycm9yKTtcbiAgICAgICAgaWYgKGxvZ0luZm8uY29uc3RydWN0b3IgPT09IE9iamVjdCl7XG4gICAgICAgICAgICB0aGlzLmxvZ2luKGxvZ0luZm8udXNlcm5hbWUsIGxvZ0luZm8ucGFzc3dvcmQpXG4gICAgICAgICAgICAudGhlbigoZnVuY3Rpb24oc3RhdHVzKXtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1cyhzdGF0dXMsIGNhbGxCYWNrKTtcbiAgICAgICAgICAgIH0pLmJpbmQodGhpcykpO1xuICAgICAgICB9IGVsc2UgaWYgKGxvZ0luZm8uY29uc3RydWN0b3IgPT09IFByb21pc2UpIHtcbiAgICAgICAgICAgIGxvZ0luZm8udGhlbigoZnVuY3Rpb24ob2JqKXtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IHRoaXMubG9naW4ob2JqLnVzZXJuYW1lLG9iai5wYXNzd29yZCk7XG4gICAgICAgICAgICAgICAgdmFyIG1hbmFnZUVycm9yID0gKGZ1bmN0aW9uKGJhZCl7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzKG51bGwsY2FsbEJhY2ssYmFkLmVycm9yKTtcbiAgICAgICAgICAgICAgICB9KS5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmIChjYWxsQmFjayl7XG4gICAgICAgICAgICAgICAgICAgIHgudGhlbihjYWxsQmFjayxtYW5hZ2VFcnJvcik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgeC50aGVuKG51bGwsIG1hbmFnZUVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHRoaXMub3B0aW9ucyk7XG4gICAgfSAgICBcbn1cblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLnN0YXR1cyA9IGZ1bmN0aW9uKGNhbGxCYWNrLCBmb3JjZSl7XG4gICAgaWYgKCgnbGFzdFJXVFN0YXR1cycgaW4gbG9jYWxTdG9yYWdlKSAmJiAhZm9yY2UpIHtcbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgdmFyIHN0YXR1cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmxhc3RSV1RTdGF0dXMpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0dXMoc3RhdHVzLGNhbGxCYWNrKTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdGF0dXMoY2FsbEJhY2ssIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYWxsQmFjayAmJiBjYWxsQmFjayhzdGF0dXMpO1xuICAgIH1cbiAgICBpZiAodGhpcy5fc3RhdHVzX2NhbGxpbmcpe1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzZWxmLnN0YXR1cyhjYWxsQmFjayk7XG4gICAgICAgIH0sNTApO1xuICAgIH1cbiAgICBpZiAodGhpcy5vcHRpb25zICYmIHRoaXMub3B0aW9ucy50aW1lc3RhbXApe1xuICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayh0aGlzLm9wdGlvbnMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3N0YXR1c19jYWxsaW5nID0gdHJ1ZTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdGhpcy4kcG9zdCgnYXBpL3N0YXR1cycsbnVsbCxmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmxhc3RSV1RTdGF0dXMgPSBKU09OLnN0cmluZ2lmeShzdGF0dXMpO1xuICAgICAgICAgICAgc2VsZi5fc3RhdHVzX2NhbGxpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHNlbGYudXBkYXRlU3RhdHVzKHN0YXR1cyxjYWxsQmFjayk7XG4gICAgICAgIH0pOyAgICAgICAgXG4gICAgfVxufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLiRwb3N0ID0gZnVuY3Rpb24odXJsLCBkYXRhLGNhbGxCYWNrKXtcbiAgICB2YXIgdGhzID0gdGhpcztcbiAgICBpZiAodGhpcy5vcHRpb25zICYmIHRoaXMub3B0aW9ucy50b2tlbil7XG4gICAgICAgIGlmICghZGF0YSl7XG4gICAgICAgICAgICBkYXRhID0ge307XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRoaXMub3B0aW9ucy50b2tlbil7XG4gICAgICAgIHZhciBoZWFkZXJzID0geyBcbiAgICAgICAgICAgIHRva2VuIDogdGhpcy5vcHRpb25zLnRva2VuLFxuICAgICAgICAgICAgYXBwbGljYXRpb24gOiB0aGlzLm9wdGlvbnMuYXBwbGljYXRpb25cbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgaGVhZGVycyA9IG51bGw7XG4gICAgfVxuXG4gICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQscmVqZWN0KXtcbiAgICAgICAgdXRpbHMueGRyKHRocy5vcHRpb25zLmVuZFBvaW50ICsgdXJsLCBkYXRhLCB0aHMub3B0aW9ucy5hcHBsaWNhdGlvbiwgdGhzLm9wdGlvbnMudG9rZW4pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbih4aHIpe1xuICAgICAgICAgICAgICAgIHRocy5ldmVudHMuZW1pdCgnaHR0cC1yZXNwb25zZScsIHhoci5yZXNwb25zZVRleHQsIHhoci5zdGF0dXMsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdodHRwLXJlc3BvbnNlLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VUZXh0LCB1cmwsIGRhdGEpO1xuICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VEYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdodHRwLXJlc3BvbnNlLScgKyB4aHIuc3RhdHVzICsgJy1qc29uJywgeGhyLnJlc3BvbnNlRGF0YSwgdXJsLCBkYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxCYWNrKSB7IGNhbGxCYWNrKCB4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQgKX07XG4gICAgICAgICAgICAgICAgYWNjZXB0KHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbih4aHIpIHtcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlRGF0YSl7XG4gICAgICAgICAgICAgICAgICAgIHRocy5ldmVudHMuZW1pdCgnZXJyb3ItanNvbicsIHhoci5yZXNwb25zZURhdGEsIHhoci5zdGF0dXMsIHVybCwgZGF0YSwgeGhyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1qc29uLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VEYXRhLHVybCwgZGF0YSwgeGhyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1odHRwJyx4aHIucmVzcG9uc2VUZXh0LCB4aHIuc3RhdHVzLHVybCxkYXRhLHhocik7XG4gICAgICAgICAgICAgICAgICAgIHRocy5ldmVudHMuZW1pdCgnZXJyb3ItaHR0cC0nICsgeGhyLnN0YXR1cywgeGhyLnJlc3BvbnNlVGV4dCx1cmwsZGF0YSx4aHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZWplY3QoeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICByZXR1cm4gcHJvbWlzZTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCl7XG4gICAgdmFyIHVybCA9IHRoaXMub3B0aW9ucy5lbmRQb2ludCArICdhcGkvbG9naW4nO1xuICAgIHZhciBjb25uZWN0aW9uID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LHJlamVjdCl7XG4gICAgICAgIHV0aWxzLnhkcih1cmwseyB1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkIDogcGFzc3dvcmR9LCBudWxsLGNvbm5lY3Rpb24ub3B0aW9ucy50b2tlbiwgdHJ1ZSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgY29ubmVjdGlvbi51cGRhdGVTdGF0dXMoeGhyLnJlc3BvbnNlRGF0YSk7XG4gICAgICAgICAgICAgICAgYWNjZXB0KHN0YXR1cyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbih4aHIpe1xuICAgICAgICAgICAgICAgIHJlamVjdCh4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uKGNhbGxCYWNrKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHdzY29ubmVjdCA9IGZ1bmN0aW9uKHNlbGYpe1xuICAgICAgICBzZWxmLndzQ29ubmVjdGlvbiA9IG5ldyB1dGlscy53c0Nvbm5lY3Qoc2VsZi5vcHRpb25zKTtcbiAgICAgICAgc2VsZi53c0Nvbm5lY3Rpb24ub25Db25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzZWxmLmV2ZW50cy5lbWl0KCd3cy1jb25uZWN0ZWQnLCBzZWxmLndzQ29ubmVjdGlvbik7XG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLndzQ29ubmVjdGlvbi5vbkRpc2Nvbm5lY3QoZnVuY3Rpb24oKXsgXG4gICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zICYmIHNlbGYub3B0aW9ucy5yZWFsdGltZUVuZFBvaW50KXtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIHdzY29ubmVjdChzZWxmKTsgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfSwxMDAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0aGlzLnN0YXR1cygoZnVuY3Rpb24oc3RhdHVzKXtcbiAgICAgICAgaWYgKCd0b2tlbicgaW4gc2VsZi5vcHRpb25zKXtcbiAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHN0YXR1cyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY29ubmVjdGluZyB0byAnICsgc2VsZi5vcHRpb25zLmVuZFBvaW50KTtcbiAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMudXNlcm5hbWUgJiYgc2VsZi5vcHRpb25zLnBhc3N3b3JkKXtcbiAgICAgICAgICAgICAgICBzZWxmLmxvZ2luKFxuICAgICAgICAgICAgICAgICAgICBzZWxmLm9wdGlvbnMudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNlbGYub3B0aW9ucy5wYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZW5ld2luZyBjb25uZWN0aW9uJylcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5vcHRpb25zLnRva2VuICYmIHNlbGYub3B0aW9ucy5yZWFsdGltZUVuZFBvaW50ICYmICghc2VsZi53c0Nvbm5lY3Rpb24pKXtcbiAgICAgICAgICAgIHdzY29ubmVjdChzZWxmKTtcbiAgICAgICAgfVxuICAgIH0pLmJpbmQodGhpcykpO1xufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLmxvZ091dCA9IGZ1bmN0aW9uKHVybCwgY2FsbEJhY2spe1xuICAgIHJldHVybiB0aGlzLiRwb3N0KCdhcGkvbG9nb3V0Jyx7fSwoZnVuY3Rpb24oc3RhdHVzKSB7XG4gICAgICAgIGlmICgnbGFzdFJXVFN0YXR1cycgaW4gbG9jYWxTdG9yYWdlKSB7XG4gICAgICAgICAgICBkZWxldGUgbG9jYWxTdG9yYWdlLmxhc3RSV1RTdGF0dXM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vcHRpb25zID0ge2VuZFBvaW50OiB0aGlzLm9wdGlvbnMuZW5kUG9pbnR9O1xuICAgICAgICBpZiAodGhpcy53c0Nvbm5lY3Rpb24pIHsgXG4gICAgICAgICAgICB0aGlzLndzQ29ubmVjdGlvbi5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy53c0Nvbm5lY3Rpb24gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmwpIHsgbG9jYXRpb24gPSB1cmw7IH1cbiAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2soKTtcbiAgICB9KS5iaW5kKHRoaXMpKTtcbn1cbiovXG52YXIgdXRpbHMgPSB7XG4gICAgcmVuYW1lRnVuY3Rpb24gOiBmdW5jdGlvbiAobmFtZSwgZm4pIHtcbiAgICAgICAgcmV0dXJuIChuZXcgRnVuY3Rpb24oXCJyZXR1cm4gZnVuY3Rpb24gKGNhbGwpIHsgcmV0dXJuIGZ1bmN0aW9uIFwiICsgbmFtZSArXG4gICAgICAgICAgICBcIiAoKSB7IHJldHVybiBjYWxsKHRoaXMsIGFyZ3VtZW50cykgfTsgfTtcIikoKSkoRnVuY3Rpb24uYXBwbHkuYmluZChmbikpO1xuICAgIH0sXG4gICAgY2FjaGVkIDogZnVuY3Rpb24oZnVuYywga2V5KXtcbiAgICAgICAgaWYgKCFrZXkpeyAgICBcbiAgICAgICAgICAgIGtleSA9ICdfJyArIGNhY2hlZEtleUlkeCsrO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHdyYXBwZXIoKXtcbiAgICAgICAgICAgIGlmICghdGhpc1trZXldKXtcbiAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSBmdW5jLmNhbGwodGhpcyxbYXJndW1lbnRzXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpc1trZXldO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gd3JhcHBlcjtcbiAgICB9LFxuLy8gICAgJFBPU1QgOiAkUE9TVCxcbi8vICAgIHJlV2hlZWxDb25uZWN0aW9uOiByZVdoZWVsQ29ubmVjdGlvbixcbiAgICBsb2c6IGZ1bmN0aW9uKCl7IFxuICAgICAgICBjb25zb2xlLmxvZyhhcmd1bWVudHMpO1xuICAgIH0sXG5cbiAgICB4ZHI6IGZ1bmN0aW9uICh1cmwsIGRhdGEsIGFwcGxpY2F0aW9uLHRva2VuLCBmb3JtRW5jb2RlKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlIGFuIEhUVFAgUmVxdWVzdCBhbmQgcmV0dXJuIGl0cyBwcm9taXNlLlxuICAgICAgICAgKi9cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgcmVxO1xuICAgICAgICAgICAgaWYgKCFkYXRhKSB7IGRhdGEgPSB7fTt9XG5cbiAgICAgICAgICAgIGlmKFhNTEh0dHBSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgcmVxID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgcmVxLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVxLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VEYXRhID0gSlNPTi5wYXJzZShyZXEucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0ge3Jlc3BvbnNlRGF0YTogcmVzcG9uc2VEYXRhLCByZXNwb25zZVRleHQ6IHJlcS5yZXNwb25zZVRleHQsc3RhdHVzOiByZXEuc3RhdHVzLCByZXF1ZXN0OiByZXF9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcS5zdGF0dXMgPj0gMjAwICYmIHJlcS5zdGF0dXMgPCA0MDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZihYRG9tYWluUmVxdWVzdCl7XG4gICAgICAgICAgICAgICAgcmVxID0gbmV3IFhEb21haW5SZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgcmVxLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBhY2NlcHQocmVxLnJlc3BvbnNlVGV4dCxyZXEuc3RhdHVzVGV4dCwgcmVxKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdDT1JTIG5vdCBzdXBwb3J0ZWQnKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlcS5vcGVuKCdQT1NUJywgdXJsLCB0cnVlKTtcbiAgICAgICAgICAgIHJlcS5vbmVycm9yID0gcmVqZWN0O1xuICAgICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICAgICAgICAgIGlmICh0b2tlbikgeyBkYXRhLl9fdG9rZW5fXyA9IHRva2VuIH1cbiAgICAgICAgICAgIGlmICghZm9ybUVuY29kZSl7XG4gICAgICAgICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsJ3RleHQvcGxhaW4nKTtcbiAgICAgICAgICAgICAgICBkYXRhID0gTGF6eShkYXRhKS5zaXplKCk/SlNPTi5zdHJpbmdpZnkoZGF0YSk6Jyc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTtcbiAgICAgICAgICAgICAgICBkYXRhID0gTGF6eShkYXRhKS5tYXAoZnVuY3Rpb24odixrKXtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBrICsgJz0nICsgZW5jb2RlVVJJKHYudG9TdHJpbmcoKSk7ICBcbiAgICAgICAgICAgICAgICB9KS50b0FycmF5KCkuam9pbignJicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVxLnNlbmQoZGF0YSk7XG4gICAgLy8gICAgICAgIHJlcS5zZW5kKG51bGwpO1xuICAgICAgICB9KVxuICAgIH0sXG4gICAgXG4gICAgY2FwaXRhbGl6ZSA6IGZ1bmN0aW9uIChzKSB7XG4gICAgICAgIHJldHVybiBzWzBdLnRvVXBwZXJDYXNlKCkgKyBzLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG4gICAgfSxcblxuICAgIGhhc2ggOiBmdW5jdGlvbihzdHIpe1xuICAgICAgICAvKipcbiAgICAgICAgICogSGFzaGVkIGZ1bmN0aW9uXG4gICAgICAgICAqL1xuICAgICAgICBzdHIgPSBzdHIudG9TdHJpbmcoKTtcbiAgICAgICAgdmFyIHJldCA9IDE7XG4gICAgICAgIGZvciAodmFyIHggPSAwO3g8c3RyLmxlbmd0aDt4Kyspe1xuICAgICAgICAgICAgcmV0ICo9ICgxICsgc3RyLmNoYXJDb2RlQXQoeCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAocmV0ICUgMzQ5NTgzNzQ5NTcpLnRvU3RyaW5nKCk7XG4gICAgfSxcblxuICAgIG1ha2VGaWx0ZXIgOiBmdW5jdGlvbiAobW9kZWwsIGZpbHRlciwgdW5pZmllciwgZG9udFRyYW5zbGF0ZUZpbHRlcikge1xuICAgICAgICAvKipcbiAgICAgICAgICogTWFrZSBmaWx0ZXIgZm9yIEFycmF5LmZpbHRlciBmdW5jdGlvbiBhcyBhbiBhbmQgb2Ygb3JcbiAgICAgICAgICovXG4gICAgICAgIGlmICghdW5pZmllcikgeyB1bmlmaWVyID0gJyAmJiAnO31cbiAgICAgICAgaWYgKExhenkoZmlsdGVyKS5zaXplKCkgPT09IDApe1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHgpeyByZXR1cm4gdHJ1ZSB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBzb3VyY2UgPSBMYXp5KGZpbHRlcikubWFwKGZ1bmN0aW9uKHZhbHMsIGZpZWxkKXtcbiAgICAgICAgICAgIGlmICghdmFscykgeyB2YWxzID0gW251bGxdfVxuICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHMpKXtcbiAgICAgICAgICAgICAgICB2YWxzID0gW3ZhbHNdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFkb250VHJhbnNsYXRlRmlsdGVyICYmIChtb2RlbC5maWVsZHNbZmllbGRdLnR5cGUgPT09ICdyZWZlcmVuY2UnKSkge1xuICAgICAgICAgICAgICAgIGZpZWxkID0gJ18nICsgZmllbGQ7XG4gICAgICAgICAgICAgICAgdmFscyA9IExhenkodmFscykubWFwKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICBpZiAoeCAmJiAoeC5jb25zdHJ1Y3RvciAhPT0gTnVtYmVyKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geC5pZDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHg7XG4gICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChtb2RlbC5maWVsZHNbZmllbGRdLnR5cGUgPT09ICdzdHJpbmcnKXtcbiAgICAgICAgICAgICAgICB2YWxzID0gdmFscy5tYXAoSlNPTi5zdHJpbmdpZnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICcoJyArICBMYXp5KHZhbHMpLm1hcChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICBpZiAoIXgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignbWFrZUZpbHRlciB4IGlzIG51bGwnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoeCA9PT0gb3JtLnV0aWxzLm1vY2spIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignbWFrZUZpbHRlciB3aXRoIE1vY2sgT2JqZWN0Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAnKHguJyArIGZpZWxkICsgJyA9PT0gJyArIHggKyAnKSc7XG4gICAgICAgICAgICB9KS5qb2luKCcgfHwgJykgICsnKSc7XG4gICAgICAgIH0pLnRvQXJyYXkoKS5qb2luKHVuaWZpZXIpO1xuICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKFwieFwiLCBcInJldHVybiBcIiArIHNvdXJjZSk7XG4gICAgfSxcblxuICAgIHNhbWVBcyA6IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZWVwIGVxdWFsXG4gICAgICAgICAqL1xuICAgICAgICBmb3IgKHZhciBrIGluIHgpIHtcbiAgICAgICAgICAgIGlmICh5W2tdICE9IHhba10pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBcbiAgICBwbHVyYWxpemUgOiBmdW5jdGlvbihzdHIsIG1vZGVsKXtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIExleGljYWxseSByZXR1cm5zIGVuZ2xpc2ggcGx1cmFsIGZvcm1cbiAgICAgICAgICovXG4gICAgICAgIHJldHVybiBzdHIgKyAncyc7XG4gICAgfSxcblxuICAgIGJlZm9yZUNhbGwgOiBmdW5jdGlvbihmdW5jLCBiZWZvcmUpe1xuICAgICAgICB2YXIgZGVjb3JhdG9yID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGJlZm9yZSgpLnRoZW4oZnVuYylcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGRlY29yYXRvcjtcbiAgICB9LFxuXG4gICAgY2xlYW5TdG9yYWdlIDogZnVuY3Rpb24oKXtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENsZWFuIGxvY2FsU3RvcmFnZSBvYmplY3RcbiAgICAgICAgICovXG4gICAgICAgIExhenkobG9jYWxTdG9yYWdlKS5rZXlzKCkuZWFjaChmdW5jdGlvbihrKXtcbiAgICAgICAgICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2Vba107XG4gICAgICAgIH0pXG4gICAgfSxcblxuICAgIGNsZWFuRGVzY3JpcHRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICBMYXp5KGxvY2FsU3RvcmFnZSlcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24odiwgbikgeyByZXR1cm4gTGF6eShuKS5zdGFydHNXaXRoKCdkZXNjcmlwdGlvbjonKX0pXG4gICAgICAgICAgICAua2V5cygpXG4gICAgICAgICAgICAuZWFjaChmdW5jdGlvbihuKSB7IGRlbGV0ZSBsb2NhbFN0b3JhZ2Vbbl0gfSk7XG4gICAgfSxcbiAgICBcbiAgICByZXZlcnNlIDogZnVuY3Rpb24gKGNociwgc3RyKSB7XG4gICAgICAgIHJldHVybiBzdHIuc3BsaXQoY2hyKS5yZXZlcnNlKCkuam9pbihjaHIpO1xuICAgIH0sXG4gICAgcGVybXV0YXRpb25zOiBmdW5jdGlvbihhcnIpe1xuICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgIGZvciAodmFyIHggPSBhcnIubGVuZ3RoLTE7IHggPj0gMDt4LS0pe1xuICAgICAgICAgICAgZm9yICh2YXIgeSA9IGFyci5sZW5ndGgtMTsgeSA+PSAwOyB5LS0pe1xuICAgICAgICAgICAgICAgIGlmICh4ICE9PSB5KVxuICAgICAgICAgICAgICAgICAgICByZXQucHVzaChbYXJyW3hdLCBhcnJbeV1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH0sXG5cbiAgICB3YWl0Rm9yOiBmdW5jdGlvbihmdW5jLCBjYWxsQmFjaykge1xuICAgICAgICB2YXIgd2FpdGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoZnVuYygpKSB7XG4gICAgICAgICAgICAgICAgY2FsbEJhY2soKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCh3YWl0ZXIsNTAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzZXRUaW1lb3V0KHdhaXRlciwgNTAwKTtcbiAgICB9LFxuXG4gICAgYm9vbDogQm9vbGVhbixcblxuICAgIG5vb3AgOiBmdW5jdGlvbigpe30sXG5cbiAgICB0ek9mZnNldDogbmV3IERhdGUoKS5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDAsXG5cbiAgICB0cmFuc0ZpZWxkVHlwZToge1xuICAgICAgICBkYXRlOiBmdW5jdGlvbih4KSB7IHJldHVybiBuZXcgRGF0ZSh4ICogMTAwMCArIHV0aWxzLnR6T2Zmc2V0ICkgfSxcbiAgICAgICAgZGF0ZXRpbWU6IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIG5ldyBEYXRlKHggKiAxMDAwICsgdXRpbHMudHpPZmZzZXQgKSB9LFxuICAgICAgICBzdHJpbmc6IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHgudG9TdHJpbmcoKTsgfSxcbiAgICAgICAgdGV4dDogZnVuY3Rpb24oeCkgeyByZXR1cm4geC50b1N0cmluZygpOyB9LFxuICAgICAgICBpbnRlZ2VyOiBmdW5jdGlvbih4KSB7IHJldHVybiBwYXJzZUludCh4KTsgfSxcbiAgICAgICAgZmxvYXQ6IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHBhcnNlRmxvYXQoeCk7IH1cbiAgICB9LCBcbiAgICBtb2NrIDogbW9ja09iamVjdCgpXG59O1xuXG5cbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIFNUQVRVU0tFWSA9ICdsYXN0UldUQ29ubmVjdGlvblN0YXR1cyc7XG5cbmZ1bmN0aW9uIFJlYWx0aW1lQ29ubmVjdGlvbihlbmRQb2ludCwgcnd0Q29ubmVjdGlvbil7XG4gICAgLyoqXG4gICAgICogQ29ubmVjdHMgYSB3ZWJzb2NrZXQgd2l0aCByZVdoZWVsIGNvbm5lY3Rpb25cbiAgICAgKi9cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICB2YXIgY29ubmVjdGlvbiA9IG5ldyBTb2NrSlMoZW5kUG9pbnQpO1xuICAgIGNvbm5lY3Rpb24ub25vcGVuID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ29wZW4gOiAnICsgeCk7XG4gICAgICAgIGNvbm5lY3Rpb24udGVuYW50KCk7XG4gICAgICAgIHJ3dENvbm5lY3Rpb24uZW1pdCgncmVhbHRpbWUtY29ubmVjdGlvbi1vcGVuJyx4KTtcbiAgICB9O1xuICAgIGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgaWYgKHgudHlwZSA9PSAnbWVzc2FnZScpIHtcbiAgICAgICAgICAgIC8vJC5ub3RpZnkoeC5kYXRhKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy9UT0RPIHNldCBmcm9tUmVhbHRpbWVcbiAgICAgICAgICAgICAgICByd3RDb25uZWN0aW9uLmVtaXQoJ3JlYWx0aW1lLW1lc3NhZ2UtanNvbicsIEpTT04ucGFyc2UoeC5kYXRhKSk7XG4gICAgICAgICAgICAgICAgLy9UT0RPIHVuc2V0IGZyb21SZWFsdGltZVxuICAgICAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAgICAgcnd0Q29ubmVjdGlvbi5lbWl0KCdyZWFsdGltZS1tZXNzYWdlLXRleHQnLCBKU09OLnBhcnNlKHguZGF0YSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Zyb20gcmVhbHRpbWUgJyx4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29ubmVjdGlvbi5vbmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBzZXRUaW1lb3V0KHV0aWxzLndzQ29ubmVjdCwxMDAwKTtcbiAgICAgICAgcnd0Q29ubmVjdGlvbi5lbWl0KCdyZWFsdGltZS1jb25uZWN0aW9uLWNsb3NlZCcpO1xuICAgIH07XG4gICAgY29ubmVjdGlvbi50ZW5hbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbm5lY3Rpb24uc2VuZCgnVEVOQU5UOicgKyByd3RDb25uZWN0aW9uLmNhY2hlZFN0YXR1cy5hcHBsaWNhdGlvbiArICc6JyArIHJ3dENvbm5lY3Rpb24uY2FjaGVkU3RhdHVzLnRva2VuKTtcbiAgICB9XG4gICAgdGhpcy5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25uZWN0aW9uLmNsb3NlKCk7XG4gICAgfVxufSAgICBcblxuZnVuY3Rpb24gcmVXaGVlbENvbm5lY3Rpb24oZW5kUG9pbnQsIGdldExvZ2luKXtcbiAgICAvKipcbiAgICAgKiBDb25uZWN0aW9uIGJhc2ljIGZvciByZVdoZWVsXG4gICAgICogQHBhcmFtIGVuZFBvaW50OiBzdHJpbmcgYmFzZSB1cmwgZm9yIGFsbCBjb211bmljYXRpb25cbiAgICAgKiBAcGFyYW0gZ2V0TG9naW46IGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBpbiBjYXNlIG9mIG1pc3NpbmcgbG9naW4uXG4gICAgICogIHRoaXMgZnVuY3Rpb24gY291bGQgcmV0dXJuIDpcbiAgICAgKiAgLSAgIGEgeyB1c2VybmFtZSA6IDx1c2VybmFtZT4gLCBwYXNzd29yZDogPHBhc3N3b3JkPn0gb3JcbiAgICAgKiAgLSAgIGIgUHJvbWlzZSAtPiB7IHVzZXJuYW1lIDogPHVzZXJuYW1lPiAsIHBhc3N3b3JkOiA8cGFzc3dvcmQ+fVxuICAgICAqL1xuICAgIC8vIG1haW4gaW5pdGlhbGl6YXRpb25cbiAgICB2YXIgZXZlbnRzID0gbmV3IE5hbWVkRXZlbnRNYW5hZ2VyKCk7XG4gICAgdGhpcy5nZXRMb2dpbiA9IGdldExvZ2luO1xuICAgIHRoaXMuZW5kUG9pbnQgPSBlbmRQb2ludC5lbmRzV2l0aCgnLycpPyBlbmRQb2ludDogKGVuZFBvaW50ICsgJy8nKTtcbiAgICB0aGlzLm9uID0gZXZlbnRzLm9uO1xuICAgIHRoaXMudW5iaW5kID0gZXZlbnRzLnVuYmluZDtcbiAgICB0aGlzLmVtaXQgPSBldmVudHMuZW1pdDtcbiAgICB0aGlzLm9uY2UgPSBldmVudHMub25jZTtcbiAgICB0aGlzLmNhY2hlZFN0YXR1cyA9IHt9O1xuICAgIHRoaXMuaXNDb25uZWN0ZWQgPSBmYWxzZTtcbiAgICB0aGlzLmlzTG9nZ2VkSW4gPSBmYWxzZTtcbiAgICAvLyByZWdpc3RlcmluZyB1cGRhdGUgc3RhdHVzXG4gICAgdmFyIHRocyA9IHRoaXM7XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuJHBvc3QgPSBmdW5jdGlvbih1cmwsIGRhdGEsY2FsbEJhY2spe1xuICAgIC8qKlxuICAgICAqIEFKQVggY2FsbCBmb3IgZmV0Y2ggYWxsIGRhdGEgZnJvbSBzZXJ2ZXJcbiAgICAgKiBAcGFyYW0gdXJsOiBsYXN0IHVybCBwYXJ0IGZvciBhamF4IGNhbGxcbiAgICAgKiBAcGFyYW0gZGF0YTogZGF0YSBvYmplY3QgdG8gYmUgc2VudFxuICAgICAqIEBwYXJhbSBjYWxsQmFjazogZnVuY3Rpb24oeGhyKSB3aWxsIGJlIGNhbGxlZCB3aGVuIGRhdGEgYXJyaXZlc1xuICAgICAqIEByZXR1cm5zIFByb21pc2U8eGhyPiBzYW1lIG9mIGNhbGxCYWNrXG4gICAgICovXG4gICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICB2YXIgdGhzID0gdGhpcztcbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCxyZWplY3Qpe1xuICAgICAgICB1dGlscy54ZHIodGhzLmVuZFBvaW50ICsgdXJsLCBkYXRhLCB0aHMuY2FjaGVkU3RhdHVzLmFwcGxpY2F0aW9uLCB0aHMuY2FjaGVkU3RhdHVzLnRva2VuKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oeGhyKXtcbiAgICAgICAgICAgICAgICB0aHMuZW1pdCgnaHR0cC1yZXNwb25zZScsIHhoci5yZXNwb25zZVRleHQsIHhoci5zdGF0dXMsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgdGhzLmVtaXQoJ2h0dHAtcmVzcG9uc2UtJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZVRleHQsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZURhdGEpe1xuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnaHR0cC1yZXNwb25zZS0nICsgeGhyLnN0YXR1cyArICctanNvbicsIHhoci5yZXNwb25zZURhdGEsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjYWxsQmFjaykgeyBjYWxsQmFjayggeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0ICl9O1xuICAgICAgICAgICAgICAgIGFjY2VwdCh4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oeGhyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZURhdGEpe1xuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnZXJyb3ItanNvbicsIHhoci5yZXNwb25zZURhdGEsIHhoci5zdGF0dXMsIHVybCwgZGF0YSwgeGhyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmVtaXQoJ2Vycm9yLWpzb24tJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZURhdGEsdXJsLCBkYXRhLCB4aHIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnZXJyb3ItaHR0cCcseGhyLnJlc3BvbnNlVGV4dCwgeGhyLnN0YXR1cyx1cmwsZGF0YSx4aHIpO1xuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnZXJyb3ItaHR0cC0nICsgeGhyLnN0YXR1cywgeGhyLnJlc3BvbnNlVGV4dCx1cmwsZGF0YSx4aHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZWplY3QoeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICByZXR1cm4gcHJvbWlzZTtcbn07XG5cbi8qKlxuICogQ2hlY2sgY3VycmVudCBzdGF0dXMgYW5kIGNhbGxiYWNrIGZvciByZXN1bHRzLlxuICogSXQgY2FjaGVzIHJlc3VsdHMgZm9yIGZ1cnRoZXIuXG4gKiBAcGFyYW0gY2FsbGJhY2s6IChzdGF0dXMgb2JqZWN0KVxuICogQHBhcmFtIGZvcmNlOiBib29sZWFuIGlmIHRydWUgZW1wdGllcyBjYWNoZSAgXG4gKiBAcmV0dXJuIHZvaWRcbiAqL1xucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLnN0YXR1cyA9IGZ1bmN0aW9uKGNhbGxCYWNrLCBmb3JjZSkge1xuICAgIC8vIGlmIGZvcmNlLCBjbGVhciBhbGwgY2FjaGVkIHZhbHVlc1xuICAgIHZhciBrZXkgPSAndG9rZW46JyArIHRoaXMuZW5kUG9pbnQ7XG4gICAgdmFyIHRocyA9IHRoaXM7XG4gICAgaWYgKGZvcmNlKSB7XG4gICAgICAgIHRoaXMuY2FjaGVkU3RhdHVzID0ge307XG4gICAgICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2Vba2V5XTtcbiAgICB9XG4gICAgaWYgKHRoaXMuc3RhdHVzV2FpdGluZykge1xuICAgICAgICAvLyB3YWl0IGZvciBzdGF0dXNcbiAgICAgICAgdXRpbHMud2FpdEZvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAhdGhzLnN0YXR1c1dhaXRpbmc7XG4gICAgICAgIH0sIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB0aHMuc3RhdHVzKGNhbGxCYWNrLGZvcmNlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gdHJ5IGZvciB2YWx1ZSByZXNvbHV0aW9uXG4gICAgLy8gZmlyc3Qgb24gbWVtb3J5XG4gICAgaWYgKExhenkodGhpcy5jYWNoZWRTdGF0dXMpLnNpemUoKSl7XG4gICAgICAgIGNhbGxCYWNrKHRoaXMuY2FjaGVkU3RhdHVzKVxuICAgIC8vIHRoZW4gaW4gbG9jYWxTdG9yYWdlXG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7fTtcbiAgICAgICAgaWYgKGtleSBpbiBsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgIGRhdGEuX190b2tlbl9fID0gbG9jYWxTdG9yYWdlW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdGF0dXNXYWl0aW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy4kcG9zdCgnYXBpL3N0YXR1cycsZGF0YSwgZnVuY3Rpb24oc3RhdHVzKXtcbiAgICAgICAgICAgIHRocy51cGRhdGVTdGF0dXMoc3RhdHVzKTtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZVtrZXldID0gc3RhdHVzLnRva2VuO1xuICAgICAgICAgICAgY2FsbEJhY2soc3RhdHVzKTtcbiAgICAgICAgICAgIHRocy5zdGF0dXNXYWl0aW5nID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBkb2Vzbid0IGNhbGwgY2FsbGJhY2tcbiAgICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNhbGxCYWNrKHRoaXMuY2FjaGVkU3RhdHVzKTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS51cGRhdGVTdGF0dXMgPSBmdW5jdGlvbihzdGF0dXMpe1xuICAgIHZhciBsYXN0QnVpbGQgPSBwYXJzZUZsb2F0KGxvY2FsU3RvcmFnZS5sYXN0QnVpbGQpIHx8IDE7XG4gICAgaWYgKGxhc3RCdWlsZCA8IHN0YXR1cy5sYXN0X2J1aWxkKXtcbiAgICAgICAgdXRpbHMuY2xlYW5EZXNjcmlwdGlvbigpO1xuICAgICAgICBsb2NhbFN0b3JhZ2UubGFzdEJ1aWxkID0gc3RhdHVzLmxhc3RfYnVpbGQ7XG4gICAgfVxuICAgIHRoaXMuaXNDb25uZWN0ZWQgPSBCb29sZWFuKHN0YXR1cy50b2tlbik7XG4gICAgdGhpcy5pc0xvZ2dlZEluID0gQm9vbGVhbihzdGF0dXMudXNlcl9pZCk7XG4gICAgdmFyIG9sZFN0YXR1cyA9IHRoaXMuY2FjaGVkU3RhdHVzO1xuICAgIHRoaXMuY2FjaGVkU3RhdHVzID0gc3RhdHVzO1xuICAgIGlmICghb2xkU3RhdHVzLnVzZXJfaWQgJiYgc3RhdHVzLnVzZXJfaWQpe1xuICAgICAgICB0aGlzLmVtaXQoJ2xvZ2dlZC1pbicsc3RhdHVzLnVzZXJfaWQpO1xuICAgIH0gZWxzZSBpZiAob2xkU3RhdHVzLnVzZXJfaWQgJiYgIXN0YXR1cy51c2VyX2lkKXtcbiAgICAgICAgdGhpcy5lbWl0KCdsb2dnZWQtb3V0Jyk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzQ29ubmVjdGVkICYmICF0aGlzLmlzTG9nZ2VkSW4pe1xuICAgICAgICB0aGlzLmVtaXQoJ2xvZ2luLXJlcXVpcmVkJyk7XG4gICAgICAgIGlmICh0aGlzLmdldExvZ2luKXtcbiAgICAgICAgICAgIHZhciBsb2dpbkluZm8gPSB0aGlzLmdldExvZ2luKCk7XG4gICAgICAgICAgICBpZiAobG9naW5JbmZvLmNvbnN0cnVjdG9yID09PSBPYmplY3Qpe1xuICAgICAgICAgICAgICAgIHRoaXMubG9naW4obG9naW5JbmZvLnVzZXJuYW1lLCBsb2dpbkluZm8ucGFzc3dvcmQsIGxvZ2luSW5mby5jYWxsQmFjayk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGxvZ2luSW5mby5jb25zdHJ1Y3RvciA9PT0gUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgIGxvZ2luSW5mby50aGVuKGZ1bmN0aW9uKG9iail7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9naW4ob2JqLnVzZXJuYW1lLCBvYmoucGFzc3dvcmQsIG9iai5jYWxsQmFjayk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyByZWFsdGltZSBjb25uZWN0aW9uIGlzIHNldHRlZFxuICAgIGlmICghb2xkU3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQgJiYgc3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQpIHtcbiAgICAgICAgdGhpcy53c0Nvbm5lY3Rpb24gPSBuZXcgUmVhbHRpbWVDb25uZWN0aW9uKHN0YXR1cy5yZWFsdGltZUVuZFBvaW50LCB0aGlzKTtcbiAgICAvLyByZWFsdGltZSBjb25uZWN0aW9uIGlzIGNsb3NlZFxuICAgIH0gZWxzZSBpZiAob2xkU3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQgJiYgIXN0YXR1cy5yZWFsdGltZUVuZFBvaW50KSB7XG4gICAgICAgIHRoaXMud3NDb25uZWN0aW9uLmNsb3NlKCk7XG4gICAgICAgIGRlbGV0ZSB0aGlzLndzQ29ubmVjdGlvbjtcbiAgICB9XG4gICAgdGhpcy5lbWl0KCd1cGRhdGUtY29ubmVjdGlvbi1zdGF0dXMnLCBzdGF0dXMsIG9sZFN0YXR1cyk7XG4gICAgbG9jYWxTdG9yYWdlW1NUQVRVU0tFWV0gPSBKU09OLnN0cmluZ2lmeShzdGF0dXMpO1xufVxuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpe1xuICAgIC8qKlxuICAgICAqIG1ha2UgbG9naW4gYW5kIHJldHVybiBhIHByb21pc2UuIElmIGxvZ2luIHN1Y2NlZCwgcHJvbWlzZSB3aWxsIGJlIGFjY2VwdGVkXG4gICAgICogSWYgbG9naW4gZmFpbHMgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIHdpdGggZXJyb3JcbiAgICAgKiBAcGFyYW0gdXNlcm5hbWU6IHVzZXJuYW1lXG4gICAgICogQHBhcmFtIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAqIEByZXR1cm4gUHJvbWlzZSAodXNlciBvYmplY3QpXG4gICAgICovXG4gICAgdmFyIHRocyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdXRpbHMueGRyKHRocy5lbmRQb2ludCArICdhcGkvbG9naW4nLCB7dXNlcm5hbWU6IHVzZXJuYW1lIHx8ICcnLCBwYXNzd29yZDogcGFzc3dvcmQgfHwgJyd9LG51bGwsdGhzLmNhY2hlZFN0YXR1cy50b2tlbiwgdHJ1ZSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHN0YXR1c1xuICAgICAgICAgICAgICAgIHRocy51cGRhdGVTdGF0dXMoeGhyLnJlc3BvbnNlRGF0YSk7XG4gICAgICAgICAgICAgICAgLy8gY2FsbCB3aXRoIHVzZXIgaWRcbiAgICAgICAgICAgICAgICBhY2NlcHQoe3N0YXR1cyA6ICdzdWNjZXNzJywgdXNlcmlkOiB0aHMuY2FjaGVkU3RhdHVzLnVzZXJfaWR9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHhocikge1xuICAgICAgICAgICAgICAgIC8vIGlmIGVycm9yIGNhbGwgZXJyb3IgbWFuYWdlciB3aXRoIGVycm9yXG4gICAgICAgICAgICAgICAgYWNjZXB0KHtlcnJvcjogeGhyLnJlc3BvbnNlRGF0YS5lcnJvciwgc3RhdHVzOiAnZXJyb3InfSk7XG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5sb2dvdXQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdGhzID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LHJlamVjdCkge1xuICAgICAgICB0aHMuJHBvc3QoJ2FwaS9sb2dvdXQnKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ob2spe1xuICAgICAgICAgICAgICAgIHRocy51cGRhdGVTdGF0dXMoe30pO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2VbU1RBVFVTS0VZXTtcbiAgICAgICAgICAgICAgICBhY2NlcHQoKVxuICAgICAgICAgICAgfSwgcmVqZWN0KTtcbiAgICB9KTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24oY2FsbEJhY2spIHtcbiAgICBpZiAodGhpcy5pc0xvZ2dlZEluKSB7XG4gICAgICAgIGNhbGxCYWNrKHRoaXMuY2FjaGVkU3RhdHVzLnVzZXJfaWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHdhaXQgZm9yIGxvZ2luXG4gICAgICAgIHRoaXMub25jZSgnbG9nZ2VkLWluJyxmdW5jdGlvbih1c2VyX2lkKXtcbiAgICAgICAgICAgIGNhbGxCYWNrKHVzZXJfaWQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zdGF0dXMoY2FsbEJhY2sgfHwgdXRpbHMubm9vcCk7XG4gICAgfVxufVxuXG51dGlscy5yZVdoZWVsQ29ubmVjdGlvbiA9IHJlV2hlZWxDb25uZWN0aW9uOyIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gVG91Y2hlcigpe1xuICAgIHZhciB0b3VjaGVkID0gZmFsc2VcbiAgICB0aGlzLnRvdWNoID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdG91Y2hlZCA9IHRydWU7XG4gICAgfTtcbiAgICB0aGlzLnRvdWNoZWQgPSBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgdCA9IHRvdWNoZWQ7XG4gICAgICAgIHRvdWNoZWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfVxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5cbmZ1bmN0aW9uIFZhY3V1bUNhY2hlcih0b3VjaCwgYXNrZWQsIG5hbWUsIHBrSW5kZXgpe1xuLypcbiAgICBpZiAobmFtZSl7XG4gICAgICAgIGNvbnNvbGUuaW5mbygnY3JlYXRlZCBWYWN1dW1DYWNoZXIgYXMgJyArIG5hbWUpO1xuICAgIH1cbiovXG4gICAgaWYgKCFhc2tlZCl7XG4gICAgICAgIHZhciBhc2tlZCA9IFtdO1xuICAgIH1cbiAgICB2YXIgbWlzc2luZyA9IFtdO1xuICAgIFxuICAgIHRoaXMuYXNrID0gZnVuY3Rpb24gKGlkLGxhenkpe1xuICAgICAgICBpZiAocGtJbmRleCAmJiAoaWQgaW4gcGtJbmRleC5zb3VyY2UpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFMYXp5KGFza2VkKS5jb250YWlucyhpZCkpe1xuLy8gICAgICAgICAgICBjb25zb2xlLmluZm8oJ2Fza2luZyAoJyArIGlkICsgJykgZnJvbSAnICsgbmFtZSk7XG4gICAgICAgICAgICBtaXNzaW5nLnB1c2goaWQpO1xuICAgICAgICAgICAgaWYgKCFsYXp5KVxuICAgICAgICAgICAgICAgIGFza2VkLnB1c2goaWQpO1xuICAgICAgICAgICAgdG91Y2gudG91Y2goKTtcbiAgICAgICAgfSBcbi8vICAgICAgICBlbHNlIGNvbnNvbGUud2FybignKCcgKyBpZCArICcpIHdhcyBqdXN0IGFza2VkIG9uICcgKyBuYW1lKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRBc2tlZEluZGV4ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGFza2VkO1xuICAgIH1cblxuICAgIHRoaXMubWlzc2luZ3MgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gTGF6eShtaXNzaW5nLnNwbGljZSgwLG1pc3NpbmcubGVuZ3RoKSkudW5pcXVlKCkudG9BcnJheSgpO1xuICAgIH1cbn1cbiIsImZ1bmN0aW9uIEF1dG9MaW5rZXIoYWN0aXZlcywgSURCLCBXMlBSRVNPVVJDRSwgbGlzdENhY2hlKXtcbiAgICB2YXIgdG91Y2ggPSBuZXcgVG91Y2hlcigpO1xuICAgIHZhciBtYWluSW5kZXggPSB7fTtcbiAgICB2YXIgZm9yZWlnbktleXMgPSB7fTtcbiAgICB2YXIgbTJtID0ge307XG4gICAgdmFyIG0ybUluZGV4ID0ge307XG4gICAgdmFyIHBlcm1pc3Npb25zID0ge307XG4gICAgdGhpcy5tYWluSW5kZXggPSBtYWluSW5kZXg7XG4gICAgdGhpcy5mb3JlaWduS2V5cyA9IGZvcmVpZ25LZXlzO1xuICAgIHRoaXMubTJtID0gbTJtO1xuICAgIHRoaXMubTJtSW5kZXggPSBtMm1JbmRleDtcbiAgICB0aGlzLnBlcm1pc3Npb25zID0gcGVybWlzc2lvbnM7XG5cbiAgICBXMlBSRVNPVVJDRS5vbignbW9kZWwtZGVmaW5pdGlvbicsZnVuY3Rpb24obW9kZWwsIGluZGV4KXtcbiAgICAgICAgLy8gZGVmaW5pbmcgYWxsIGluZGV4ZXMgZm9yIHByaW1hcnkga2V5XG4gICAgICAgIHZhciBwa0luZGV4ID0gbGlzdENhY2hlLmdldEluZGV4Rm9yKG1vZGVsLm5hbWUsICdpZCcpO1xuICAgICAgICBtYWluSW5kZXhbbW9kZWwubmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLCBwa0luZGV4LCAnbWFpbkluZGV4LicgKyBtb2RlbC5uYW1lLCBpbmRleCk7XG4gICAgICAgIFxuICAgICAgICAvLyBjcmVhdGluZyBwZXJtaXNzaW9uIGluZGV4ZXNcbiAgICAgICAgcGVybWlzc2lvbnNbbW9kZWwubmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLG51bGwsICdwZXJtaXNzaW9ucy4nICsgbW9kZWwubmFtZSk7XG5cbiAgICAgICAgLy8gY3JlYXRpbmcgaW5kZXhlcyBmb3IgZm9yZWlnbiBrZXlzXG4gICAgICAgIExhenkobW9kZWwucmVmZXJlbmNlcykuZWFjaChmdW5jdGlvbihyZWZlcmVuY2Upe1xuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IG1vZGVsLm5hbWUgKyAnXycgKyByZWZlcmVuY2UuaWQ7XG4gICAgICAgICAgICBmb3JlaWduS2V5c1tpbmRleE5hbWVdID0gbmV3IFZhY3V1bUNhY2hlcih0b3VjaCwgbGlzdENhY2hlLmdldEluZGV4Rm9yKHJlZmVyZW5jZS50bywgJ2lkJyksIHJlZmVyZW5jZS50byArICcuaWQgZm9yZWlnbktleXMuJyArIGluZGV4TmFtZSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBjcmVhdGluZyByZXZlcnNlIGZvcmVpZ24ga2V5c1xuICAgICAgICBMYXp5KG1vZGVsLnJlZmVyZW5jZWRCeSkuZWFjaChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gZmllbGQuYnkgKyAnLicgKyBmaWVsZC5pZDtcbiAgICAgICAgICAgIGZvcmVpZ25LZXlzW2luZGV4TmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLCBsaXN0Q2FjaGUuZ2V0SW5kZXhGb3IoZmllbGQuYnksZmllbGQuaWQpLCBmaWVsZC5ieSArICcuJyArIGZpZWxkLmlkICsgJyBmb3JlaWduS2V5cy4nICsgaW5kZXhOYW1lKTtcbiAgICAgICAgfSk7XG4gICAgICAgIExhenkobW9kZWwubWFueVRvTWFueSkuZWFjaChmdW5jdGlvbihyZWxhdGlvbil7XG4gICAgICAgICAgICBpZiAoIShyZWxhdGlvbi5pbmRleE5hbWUgaW4gbTJtKSlcbiAgICAgICAgICAgICAgICBtMm1bcmVsYXRpb24uaW5kZXhOYW1lXSA9IFtuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLG51bGwsJ20ybS4nICsgcmVsYXRpb24uaW5kZXhOYW1lICsgJ1swXScpLCBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLG51bGwsJ20ybS4nICsgcmVsYXRpb24uaW5kZXhOYW1lKydbMV0nKV07XG4gICAgICAgICAgICBpZiAoIShyZWxhdGlvbi5pbmRleE5hbWUgaW4gbTJtSW5kZXgpKVxuICAgICAgICAgICAgICAgIG0ybUluZGV4W3JlbGF0aW9uLmluZGV4TmFtZV0gPSBuZXcgTWFueVRvTWFueVJlbGF0aW9uKHJlbGF0aW9uLG0ybVtyZWxhdGlvbi5pbmRleE5hbWVdKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgdmFyIG0ybUdldCA9IGZ1bmN0aW9uKGluZGV4TmFtZSwgbiwgY29sbGVjdGlvbiwgY2FsbEJhY2spe1xuICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdCgobiA/IHV0aWxzLnJldmVyc2UoJy8nLCBpbmRleE5hbWUpIDogaW5kZXhOYW1lKSArICdzJyArICcvbGlzdCcsIHtjb2xsZWN0aW9uOiBjb2xsZWN0aW9ufSwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKGRhdGEsIGNhbGxCYWNrKTtcbiAgICAgICAgICAgIGRlbGV0ZSBhY3RpdmVzW2luZGV4TmFtZV1cbiAgICAgICAgfSk7ICAgICAgICBcbiAgICB9O1xuXG4gICAgdmFyIGdldE0yTSA9IGZ1bmN0aW9uKGluZGV4TmFtZSwgY29sbGVjdGlvbiwgbiwgY2FsbEJhY2spe1xuICAgICAgICAvLyBhc2sgYWxsIGl0ZW1zIGluIGNvbGxlY3Rpb24gdG8gbTJtIGluZGV4XG4gICAgICAgIExhenkoY29sbGVjdGlvbikuZWFjaChtMm1baW5kZXhOYW1lXVtuXS5hc2suYmluZChtMm1baW5kZXhOYW1lXVtuXSkpO1xuICAgICAgICAvLyByZW5ld2luZyBjb2xsZWN0aW9uIHdpdGhvdXQgYXNrZWRcbiAgICAgICAgY29sbGVjdGlvbiA9IG0ybVtpbmRleE5hbWVdW25dLm1pc3NpbmdzKCk7XG4gICAgICAgIC8vIGNhbGxpbmcgcmVtb3RlIGZvciBtMm0gY29sbGVjdGlvbiBpZiBhbnlcbiAgICAgICAgaWYgKGNvbGxlY3Rpb24ubGVuZ3RoKXtcbiAgICAgICAgICAgIGFjdGl2ZXNbaW5kZXhOYW1lXSA9IDE7XG4gICAgICAgICAgICBtMm1HZXQoaW5kZXhOYW1lLCBuLCBjb2xsZWN0aW9uLCBjYWxsQmFjayk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjaygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmdldE0yTSA9IGdldE0yTTtcblxuICAgIHZhciBsaW5rVW5saW5rZWQgPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyBwZXJmb3JtIGEgRGF0YUJhc2Ugc3luY2hyb25pemF0aW9uIHdpdGggc2VydmVyIGxvb2tpbmcgZm9yIHVua25vd24gZGF0YVxuICAgICAgICBpZiAoIXRvdWNoLnRvdWNoZWQoKSkgcmV0dXJuO1xuICAgICAgICBpZiAoTGF6eShhY3RpdmVzKS52YWx1ZXMoKS5zdW0oKSkge1xuICAgICAgICAgICAgdG91Y2gudG91Y2goKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICBMYXp5KG0ybSkuZWFjaChmdW5jdGlvbihpbmRleGVzLCBpbmRleE5hbWUpe1xuICAgICAgICAgICAgTGF6eShpbmRleGVzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCxuKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBpbmRleC5taXNzaW5ncygpO1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24gPSBMYXp5KGNvbGxlY3Rpb24pLmZpbHRlcihCb29sZWFuKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHgpXG4gICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIGlmIChjb2xsZWN0aW9uLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBJTkRFWCA9IG0ybUluZGV4W2luZGV4TmFtZV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBnZXR0ZXIgPSBJTkRFWFsnZ2V0JyArICgxIC0gbildLmJpbmQoSU5ERVgpO1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbTJtR2V0KGluZGV4TmFtZSwgbiwgY29sbGVjdGlvbiwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWRzID0gY29sbGVjdGlvbi5tYXAoZ2V0dGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3RoZXJJbmRleCA9IGluZGV4TmFtZS5zcGxpdCgnLycpWzEgLSBuXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5kZXNjcmliZShvdGhlckluZGV4LGZ1bmN0aW9uKCl7XG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGF6eShpZHMpLmZsYXR0ZW4oKS51bmlxdWUoKS5lYWNoKG1haW5JbmRleFtvdGhlckluZGV4XS5hc2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMYXp5KGlkcykuZmxhdHRlbigpLnVuaXF1ZSgpLmVhY2goZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWluSW5kZXhbb3RoZXJJbmRleF0uYXNrKHgsdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIExhenkobWFpbkluZGV4KS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgbW9kZWxOYW1lKSB7XG4gICAgICAgICAgICB2YXIgaWRzID0gaW5kZXgubWlzc2luZ3MoKTtcbiAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIGlkYiA9IG1vZGVsTmFtZSBpbiBJREIgPyBJREJbbW9kZWxOYW1lXS5rZXlzKCkgOiBMYXp5KCk7XG4gICAgICAgICAgICAgICAgLy9sb2coJ2xpbmtpbmcuJyArIG1vZGVsTmFtZSArICcgPSAnICsgVzJQUkVTT1VSQ0UubGlua2luZy5zb3VyY2VbbW9kZWxOYW1lXSk7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gobW9kZWxOYW1lLCB7aWQ6IGlkc30sbnVsbCx1dGlscy5ub29wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIEZvcmVpZ24ga2V5c1xuICAgICAgICBMYXp5KGZvcmVpZ25LZXlzKVxuICAgICAgICAubWFwKGZ1bmN0aW9uKHYsayl7XG4gICAgICAgICAgICByZXR1cm4gW2ssIHYubWlzc2luZ3MoKV1cbiAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uKHYpe1xuICAgICAgICAgICAgcmV0dXJuIHZbMV0ubGVuZ3RoXG4gICAgICAgIH0pLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIGlkcyA9IHhbMV07XG4gICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0geFswXTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGluZGV4TmFtZS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgdmFyIG1haW5SZXNvdXJjZSA9IGluZGV4WzBdO1xuICAgICAgICAgICAgdmFyIGZpZWxkTmFtZSA9IGluZGV4WzFdO1xuICAgICAgICAgICAgdmFyIGZpbHRlciA9IHt9O1xuICAgICAgICAgICAgZmlsdGVyW2ZpZWxkTmFtZV0gPSBpZHM7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5mZXRjaChtYWluUmVzb3VyY2UsIGZpbHRlcik7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgTGF6eShMYXp5KHBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24odixrKXtcbiAgICAgICAgICAgIHJldHVybiBbaywgdi5taXNzaW5ncygpXVxuICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIHJldHVybiB2WzFdLmxlbmd0aFxuICAgICAgICB9KS50b09iamVjdCgpKS5lYWNoKGZ1bmN0aW9uIChpZHMsIHJlc291cmNlTmFtZSkge1xuICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgYWN0aXZlc1tyZXNvdXJjZU5hbWVdID0gMTtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdChyZXNvdXJjZU5hbWUgKyAnL215X3Blcm1zJywge2lkczogTGF6eShpZHMpLnVuaXF1ZSgpLnRvQXJyYXkoKX0sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdFBlcm1pc3Npb25zKGRhdGEuUEVSTUlTU0lPTlMpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgYWN0aXZlc1tyZXNvdXJjZU5hbWVdXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRJbnRlcnZhbChsaW5rVW5saW5rZWQsNTApO1xufTtcblxuXG4iLCJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gTGlzdENhY2hlcigpe1xuICAgIHZhciBnb3RBbGwgPSB7fTtcbiAgICB2YXIgYXNrZWQgPSB7fTsgLy8gbWFwIG9mIGFycmF5XG4gICAgdmFyIGNvbXBvc2l0ZUFza2VkID0ge307XG4gICAgdmFyIGNhcnRlc2lhblByb2R1Y3QxID0gZnVuY3Rpb24oeCx5LGlzQXJyYXkpe1xuICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgIGlmIChpc0FycmF5KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBhIGluIHgpe1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGIgaW4geSl7XG4gICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKExhenkoW3hbYV0seVtiXV0pLmZsYXR0ZW4oKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAodmFyIGEgaW4geCl7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYiBpbiB5KXtcbiAgICAgICAgICAgICAgICAgICAgcmV0LnB1c2goW3hbYV0seVtiXV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH07XG4gICAgdmFyIGNhcnRlc2lhblByb2R1Y3QgPSBmdW5jdGlvbihhcnIpe1xuICAgICAgICB2YXIgaXNBcnJheSA9IGZhbHNlO1xuICAgICAgICB2YXIgcmV0ID0gYXJyWzBdOyBcbiAgICAgICAgZm9yICh2YXIgeCA9IDE7IHggPCBhcnIubGVuZ3RoOyArK3gpe1xuICAgICAgICAgICAgcmV0ID0gY2FydGVzaWFuUHJvZHVjdDEocmV0LCBhcnJbeF0sIGlzQXJyYXkpO1xuICAgICAgICAgICAgaXNBcnJheSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG4gICAgdmFyIGV4cGxvZGVGaWx0ZXIgPSBmdW5jdGlvbihmaWx0ZXIpIHtcbiAgICAgICAgdmFyIHByb2R1Y3QgPSBjYXJ0ZXNpYW5Qcm9kdWN0KExhenkoZmlsdGVyKS52YWx1ZXMoKS50b0FycmF5KCkpO1xuICAgICAgICB2YXIga2V5cyA9IExhenkoZmlsdGVyKS5rZXlzKCkudG9BcnJheSgpO1xuICAgICAgICByZXR1cm4gcHJvZHVjdC5tYXAoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICB2YXIgciA9IHt9O1xuICAgICAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGEsbil7XG4gICAgICAgICAgICAgICAgclthXSA9IHhbbl07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICB9O1xuICAgIHZhciBmaWx0ZXJTaW5nbGUgPSBmdW5jdGlvbihtb2RlbCwgZmlsdGVyLCB0ZXN0T25seSl7XG4gICAgICAgIC8vIExhenkgYXV0byBjcmVhdGUgaW5kZXhlc1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gbW9kZWwubW9kZWxOYW1lO1xuICAgICAgICB2YXIgZ2V0SW5kZXhGb3IgPSB0aGlzLmdldEluZGV4Rm9yO1xuICAgICAgICB2YXIga2V5cyA9IExhenkoZmlsdGVyKS5tYXAoZnVuY3Rpb24odixrZXkpeyByZXR1cm4gW2tleSwgbW9kZWxOYW1lICsgJy4nICsga2V5XTsgfSkudG9PYmplY3QoKTtcbiAgICAgICAgdmFyIGluZGV4ZXMgPSBMYXp5KGZpbHRlcikua2V5cygpLm1hcChmdW5jdGlvbihrZXkpeyByZXR1cm4gW2tleSwgZ2V0SW5kZXhGb3IobW9kZWxOYW1lLCBrZXkpXX0pLnRvT2JqZWN0KCk7IFxuICAgICAgICAvLyBmYWtlIGZvciAoaXQgd2lsbCBjeWNsZSBvbmNlKVxuICAgICAgICBmb3IgKHZhciB4IGluIGZpbHRlcil7XG4gICAgICAgICAgICAvLyBnZXQgYXNrZWQgaW5kZXggYW5kIGNoZWNrIHByZXNlbmNlXG4gICAgICAgICAgICB2YXIgZGlmZmVyZW5jZSA9IExhenkoZmlsdGVyW3hdKS5kaWZmZXJlbmNlKGluZGV4ZXNbeF0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIGlmIChkaWZmZXJlbmNlLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgLy8gZ2VuZXJhdGUgbmV3IGZpbHRlclxuICAgICAgICAgICAgICAgIHZhciByZXQgPSBMYXp5KFtbeCwgZGlmZmVyZW5jZV1dKS50b09iamVjdCgpO1xuICAgICAgICAgICAgICAgIC8vIHJlbWVtYmVyIGFza2VkXG4gICAgICAgICAgICAgICAgaWYgKCF0ZXN0T25seSlcbiAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoaW5kZXhlc1t4XSwgZGlmZmVyZW5jZSk7XG4vLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlIGZpbHRlciA6ICcgKyBKU09OLnN0cmluZ2lmeShmaWx0ZXIpICsgJ1xcbk91dCA6JyArIEpTT04uc3RyaW5naWZ5KHJldCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuLy8gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NpbmdsZSBmaWx0ZXIgOiAnICsgSlNPTi5zdHJpbmdpZnkoZmlsdGVyKSArICdcXG5PdXQgOiBudWxsJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIGNsZWFuQ29tcG9zaXRlcyA9IGZ1bmN0aW9uKG1vZGVsLGZpbHRlcil7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjbGVhbiBjb21wb3NpdGVBc2tlZFxuICAgICAgICAgKi9cbiAgICAgICAgLy8gbGF6eSBjcmVhdGUgY29uZGl0aW9uYWwgYXNrZWQgaW5kZXhcbiAgICAgICAgaWYgKCEobW9kZWwubmFtZSBpbiBjb21wb3NpdGVBc2tlZCkpIHsgY29tcG9zaXRlQXNrZWRbbW9kZWwubmFtZV0gPSBbXSB9O1xuICAgICAgICB2YXIgaW5kZXggPSBjb21wb3NpdGVBc2tlZFttb2RlbC5uYW1lXTtcbiAgICAgICAgLy8gc2VhcmNoIGZvciBhbGwgZWxlbWVudHMgd2hvIGhhdmUgc2FtZSBwYXJ0aWFsXG4gICAgICAgIHZhciBmaWx0ZXJMZW4gPSBMYXp5KGZpbHRlcikuc2l6ZSgpO1xuICAgICAgICB2YXIgaXRlbXMgPSBpbmRleC5maWx0ZXIodXRpbHMubWFrZUZpbHRlcihtb2RlbCwgZmlsdGVyLCAnICYmICcsdHJ1ZSkpLmZpbHRlcihmdW5jdGlvbihpdGVtKXsgTGF6eShpdGVtKS5zaXplKCkgPiBmaWx0ZXJMZW4gfSk7XG4vLyAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0aW5nIDonICsgSlNPTi5zdHJpbmdpZnkoaXRlbXMpKTtcbiAgICB9O1xuXG4gICAgdGhpcy5maWx0ZXIgPSBmdW5jdGlvbihtb2RlbCwgZmlsdGVyKXtcbi8vICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tXFxuZmlsdGVyIDogJyArIEpTT04uc3RyaW5naWZ5KGZpbHRlcikpO1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gbW9kZWwubW9kZWxOYW1lO1xuXG4gICAgICAgIC8vIGlmIHlvdSBmZXRjaCBhbGwgb2JqZWN0cyBmcm9tIHNlcnZlciwgdGhpcyBtb2RlbCBoYXMgdG8gYmUgbWFya2VkIGFzIGdvdCBhbGw7XG4gICAgICAgIHZhciBmaWx0ZXJMZW4gID0gTGF6eShmaWx0ZXIpLnNpemUoKTtcbiAgICAgICAgc3dpdGNoIChmaWx0ZXJMZW4pIHtcbiAgICAgICAgICAgIGNhc2UgMCA6IHtcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gbnVsbCBvciBhbGxcbiAgICAgICAgICAgICAgICB2YXIgZ290ID0gZ290QWxsW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgZ290QWxsW21vZGVsTmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gYXNrZWQpe1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgYXNrZWRbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnb3V0IDogbnVsbCAoZ290IGFsbCknKTtcbiAgICAgICAgICAgICAgICAvLyBjb25kaXRpb25hbCBjbGVhblxuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gY29tcG9zaXRlQXNrZWQpeyBcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnb3QpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgMSA6IHtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gZmlsdGVyU2luZ2xlLmNhbGwodGhpcywgbW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICAgICAgY2xlYW5Db21wb3NpdGVzLmNhbGwodGhpcywgbW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgdmFyIHNpbmdsZSA9IExhenkoZmlsdGVyKS5rZXlzKCkuc29tZShmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIHZhciBmID0ge307XG4gICAgICAgICAgICBmW2tleV0gPSBmaWx0ZXJba2V5XTtcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJTaW5nbGUuY2FsbCh0aHMsIG1vZGVsLCBmLCB0cnVlKSA9PSBudWxsO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHNpbmdsZSkgeyByZXR1cm4gbnVsbCB9XG4gICAgICAgIC8vIGxhenkgY3JlYXRlIGNvbXBvc2l0ZUFza2VkXG4gICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBjb21wb3NpdGVBc2tlZCkpeyBjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdID0gW107IH1cbiAgICAgICAgLy8gZXhwbG9kZSBmaWx0ZXJcbiAgICAgICAgdmFyIGV4cGxvZGVkID0gZXhwbG9kZUZpbHRlcihmaWx0ZXIpO1xuICAgICAgICAvLyBjb2xsZWN0IHBhcnRpYWxzXG4gICAgICAgIHZhciBwYXJ0aWFscyA9IGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV0uZmlsdGVyKHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIGZpbHRlciwgJyB8fCAnLHRydWUpKTtcbiAgICAgICAgLy8gY29sbGVjdCBtaXNzaW5ncyAoZXhwbG9kZWQgLSBwYXJ0aWFscylcbiAgICAgICAgaWYgKHBhcnRpYWxzLmxlbmd0aCl7XG4gICAgICAgICAgICB2YXIgYmFkICA9IFtdO1xuICAgICAgICAgICAgLy8gcGFydGlhbCBkaWZmZXJlbmNlXG4gICAgICAgICAgICBmb3IgKHZhciB4IGluIHBhcnRpYWxzKXtcbiAgICAgICAgICAgICAgICBiYWQucHVzaC5hcHBseShiYWQsZXhwbG9kZWQuZmlsdGVyKHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIHBhcnRpYWxzW3hdLCcgJiYgJywgdHJ1ZSkpKTtcbiAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgY29uc29sZS5sb2coJ2V4cGxvZGVkIC0gcGFydGlhbCA6ICcgKyBKU09OLnN0cmluZ2lmeShiYWQpKTtcbiAgICAgICAgICAgIHZhciBtaXNzaW5ncyA9IExhenkoZXhwbG9kZWQpLmRpZmZlcmVuY2UoYmFkKS50b0FycmF5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgbWlzc2luZ3MgPSBleHBsb2RlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZpbHRlciBwYXJ0aWFsc1xuICAgICAgICBpZiAobWlzc2luZ3MubGVuZ3RoKXtcbiAgICAgICAgICAgIGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV0ucHVzaC5hcHBseShjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdLG1pc3NpbmdzKTtcbiAgICAgICAgICAgIC8vIGFnZ3JlZ2F0ZSBtaXNzaW5nc1xuICAgICAgICAgICAgdmFyIG1pc3NpbmdzID0gTGF6eShmaWx0ZXIpLmtleXMoKS5tYXAoZnVuY3Rpb24oa2V5KXtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gTGF6eShtaXNzaW5ncykucGx1Y2soa2V5KS51bmlxdWUoKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtrZXksIHJldC5sZW5ndGg/cmV0OmZpbHRlcltrZXldXTtcbiAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4vLyAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvdXQgOiAnICsgSlNPTi5zdHJpbmdpZnkobWlzc2luZ3MpKTtcbiAgICAgICAgICAgIC8vIGNsZWFuIGNvbmRpdGlvbmFsXG4gICAgICAgICAgICBjbGVhbkNvbXBvc2l0ZXMobW9kZWwsIG1pc3NpbmdzKTtcbiAgICAgICAgICAgIHJldHVybiBtaXNzaW5ncztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRJbmRleEZvciA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgZmllbGROYW1lKXtcbiAgICAgICAgdmFyIGluZGV4TmFtZSA9IG1vZGVsTmFtZSArICcuJyArIGZpZWxkTmFtZTtcbiAgICAgICAgaWYgKCEoaW5kZXhOYW1lIGluIGFza2VkKSl7XG4gICAgICAgICAgICBhc2tlZFtpbmRleE5hbWVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFza2VkW2luZGV4TmFtZV07XG4gICAgfVxufTsiLCIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIE1hbnlUb01hbnlSZWxhdGlvbihyZWxhdGlvbixtMm0pe1xuICAgIHZhciBpdGVtcyA9IFtdO1xuICAgIHRoaXMuYWRkID0gaXRlbXMucHVzaC5iaW5kKGl0ZW1zKTtcbiAgICB0aGlzLmFkZCA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAvLyAgICAgIGNvbnNvbGUubG9nKCdhZGRpbmcgJyArIGl0ZW0pO1xuICAgICAgICBpZiAoIShMYXp5KGl0ZW1zKS5maW5kKGl0ZW0pKSl7XG4gICAgICAgICAgICBpdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5nZXQwID0gZnVuY3Rpb24oaWQpe1xuICAgICAgICBtMm1bMV0uYXNrKGlkKTtcbiAgICAgICAgcmV0dXJuIExhenkoaXRlbXMpLmZpbHRlcihmdW5jdGlvbih4KXtcbiAgICAgICAgICAgIHJldHVybiB4WzBdID09PSBpZDtcbiAgICAgICAgfSkucGx1Y2soXCIxXCIpLnRvQXJyYXkoKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXQxID0gZnVuY3Rpb24oaWQpe1xuICAgICAgICBtMm1bMF0uYXNrKGlkKTtcbiAgICAgICAgcmV0dXJuIExhenkoaXRlbXMpLmZpbHRlcihmdW5jdGlvbih4KXtcbiAgICAgICAgICAgIHJldHVybiB4WzFdID09PSBpZDtcbiAgICAgICAgfSkucGx1Y2soXCIwXCIpLnRvQXJyYXkoKTtcbiAgICB9O1xuICAgIHRoaXNbJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKHJlbGF0aW9uLmluZGV4TmFtZS5zcGxpdCgnLycpWzFdKV0gPSB0aGlzLmdldDE7XG4gICAgdGhpc1snZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUocmVsYXRpb24uaW5kZXhOYW1lLnNwbGl0KCcvJylbMF0pXSA9IHRoaXMuZ2V0MDtcblxuICAgIHRoaXMuZGVsID0gZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgIHZhciBsID0gaXRlbXMubGVuZ3RoO1xuICAgICAgICB2YXIgaWR4ID0gbnVsbDtcbiAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCBsOyBhKyspeyBcbiAgICAgICAgICAgIGlmICgoaXRlbXNbYV1bMF0gPT09IGl0ZW1bMF0pICYmIChpdGVtc1thXVsxXSA9PT0gaXRlbVsxXSkpe1xuICAgICAgICAgICAgICAgIGlkeCA9IGE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlkeCl7XG4gICAgICAgICAgICBpdGVtcy5zcGxpY2UoYSwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0aW5nICcsIGl0ZW0pO1xuICAgIH07XG59IiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBjYWNoZWRQcm9wZXJ0eUJ5RXZlbnRzKHByb3RvLCBwcm9wZXJ0eU5hbWUsZ2V0dGVyLCBzZXR0ZXIpe1xuICAgIHZhciBldmVudHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNCk7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIFxuICAgIExhenkoZXZlbnRzKS5lYWNoKGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgcHJvdG8ub3JtLm9uKGV2ZW50LGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICByZXN1bHQgPSB7fTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgdmFyIHByb3BlcnR5RGVmID0ge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGNhY2hlZCgpe1xuLy8gICAgICAgICAgICByZXR1cm4gZ2V0dGVyLmNhbGwodGhpcyk7XG4gICAgICAgICAgICBpZiAoISh0aGlzLmlkIGluIHJlc3VsdCkpe1xuICAgICAgICAgICAgICAgIHJlc3VsdFt0aGlzLmlkXSA9IGdldHRlci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFt0aGlzLmlkXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgaWYgKHNldHRlcil7XG4gICAgICAgIHByb3BlcnR5RGVmWydzZXQnXSA9IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgICAgIGlmICghaXNGaW5pdGUodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaWQgaW4gcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSByZXN1bHRbdGhpcy5pZF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgICAgaWYgKHZhbHVlICE9PSByZXN1bHRbdGhpcy5pZF0pe1xuICAgICAgICAgICAgICAgIHNldHRlci5jYWxsKHRoaXMsdmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlkIGluIHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSByZXN1bHRbdGhpcy5pZF07XG4gICAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvLCBwcm9wZXJ0eU5hbWUscHJvcGVydHlEZWYpO1xufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBWYWxpZGF0aW9uRXJyb3IoZGF0YSl7XG4gICAgdGhpcy5yZXNvdXJjZSA9IGRhdGEuX3Jlc291cmNlO1xuICAgIHRoaXMuZm9ybUlkeCA9IGRhdGEuZm9ybUlkeDtcbiAgICB0aGlzLmZpZWxkcyA9IGRhdGEuZXJyb3JzO1xufVxudmFyIGJhc2VPUk0gPSBmdW5jdGlvbihvcHRpb25zLCBleHRPUk0pe1xuICAgIFxuICAgIC8vIGNyZWF0aW5nIHJld2hlZWwgY29ubmVjdGlvblxuICAgIGlmIChvcHRpb25zLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpe1xuICAgICAgICB2YXIgY29ubmVjdGlvbiA9IG5ldyByZVdoZWVsQ29ubmVjdGlvbihvcHRpb25zKTtcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMuY29uc3RydWN0b3IgPT09IHV0aWxzLnJlV2hlZWxDb25uZWN0aW9uKXtcbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBvcHRpb25zO1xuICAgIH1cbiAgICB0aGlzLmNvbm5lY3Rpb24gPSBjb25uZWN0aW9uO1xuICAgIGNvbm5lY3Rpb24ub24oJ2Nvbm5lY3RlZCcsIGZ1bmN0aW9uKCl7IFxuICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IHRydWU7XG4gICAgfSk7XG4gICAgdGhpcy5vbiA9IGNvbm5lY3Rpb24ub247XG4gICAgdGhpcy5lbWl0ID0gY29ubmVjdGlvbi5lbWl0O1xuICAgIHRoaXMudW5iaW5kID0gY29ubmVjdGlvbi51bmJpbmQ7XG4gICAgdGhpcy5vbmNlID0gY29ubmVjdGlvbi5vbmNlO1xuICAgIHRoaXMuJHBvc3QgPSBjb25uZWN0aW9uLiRwb3N0LmJpbmQoY29ubmVjdGlvbik7XG5cbiAgICAvLyBoYW5kbGluZyB3ZWJzb2NrZXQgZXZlbnRzXG4gICAgdGhpcy5vbignd3MtY29ubmVjdGVkJyxmdW5jdGlvbih3cyl7XG4gICAgICAgIGNvbnNvbGUuaW5mbygnV2Vic29ja2V0IGNvbm5lY3RlZCcpO1xuICAgICAgICAvLyBhbGwganNvbiBkYXRhIGhhcyB0byBiZSBwYXJzZWQgYnkgZ290RGF0YVxuICAgICAgICB3cy5vbk1lc3NhZ2VKc29uKFcyUFJFU09VUkNFLmdvdERhdGEuYmluZChXMlBSRVNPVVJDRSkpO1xuICAgICAgICAvL1xuICAgICAgICB3cy5vbk1lc3NhZ2VUZXh0KGZ1bmN0aW9uKG1lc3NhZ2Upe1xuICAgICAgICAgICAgY29uc29sZS5pbmZvKCdXUyBtZXNzYWdlIDogJyArIG1lc3NhZ2UpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHRoaXMub24oJ3dzLWRpc2Nvbm5lY3RlZCcsIGZ1bmN0aW9uKHdzKXtcbiAgICAgICAgY29uc29sZS5lcnJvcignV2Vic29ja2V0IGRpc2Nvbm5lY3RlZCcpXG4gICAgfSk7XG4gICAgdGhpcy5vbignZXJyb3ItanNvbi00MDQnLGZ1bmN0aW9uKGVycm9yLHVybCwgc2VudERhdGEsIHhocil7IFxuICAgICAgICBjb25zb2xlLmVycm9yKCdKU09OIGVycm9yICcsIEpTT04uc3RyaW5naWZ5KGVycm9yKSk7XG4gICAgICAgIGRlbGV0ZSB3YWl0aW5nQ29ubmVjdGlvbnNbdXJsLnNwbGl0KCcvJylbMF1dO1xuICAgIH0pO1xuICAgIHRoaXMub24oJ3JlYWx0aW1lLW1lc3NhZ2UtanNvbicsIGZ1bmN0aW9uKG1lc3NhZ2Upe1xuICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKG1lc3NhZ2UpO1xuICAgIH0pO1xuXG4gICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICB2YXIgVzJQUkVTT1VSQ0UgPSB0aGlzO1xuICAgIHZhciBJREIgPSB7YXV0aF9ncm91cCA6IExhenkoe30pfTsgLy8gdGFibGVOYW1lIC0+IGRhdGEgYXMgQXJyYXlcbiAgICB2YXIgSURYID0ge307IC8vIHRhYmxlTmFtZSAtPiBMYXp5KGluZGV4QnkoJ2lkJykpIC0+IElEQltkYXRhXVxuICAgIHZhciBSRVZJRFggPSB7fTsgLy8gdGFibGVOYW1lIC0+IGZpZWxkTmFtZSAtPiBMYXp5Lmdyb3VwQnkoKSAtPiBJREJbREFUQV1cbiAgICB2YXIgYnVpbGRlckhhbmRsZXJzID0ge307XG4gICAgdmFyIGJ1aWxkZXJIYW5kbGVyVXNlZCA9IHt9O1xuICAgIHZhciBwZXJzaXN0ZW50QXR0cmlidXRlcyA9IHt9O1xuICAgIHZhciBldmVudEhhbmRsZXJzID0ge307XG4gICAgdmFyIHBlcm1pc3Npb25XYWl0aW5nID0ge307XG4gICAgdmFyIG1vZGVsQ2FjaGUgPSB7fTtcbiAgICB2YXIgZmFpbGVkTW9kZWxzID0ge307XG4gICAgdmFyIHdhaXRpbmdDb25uZWN0aW9ucyA9IHt9IC8vIGFjdHVhbCBjb25uZWN0aW9uIHdobyBpJ20gd2FpdGluZyBmb3JcbiAgICB2YXIgbGlzdENhY2hlID0gbmV3IExpc3RDYWNoZXIoTGF6eSk7XG4gICAgdmFyIGxpbmtlciA9IG5ldyBBdXRvTGlua2VyKHdhaXRpbmdDb25uZWN0aW9ucyxJREIsIHRoaXMsIGxpc3RDYWNoZSk7XG4vKiAgICB3aW5kb3cubGwgPSBsaW5rZXI7XG4gICAgd2luZG93LmxjID0gbGlzdENhY2hlO1xuKi9cbiAgICB3aW5kb3cuSURCID0gSURCO1xuICAgIHRoaXMudmFsaWRhdGlvbkV2ZW50ID0gdGhpcy5vbignZXJyb3ItanNvbi01MTMnLCBmdW5jdGlvbihkYXRhLCB1cmwsIHNlbnREYXRhLCB4aHIpe1xuICAgICAgICBpZiAoY3VycmVudENvbnRleHQuc2F2aW5nRXJyb3JIYW5sZGVyKXtcbiAgICAgICAgICAgIGN1cnJlbnRDb250ZXh0LnNhdmluZ0Vycm9ySGFubGRlcihuZXcgVmFsaWRhdGlvbkVycm9yKGRhdGEpKTtcbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICB2YXIgZ2V0SW5kZXggPSBmdW5jdGlvbiAoaW5kZXhOYW1lKSB7XG4gICAgICAgIGlmIChpbmRleE5hbWUgaW4gSURCKVxuICAgICAgICAgICAgcmV0dXJuIElEQltpbmRleE5hbWVdO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIElEQltpbmRleE5hbWVdID0gTGF6eSh7fSk7XG4gICAgICAgICAgICByZXR1cm4gSURCW2luZGV4TmFtZV07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBnZXRVbmxpbmtlZCA9IGZ1bmN0aW9uIChpbmRleE5hbWUpIHtcbiAgICAgICAgaWYgKGluZGV4TmFtZSBpbiBVTkxJTktFRClcbiAgICAgICAgICAgIHJldHVybiBVTkxJTktFRFtpbmRleE5hbWVdO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIFVOTElOS0VEW2luZGV4TmFtZV0gPSB7fTtcbiAgICAgICAgICAgIHJldHVybiBVTkxJTktFRFtpbmRleE5hbWVdO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFBlcm1pc3Npb25UYWJsZShpZCwga2xhc3MsIHBlcm1pc3Npb25zKSB7XG4gICAgICAgIC8vIGNyZWF0ZSBQZXJtaXNzaW9uVGFibGUgY2xhc3NcbiAgICAgICAgdGhpcy5rbGFzcyA9IGtsYXNzO1xuICAgICAgICB0aGlzLnBlcm1pc3Npb25zID0gW107XG4gICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgZm9yICh2YXIgayBpbiBwZXJtaXNzaW9ucykge1xuICAgICAgICAgICAgdGhpcy5wdXNoLmFwcGx5KHRoaXMsIFtrLCBwZXJtaXNzaW9uc1trXV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIFBlcm1pc3Npb25UYWJsZS5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAvLyBzYXZlIE9iamVjdCB0byBzZXJ2ZXJcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBwZXJtaXNzaW9uczogTGF6eSh0aGlzLnBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW3hbMF0uaWQsIHhbMV1dXG4gICAgICAgICAgICB9KS50b09iamVjdCgpXG4gICAgICAgIH07XG4gICAgICAgIGRhdGEuaWQgPSB0aGlzLmlkO1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gdGhpcy5rbGFzcy5tb2RlbE5hbWU7XG4gICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KHRoaXMua2xhc3MubW9kZWxOYW1lICsgJy9zZXRfcGVybWlzc2lvbnMnLCBkYXRhLCBmdW5jdGlvbiAobXlQZXJtcywgYSwgYiwgcmVxKSB7XG4gICAgICAgICAgICBjYihteVBlcm1zKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBQZXJtaXNzaW9uVGFibGUucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAoZ3JvdXBfaWQsIHBlcm1pc3Npb25MaXN0KSB7XG4gICAgICAgIHZhciBwID0gTGF6eShwZXJtaXNzaW9uTGlzdCk7XG4gICAgICAgIHZhciBwZXJtcyA9IExhenkodGhpcy5rbGFzcy5hbGxQZXJtaXNzaW9ucykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4gW3gsIHAuY29udGFpbnMoeCldXG4gICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgIHZhciBsID0gTGF6eSh0aGlzLnBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHJldHVybiB4WzBdLmlkXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAobC5jb250YWlucyhncm91cF9pZCkpXG4gICAgICAgICAgICB0aGlzLnBlcm1pc3Npb25zW2wuaW5kZXhPZihncm91cF9pZCldWzFdID0gcGVybXM7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRoaXMucGVybWlzc2lvbnMucHVzaChbSURCLmF1dGhfZ3JvdXAuZ2V0KGdyb3VwX2lkKSwgcGVybXNdKTtcbiAgICB9O1xuXG4gICAgLy8gY3JlYXRlcyBkeW5hbWljYWwgbW9kZWxzXG4gICAgdmFyIG1ha2VNb2RlbENsYXNzID0gZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgICAgIHZhciBfbW9kZWwgPSBtb2RlbDtcbiAgICAgICAgbW9kZWwuZmllbGRzLmlkLnJlYWRhYmxlID0gZmFsc2U7XG4gICAgICAgIG1vZGVsLmZpZWxkcy5pZC53cml0YWJsZSA9IGZhbHNlO1xuICAgICAgICB2YXIgZmllbGRzID0gTGF6eShtb2RlbC5maWVsZHMpO1xuICAgICAgICBpZiAobW9kZWwucHJpdmF0ZUFyZ3MpIHtcbiAgICAgICAgICAgIGZpZWxkcyA9IGZpZWxkcy5tZXJnZShtb2RlbC5wcml2YXRlQXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgnbW9kZWwtZGVmaW5pdGlvbicsIG1vZGVsLCBnZXRJbmRleChtb2RlbC5uYW1lKSk7XG4gICAgICAgIC8vIGdldHRpbmcgZmllbGRzIG9mIHR5cGUgZGF0ZSBhbmQgZGF0ZXRpbWVcbi8qXG4gICAgICAgIHZhciBEQVRFRklFTERTID0gZmllbGRzLmZpbHRlcihmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuICh4LnR5cGUgPT0gJ2RhdGUnKSB8fCAoeC50eXBlID09ICdkYXRldGltZScpXG4gICAgICAgIH0pLm1hcChmdW5jdGlvbiAoeCwgdikge1xuICAgICAgICAgICAgcmV0dXJuIFt2LCB0cnVlXVxuICAgICAgICB9KS50b09iamVjdCgpO1xuXG4gICAgICAgIC8vIGdldHRpbmcgYm9vbGVhbiBmaWVsZHNcbiAgICAgICAgdmFyIEJPT0xGSUVMRFMgPSBmaWVsZHMuZmlsdGVyKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4gKHgudHlwZSA9PSAnYm9vbGVhbicpXG4gICAgICAgIH0pLm1hcChmdW5jdGlvbiAoeCwgdikge1xuICAgICAgICAgICAgcmV0dXJuIFt2LCB0cnVlXVxuICAgICAgICB9KS50b09iamVjdCgpO1xuXG4gICAgICAgIC8vIGJvb2xlYW5zIGFuZCBkYXRldGltZXMgc3RvcmFnZSBleHRlcm5hbCBcbiAgICAgICAgTU9ERUxfREFURUZJRUxEU1ttb2RlbC5uYW1lXSA9IERBVEVGSUVMRFM7XG4gICAgICAgIE1PREVMX0JPT0xGSUVMRFNbbW9kZWwubmFtZV0gPSBCT09MRklFTERTO1xuKi9cbiAgICAgICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICAgICAgdmFyIGZ1bmNTdHJpbmcgPSBcImlmICghcm93KSB7IHJvdyA9IHt9fTtcXG5cIjtcbiAgICAgICAgZnVuY1N0cmluZyArPSBtb2RlbC5yZWZlcmVuY2VzLm1hcChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICByZXR1cm4gJ3RoaXMuXycgKyBmaWVsZC5pZCArICcgPSByb3cuJyArIGZpZWxkLmlkICsgJzsnO1xuICAgICAgICB9KS5qb2luKCc7XFxuJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBkYXRlZmllbGQgY29udmVyc2lvblxuICAgICAgICBmdW5jU3RyaW5nICs9IGZpZWxkcy5tYXAoZnVuY3Rpb24gKHgsaykge1xuICAgICAgICAgICAgaWYgKCh4LnR5cGUgPT0gJ2RhdGUnKSB8fCAoeC50eXBlID09ICdkYXRldGltZScpKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ3RoaXMuJyArIGsgKyAnID0gcm93LicgKyBrICsgJz9uZXcgRGF0ZShyb3cuJyArIGsgKyAnICogMTAwMCAtICcgKyB1dGlscy50ek9mZnNldCArICcpOm51bGw7XFxuJzsgXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHgudHlwZSA9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ3RoaXMuJyArIGsgKyAnID0gKHJvdy4nICsgayArICcgPT09IFwiVFwiKSB8fCAocm93LicgKyBrICsgJyA9PT0gdHJ1ZSk7XFxuJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICd0aGlzLicgKyBrICsgJyA9IHJvdy4nICsgayArICc7XFxuJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkudG9TdHJpbmcoJ1xcbicpOyArICdcXG4nO1xuXG4gICAgICAgIGZ1bmNTdHJpbmcgKz0gXCJpZiAocGVybWlzc2lvbnMpIHt0aGlzLl9wZXJtaXNzaW9ucyA9IHBlcm1pc3Npb25zICYmIExhenkocGVybWlzc2lvbnMpLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gW3gsIHRydWVdIH0pLnRvT2JqZWN0KCk7fVwiXG5cbiAgICAgICAgXG4gICAgICAgIC8vIG1hc3RlciBjbGFzcyBmdW5jdGlvblxuICAgICAgICB2YXIgS2xhc3MgPSBuZXcgRnVuY3Rpb24oJ3JvdycsICdwZXJtaXNzaW9ucycsZnVuY1N0cmluZylcblxuICAgICAgICBLbGFzcy5wcm90b3R5cGUub3JtID0gZXh0T1JNO1xuICAgICAgICBLbGFzcy5yZWZfdHJhbnNsYXRpb25zID0ge307XG4gICAgICAgIEtsYXNzLm1vZGVsTmFtZSA9IG1vZGVsLm5hbWU7XG4gICAgICAgIEtsYXNzLnJlZmVyZW5jZXMgPSBMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLnBsdWNrKCdpZCcpLnRvQXJyYXkoKTtcblxuICAgICAgICBLbGFzcy5pbnZlcnNlX3JlZmVyZW5jZXMgPSBtb2RlbC5yZWZlcmVuY2VkQnkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAvLyBtYW5hZ2luZyByZWZlcmVuY2VzIHdoZXJlIFxuICAgICAgICAgICAgcmV0dXJuIHguYnkgKyAnXycgKyB4LmlkICsgJ19zZXQnXG4gICAgICAgIH0pO1xuICAgICAgICBLbGFzcy5yZWZlcmVudHMgPSBtb2RlbC5yZWZlcmVuY2VkQnkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4gW3guYnksIHguaWRdXG4gICAgICAgIH0pO1xuICAgICAgICBLbGFzcy5maWVsZHNPcmRlciA9IG1vZGVsLmZpZWxkT3JkZXI7XG4gICAgICAgIEtsYXNzLmFsbFBlcm1pc3Npb25zID0gbW9kZWwucGVybWlzc2lvbnM7XG5cbiAgICAgICAgLy8gcmVkZWZpbmluZyB0b1N0cmluZyBtZXRob2RcbiAgICAgICAgaWYgKExhenkobW9kZWwucmVwcmVzZW50YXRpb24pLnNpemUoKSl7XG4gICAgICAgICAgICBLbGFzcy5wcm90b3R5cGUudG9TdHJpbmcgPSBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzLicgKyBMYXp5KG1vZGVsLnJlcHJlc2VudGF0aW9uKS50b1N0cmluZygnICsgXCIgXCIgKyB0aGlzLicpKTtcbiAgICAgICAgfVxuICAgICAgICBLbGFzcy5wcm90b3R5cGUudG9VcHBlckNhc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyByZWRlZmluZSB0byBVcHBlckNhc2VcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKTtcbiAgICAgICAgfTtcbiAgICAgIFxuICAgICAgICBLbGFzcy5wcm90b3R5cGUudG9Mb3dlckNhc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICBLbGFzcy5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gZGVsZXRlIGluc3RhbmNlIGZyb20gc2VydmVyXG4gICAgICAgICAgICByZXR1cm4gZXh0T1JNLmRlbGV0ZSh0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZSwgW3RoaXMuaWRdKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwZXJtaXNzaW9uIGdldHRlciBwcm9wZXJ0eVxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoS2xhc3MucHJvdG90eXBlLCAncGVybWlzc2lvbnMnLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcGVybWlzc2lvbnMpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wZXJtaXNzaW9ucztcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGlua2VyLnBlcm1pc3Npb25zW3RoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lXS5hc2sodGhpcy5pZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gZ2V0dGluZyBmdWxsIHBlcm1pc3Npb24gdGFibGUgZm9yIGFuIG9iamVjdFxuICAgICAgICBLbGFzcy5wcm90b3R5cGUuYWxsX3Blcm1zID0gZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgICAgICB2YXIgb2JqZWN0X2lkID0gdGhpcy5pZDtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KHRoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lICsgJy9hbGxfcGVybXMnLCB7aWQ6IHRoaXMuaWR9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBwZXJtaXNzaW9ucyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwZWQgPSB7fTtcbiAgICAgICAgICAgICAgICB2YXIgdW5rbm93bl9ncm91cHMgPSBMYXp5KHBlcm1pc3Npb25zKS5wbHVjaygnZ3JvdXBfaWQnKS51bmlxdWUoKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnICsgeFxuICAgICAgICAgICAgICAgIH0pLmRpZmZlcmVuY2UoSURCLmF1dGhfZ3JvdXAua2V5cygpKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgTGF6eShwZXJtaXNzaW9ucykuZ3JvdXBCeShmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geC5ncm91cF9pZFxuICAgICAgICAgICAgICAgIH0pLmVhY2goZnVuY3Rpb24gKHYsIGspIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBlZFtrXSA9IExhenkodikucGx1Y2soJ25hbWUnKS50b0FycmF5KClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgY2FsbCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIGNiKG5ldyBQZXJtaXNzaW9uVGFibGUob2JqZWN0X2lkLCBLbGFzcywgZ3JvdXBlZCkpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHVua25vd25fZ3JvdXBzLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ2V0KCdhdXRoX2dyb3VwJyx1bmtub3duX2dyb3VwcyxjYWxsKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGNhbGwoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBvID0gdGhpcy5hc1JhdygpO1xuICAgICAgICAgICAgdmFyIGZpZWxkcyA9IEtsYXNzLmZpZWxkcztcbiAgICAgICAgICAgIHZhciBJRCA9IHRoaXMuaWQ7XG4gICAgICAgICAgICB2YXIgbW9kZWxOYW1lID0gdGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWU7XG4gICAgICAgICAgICBpZiAoYXJncykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGFyZyBpbiBhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIG9bYXJnXSA9IGFyZ3NbYXJnXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBlbGltaW5hdGUgdW53cml0YWJsZXNcbiAgICAgICAgICAgIExhenkoS2xhc3MuZmllbGRzT3JkZXIpLmZpbHRlcihmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICByZXR1cm4gIWZpZWxkc1t4XS53cml0YWJsZTtcbiAgICAgICAgICAgIH0pLmVhY2goZnVuY3Rpb24oZmllbGROYW1lKXtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGROYW1lIGluIG8pIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9bZmllbGROYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChJRCkgeyBvLmlkID0gSUQ7IH1cbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gVzJQUkVTT1VSQ0UuJHBvc3QobW9kZWxOYW1lICsgKElEID8gJy9wb3N0JyA6ICcvcHV0JyksIG8pO1xuICAgICAgICAgICAgaWYgKGFyZ3MgJiYgKGFyZ3MuY29uc3RydWN0b3IgPT09IEZ1bmN0aW9uKSl7XG4gICAgICAgICAgICAgICAgLy8gcGxhY2luZyBjYWxsYmFjayBpbiBhIGNvbW1vbiBwbGFjZVxuICAgICAgICAgICAgICAgIHByb21pc2UuY29udGV4dC5zYXZpbmdFcnJvckhhbmxkZXIgPSBhcmdzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHByb21pc2VcbiAgICAgICAgfTtcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb2JqID0gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5hc1JhdygpKTtcbiAgICAgICAgICAgIG9iai5fcGVybWlzc2lvbnMgPSB0aGlzLl9wZXJtaXNzaW9ucztcbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gYnVpbGRpbmcgc2VyaWFsaXphdGlvbiBmdW5jdGlvblxuICAgICAgICB2YXIgYXNyID0gJ3JldHVybiB7XFxuJyArIExhenkobW9kZWwucmVmZXJlbmNlcykubWFwKGZ1bmN0aW9uKGZpZWxkKXtcbiAgICAgICAgICAgIHJldHVybiBmaWVsZC5pZCArICcgOiB0aGlzLl8nICsgZmllbGQuaWQ7XG4gICAgICAgIH0pLmNvbmNhdChmaWVsZHMubWFwKGZ1bmN0aW9uICh4LGspIHtcbiAgICAgICAgICAgIGlmICgoeC50eXBlID09ICdkYXRlJykgfHwgKHgudHlwZSA9PSAnZGF0ZXRpbWUnKSl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGsgKyAnIDogKHRoaXMuJyArIGsgKyAnPyhNYXRoLnJvdW5kKHRoaXMuJyArIGsgKyAnLmdldFRpbWUoKSAtIHRoaXMuJyArIGsgKyAnLmdldFRpbWV6b25lT2Zmc2V0KCkgKiA2MDAwMCkgLyAxMDAwKTpudWxsKSc7IFxuICAgICAgICAgICAgfSBlbHNlIGlmICh4LnR5cGUgPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGsgKyAnIDogdGhpcy4nICsgayArICc/XCJUXCI6XCJGXCInO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gayArICcgOiB0aGlzLicgKyBrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSkudG9TdHJpbmcoJyxcXG4nKSArICd9Oyc7XG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS5hc1JhdyA9IG5ldyBGdW5jdGlvbihhc3IpO1xuXG4gICAgICAgIEtsYXNzLnNhdmVNdWx0aSA9IGZ1bmN0aW9uIChvYmplY3RzLCBjYiwgc2NvcGUpIHtcbiAgICAgICAgICAgIHZhciByYXcgPSBbXTtcbiAgICAgICAgICAgIHZhciBkZWxldGFibGUgPSBMYXp5KEtsYXNzLmZpZWxkcylcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAheC53cml0YWJsZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnBsdWNrKCdpZCcpXG4gICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIExhenkob2JqZWN0cylcbiAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4LmFzUmF3KClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIExhenkoZGVsZXRhYmxlKS5lYWNoKGZ1bmN0aW9uICh5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgeFt5XTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJhdy5wdXNoKHgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QoS2xhc3MubW9kZWxOYW1lLCAncHV0Jywge211bHRpcGxlOiByYXcsIGZvcm1JZHggOiBXMlBSRVNPVVJDRS5mb3JtSWR4Kyt9LCBmdW5jdGlvbiAoZWxlbXMpIHtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKGVsZW1zKTtcbiAgICAgICAgICAgICAgICB2YXIgdGFiID0gSURCW0tsYXNzLm1vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgdmFyIG9ianMgPSBMYXp5KGVsZW1zW0tsYXNzLm1vZGVsTmFtZV0ucmVzdWx0cykucGx1Y2soJ2lkJykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YWIuZ2V0KHgpXG4gICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIGlmIChjYikge1xuICAgICAgICAgICAgICAgICAgICBjYihvYmpzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBzY29wZSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmICgnZXh0cmFfdmVyYnMnIGluIG1vZGVsKVxuICAgICAgICAgICAgTGF6eShtb2RlbC5leHRyYV92ZXJicykuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgIHZhciBmdW5jTmFtZSA9IHhbMF07XG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSB4WzFdO1xuICAgICAgICAgICAgICAgIHZhciBkZGF0YSA9ICd2YXIgZGF0YSA9IHtpZCA6IHRoaXMuaWQnO1xuICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgZGRhdGEgKz0gJywgJyArIExhenkoYXJncykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHggKyAnIDogJyArIHg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5qb2luKCcsJyk7XG4gICAgICAgICAgICAgICAgZGRhdGEgKz0gJ307XFxuJztcbiAgICAgICAgICAgICAgICBhcmdzID0gWydwb3N0JywnZ290RGF0YSddLmNvbmNhdChhcmdzKTtcbiAgICAgICAgICAgICAgICBhcmdzLnB1c2goJ2NiJyk7XG4gICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBkZGF0YSArICcgcmV0cnVuIHBvc3QoXCInICsgS2xhc3MubW9kZWxOYW1lICsgJy8nICsgZnVuY05hbWUgKyAnXCIsIGRhdGEsY2IpOyc7XG4gICAgICAgICAgICAgICAgdmFyIGZ1bmMgPSBuZXcgRnVuY3Rpb24oYXJncywgY29kZSk7XG4gICAgICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlW2Z1bmNOYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtwb3N0LCBnb3REYXRhXS5jb25jYXQoYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgZnVuYy5hcHBseSh0aGlzLCBhcmdzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICBpZiAoJ3ByaXZhdGVBcmdzJyBpbiBtb2RlbCkge1xuICAgICAgICAgICAgS2xhc3MucHJpdmF0ZUFyZ3MgPSBMYXp5KG1vZGVsLnByaXZhdGVBcmdzKS5rZXlzKCkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFt4LCB0cnVlXTtcbiAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgICAgICBLbGFzcy5wcm90b3R5cGUuc2F2ZVBBID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgICAgICAgICB2YXIgVCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIG9vID0ge2lkOiB0aGlzLmlkfTtcbiAgICAgICAgICAgICAgICB2YXIgUEEgPSB0aGlzLmNvbnN0cnVjdG9yLnByaXZhdGVBcmdzO1xuICAgICAgICAgICAgICAgIHZhciBGcyA9IHRoaXMuY29uc3RydWN0b3IuZmllbGRzO1xuICAgICAgICAgICAgICAgIHZhciB0ID0gbmV3IHRoaXMuY29uc3RydWN0b3IobykuYXNSYXcoKTtcbiAgICAgICAgICAgICAgICB2YXIgZmllbGRJZHggPSBMYXp5KFBBKS5rZXlzKCkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbeCwgRnNbeF1dXG4gICAgICAgICAgICAgICAgfSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgICAgICBMYXp5KG8pLmVhY2goZnVuY3Rpb24gKHYsIGspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChrIGluIFBBKSAmJiBmaWVsZElkeFtrXS53cml0YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb29ba10gPSB2O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QodGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUgKyAnL3NhdmVQQScsIG9vLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIExhenkob28pLmVhY2goZnVuY3Rpb24gKHYsIGspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFRba10gPSB2O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBtb2RlbENhY2hlW0tsYXNzLm1vZGVsTmFtZV0gPSBLbGFzcztcbiAgICAgICAgLy8gYWRkaW5nIGlkIHRvIGZpZWxkc1xuICAgICAgICBmb3IgKHZhciBmIGluIG1vZGVsLmZpZWxkcykge1xuICAgICAgICAgICAgbW9kZWwuZmllbGRzW2ZdLmlkID0gZjtcbiAgICAgICAgfVxuICAgICAgICBLbGFzcy5maWVsZHMgPSBMYXp5KG1vZGVsLmZpZWxkcykuY29uY2F0KExhenkobW9kZWwucHJpdmF0ZUFyZ3MpKS5jb25jYXQoTGF6eShtb2RlbC5yZWZlcmVuY2VzKS50YXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHgudHlwZSA9IHgudHlwZSB8fCAncmVmZXJlbmNlJ1xuICAgICAgICB9KSkuaW5kZXhCeSgnaWQnKS50b09iamVjdCgpO1xuICAgICAgICAvLyBzZXR0aW5nIHdpZGdldHMgZm9yIGZpZWxkc1xuICAgICAgICBMYXp5KEtsYXNzLmZpZWxkcykuZWFjaChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICBpZiAoIWZpZWxkLndpZGdldCl7XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09ICdyZWZlcmVuY2UnKXtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQud2lkZ2V0ID0gJ2Nob2ljZXMnXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQud2lkZ2V0ID0gZmllbGQudHlwZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBidWlsZGluZyByZWZlcmVuY2VzIHRvIChtYW55IHRvIG9uZSkgZmllbGRzXG4gICAgICAgIExhenkobW9kZWwucmVmZXJlbmNlcykuZWFjaChmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgICAgICB2YXIgZXh0X3JlZiA9IHJlZi50bztcbiAgICAgICAgICAgIHZhciBsb2NhbF9yZWYgPSAnXycgKyByZWYuaWQ7XG4gICAgICAgICAgICBjYWNoZWRQcm9wZXJ0eUJ5RXZlbnRzKEtsYXNzLnByb3RvdHlwZSwgcmVmLmlkLGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXNbbG9jYWxfcmVmXSkgeyByZXR1cm4gbnVsbCB9O1xuICAgICAgICAgICAgICAgIGlmICghKGV4dF9yZWYgaW4gSURCKSl7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5kZXNjcmliZShleHRfcmVmLGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlua2VyLm1haW5JbmRleFtleHRfcmVmXS5hc2sodGhzW2xvY2FsX3JlZl0sdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gKGV4dF9yZWYgaW4gSURCKSAmJiB0aGlzW2xvY2FsX3JlZl0gJiYgSURCW2V4dF9yZWZdLmdldCh0aGlzW2xvY2FsX3JlZl0pO1xuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0ICYmIChleHRfcmVmIGluIGxpbmtlci5tYWluSW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFza2luZyB0byBsaW5rZXJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzW2xvY2FsX3JlZl0gPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5rZXIubWFpbkluZGV4W2V4dF9yZWZdLmFzayh0aGlzW2xvY2FsX3JlZl0sdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ251bGwgcmVmZXJlbmNlIGZvciAnICsgbG9jYWxfcmVmICsgJygnICsgdGhpcy5pZCArICcpIHJlc291cmNlICcgKyBLbGFzcy5tb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1dGlscy5tb2NrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUuY29uc3RydWN0b3IgIT09IHV0aWxzLm1vY2spICYmICh2YWx1ZS5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUgIT09IGV4dF9yZWYpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdZb3UgY2FuIGFzc2lnbiBvbmx5ICcgKyBleHRfcmVmICsgJyB0byAnICsgcmVmLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzW2xvY2FsX3JlZl0gPSB2YWx1ZS5pZDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW2xvY2FsX3JlZl0gPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sICduZXctJyArIGV4dF9yZWYsICdkZWxldGVkLScgKyBleHRfcmVmLCd1cGRhdGVkLScgKyBleHRfcmVmLCAnbmV3LW1vZGVsLScgKyBleHRfcmVmLyosICd1cGRhdGVkLScgKyBLbGFzcy5tb2RlbE5hbWUqLyk7XG5cblxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZShyZWYuaWQpXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXh0T1JNLmdldChleHRfcmVmLHRoaXNbbG9jYWxfcmVmXSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2J1aWxkaW5nIHJlZmVyZW5jZXMgdG8gKG9uZSB0byBtYW55KSBmaWVsZHNcbiAgICAgICAgTGF6eShtb2RlbC5yZWZlcmVuY2VkQnkpLmVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IHJlZi5ieSArICcuJyArIHJlZi5pZDtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSByZWYuYnkgKyAnXycgKyB1dGlscy5wbHVyYWxpemUocmVmLmlkKTtcbiAgICAgICAgICAgIHZhciByZXZJbmRleCA9IHJlZi5ieTtcbiAgICAgICAgICAgIGlmIChLbGFzcy5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkocHJvcGVydHlOYW1lKSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RyeWVkIHRvIHJlZGVmaW5lIHByb3BlcnR5ICcgKyBwcm9wZXJ0eU5hbWUgKyAncycgKyAnIGZvciAnICsgS2xhc3MubW9kZWxOYW1lKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2FjaGVkUHJvcGVydHlCeUV2ZW50cyhLbGFzcy5wcm90b3R5cGUsIHByb3BlcnR5TmFtZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmV0ID0gKHJldkluZGV4IGluIElEQikgPyBSRVZJRFhbaW5kZXhOYW1lXS5nZXQodGhpcy5pZCArICcnKTpudWxsO1xuICAgICAgICAgICAgICAgICAgICBsaW5rZXIuZm9yZWlnbktleXNbaW5kZXhOYW1lXS5hc2sodGhpcy5pZCx0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgICAgICB9LCBudWxsLCAnbmV3LScgKyByZXZJbmRleCwgJ3VwZGF0ZWQtJyArIHJldkluZGV4LCAnZGVsZXRlZC0nICsgcmV2SW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZSh1dGlscy5wbHVyYWxpemUocmVmLmJ5KSldID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBvcHRzID0ge307XG4gICAgICAgICAgICAgICAgb3B0c1tyZWYuaWRdID0gW3RoaXMuaWRdO1xuICAgICAgICAgICAgICAgIHJldHVybiBleHRPUk0uZ2V0KHJlZi5ieSxvcHRzKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vYnVpbGRpbmcgcmVmZXJlbmNlIHRvIChtYW55IHRvIG1hbnkpIGZpZWxkc1xuICAgICAgICBpZiAobW9kZWwubWFueVRvTWFueSkge1xuICAgICAgICAgICAgTGF6eShtb2RlbC5tYW55VG9NYW55KS5lYWNoKGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gcmVmLmluZGV4TmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3QgPSByZWYuZmlyc3Q/IDAgOiAxO1xuICAgICAgICAgICAgICAgIHZhciBvbW9kZWxOYW1lID0gcmVmLm1vZGVsO1xuLy8gICAgICAgICAgICAgICAgdmFyIG9tb2RlbCA9IGdldEluZGV4KG9tb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciBnZXR0ZXIgPSBsaW5rZXIubTJtSW5kZXhbaW5kZXhOYW1lXVsnZ2V0JyArICgxIC0gZmlyc3QpXTtcblxuICAgICAgICAgICAgICAgIGNhY2hlZFByb3BlcnR5QnlFdmVudHMoS2xhc3MucHJvdG90eXBlLCByZWYubW9kZWwgKyAncycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkcyA9IGdldHRlcih0aHMuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdldCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9XMlBSRVNPVVJDRS5mZXRjaChvbW9kZWxOYW1lLCB7aWQgOiBpZHN9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXQgPSBnZXRJbmRleChvbW9kZWxOYW1lKS5nZXQuYmluZChJREJbb21vZGVsTmFtZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRzICYmIGdldClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXQgPSBMYXp5KGlkcykubWFwKGdldCkuZmlsdGVyKHV0aWxzLmJvb2wpLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICAgICAgICAgIH0sIG51bGwsICdyZWNlaXZlZC1tMm0tJyArIGluZGV4TmFtZSwgJ3JlY2VpdmVkLScgKyBvbW9kZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZVsnZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUodXRpbHMucGx1cmFsaXplKG9tb2RlbE5hbWUpKV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3Qpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rZXIuZ2V0TTJNKGluZGV4TmFtZSwgW3Rocy5pZF0sIGZpcnN0LGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWRzID0gZ2V0dGVyKHRocy5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmZldGNoKG9tb2RlbE5hbWUsIHtpZCA6IGlkc30sbnVsbCxmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnZXQgPSBJREJbb21vZGVsTmFtZV0uZ2V0LmJpbmQoSURCW29tb2RlbE5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQoTGF6eShpZHMpLm1hcChnZXQpLmZpbHRlcih1dGlscy5ib29sKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQoW10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAgICAgS2xhc3MuZmllbGRzW3V0aWxzLmNhcGl0YWxpemUob21vZGVsTmFtZSldID0ge1xuICAgICAgICAgICAgICAgICAgICBpZDogdXRpbHMuY2FwaXRhbGl6ZShvbW9kZWxOYW1lKSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogdXRpbHMuY2FwaXRhbGl6ZShvbW9kZWxOYW1lKSxcbiAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHJlYWRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTTJNJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdG9yczogW11cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlLnVubGlua1JlZmVyZW5jZSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHZhciBtdWx0aXBsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBJRCA9IHRoaXMuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5jb25zdHJ1Y3Rvci5uYW1lID09ICdBcnJheScpIHtcbiAgICAgICAgICAgICAgICAgICAgbXVsdGlwbGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZXMgPSBpbnN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBpbnN0YW5jZXNbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBvbW9kZWwgPSBpbnN0YW5jZS5jb25zdHJ1Y3Rvci5tb2RlbE5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKG11bHRpcGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gTGF6eShpbnN0YW5jZXMpLnBsdWNrKCdpZCcpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtJRCwgeF1cbiAgICAgICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gW1tJRCwgaW5zdGFuY2UuaWRdXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QoS2xhc3MubW9kZWxOYW1lICsgJy8nICsgb21vZGVsICsgJ3MvZGVsZXRlJywge2NvbGxlY3Rpb246IGNvbGxlY3Rpb259KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZS5saW5rUmVmZXJlbmNlID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG11bHRpcGxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIElEID0gdGhpcy5pZDtcbiAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2VzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLmNvbnN0cnVjdG9yLm5hbWUgPT0gJ0FycmF5Jykge1xuICAgICAgICAgICAgICAgICAgICBtdWx0aXBsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlcyA9IGluc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZSA9IGluc3RhbmNlc1swXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG9tb2RlbCA9IGluc3RhbmNlLmNvbnN0cnVjdG9yLm1vZGVsTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gS2xhc3MubW9kZWxOYW1lICsgJy8nICsgb21vZGVsO1xuICAgICAgICAgICAgICAgIGlmIChtdWx0aXBsZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVmcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXhOYW1lIGluIElOREVYX00yTSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcyA9IExhenkoaW5zdGFuY2VzKS5wbHVjaygnaWQnKS5kaWZmZXJlbmNlKExhenkoSU5ERVhfTTJNW2luZGV4TmFtZV1bMF0uZ2V0KHRoaXMuaWQpKSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGluZGV4TmFtZSA9IG9tb2RlbCArICcvJyArIEtsYXNzLm1vZGVsTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4TmFtZSBpbiBJTkRFWF9NMk0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnMgPSBMYXp5KGluc3RhbmNlcykucGx1Y2soJ2lkJykuZGlmZmVyZW5jZShMYXp5KElOREVYX00yTVtpbmRleE5hbWVdWzBdLmdldCh0aGlzLmlkKSkpLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocmVmcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gTGF6eShyZWZzKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW0lELCB4XVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgVzJQX1BPU1QoS2xhc3MubW9kZWxOYW1lLCBvbW9kZWwgKyAncy9wdXQnLCB7Y29sbGVjdGlvbjogY29sbGVjdGlvbn0sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoaW5kZXhOYW1lIGluIGxpbmtlci5tMm1JbmRleCkgJiYgTGF6eShsaW5rZXIubTJtSW5kZXhbaW5kZXhOYW1lXVsnZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUob21vZGVsKV0oaW5zdGFuY2UuaWQpKS5maW5kKHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QoS2xhc3MubW9kZWxOYW1lICsgJy8nICsgb21vZGVsICsgJ3MvcHV0Jywge2NvbGxlY3Rpb246IFtbdGhpcy5pZCwgaW5zdGFuY2UuaWRdXX0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgnbmV3LW1vZGVsJywgS2xhc3MpO1xuICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCduZXctbW9kZWwtJyArIEtsYXNzLm1vZGVsTmFtZSk7XG4gICAgICAgIHJldHVybiBLbGFzcztcbiAgICB9O1xuXG4gICAgdGhpcy5nb3REYXRhID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxCYWNrKSB7XG4gICAgICAgIC8vIHJlY2VpdmUgYWxsIGRhdGEgZnJvbSBldmVyeSBlbmQgcG9pbnRcbiAgICAgICAgY29uc29sZS5pbmZvKCdnb3REYXRhJyk7XG4gICAgICAgIGlmICh0eXBlb2YoZGF0YSkgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkYXRhICcgKyBkYXRhICsgJyByZWZ1c2VkIGZyb20gZ290RGF0YSgpJyk7XG4gICAgICAgICAgICBpZiAoY2FsbEJhY2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbEJhY2soZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gY2xlYW4gZGF0YSBmcm9tIHJlbGF0aW9ucyBhbmQgcGVybWlzc2lvbnMgZm9yIHVzaW5nIGl0IGFmdGVyIG1vZGVsIHBhcnNpbmdcbiAgICAgICAgaWYgKCdfZXh0cmEnIGluIGRhdGEpeyBkZWxldGUgZGF0YS5fZXh0cmEgfVxuICAgICAgICB2YXIgVE9PTkUgPSBkYXRhLlRPT05FO1xuICAgICAgICB2YXIgVE9NQU5ZID0gZGF0YS5UT01BTlk7XG4gICAgICAgIHZhciBNQU5ZVE9NQU5ZID0gZGF0YS5NQU5ZVE9NQU5ZO1xuICAgICAgICB2YXIgUEVSTUlTU0lPTlMgPSBkYXRhLlBFUk1JU1NJT05TO1xuICAgICAgICB2YXIgUEEgPSBkYXRhLlBBO1xuICAgICAgICBkZWxldGUgZGF0YS5UT09ORTtcbiAgICAgICAgZGVsZXRlIGRhdGEuVE9NQU5ZO1xuICAgICAgICBkZWxldGUgZGF0YS5NQU5ZVE9NQU5ZO1xuICAgICAgICBkZWxldGUgZGF0YS5QRVJNSVNTSU9OUztcbiAgICAgICAgZGVsZXRlIGRhdGEuUEE7XG4gICAgICAgIGlmICghUEEpIHsgUEEgPSB7fTsgfVxuXG4gICAgICAgIC8vIGNsZWFuaW5nIGZyb20gdXNlbGVzcyBkZWxldGVkIGRhdGFcbiAgICAgICAgZGF0YSA9IExhenkoZGF0YSkuZmlsdGVyKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICByZXR1cm4gKCEoJ2RlbGV0ZWQnIGluIHYpIHx8ICgoayBpbiBtb2RlbENhY2hlKSkpO1xuICAgICAgICB9KS50b09iamVjdCgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCdtMm0nIGluIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBtMm0gPSBkYXRhLm0ybTtcbiAgICAgICAgICAgIGRlbGV0ZSBkYXRhWydtMm0nXTtcbiAgICAgICAgfVxuICAgICAgICBMYXp5KGRhdGEpLmVhY2goZnVuY3Rpb24gKGRhdGEsIG1vZGVsTmFtZSkge1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUobW9kZWxOYW1lLCBmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWxDbGFzcyA9IG1vZGVsO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLnJlc3VsdHMgJiYgKGRhdGEucmVzdWx0cy5sZW5ndGggPiAwKSAmJiAoZGF0YS5yZXN1bHRzWzBdLmNvbnN0cnVjdG9yID09IEFycmF5KSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMgPSBMYXp5KGRhdGEucmVzdWx0cykubWFwKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIExhenkobW9kZWxDbGFzcy5maWVsZHNPcmRlcikuemlwKHgpLnRvT2JqZWN0KClcbiAgICAgICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IExhenkoZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICB2YXIgZGVsZXRlZCA9IGRhdGEuZGVsZXRlZDtcbiAgICAgICAgICAgICAgICBpZiAobW9kZWxOYW1lIGluIFBBKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBNUEEgPSBQQVttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICBMYXp5KHJlc3VsdHMpLmVhY2goZnVuY3Rpb24gKHJlY29yZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlY29yZC5pZCBpbiBNUEEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMYXp5KE1QQVtyZWNvcmQuaWRdKS5lYWNoKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY29yZFtrXSA9IHY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gaW5kZXhpbmcgcmVmZXJlbmNlcyBieSBpdHMgSURcbiAgICAgICAgICAgICAgICB2YXIgaXRhYiA9IGdldEluZGV4KG1vZGVsTmFtZSk7XG4gICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gaXRhYi5zb3VyY2U7XG5cbiAgICAgICAgICAgICAgICAvLyBvYmplY3QgZGVsZXRpb25cbiAgICAgICAgICAgICAgICBpZiAoZGVsZXRlZCl7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZWQuZm9yRWFjaChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YWJsZVt4XTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4vKlxuICAgICAgICAgICAgICAgIExhenkoZGVsZXRlZCkuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFibGVbeF07XG4gICAgICAgICAgICAgICAgfSk7XG4qL1xuICAgICAgICAgICAgICAgIHZhciBpZHggPSByZXN1bHRzLmluZGV4QnkoJ2lkJyk7XG4gICAgICAgICAgICAgICAgdmFyIGlrID0gaWR4LmtleXMoKTtcbiAgICAgICAgICAgICAgICB2YXIgbm5ldyA9IGlrLmRpZmZlcmVuY2UoaXRhYi5rZXlzKCkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh4KVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZCA9IGlrLmRpZmZlcmVuY2Uobm5ldyk7XG4gICAgICAgICAgICAgICAgLy8gcmVtb3Zpbmcgb2xkIGlkZW50aWNhbCB2YWx1ZXNcbiAgICAgICAgICAgICAgICB1cGRhdGVkID0gdXBkYXRlZC5maWx0ZXIoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICF1dGlscy5zYW1lQXMoaWR4LmdldCh4KSwgaXRhYi5nZXQoeCkuYXNSYXcoKSk7XG4gICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIC8vIGNsYXNzaWZ5IHJlY29yZHNcbiAgICAgICAgICAgICAgICB2YXIgcGVybXMgPSBkYXRhLnBlcm1pc3Npb25zID8gTGF6eShkYXRhLnBlcm1pc3Npb25zKSA6IExhenkoe30pO1xuICAgICAgICAgICAgICAgIHZhciBuZXdPYmplY3RzID0gbm5ldy5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBtb2RlbENsYXNzKGlkeC5nZXQoeCksIHBlcm1zLmdldCh4KSlcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vLy8gY2xhc3NpZnlpbmcgdXBkYXRlZFxuICAgICAgICAgICAgICAgIC8vdmFyIHVwZGF0ZWRPYmplY3RzID0gdXBkYXRlZC5tYXAoZnVuY3Rpb24oeCl7cmV0dXJuIG5ldyBtb2RlbENsYXNzKGlkeC5nZXQoeCkscGVybXMuZ2V0KHgpKX0pO1xuICAgICAgICAgICAgICAgIC8vdmFyIHVvID0gdXBkYXRlZE9iamVjdHMudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIC8vdXBkYXRlZE9iamVjdHMgPSBMYXp5KHVvKS5tYXAoZnVuY3Rpb24oeCl7cmV0dXJuIFt4LHRhYmxlW3guaWRdXX0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGluZyBzaW5nbGUgb2JqZWN0c1xuICAgICAgICAgICAgICAgIHZhciBjaGFuZ2VkID0gW107XG4vLyAgICAgICAgICAgICAgICB2YXIgREFURUZJRUxEUyA9IE1PREVMX0RBVEVGSUVMRFNbbW9kZWxOYW1lXTtcbi8vICAgICAgICAgICAgICAgIHZhciBCT09MRklFTERTID0gTU9ERUxfQk9PTEZJRUxEU1ttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgIHZhciBtb2RlbFJlZmVyZW5jZXMgPSBMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLm1hcChmdW5jdGlvbihrKSB7IHJldHVybiBbaywxXX0pLnRvT2JqZWN0KCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlZC5mb3JFYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRJdGVtID0gdGFibGVbeF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRDb3B5ID0gb2xkSXRlbS5jb3B5KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtID0gaWR4LmdldCh4KTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0aW5nIGVhY2ggYXR0cmlidXRlIHNpbmd1bGFybHlcblxuICAgICAgICAgICAgICAgICAgICBMYXp5KG1vZGVsLmZpZWxkcykuZWFjaChmdW5jdGlvbihmaWVsZCwgZmllbGROYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goZmllbGQudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JlZmVyZW5jZScgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZEl0ZW1bJ18nICsgZmllbGROYW1lXSA9IG5ld0l0ZW1bZmllbGROYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmFOIGlzIGNvbnZudGlvbmFsbHkgYSBjYWNoZSBkZWxldGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZEl0ZW1bZmllbGROYW1lXSA9IE5hTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RhdGUnOiB7b2xkSXRlbVtmaWVsZE5hbWVdID0gbmV3IERhdGUobmV3SXRlbVtmaWVsZE5hbWVdICogMTAwMCk7IGJyZWFrfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdkYXRldGltZSc6IHtvbGRJdGVtW2ZpZWxkTmFtZV0gPSBuZXcgRGF0ZShuZXdJdGVtW2ZpZWxkTmFtZV0gKiAxMDAwKTsgYnJlYWt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Jvb2xlYW4nIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG5ld0l0ZW1bZmllbGROYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBudWxsIDogeyBvbGRJdGVtW2ZpZWxkTmFtZV0gPSBudWxsOyBicmVhazsgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ1QnIDogeyBvbGRJdGVtW2ZpZWxkTmFtZV0gPSB0cnVlOyBicmVhazsgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0YnIDogeyBvbGRJdGVtW2ZpZWxkTmFtZV0gPSBmYWxzZTsgYnJlYWs7IH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIHRydWUgOiB7IG9sZEl0ZW1bZmllbGROYW1lXSA9IHRydWU7IGJyZWFrOyB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBmYWxzZSA6IHsgb2xkSXRlbVtmaWVsZE5hbWVdID0gZmFsc2U7IGJyZWFrOyB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoge29sZEl0ZW1bZmllbGROYW1lXSA9IG5ld0l0ZW1bZmllbGROYW1lXX1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgICAgICAgICAgICAgb2xkSXRlbVtmaWVsZE5hbWVdID0gbmV3SXRlbVtmaWVsZE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZC5wdXNoKFtuZXdJdGVtLCBvbGRDb3B5XSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLy8vIHNlbmRpbmcgc2lnbmFsIGZvciB1cGRhdGVkIHZhbHVlc1xuICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VkLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCd1cGRhdGVkLScgKyBtb2RlbE5hbWUsIGNoYW5nZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyoqKioqKioqIFVwZGF0ZSB1bml2ZXJzZSAqKioqKioqKlxuICAgICAgICAgICAgICAgIHZhciBubyA9IG5ld09iamVjdHMudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIExhenkobm8pLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVbeC5pZF0gPSB4XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gcmVidWxkaW5nIHJldmVyc2UgaW5kZXhlc1xuICAgICAgICAgICAgICAgIExhenkobW9kZWxDYWNoZVttb2RlbE5hbWVdLnJlZmVyZW5jZXMpLmVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgICAgICAgICAgICAgICBSRVZJRFhbbW9kZWxOYW1lICsgJy4nICsgcmVmXSA9IElEQlttb2RlbE5hbWVdLmdyb3VwQnkoJ18nICsgcmVmKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBzZW5kaW5nIGV2ZW50cyBmb3IgbmV3IHZhbHVlc1xuICAgICAgICAgICAgICAgIGlmIChuby5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ25ldy0nICsgbW9kZWxOYW1lLCBMYXp5KG5vKSwgZGF0YS50b3RhbFJlc3VsdHMpO1xuICAgICAgICAgICAgICAgIGlmIChkZWxldGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ2RlbGV0ZWQtJyArIG1vZGVsTmFtZSwgZGVsZXRlZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHNlbmRpbmcgZXZlbnRzIGZvciBkYXRhIGFycml2ZWRcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCdyZWNlaXZlZC0nICsgbW9kZWxOYW1lKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuLyogICAgICAgIFxuICAgICAgICBpZiAoVE9PTkUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RPT05FJyk7XG4gICAgICAgICAgICBMYXp5KFRPT05FKS5lYWNoKGZ1bmN0aW9uICh2YWxzLCBtb2RlbE5hbWUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciB1ZHggPSBnZXRVbmxpbmtlZChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFRPTUFOWSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignVE9NQU5ZJyk7XG4gICAgICAgICAgICBMYXp5KFRPTUFOWSkuZWFjaChmdW5jdGlvbiAodmFscywgaW5kZXhOYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoaW5kZXhOYW1lIGluIEFTS0VEX1VOTElOS0VEKSkge1xuICAgICAgICAgICAgICAgICAgICBBU0tFRF9VTkxJTktFRFtpbmRleE5hbWVdID0gTGF6eShbXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIExhenkodmFscykuZWFjaChmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQVNLRURfVU5MSU5LRURbaW5kZXhOYW1lXS5zb3VyY2UucHVzaChpZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTUFOWVRPTUFOWSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignTUFOWVRPTUFOWScpO1xuICAgICAgICAgICAgTGF6eShNQU5ZVE9NQU5ZKS5lYWNoKGZ1bmN0aW9uICh2YWxzLCBpbmRleE5hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3QgPSBwYXJzZUludChpbmRleE5hbWUuc3BsaXQoJ3wnKVsxXSk7XG4gICAgICAgICAgICAgICAgaW5kZXhOYW1lID0gaW5kZXhOYW1lLnNwbGl0KCd8JylbMF07XG4gICAgICAgICAgICAgICAgaWYgKCEoaW5kZXhOYW1lIGluIEFTS0VEX00yTSkpIHtcbiAgICAgICAgICAgICAgICAgICAgQVNLRURfTTJNW2luZGV4TmFtZV0gPSBbe30sIHt9XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIE1JRFggPSBBU0tFRF9NMk1baW5kZXhOYW1lXVtmaXJzdF07XG4gICAgICAgICAgICAgICAgTGF6eSh2YWxzKS5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIE1JRFhbeCArICcnXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIE1JRFhbeF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIFxuKi9cbiAgICAgICAgaWYgKG0ybSkge1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290TTJNKG0ybSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFBFUk1JU1NJT05TKSB7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3RQZXJtaXNzaW9ucyhQRVJNSVNTSU9OUyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2FsbEJhY2spIHtcbiAgICAgICAgICAgIGNhbGxCYWNrKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ2dvdC1kYXRhJyk7XG4gICAgfTtcbiAgICB0aGlzLmdvdFBlcm1pc3Npb25zID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgTGF6eShkYXRhKS5lYWNoKGZ1bmN0aW9uICh2LCByZXNvdXJjZU5hbWUpIHtcbiAgICAgICAgICAgIExhenkodlswXSkuZWFjaChmdW5jdGlvbiAocm93LCBpZCkge1xuICAgICAgICAgICAgICAgIGlmICgocmVzb3VyY2VOYW1lIGluIElEQikgJiYgKGlkIGluIElEQltyZXNvdXJjZU5hbWVdLnNvdXJjZSkpe1xuICAgICAgICAgICAgICAgICAgICBJREJbcmVzb3VyY2VOYW1lXS5nZXQoaWQpLl9wZXJtaXNzaW9ucyA9IExhenkocm93KS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbeCwgdHJ1ZV1cbiAgICAgICAgICAgICAgICAgICAgfSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChMYXp5KHZbMF0pLnNpemUoKSl7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgndXBkYXRlLXBlcm1pc3Npb25zLScgKyByZXNvdXJjZU5hbWUsIExhenkodlswXSkua2V5cygpLnRvQXJyYXkoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmVtaXQoJ3VwZGF0ZS1wZXJtaXNzaW9ucycpO1xuICAgIH07XG5cblxuICAgIHRoaXMuZ290TTJNID0gZnVuY3Rpb24obTJtKXtcbiAgICAgICAgTGF6eShtMm0pLmVhY2goZnVuY3Rpb24oZGF0YSwgaW5kZXhOYW1lKXtcbiAgICAgICAgICAgIHZhciBtMm1JbmRleCA9IGxpbmtlci5tMm1JbmRleFtpbmRleE5hbWVdO1xuICAgICAgICAgICAgTGF6eShkYXRhKS5lYWNoKGZ1bmN0aW9uKG0pe1xuICAgICAgICAgICAgICAgIExhenkobSkuZWFjaChmdW5jdGlvbihkYXRhLHZlcmIpe1xuICAgICAgICAgICAgICAgICAgICBtMm1JbmRleFt2ZXJiXShkYXRhKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgncmVjZWl2ZWQtbTJtJyk7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCdyZWNlaXZlZC1tMm0tJyArIGluZGV4TmFtZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMuZmV0Y2ggPSBmdW5jdGlvbiAobW9kZWxOYW1lLCBmaWx0ZXIsIHRvZ2V0aGVyLCBjYWxsQmFjaykgeyAgLy9cbiAgICAgICAgLy8gaWYgYSBjb25uZWN0aW9uIGlzIGN1cnJlbnRseSBydW5uaW5nLCB3YWl0IGZvciBjb25uZWN0aW9uLlxuICAgICAgICBpZiAobW9kZWxOYW1lIGluIHdhaXRpbmdDb25uZWN0aW9ucyl7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gobW9kZWxOYW1lLCBmaWx0ZXIsIHRvZ2V0aGVyLCBjYWxsQmFjayk7XG4gICAgICAgICAgICB9LDUwMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBmZXRjaGluZyBhc3luY2hyb21vdXMgbW9kZWwgZnJvbSBzZXJ2ZXJcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmRlc2NyaWJlKG1vZGVsTmFtZSwgKGZ1bmN0aW9uKG1vZGVsKXtcbiAgICAgICAgICAgICAgICAvLyBpZiBkYXRhIGNhbWVzIGZyb20gcmVhbHRpbWUgY29ubmVjdGlvblxuICAgICAgICAgICAgICAgIGlmIChXMlBSRVNPVVJDRS5jb25uZWN0aW9uLmNhY2hlZFN0YXR1cy5yZWFsdGltZUVuZFBvaW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIGdldHRpbmcgZmlsdGVyIGZpbHRlcmVkIGJ5IGNhY2hpbmcgc3lzdGVtXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlciA9IGxpc3RDYWNoZS5maWx0ZXIobW9kZWwsZmlsdGVyKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBpZiBzb210aGluZyBpcyBtaXNzaW5nIG9uIG15IGxvY2FsIERCIFxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsdGVyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFzayBmb3IgbWlzc2luZ3MgYW5kIHBhcnNlIHNlcnZlciByZXNwb25zZSBpbiBvcmRlciB0byBlbnJpY2ggbXkgbG9jYWwgREIuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwbGFjaW5nIGxvY2sgZm9yIHRoaXMgbW9kZWxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRpbmdDb25uZWN0aW9uc1ttb2RlbE5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KG1vZGVsTmFtZSArICcvbGlzdCcsIHtmaWx0ZXIgOiBmaWx0ZXJ9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKGRhdGEsY2FsbEJhY2spO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbGVhc2UgbG9ja1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2FpdGluZ0Nvbm5lY3Rpb25zW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmV0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVsZWFzZSBsb2NrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlcjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRwb3N0KG1vZGVsTmFtZSArICcvbGlzdCcsIHNlbmREYXRhLGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWx0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR09UX0FMTC5zb3VyY2UucHVzaChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKGRhdGEsIGNhbGxCYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24obW9kZWxOYW1lLCBpZHMsIGNhbGxCYWNrKXtcbiAgICAgICAgLy8gc2VhcmNoIG9iamVjdHMgZnJvbSBJREIuIElmIHNvbWUgaWQgaXMgbWlzc2luZywgaXQgcmVzb2x2ZSBpdCBieSB0aGUgc2VydmVyXG4gICAgICAgIC8vIGlmIGEgcmVxdWVzdCB0byB0aGUgc2FtZSBtb2RlbCBpcyBwZW5kaW5nLCB3YWl0IGZvciBpdHMgY29tcGxldGlvblxuICAgICAgICBcbiAgICAgICAgaWYgKGlkcy5jb25zdHJ1Y3RvciAhPT0gQXJyYXkpe1xuICAgICAgICAgICAgaWRzID0gW2lkc107XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWYgc29tZSBlbnRpdHkgaXMgbWlzc2luZyBcbiAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gobW9kZWxOYW1lICwge2lkOiBpZHN9LCBudWxsLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgICAgICB2YXIgaXRhYiA9IElEQlttb2RlbE5hbWVdXG4gICAgICAgICAgICBmb3IgKHZhciBpZCBpbiBpZHMpe1xuICAgICAgICAgICAgICAgIHJldC5wdXNoKGl0YWIuc291cmNlW2lkc1tpZF1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhbGxCYWNrKHJldCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0aGlzLmdvdE1vZGVsID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgZm9yICh2YXIgbW9kZWxOYW1lIGluIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBtb2RlbCA9IGRhdGFbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZVsnZGVzY3JpcHRpb246JyArIG1vZGVsTmFtZV0gPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgICAgICAgIG1vZGVsQ2FjaGVbbW9kZWxOYW1lXSA9IG1ha2VNb2RlbENsYXNzKG1vZGVsKTtcbiAgICAgICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBJREIpKSB7XG4gICAgICAgICAgICAgICAgSURCW21vZGVsTmFtZV0gPSBMYXp5KHt9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmRlc2NyaWJlID0gZnVuY3Rpb24obW9kZWxOYW1lLCBjYWxsQmFjayl7XG4gICAgICAgIHZhciByZXQgPSBtb2RlbENhY2hlW21vZGVsTmFtZV07XG4gICAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHJldCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gd2FpdGluZ0Nvbm5lY3Rpb25zKSl7XG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBmYWlsZWRNb2RlbHMpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNhY2hlS2V5ID0gJ2Rlc2NyaXB0aW9uOicgKyBtb2RlbE5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlS2V5IGluIGxvY2FsU3RvcmFnZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdvdE1vZGVsKEpTT04ucGFyc2UobG9jYWxTdG9yYWdlW2NhY2hlS2V5XSkpO1xuICAgICAgICAgICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayhtb2RlbENhY2hlW21vZGVsTmFtZV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdhaXRpbmdDb25uZWN0aW9uc1ttb2RlbE5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcG9zdChtb2RlbE5hbWUgKyAnL2Rlc2NyaWJlJyxudWxsLCBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdE1vZGVsKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2sobW9kZWxDYWNoZVttb2RlbE5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGVsTm90Rm91bmQuaGFuZGxlKG1vZGVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmYWlsZWRNb2RlbHNbbW9kZWxOYW1lXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gd2FpdCBmb3IgY29ubmVjdGlvblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUobW9kZWxOYW1lLCBjYWxsQmFjayk7XG4gICAgICAgICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSAgICAgICAgXG4gICAgfTtcbiAgICB0aGlzLmFkZE1vZGVsSGFuZGxlciA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIGRlY29yYXRvcikge1xuICAgICAgICB2YXIga2V5ID0gdXRpbHMuaGFzaChkZWNvcmF0b3IpO1xuICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gYnVpbGRlckhhbmRsZXJzKSkgYnVpbGRlckhhbmRsZXJzW21vZGVsTmFtZV0gPSBuZXcgSGFuZGxlcigpO1xuICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gYnVpbGRlckhhbmRsZXJVc2VkKSkgYnVpbGRlckhhbmRsZXJVc2VkW21vZGVsTmFtZV0gPSB7fTtcbiAgICAgICAgaWYgKGtleSBpbiBidWlsZGVySGFuZGxlclVzZWRbbW9kZWxOYW1lXSl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidWlsZGVySGFuZGxlclVzZWRbbW9kZWxOYW1lXVtrZXldID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobW9kZWxOYW1lIGluIG1vZGVsQ2FjaGUpIHtcbiAgICAgICAgICAgIGRlY29yYXRvcihtb2RlbENhY2hlW21vZGVsTmFtZV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVpbGRlckhhbmRsZXJzW21vZGVsTmFtZV0uYWRkSGFuZGxlcihkZWNvcmF0b3IpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzID0gZnVuY3Rpb24obW9kZWxOYW1lLCBhdHRyaWJ1dGVzKXtcbiAgICAgICAgdmFyIGFkZFByb3BlcnR5ID0gZnVuY3Rpb24obW9kZWwsIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICBhdHRyaWJ1dGVzLmZvckVhY2goZnVuY3Rpb24odmFsKXtcbiAgICAgICAgICAgIHZhciBrZXkgPSAncEE6JyArIG1vZGVsLm1vZGVsTmFtZSArICc6JyArIHZhbDtcbiAgICAgICAgICAgIHZhciBrYXR0ciA9ICdfXycgKyB2YWw7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kZWwucHJvdG90eXBlLCB2YWwsIHtcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGlmICghKGthdHRyIGluIHRoaXMpKXtcbiAgICAgICAgICAgICAgICAgIHZhciB2ID0gbG9jYWxTdG9yYWdlW2tleSArIHRoaXMuaWRdO1xuICAgICAgICAgICAgICAgICAgdGhpc1trYXR0cl0gPSB2P0pTT04ucGFyc2Uodik6bnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNba2F0dHJdO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgICAgICAgICB0aGlzW2thdHRyXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZVtrZXkgKyB0aGlzLmlkXSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBwZXJzaXN0ZW50QXR0cmlidXRlcykpIHsgcGVyc2lzdGVudEF0dHJpYnV0ZXNbbW9kZWxOYW1lXSA9IFtdOyB9XG4gICAgICAgIHZhciBhdHRycyA9IHBlcnNpc3RlbnRBdHRyaWJ1dGVzW21vZGVsTmFtZV07XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICB2YXIgbmV3QXR0cnMgPSBMYXp5KGF0dHJpYnV0ZXMpLmRpZmZlcmVuY2UoYXR0cnMpLnRvQXJyYXkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBuZXdBdHRycyA9IGF0dHJzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdBdHRycy5sZW5ndGgpe1xuICAgICAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBtb2RlbENhY2hlKXtcbiAgICAgICAgICAgICAgICBhZGRQcm9wZXJ0eShtb2RlbENhY2hlW21vZGVsTmFtZV0sIG5ld0F0dHJzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzKXtcbiAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShhdHRycyxuZXdBdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMub24oJ25ldy1tb2RlbCcsIGZ1bmN0aW9uKG1vZGVsKXtcbiAgICAgICAgaWYgKG1vZGVsLm1vZGVsTmFtZSBpbiBidWlsZGVySGFuZGxlcnMpe1xuICAgICAgICAgICAgYnVpbGRlckhhbmRsZXJzW21vZGVsLm1vZGVsTmFtZV0uaGFuZGxlKG1vZGVsQ2FjaGVbbW9kZWwubW9kZWxOYW1lXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vZGVsLm1vZGVsTmFtZSBpbiBwZXJzaXN0ZW50QXR0cmlidXRlcyl7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5hZGRQZXJzaXN0ZW50QXR0cmlidXRlcyhtb2RlbC5tb2RlbE5hbWUpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLnF1ZXJ5ID0gZnVuY3Rpb24obW9kZWxOYW1lLCBmaWx0ZXIsIHRvZ2V0aGVyLCBjYWxsQmFjayl7XG4gICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICB0aGlzLmRlc2NyaWJlKG1vZGVsTmFtZSxmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgICAgICAvLyBhcnJheWZpeSBhbGwgZmlsdGVyIHZhbHVlc1xuICAgICAgICAgICAgZmlsdGVyID0gTGF6eShmaWx0ZXIpLm1hcChmdW5jdGlvbih2LGspeyByZXR1cm4gW2ssQXJyYXkuaXNBcnJheSh2KT92Olt2XV19KS50b09iamVjdCgpO1xuICAgICAgICAgICAgdmFyIGZpbHRlckZ1bmN0aW9uID0gdXRpbHMubWFrZUZpbHRlcihtb2RlbCwgZmlsdGVyKTtcbiAgICAgICAgICAgIHZhciBpZHggPSBnZXRJbmRleChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgdGhzLmZldGNoKG1vZGVsTmFtZSxmaWx0ZXIsdG9nZXRoZXIsIGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgIGNhbGxCYWNrKGlkeC5maWx0ZXIoZmlsdGVyRnVuY3Rpb24pLnZhbHVlcygpLnRvQXJyYXkoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICB9O1xuICAgIHRoaXMuZGVsZXRlID0gZnVuY3Rpb24obW9kZWxOYW1lLCBpZHMsIGNhbGxCYWNrKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHBvc3QobW9kZWxOYW1lICsgJy9kZWxldGUnLCB7IGlkIDogaWRzfSwgY2FsbEJhY2spO1xuICAgIH07XG5cbiAgICB0aGlzLmNvbm5lY3QgPSBmdW5jdGlvbiAoY2FsbEJhY2spIHtcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGlvbi5pc0xvZ2dlZEluKSB7XG4gICAgICAgICAgICBjYWxsQmFjaygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0aW9uLmNvbm5lY3QoY2FsbEJhY2spO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuZnVuY3Rpb24gcmVXaGVlbE9STShlbmRQb2ludCwgbG9naW5GdW5jKXtcbiAgICB0aGlzLiRvcm0gPSBuZXcgYmFzZU9STShuZXcgdXRpbHMucmVXaGVlbENvbm5lY3Rpb24oZW5kUG9pbnQsIGxvZ2luRnVuYyksdGhpcyk7XG4gICAgdGhpcy5vbiA9IHRoaXMuJG9ybS5vbi5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy5lbWl0ID0gdGhpcy4kb3JtLmVtaXQuYmluZCh0aGlzLiRvcm0pO1xuICAgIHRoaXMudW5iaW5kID0gdGhpcy4kb3JtLnVuYmluZC5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy5vbmNlID0gdGhpcy4kb3JtLm9uY2U7XG4gICAgdGhpcy5hZGRNb2RlbEhhbmRsZXIgPSB0aGlzLiRvcm0uYWRkTW9kZWxIYW5kbGVyLmJpbmQodGhpcy4kb3JtKTtcbiAgICB0aGlzLmFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzID0gdGhpcy4kb3JtLmFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzLmJpbmQodGhpcy4kb3JtKTtcbiAgICB0aGlzLnV0aWxzID0gdXRpbHM7XG4gICAgdGhpcy5sb2dvdXQgPSB0aGlzLiRvcm0uY29ubmVjdGlvbi5sb2dvdXQuYmluZCh0aGlzLiRvcm0uY29ubmVjdGlvbik7XG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbigpe1xuICAgIHZhciBjb25uZWN0aW9uID0gdGhpcy4kb3JtLmNvbm5lY3Rpb247XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihjYWxsQmFjayxyZWplY3Qpe1xuICAgICAgICBjb25uZWN0aW9uLmNvbm5lY3QoY2FsbEJhY2spO1xuICAgIH0pKTtcbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKGFjY2VwdCxyZWplY3Qpe1xuICAgICAgICB0aGlzLiRvcm0uY29ubmVjdGlvbi5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQsIGFjY2VwdCk7ICAgIFxuICAgIH0pLmJpbmQodGhpcykpO1xuICAgIFxufTtcblxucmVXaGVlbE9STS5wcm90b3R5cGUubG9nb3V0ID0gZnVuY3Rpb24odXJsKXtcbiAgICByZXR1cm4gdGhpcy4kb3JtLmNvbm5lY3Rpb24ubG9nb3V0KCk7XG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmdldE1vZGVsID0gZnVuY3Rpb24obW9kZWxOYW1lKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHNlbGYuJG9ybS5jb25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgc2VsZi4kb3JtLmRlc2NyaWJlKG1vZGVsTmFtZSxhY2NlcHQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihtb2RlbE5hbWUsIGlkcyl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBzaW5nbGUgPSBmYWxzZTtcbiAgICB2YXIgbW9kTmFtZSA9IG1vZGVsTmFtZTtcbiAgICB2YXIgZmlsdGVyO1xuICAgIGlmICh0eXBlb2YgaWRzID09PSAnbnVtYmVyJykge1xuICAgICAgICBzaW5nbGUgPSB0cnVlO1xuICAgICAgICBmaWx0ZXIgPSB7IGlkIDogW2lkc119O1xuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShpZHMpKXtcbiAgICAgICAgZmlsdGVyID0geyBpZCA6IGlkcyB9O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGlkcyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgZmlsdGVyID0gaWRzO1xuICAgIH0gZWxzZSBpZiAoaWRzID09PSBudWxsKSB7XG4gICAgICAgIGZpbHRlciA9IHt9O1xuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3Qpe1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICBzZWxmLiRvcm0uY29ubmVjdChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5xdWVyeShtb2RlbE5hbWUsIGZpbHRlciwgbnVsbCwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2luZ2xlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQoZGF0YS5sZW5ndGggPyBkYXRhWzBdIDogbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxuLypcbnJlV2hlZWxPUk0ucHJvdG90eXBlLnF1ZXJ5ID0gZnVuY3Rpb24gKG1vZGVsTmFtZSwgZmlsdGVyLCByZWxhdGVkKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdmFyIHRvZ2V0aGVyID0gbnVsbDtcbiAgICAgICAgaWYgKHJlbGF0ZWQgJiYgKHJlbGF0ZWQuY29uc3RydWN0b3IgPT09IEFycmF5KSAmJiAocmVsYXRlZC5sZW5ndGgpKXtcbiAgICAgICAgICAgIHRvZ2V0aGVyID0gcmVsYXRlZDtcbiAgICAgICAgfSBlbHNlIGlmIChyZWxhdGVkICYmIChyZWxhdGVkLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpICYmIChyZWxhdGVkLmxlbmd0aCkpe1xuICAgICAgICAgICAgdG9nZXRoZXIgPSByZWxhdGVkLnNwbGl0KCcsJyk7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgc2VsZi4kb3JtLmNvbm5lY3QoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBzZWxmLiRvcm0ucXVlcnkobW9kZWxOYW1lLCBmaWx0ZXIsIHRvZ2V0aGVyLCBhY2NlcHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9XG4gICAgfSlcbn07XG4qL1xuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAobW9kZWxOYW1lLCBpZHMpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3Qpe1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICBzZWxmLiRvcm0uY29ubmVjdChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5kZWxldGUobW9kZWxOYW1lLCBpZHMsIGFjY2VwdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KVxufTtcblxucmVXaGVlbE9STS5wcm90b3R5cGUuZ2V0TG9nZ2VkVXNlciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBpZiAodGhpcy4kb3JtLmNvbm5lY3Rpb24uY2FjaGVkU3RhdHVzLnVzZXJfaWQpXG4gICAgICAgIHJldHVybiB0aGlzLmdldCgnYXV0aF91c2VyJyx0aGlzLiRvcm0uY29ubmVjdGlvbi5jYWNoZWRTdGF0dXMudXNlcl9pZCk7XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCkge1xuICAgICAgICAgICAgc2VsZi5vbmNlKCdsb2dnZWQtaW4nLGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmdldCgnYXV0aF91c2VyJywgdXNlcikudGhlbihhY2NlcHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUuJHNlbmRUb0VuZHBvaW50ID0gZnVuY3Rpb24gKHVybCwgZGF0YSl7XG4gICAgcmV0dXJuIHRoaXMuJG9ybS4kcG9zdCh1cmwsIGRhdGEpO1xufVxuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCl7XG4gICAgcmV0dXJuIHRoaXMuJG9ybS5jb25uZWN0aW9uLmxvZ2luKHVzZXJuYW1lLHBhc3N3b3JkKTtcbn1cbiJdfQ==
