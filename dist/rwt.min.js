!function(t,e,n){"use strict";function i(){this.handlers=[],this.strHandlers={}}function r(){var t={},n={},i=0;this.on=function(e,r){e in t||(t[e]=new Array);var o=i++;return t[e].push(r),n[o]=r,o},this.emit=function(e){if(e in t){var n=Array.prototype.slice.call(arguments,1);t[e].forEach(function(t){t.apply(null,n)})}},this.unbind=function(i){var r=0;if(i in n){var o=n[i+""];e(t).each(function(t,e){var n=[];for(var i in t)t[i]===o&&(n.push(i),r++);n.reverse().forEach(function(e){t.splice(e,1)})})}return delete n[i],r},this.once=function(t,e){var n=this,i=this.on(t,function(){e.apply(this,arguments),n.unbind(i)})}}function o(){return new Proxy({},{get:function(t,e){return"string"==typeof e?"toString"===e?y:v.mock:t[e]}})}function s(t,e){var i=new n(t);i.onopen=function(t){console.log("open : "+t),i.tenant(),e.emit("realtime-connection-open",t)},i.onmessage=function(t){if("message"==t.type)try{e.emit("realtime-message-json",JSON.parse(t.data))}catch(n){e.emit("realtime-message-text",JSON.parse(t.data))}else console.log("from realtime ",t)},i.onclose=function(){setTimeout(v.wsConnect,1e3),e.emit("realtime-connection-closed")},i.tenant=function(){i.send("TENANT:"+e.cachedStatus.application+":"+e.cachedStatus.token)},this.close=function(){i.close()}}function a(t,e){var n=new r;this.getLogin=e,this.endPoint=t.endsWith("/")?t:t+"/",this.on=n.on,this.unbind=n.unbind,this.emit=n.emit,this.once=n.once,this.cachedStatus={},this.isConnected=!1,this.isLoggedIn=!1}function c(){var t=!1;this.touch=function(){t=!0},this.touched=function(){var e=t;return t=!1,e}}function u(t,n,i,r){if(!n)var n=[];var o=[];this.ask=function(s,a){r&&s in r.source||e(n).contains(s)||(console.info("asking ("+s+") from "+i),o.push(s),a||n.push(s),t.touch())},this.getAskedIndex=function(){return n},this.missings=function(){return e(o.splice(0,o.length)).unique().toArray()}}function l(t,n,i,r){var o=new c,s={},a={},l={},f={},h={};this.mainIndex=s,this.foreignKeys=a,this.m2m=l,this.m2mIndex=f,this.permissions=h,i.on("model-definition",function(t,n){var i=r.getIndexFor(t.name,"id");s[t.name]=new u(o,i,"mainIndex."+t.name,n),h[t.name]=new u(o,null,"permissions."+t.name),e(t.references).each(function(e){var n=t.name+"_"+e.id;a[n]=new u(o,r.getIndexFor(e.to,"id"),e.to+".id foreignKeys."+n)}),e(t.referencedBy).each(function(t){var e=t.by+"."+t.id;a[e]=new u(o,r.getIndexFor(t.by,t.id),t.by+"."+t.id+" foreignKeys."+e)}),e(t.manyToMany).each(function(t){t.indexName in l||(l[t.indexName]=[new u(o,null,"m2m."+t.indexName+"[0]"),new u(o,null,"m2m."+t.indexName+"[1]")]),t.indexName in f||(f[t.indexName]=new d(t,l[t.indexName]))})});var p=function(e,n,r,o){i.$post((n?v.reverse("/",e):e)+"s/list",{collection:r},function(n){i.gotData(n,o),delete t[e]})},m=function(n,i,r,o){e(i).each(l[n][r].ask.bind(l[n][r])),i=l[n][r].missings(),i.length?(t[n]=1,p(n,r,i,o)):o&&o()};this.getM2M=m;var g=function(){if(o.touched()){if(e(t).values().sum())return void o.touch();var r=!1;e(l).each(function(t,n){e(t).each(function(t,o){var a=t.missings();if(a=e(a).filter(Boolean).map(function(t){return parseInt(t)}).toArray(),a.length){var c=f[n],u=c["get"+(1-o)].bind(c);r=!0,p(n,o,a,function(t){var r=a.map(u);if(r.length){var c=n.split("/")[1-o];i.describe(c,function(){e(r).flatten().unique().each(function(t){s[c].ask(t,!0)})})}})}})}),e(s).each(function(t,o){var s=t.missings();if(s.length){r=!0;o in n?n[o].keys():e();i.fetch(o,{id:s},null,v.noop)}}),e(a).map(function(t,e){return[e,t.missings()]}).filter(function(t){return t[1].length}).each(function(t){r=!0;var e=t[1],n=t[0],o=n.split("."),s=o[0],a=o[1],c={};c[a]=e,i.fetch(s,c)}),e(e(h).map(function(t,e){return[e,t.missings()]}).filter(function(t){return t[1].length}).toObject()).each(function(n,o){r=!0,n.length&&(t[o]=1,i.$post(o+"/my_perms",{ids:e(n).unique().toArray()},function(e){i.gotPermissions(e.PERMISSIONS),delete t[o]}))})}};setInterval(g,50)}function f(){var t={},n={},i={},r=function(t,n,i){var r=[];if(i)for(var o in t)for(var s in n)r.push(e([t[o],n[s]]).flatten().toArray());else for(var o in t)for(var s in n)r.push([t[o],n[s]]);return r},o=function(t){for(var e=!1,n=t[0],i=1;i<t.length;++i)n=r(n,t[i],e),e=!0;return n},s=function(t){var n=o(e(t).values().toArray()),i=e(t).keys().toArray();return n.map(function(t){var e={};return i.forEach(function(n,i){e[n]=t[i]}),e})},a=function(t,n,i){var r=t.modelName,o=this.getIndexFor,s=(e(n).map(function(t,e){return[e,r+"."+e]}).toObject(),e(n).keys().map(function(t){return[t,o(r,t)]}).toObject());for(var a in n){var c=e(n[a]).difference(s[a]).toArray();if(c.length){var u=e([[a,c]]).toObject();return i||Array.prototype.push.apply(s[a],c),u}return null}},c=function(t,n){t.name in i||(i[t.name]=[]);var r=i[t.name],o=e(n).size();r.filter(v.makeFilter(t,n," && ",!0)).filter(function(t){e(t).size()>o})};this.filter=function(r,o){var u=r.modelName,l=e(o).size();switch(l){case 0:var f=t[u];return t[u]=!0,u in n&&delete n[u],u in i&&delete i[u],f?null:{};case 1:var d=a.call(this,r,o);return c.call(this,r,o),d}var h=this,p=e(o).keys().some(function(t){var e={};return e[t]=o[t],null==a.call(h,r,e,!0)});if(p)return null;u in i||(i[u]=[]);var m=s(o),g=i[u].filter(v.makeFilter(r,o," || ",!0));if(g.length){var y=[];for(var w in g)y.push.apply(y,m.filter(v.makeFilter(r,g[w]," && ",!0)));var b=e(m).difference(y).toArray()}else var b=m;if(b.length){i[u].push.apply(i[u],b);var b=e(o).keys().map(function(t){var n=e(b).pluck(t).unique().toArray();return[t,n.length?n:o[t]]}).toObject();return c(r,b),b}return null},this.getIndexFor=function(t,e){var i=t+"."+e;return i in n||(n[i]=[]),n[i]}}function d(t,n){var i=[];this.add=i.push.bind(i),this.add=function(t){e(i).find(t)||i.push(t)},this.get0=function(t){return n[1].ask(t),e(i).filter(function(e){return e[0]===t}).pluck("1").toArray()},this.get1=function(t){return n[0].ask(t),e(i).filter(function(e){return e[1]===t}).pluck("0").toArray()},this["get"+v.capitalize(t.indexName.split("/")[1])]=this.get1,this["get"+v.capitalize(t.indexName.split("/")[0])]=this.get0,this.del=function(t){for(var e=i.length,n=null,r=0;r<e;r++)if(i[r][0]===t[0]&&i[r][1]===t[1]){n=r;break}n&&i.splice(r,1),console.log("deleting ",t)}}function h(t,n,i,r){var o=Array.prototype.slice.call(arguments,4),s={};e(o).each(function(e){t.orm.on(e,function(){s={}})});var a={get:function(){return this.id in s||(s[this.id]=i.call(this)),s[this.id]}};r&&(a.set=function(t){isFinite(t)?(r.call(this,t),this.id in s&&delete s[this.id]):this.id in s&&delete s[this.id]}),Object.defineProperty(t,n,a)}function p(t){this.resource=t._resource,this.formIdx=t.formIdx,this.fields=t.errors}function m(t,e){this.$orm=new b(new v.reWheelConnection(t,e),this),this.on=this.$orm.on.bind(this.$orm),this.emit=this.$orm.emit.bind(this.$orm),this.unbind=this.$orm.unbind.bind(this.$orm),this.once=this.$orm.once,this.addModelHandler=this.$orm.addModelHandler.bind(this.$orm),this.addPersistentAttributes=this.$orm.addPersistentAttributes.bind(this.$orm),this.utils=v,this.logout=this.$orm.connection.logout.bind(this.$orm.connection)}i.prototype.addHandler=function(t){var e=v.hash(t.toString());e in this.strHandlers||(this.strHandlers[e]=t,this.handlers.push(t))},i.prototype.handle=function(){var t=Array.prototype.slice.call(arguments,0);this.handlers.forEach(function(e){e.apply(null,t)})},i.prototype.handleBy=function(){var t=Array.prototype.slice.call(arguments,1),e=arguments[0];this.handlers.forEach(function(n){n.apply(e,t)})};var g=0,y=function(){return""},v={renameFunction:function(t,e){return new Function("return function (call) { return function "+t+" () { return call(this, arguments) }; };")()(Function.apply.bind(e))},cached:function(t,e){function n(){return this[e]||(this[e]=t.call(this,[arguments])),this[e]}return e||(e="_"+g++),n},log:function(){console.log(arguments)},xdr:function(t,n,i,r,o){return new Promise(function(i,s){var a;n||(n={}),XMLHttpRequest?(a=new XMLHttpRequest,a.onreadystatechange=function(){if(4===a.readyState){try{var t=JSON.parse(a.responseText)}catch(t){var t=null}var e={responseData:t,responseText:a.responseText,status:a.status,request:a};a.status>=200&&a.status<400?i(e):s(e)}}):XDomainRequest?(a=new XDomainRequest,a.onload=function(){i(a.responseText,a.statusText,a)}):s(new Error("CORS not supported")),a.open("POST",t,!0),a.onerror=s,a.setRequestHeader("Accept","application/json"),r&&(n.__token__=r),o?(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n=e(n).map(function(t,e){return e+"="+encodeURI(t.toString())}).toArray().join("&")):(a.setRequestHeader("Content-Type","text/plain"),n=e(n).size()?JSON.stringify(n):""),a.send(n)})},capitalize:function(t){return t[0].toUpperCase()+t.slice(1).toLowerCase()},hash:function(t){t=t.toString();for(var e=1,n=0;n<t.length;n++)e*=1+t.charCodeAt(n);return(e%34958374957).toString()},makeFilter:function(t,n,i,r){if(i||(i=" && "),0===e(n).size())return function(t){return!0};var o=e(n).map(function(n,i){return n||(n=[null]),Array.isArray(n)||(n=[n]),r||"reference"!==t.fields[i].type?"string"===t.fields[i].type&&(n=n.map(JSON.stringify)):(i="_"+i,n=e(n).map(function(t){return t&&t.constructor!==Number?t.id:t}).toArray()),"("+e(n).map(function(t){return t?t===orm.utils.mock&&console.error("makeFilter with Mock Object"):console.error("makeFilter x is null"),"(x."+i+" === "+t+")"}).join(" || ")+")"}).toArray().join(i);return new Function("x","return "+o)},sameAs:function(t,e){for(var n in t)if(e[n]!=t[n])return!1;return!0},pluralize:function(t,e){return t+"s"},beforeCall:function(t,e){var n=function(){e().then(t)};return n},cleanStorage:function(){e(localStorage).keys().each(function(t){delete localStorage[t]})},cleanDescription:function(){e(localStorage).filter(function(t,n){return e(n).startsWith("description:")}).keys().each(function(t){delete localStorage[t]})},reverse:function(t,e){return e.split(t).reverse().join(t)},permutations:function(t){for(var e=[],n=t.length-1;n>=0;n--)for(var i=t.length-1;i>=0;i--)n!==i&&e.push([t[n],t[i]]);return e},waitFor:function(t,e){var n=function(){t()?e():setTimeout(n,500)};setTimeout(n,500)},bool:Boolean,noop:function(){},tzOffset:6e4*(new Date).getTimezoneOffset(),transFieldType:{date:function(t){return new Date(1e3*t+v.tzOffset)},datetime:function(t){return new Date(1e3*t+v.tzOffset)},string:function(t){return t.toString()},text:function(t){return t.toString()},integer:function(t){return parseInt(t)},float:function(t){return parseFloat(t)}},mock:o()},w="lastRWTConnectionStatus";a.prototype.$post=function(t,e,n){var i=this,r=new Promise(function(r,o){v.xdr(i.endPoint+t,e,i.cachedStatus.application,i.cachedStatus.token).then(function(o){i.emit("http-response",o.responseText,o.status,t,e),i.emit("http-response-"+o.status,o.responseText,t,e),o.responseData&&i.emit("http-response-"+o.status+"-json",o.responseData,t,e),n&&n(o.responseData||o.responseText),r(o.responseData||o.responseText)},function(n){n.responseData?(i.emit("error-json",n.responseData,n.status,t,e,n),i.emit("error-json-"+n.status,n.responseData,t,e,n)):(i.emit("error-http",n.responseText,n.status,t,e,n),i.emit("error-http-"+n.status,n.responseText,t,e,n)),o(n.responseData||n.responseText)})});return r},a.prototype.status=function(t,n){var i="token:"+this.endPoint,r=this;if(n&&(this.cachedStatus={},delete localStorage[i]),this.statusWaiting)return void v.waitFor(function(){return!r.statusWaiting},function(){r.status(t,n)});if(!e(this.cachedStatus).size()){var o={};return i in localStorage&&(o.__token__=localStorage[i]),this.statusWaiting=!0,void this.$post("api/status",o,function(e){r.updateStatus(e),localStorage[i]=e.token,t(e),r.statusWaiting=!1})}t(this.cachedStatus),t(this.cachedStatus)},a.prototype.updateStatus=function(t){var e=parseFloat(localStorage.lastBuild)||1;e<t.last_build&&(v.cleanDescription(),localStorage.lastBuild=t.last_build),this.isConnected=Boolean(t.token),this.isLoggedIn=Boolean(t.user_id);var n=this.cachedStatus;if(this.cachedStatus=t,!n.user_id&&t.user_id)this.emit("logged-in",t.user_id);else if(n.user_id&&!t.user_id)this.emit("logged-out");else if(this.isConnected&&!this.isLoggedIn&&(this.emit("login-required"),this.getLogin)){var i=this.getLogin();i.constructor===Object?this.login(i.username,i.password,i.callBack):i.constructor===Promise&&i.then(function(t){this.login(t.username,t.password,t.callBack)})}!n.realtimeEndPoint&&t.realtimeEndPoint?this.wsConnection=new s(t.realtimeEndPoint,this):n.realtimeEndPoint&&!t.realtimeEndPoint&&(this.wsConnection.close(),delete this.wsConnection),this.emit("update-connection-status",t,n),localStorage[w]=JSON.stringify(t)},a.prototype.login=function(t,e){var n=this;return new Promise(function(i,r){v.xdr(n.endPoint+"api/login",{username:t||"",password:e||""},null,n.cachedStatus.token,!0).then(function(t){n.updateStatus(t.responseData),i({status:"success",userid:n.cachedStatus.user_id})},function(t){i({error:t.responseData.error,status:"error"})})})},a.prototype.logout=function(){var t=this;return new Promise(function(e,n){t.$post("api/logout").then(function(n){t.updateStatus({}),delete localStorage[w],e()},n)})},a.prototype.connect=function(t){this.isLoggedIn?t(this.cachedStatus.user_id):(this.once("logged-in",function(e){t(e)}),this.status(t||v.noop))},v.reWheelConnection=a;var b=function(t,n){function r(t,e,n){this.klass=e,this.permissions=[],this.id=t;for(var i in n)this.push.apply(this,[i,n[i]])}if(t.constructor===String)var o=new a(t);else if(t.constructor===v.reWheelConnection)var o=t;this.connection=o,o.on("connected",function(){this.connected=!0}),this.on=o.on,this.emit=o.emit,this.unbind=o.unbind,this.once=o.once,this.$post=o.$post.bind(o),this.on("ws-connected",function(t){console.info("Websocket connected"),t.onMessageJson(s.gotData.bind(s)),t.onMessageText(function(t){console.info("WS message : "+t)})}),this.on("ws-disconnected",function(t){console.error("Websocket disconnected")}),this.on("error-json-404",function(t,e,n,i){console.error("JSON error ",JSON.stringify(t)),delete b[e.split("/")[0]]}),this.on("realtime-message-json",function(t){s.gotData(t)});var s=this,c={auth_group:e({})},u={},d={},m={},g={},y={},w={},b={},S=new f(e),A=new l(b,c,this,S);window.IDB=c,this.validationEvent=this.on("error-json-513",function(t,e,n,i){currentContext.savingErrorHanlder&&currentContext.savingErrorHanlder(new p(t))});var k=function(t){return t in c?c[t]:(c[t]=e({}),c[t])};r.prototype.save=function(t){var n={permissions:e(this.permissions).map(function(t){return[t[0].id,t[1]]}).toObject()};n.id=this.id;this.klass.modelName;s.$post(this.klass.modelName+"/set_permissions",n,function(e,n,i,r){t(e)})},r.prototype.push=function(t,n){var i=e(n),r=e(this.klass.allPermissions).map(function(t){return[t,i.contains(t)]}).toObject(),o=e(this.permissions).map(function(t){return t[0].id});o.contains(t)?this.permissions[o.indexOf(t)][1]=r:this.permissions.push([c.auth_group.get(t),r])};var N=function(t){t.fields.id.readable=!1,t.fields.id.writable=!1;var i=e(t.fields);t.privateArgs&&(i=i.merge(t.privateArgs)),s.emit("model-definition",t,k(t.name));var o="if (!row) { row = {}};\n";o+=t.references.map(function(t){return"this._"+t.id+" = row."+t.id+";"}).join(";\n"),o+=i.map(function(t,e){return"date"==t.type||"datetime"==t.type?"this."+e+" = row."+e+"?new Date(row."+e+" * 1000 - "+v.tzOffset+"):null;\n":"boolean"==t.type?"this."+e+" = (row."+e+' === "T") || (row.'+e+" === true);\n":"this."+e+" = row."+e+";\n"}).toString("\n"),o+="if (permissions) {this._permissions = permissions && Lazy(permissions).map(function (x) { return [x, true] }).toObject();}";var a=new Function("row","permissions",o);a.prototype.orm=n,a.ref_translations={},a.modelName=t.name,a.references=e(t.references).pluck("id").toArray(),a.inverse_references=t.referencedBy.map(function(t){return t.by+"_"+t.id+"_set"}),a.referents=t.referencedBy.map(function(t){return[t.by,t.id]}),a.fieldsOrder=t.fieldOrder,a.allPermissions=t.permissions,e(t.representation).size()&&(a.prototype.toString=new Function("return this."+e(t.representation).toString(' + " " + this.'))),a.prototype.toUpperCase=function(){return this.toString().toUpperCase()},a.prototype.toLowerCase=function(){return this.toString().toLowerCase()},a.prototype.delete=function(){return n.delete(this.constructor.modelName,[this.id])},Object.defineProperty(a.prototype,"permissions",{get:function(){return this._permissions?this._permissions:void A.permissions[this.constructor.modelName].ask(this.id)}}),a.prototype.all_perms=function(t){var n=this.id;s.$post(this.constructor.modelName+"/all_perms",{id:this.id},function(i){var o=i,u={},l=e(o).pluck("group_id").unique().map(function(t){return""+t}).difference(c.auth_group.keys()).toArray();e(o).groupBy(function(t){return t.group_id}).each(function(t,n){u[n]=e(t).pluck("name").toArray()});var f=function(e){t(new r(n,a,u))};l.length?s.get("auth_group",l,f):f()})},a.prototype.save=function(t){var n=this.asRaw(),i=a.fields,r=this.id,o=this.constructor.modelName;if(t)for(var c in t)n[c]=t[c];e(a.fieldsOrder).filter(function(t){return!i[t].writable}).each(function(t){t in n&&delete n[t]}),r&&(n.id=r);var u=s.$post(o+(r?"/post":"/put"),n);return t&&t.constructor===Function&&(u.context.savingErrorHanlder=t),u},a.prototype.copy=function(){var t=new this.constructor(this.asRaw());return t._permissions=this._permissions,t};var l="return {\n"+e(t.references).map(function(t){return t.id+" : this._"+t.id}).concat(i.map(function(t,e){return"date"==t.type||"datetime"==t.type?e+" : (this."+e+"?(Math.round(this."+e+".getTime() - this."+e+".getTimezoneOffset() * 60000) / 1000):null)":"boolean"==t.type?e+" : this."+e+'?"T":"F"':e+" : this."+e})).toString(",\n")+"};";a.prototype.asRaw=new Function(l),a.saveMulti=function(t,n,i){var r=[],o=e(a.fields).filter(function(t){return!t.writable}).pluck("id").toArray();e(t).map(function(t){return t.asRaw()}).each(function(t){e(o).each(function(e){delete t[e]}),r.push(t)}),s.$post(a.modelName,"put",{multiple:r,formIdx:s.formIdx++},function(t){s.gotData(t);var i=c[a.modelName],r=e(t[a.modelName].results).pluck("id").map(function(t){return i.get(t)}).toArray();n&&n(r)},i)},"extra_verbs"in t&&e(t.extra_verbs).each(function(t){var n=t[0],i=t[1],r="data = {id : this.id";i.length&&(r+=", "+e(i).map(function(t){return t+" : "+t}).join(",")),r+="};",i.push("cb"),a.prototype[n]=new Function(i,r+'W2S.W2P_POST(this.constructor.modelName,"'+n+'", data,function(data,status,headers,x){try{\n   if (!headers("nomodel")) {window.W2S.gotData(data,cb);}\n   else {if (cb) {cb(data)}}\n} catch(e){\nif (cb) {cb(data);}\n}\n});\n')}),"privateArgs"in t&&(a.privateArgs=e(t.privateArgs).keys().map(function(t){return[t,!0]}).toObject(),a.prototype.savePA=function(t){var n=this,i={id:this.id},r=this.constructor.privateArgs,o=this.constructor.fields,a=(new this.constructor(t).asRaw(),e(r).keys().map(function(t){return[t,o[t]]}).toObject());e(t).each(function(t,e){e in r&&a[e].writable&&(i[e]=t)}),s.$post(this.constructor.modelName+"/savePA",i,function(){e(i).each(function(t,e){n[e]=t})})}),y[a.modelName]=a;for(var f in t.fields)t.fields[f].id=f;return a.fields=e(t.fields).concat(e(t.privateArgs)).concat(e(t.references).tap(function(t){t.type=t.type||"reference"})).indexBy("id").toObject(),e(a.fields).each(function(t){t.widget||("reference"===t.type?t.widget="choices":t.widget=t.type)}),e(t.references).each(function(t){var e=t.to,i="_"+t.id;h(a.prototype,t.id,function(){if(!this[i])return null;if(!(e in c)){var t=this;s.describe(e,function(n){A.mainIndex[e].ask(t[i],!0)})}var n=e in c&&this[i]&&c[e].get(this[i]);return!n&&e in A.mainIndex?("number"==typeof this[i]?A.mainIndex[e].ask(this[i],!0):console.warn("null reference for "+i+"("+this.id+") resource "+a.modelName),v.mock):n},function(n){if(n){if(n.constructor!==v.mock&&n.constructor.modelName!==e)throw new TypeError("You can assign only "+e+" to "+t.id);this[i]=n.id}else this[i]=null},"new-"+e,"deleted-"+e,"updated-"+e,"new-model-"+e),a.prototype["get"+v.capitalize(t.id)]=function(){return n.get(e,this[i])}}),e(t.referencedBy).each(function(t){var e=t.by+"."+t.id,i=t.by+"_"+v.pluralize(t.id),r=t.by;a.prototype.hasOwnProperty(i)?console.error("Tryed to redefine property "+i+"s for "+a.modelName):h(a.prototype,i,function(){var t=r in c?u[e].get(this.id+""):null;return A.foreignKeys[e].ask(this.id,!0),t},null,"new-"+r,"updated-"+r,"deleted-"+r),a.prototype["get"+v.capitalize(v.pluralize(t.by))]=function(){var e={};return e[t.id]=[this.id],n.get(t.by,e)}}),t.manyToMany&&(e(t.manyToMany).each(function(t){var n=t.indexName,i=t.first?0:1,r=t.model,o=A.m2mIndex[n]["get"+(1-i)];h(a.prototype,t.model+"s",function(){var t=this,n=[],i=o(t.id),s=null;return i.length&&(s=k(r).get.bind(c[r])),i&&s&&(n=e(i).map(s).filter(v.bool).toArray()),n},null,"received-m2m-"+n,"received-"+r),a.prototype["get"+v.capitalize(v.pluralize(r))]=function(){var t=this;return new Promise(function(a,u){try{A.getM2M(n,[t.id],i,function(n){var i=o(t.id);i.length?s.fetch(r,{id:i},null,function(){var t=c[r].get.bind(c[r]);a(e(i).map(t).filter(v.bool).toArray())}):a([])})}catch(t){console.error(t),u(t)}})},a.fields[v.capitalize(r)]={id:v.capitalize(r),name:v.capitalize(r),writable:!0,readable:!0,type:"M2M",validators:[]}}),a.prototype.unlinkReference=function(t){var n=!1,i=this.id,r=[];"Array"==t.constructor.name&&(n=!0,r=t,t=r[0]);var o=t.constructor.modelName;if(n)var c=e(r).pluck("id").map(function(t){return[i,t]}).toArray();else var c=[[i,t.id]];s.$post(a.modelName+"/"+o+"s/delete",{collection:c})},a.prototype.linkReference=function(t){var n=!1,i=this.id,r=[];"Array"==t.constructor.name&&(n=!0,r=t,t=r[0]);var o=t.constructor.modelName,c=a.modelName+"/"+o;if(n){var u=[];if(c in INDEX_M2M&&(u=e(r).pluck("id").difference(e(INDEX_M2M[c][0].get(this.id))).toArray()),c=o+"/"+a.modelName,c in INDEX_M2M&&(u=e(r).pluck("id").difference(e(INDEX_M2M[c][0].get(this.id))).toArray()),u.length){var l=e(u).map(function(t){return[i,t]}).toArray();W2P_POST(a.modelName,o+"s/put",{collection:l},function(t){})}}else{if(c in A.m2mIndex&&e(A.m2mIndex[c]["get"+v.capitalize(o)](t.id)).find(this))return;s.$post(a.modelName+"/"+o+"s/put",{collection:[[this.id,t.id]]})}}),s.emit("new-model",a),s.emit("new-model-"+a.modelName),a};this.gotData=function(t,n){if(console.info("gotData"),"string"!=typeof t){"_extra"in t&&delete t._extra;var i=(t.TOONE,t.TOMANY,t.MANYTOMANY,t.PERMISSIONS),r=t.PA;if(delete t.TOONE,delete t.TOMANY,delete t.MANYTOMANY,delete t.PERMISSIONS,delete t.PA,r||(r={}),t=e(t).filter(function(t,e){return!("deleted"in t)||e in y}).toObject(),"m2m"in t){var o=t.m2m;delete t.m2m}e(t).each(function(t,n){s.describe(n,function(i){var o=i;t.results&&t.results.length>0&&t.results[0].constructor==Array&&(t.results=e(t.results).map(function(t){return e(o.fieldsOrder).zip(t).toObject()}).toArray());var a=e(t.results),l=t.deleted;if(n in r){var f=r[n];e(a).each(function(t){t.id in f&&e(f[t.id]).each(function(e,n){t[n]=e})})}var d=k(n),h=d.source;l&&l.forEach(function(t){delete h[t]});var p=a.indexBy("id"),m=p.keys(),g=m.difference(d.keys().map(function(t){return parseInt(t)})),w=m.difference(g);w=w.filter(function(t){return!v.sameAs(p.get(t),d.get(t).asRaw())}).toArray();var b=e(t.permissions?t.permissions:{}),S=g.map(function(t){return new o(p.get(t),b.get(t))}),A=[];e(i.references).map(function(t){return[t,1]}).toObject();w.forEach(function(t){var n=h[t],r=n.copy(),o=p.get(t);e(i.fields).each(function(t,e){switch(t.type){case"reference":n["_"+e]=o[e],n[e]=NaN;break;case"date":n[e]=new Date(1e3*o[e]);break;case"datetime":n[e]=new Date(1e3*o[e]);break;case"boolean":switch(o[e]){case null:n[e]=null;break;case"T":n[e]=!0;break;case"F":n[e]=!1;break;case!0:n[e]=!0;break;case!1:n[e]=!1}break;default:n[e]=o[e]}}),A.push([o,r])}),A.length&&s.emit("updated-"+n,A);var N=S.toArray();e(N).each(function(t){h[t.id]=t}),e(y[n].references).each(function(t){u[n+"."+t]=c[n].groupBy("_"+t)}),N.length&&s.emit("new-"+n,e(N),t.totalResults),l&&s.emit("deleted-"+n,l),s.emit("received-"+n)})}),o&&s.gotM2M(o),i&&s.gotPermissions(i),n&&n(t),s.emit("got-data")}else if(console.log("data "+t+" refused from gotData()"),n)return n(t)},this.gotPermissions=function(t){e(t).each(function(t,n){e(t[0]).each(function(t,i){n in c&&i in c[n].source&&(c[n].get(i)._permissions=e(t).map(function(t){return[t,!0]}).toObject())}),e(t[0]).size()&&s.emit("update-permissions-"+n,e(t[0]).keys().toArray())}),this.emit("update-permissions")},this.gotM2M=function(t){e(t).each(function(t,n){var i=A.m2mIndex[n];e(t).each(function(t){e(t).each(function(t,e){i[e](t)})}),s.emit("received-m2m"),s.emit("received-m2m-"+n)})},this.fetch=function(t,e,n,i){t in b?setTimeout(function(){s.fetch(t,e,n,i)},500):s.describe(t,function(n){return s.connection.cachedStatus.realtimeEndPoint?(e=S.filter(n,e),e?(b[t]=!0,s.$post(t+"/list",{filter:e}).then(function(e){s.gotData(e,i),delete b[t]},function(e){delete b[t]})):i&&i(),e):void this.$post(t+"/list",sendData,function(n){e||GOT_ALL.source.push(t),s.gotData(n,i)})}.bind(this))},this.get=function(t,e,n){e.constructor!==Array&&(e=[e]),s.fetch(t,{id:e},null,function(){var i=[],r=c[t];for(var o in e)i.push(r.source[e[o]]);n(i)})},this.gotModel=function(t){for(var n in t){var i=t[n];localStorage["description:"+n]=JSON.stringify(t),y[n]=N(i),n in c||(c[n]=e({}))}},this.describe=function(t,e){var n=y[t];if(n)e&&e(n);else if(t in b)setTimeout(function(){s.describe(t,e)},500);else{if(t in w)return;var i="description:"+t;i in localStorage?(this.gotModel(JSON.parse(localStorage[i])),e&&e(y[t])):(b[t]=!0,this.$post(t+"/describe",null,function(n){s.gotModel(n),e&&e(y[t]),delete b[t]},function(e){this.modelNotFound.handle(t),w[t]=!0}))}},this.addModelHandler=function(t,e){var n=v.hash(e);t in d||(d[t]=new i),t in m||(m[t]={}),n in m[t]||(m[t][n]=!0,t in y?e(y[t]):d[t].addHandler(e))},this.addPersistentAttributes=function(t,n){var i=function(t,e){e.forEach(function(e){var n="pA:"+t.modelName+":"+e,i="__"+e;Object.defineProperty(t.prototype,e,{get:function(){if(!(i in this)){var t=localStorage[n+this.id];this[i]=t?JSON.parse(t):null}return this[i]},set:function(t){this[i]=t,localStorage[n+this.id]=JSON.stringify(t)}})})};t in g||(g[t]=[]);var r=g[t];if(n)var o=e(n).difference(r).toArray();else var o=r;o.length&&(t in y&&i(y[t],o),n&&Array.prototype.push.apply(r,o))},this.on("new-model",function(t){t.modelName in d&&d[t.modelName].handle(y[t.modelName]),t.modelName in g&&s.addPersistentAttributes(t.modelName)}),this.query=function(t,n,i,r){var o=this;this.describe(t,function(s){n=e(n).map(function(t,e){return[e,Array.isArray(t)?t:[t]]}).toObject();var a=v.makeFilter(s,n),c=k(t);o.fetch(t,n,i,function(t){r(c.filter(a).values().toArray())})})},this.delete=function(t,e,n){return this.$post(t+"/delete",{id:e},n)},this.connect=function(t){this.connection.isLoggedIn?t():this.connection.connect(t)}};m.prototype.connect=function(){var t=this.$orm.connection;return new Promise(function(e,n){t.connect(e)})},m.prototype.login=function(t,e){return new Promise(function(n,i){this.$orm.connection.login(t,e,n)}.bind(this))},m.prototype.logout=function(t){return this.$orm.connection.logout()},m.prototype.getModel=function(t){var e=this;return new Promise(function(n,i){try{e.$orm.connect(function(){e.$orm.describe(t,n)})}catch(t){i(t)}})},m.prototype.get=function(t,e){var n,i=this,r=!1;return"number"==typeof e?(r=!0,n={id:[e]}):Array.isArray(e)?n={id:e}:"object"==typeof e?n=e:null===e&&(n={}),new Promise(function(e,o){try{i.$orm.connect(function(){i.$orm.query(t,n,null,function(t){e(r?t.length?t[0]:null:t)})})}catch(t){o(t)}})},m.prototype.delete=function(t,e){var n=this;return new Promise(function(i,r){try{n.$orm.connect(function(){n.$orm.delete(t,e,i)})}catch(t){r(t)}})},m.prototype.getLoggedUser=function(){var t=this;return this.$orm.connection.cachedStatus.user_id?this.get("auth_user",this.$orm.connection.cachedStatus.user_id):new Promise(function(e,n){t.once("logged-in",function(n){t.get("auth_user",n).then(e)})})},m.prototype.$sendToEndpoint=function(t,e){return this.$orm.$post(t,e)},m.prototype.login=function(t,e){return this.$orm.connection.login(t,e)},t.rwt=m}(window,Lazy,SockJS);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhbmRsZXJzLmpzIiwidXRpbHMuanMiLCJjb25uZWN0aW9uLmpzIiwidG91Y2hlci5qcyIsInZhY3V1bWNhY2hlci5qcyIsImF1dG9saW5rZXIuanMiLCJsaXN0Y2FjaGVyLmpzIiwibWFueXRvbWFueS5qcyIsImNhY2hlci5qcyIsIm9ybS5qcyJdLCJuYW1lcyI6WyJIYW5kbGVyIiwidGhpcyIsImhhbmRsZXJzIiwic3RySGFuZGxlcnMiLCJOYW1lZEV2ZW50TWFuYWdlciIsImV2ZW50cyIsImhhbmRsZXJJZCIsImlkeElkIiwib24iLCJuYW1lIiwiZnVuYyIsIkFycmF5IiwiaWQiLCJwdXNoIiwiZW1pdCIsImFyZ3MiLCJwcm90b3R5cGUiLCJzbGljZSIsImNhbGwiLCJhcmd1bWVudHMiLCJmb3JFYWNoIiwiZXZlbnQiLCJhcHBseSIsInVuYmluZCIsImhhbmRsZXIiLCJjb3VudCIsIkxhenkiLCJlYWNoIiwidiIsImsiLCJpZHgiLCJuIiwicmV2ZXJzZSIsIngiLCJzcGxpY2UiLCJvbmNlIiwiZXZlbnROYW1lIiwiaGFuZGxlckZ1bmN0aW9uIiwic2VsZiIsIm1vY2tPYmplY3QiLCJQcm94eSIsImdldCIsInRhcmdldCIsIm51bGxTdHJpbmciLCJ1dGlscyIsIm1vY2siLCJSZWFsdGltZUNvbm5lY3Rpb24iLCJlbmRQb2ludCIsInJ3dENvbm5lY3Rpb24iLCJjb25uZWN0aW9uIiwiU29ja0pTIiwib25vcGVuIiwiY29uc29sZSIsImxvZyIsInRlbmFudCIsIm9ubWVzc2FnZSIsInR5cGUiLCJKU09OIiwicGFyc2UiLCJkYXRhIiwiZSIsIm9uY2xvc2UiLCJzZXRUaW1lb3V0Iiwid3NDb25uZWN0Iiwic2VuZCIsImNhY2hlZFN0YXR1cyIsImFwcGxpY2F0aW9uIiwidG9rZW4iLCJjbG9zZSIsInJlV2hlZWxDb25uZWN0aW9uIiwiZ2V0TG9naW4iLCJlbmRzV2l0aCIsImlzQ29ubmVjdGVkIiwiaXNMb2dnZWRJbiIsIlRvdWNoZXIiLCJ0b3VjaGVkIiwidG91Y2giLCJ0IiwiVmFjdXVtQ2FjaGVyIiwiYXNrZWQiLCJwa0luZGV4IiwibWlzc2luZyIsImFzayIsImxhenkiLCJzb3VyY2UiLCJjb250YWlucyIsImluZm8iLCJnZXRBc2tlZEluZGV4IiwibWlzc2luZ3MiLCJsZW5ndGgiLCJ1bmlxdWUiLCJ0b0FycmF5IiwiQXV0b0xpbmtlciIsImFjdGl2ZXMiLCJJREIiLCJXMlBSRVNPVVJDRSIsImxpc3RDYWNoZSIsIm1haW5JbmRleCIsImZvcmVpZ25LZXlzIiwibTJtIiwibTJtSW5kZXgiLCJwZXJtaXNzaW9ucyIsIm1vZGVsIiwiaW5kZXgiLCJnZXRJbmRleEZvciIsInJlZmVyZW5jZXMiLCJyZWZlcmVuY2UiLCJpbmRleE5hbWUiLCJ0byIsInJlZmVyZW5jZWRCeSIsImZpZWxkIiwiYnkiLCJtYW55VG9NYW55IiwicmVsYXRpb24iLCJNYW55VG9NYW55UmVsYXRpb24iLCJtMm1HZXQiLCJjb2xsZWN0aW9uIiwiY2FsbEJhY2siLCIkcG9zdCIsImdvdERhdGEiLCJnZXRNMk0iLCJiaW5kIiwibGlua1VubGlua2VkIiwidmFsdWVzIiwic3VtIiwiY2hhbmdlZCIsImluZGV4ZXMiLCJmaWx0ZXIiLCJCb29sZWFuIiwibWFwIiwicGFyc2VJbnQiLCJJTkRFWCIsImdldHRlciIsImlkcyIsIm90aGVySW5kZXgiLCJzcGxpdCIsImRlc2NyaWJlIiwiZmxhdHRlbiIsIm1vZGVsTmFtZSIsImtleXMiLCJmZXRjaCIsIm5vb3AiLCJtYWluUmVzb3VyY2UiLCJmaWVsZE5hbWUiLCJ0b09iamVjdCIsInJlc291cmNlTmFtZSIsImdvdFBlcm1pc3Npb25zIiwiUEVSTUlTU0lPTlMiLCJzZXRJbnRlcnZhbCIsIkxpc3RDYWNoZXIiLCJnb3RBbGwiLCJjb21wb3NpdGVBc2tlZCIsImNhcnRlc2lhblByb2R1Y3QxIiwieSIsImlzQXJyYXkiLCJyZXQiLCJhIiwiYiIsImNhcnRlc2lhblByb2R1Y3QiLCJhcnIiLCJleHBsb2RlRmlsdGVyIiwicHJvZHVjdCIsInIiLCJmaWx0ZXJTaW5nbGUiLCJ0ZXN0T25seSIsImtleSIsImRpZmZlcmVuY2UiLCJjbGVhbkNvbXBvc2l0ZXMiLCJmaWx0ZXJMZW4iLCJzaXplIiwibWFrZUZpbHRlciIsIml0ZW0iLCJnb3QiLCJ0aHMiLCJzaW5nbGUiLCJzb21lIiwiZiIsImV4cGxvZGVkIiwicGFydGlhbHMiLCJiYWQiLCJwbHVjayIsIml0ZW1zIiwiYWRkIiwiZmluZCIsImdldDAiLCJnZXQxIiwiY2FwaXRhbGl6ZSIsImRlbCIsImwiLCJjYWNoZWRQcm9wZXJ0eUJ5RXZlbnRzIiwicHJvdG8iLCJwcm9wZXJ0eU5hbWUiLCJzZXR0ZXIiLCJyZXN1bHQiLCJvcm0iLCJwcm9wZXJ0eURlZiIsInZhbHVlIiwiaXNGaW5pdGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsIlZhbGlkYXRpb25FcnJvciIsInJlc291cmNlIiwiX3Jlc291cmNlIiwiZm9ybUlkeCIsImZpZWxkcyIsImVycm9ycyIsInJlV2hlZWxPUk0iLCJsb2dpbkZ1bmMiLCIkb3JtIiwiYmFzZU9STSIsImFkZE1vZGVsSGFuZGxlciIsImFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzIiwibG9nb3V0IiwiYWRkSGFuZGxlciIsInN0ckhhbmRsZXIiLCJoYXNoIiwidG9TdHJpbmciLCJoYW5kbGUiLCJoYW5kbGVCeSIsImNhY2hlZEtleUlkeCIsInJlbmFtZUZ1bmN0aW9uIiwiZm4iLCJGdW5jdGlvbiIsImNhY2hlZCIsIndyYXBwZXIiLCJ4ZHIiLCJ1cmwiLCJmb3JtRW5jb2RlIiwiUHJvbWlzZSIsImFjY2VwdCIsInJlamVjdCIsInJlcSIsIlhNTEh0dHBSZXF1ZXN0Iiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInJlc3BvbnNlRGF0YSIsInJlc3BvbnNlVGV4dCIsInJlc3BvbnNlIiwic3RhdHVzIiwicmVxdWVzdCIsIlhEb21haW5SZXF1ZXN0Iiwib25sb2FkIiwic3RhdHVzVGV4dCIsIkVycm9yIiwib3BlbiIsIm9uZXJyb3IiLCJzZXRSZXF1ZXN0SGVhZGVyIiwiX190b2tlbl9fIiwiZW5jb2RlVVJJIiwiam9pbiIsInN0cmluZ2lmeSIsInMiLCJ0b1VwcGVyQ2FzZSIsInRvTG93ZXJDYXNlIiwic3RyIiwiY2hhckNvZGVBdCIsInVuaWZpZXIiLCJkb250VHJhbnNsYXRlRmlsdGVyIiwidmFscyIsImNvbnN0cnVjdG9yIiwiTnVtYmVyIiwiZXJyb3IiLCJzYW1lQXMiLCJwbHVyYWxpemUiLCJiZWZvcmVDYWxsIiwiYmVmb3JlIiwiZGVjb3JhdG9yIiwidGhlbiIsImNsZWFuU3RvcmFnZSIsImxvY2FsU3RvcmFnZSIsImNsZWFuRGVzY3JpcHRpb24iLCJzdGFydHNXaXRoIiwiY2hyIiwicGVybXV0YXRpb25zIiwid2FpdEZvciIsIndhaXRlciIsImJvb2wiLCJ0ek9mZnNldCIsIkRhdGUiLCJnZXRUaW1lem9uZU9mZnNldCIsInRyYW5zRmllbGRUeXBlIiwiZGF0ZSIsImRhdGV0aW1lIiwic3RyaW5nIiwidGV4dCIsImludGVnZXIiLCJmbG9hdCIsInBhcnNlRmxvYXQiLCJTVEFUVVNLRVkiLCJwcm9taXNlIiwieGhyIiwiZm9yY2UiLCJzdGF0dXNXYWl0aW5nIiwidXBkYXRlU3RhdHVzIiwibGFzdEJ1aWxkIiwibGFzdF9idWlsZCIsInVzZXJfaWQiLCJvbGRTdGF0dXMiLCJsb2dpbkluZm8iLCJsb2dpbiIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJvYmoiLCJyZWFsdGltZUVuZFBvaW50Iiwid3NDb25uZWN0aW9uIiwidXNlcmlkIiwib2siLCJjb25uZWN0Iiwib3B0aW9ucyIsImV4dE9STSIsIlBlcm1pc3Npb25UYWJsZSIsImtsYXNzIiwiU3RyaW5nIiwiY29ubmVjdGVkIiwid3MiLCJvbk1lc3NhZ2VKc29uIiwib25NZXNzYWdlVGV4dCIsIm1lc3NhZ2UiLCJzZW50RGF0YSIsIndhaXRpbmdDb25uZWN0aW9ucyIsImF1dGhfZ3JvdXAiLCJSRVZJRFgiLCJidWlsZGVySGFuZGxlcnMiLCJidWlsZGVySGFuZGxlclVzZWQiLCJwZXJzaXN0ZW50QXR0cmlidXRlcyIsIm1vZGVsQ2FjaGUiLCJmYWlsZWRNb2RlbHMiLCJsaW5rZXIiLCJ3aW5kb3ciLCJ2YWxpZGF0aW9uRXZlbnQiLCJjdXJyZW50Q29udGV4dCIsInNhdmluZ0Vycm9ySGFubGRlciIsImdldEluZGV4Iiwic2F2ZSIsImNiIiwibXlQZXJtcyIsImdyb3VwX2lkIiwicGVybWlzc2lvbkxpc3QiLCJwIiwicGVybXMiLCJhbGxQZXJtaXNzaW9ucyIsImluZGV4T2YiLCJtYWtlTW9kZWxDbGFzcyIsInJlYWRhYmxlIiwid3JpdGFibGUiLCJwcml2YXRlQXJncyIsIm1lcmdlIiwiZnVuY1N0cmluZyIsIktsYXNzIiwicmVmX3RyYW5zbGF0aW9ucyIsImludmVyc2VfcmVmZXJlbmNlcyIsInJlZmVyZW50cyIsImZpZWxkc09yZGVyIiwiZmllbGRPcmRlciIsInJlcHJlc2VudGF0aW9uIiwiZGVsZXRlIiwiX3Blcm1pc3Npb25zIiwiYWxsX3Blcm1zIiwib2JqZWN0X2lkIiwiZ3JvdXBlZCIsInVua25vd25fZ3JvdXBzIiwiZ3JvdXBCeSIsIm8iLCJhc1JhdyIsIklEIiwiYXJnIiwiY29udGV4dCIsImNvcHkiLCJhc3IiLCJjb25jYXQiLCJzYXZlTXVsdGkiLCJvYmplY3RzIiwic2NvcGUiLCJyYXciLCJkZWxldGFibGUiLCJtdWx0aXBsZSIsImVsZW1zIiwidGFiIiwib2JqcyIsInJlc3VsdHMiLCJleHRyYV92ZXJicyIsImZ1bmNOYW1lIiwiZGRhdGEiLCJzYXZlUEEiLCJUIiwib28iLCJQQSIsIkZzIiwiZmllbGRJZHgiLCJ0YXAiLCJpbmRleEJ5Iiwid2lkZ2V0IiwicmVmIiwiZXh0X3JlZiIsImxvY2FsX3JlZiIsIndhcm4iLCJUeXBlRXJyb3IiLCJyZXZJbmRleCIsImhhc093blByb3BlcnR5Iiwib3B0cyIsImZpcnN0Iiwib21vZGVsTmFtZSIsInZhbGlkYXRvcnMiLCJ1bmxpbmtSZWZlcmVuY2UiLCJpbnN0YW5jZSIsImluc3RhbmNlcyIsIm9tb2RlbCIsImxpbmtSZWZlcmVuY2UiLCJyZWZzIiwiSU5ERVhfTTJNIiwiVzJQX1BPU1QiLCJfZXh0cmEiLCJUT09ORSIsIlRPTUFOWSIsIk1BTllUT01BTlkiLCJtb2RlbENsYXNzIiwiemlwIiwiZGVsZXRlZCIsIk1QQSIsInJlY29yZCIsIml0YWIiLCJ0YWJsZSIsImlrIiwibm5ldyIsInVwZGF0ZWQiLCJuZXdPYmplY3RzIiwib2xkSXRlbSIsIm9sZENvcHkiLCJuZXdJdGVtIiwiTmFOIiwibm8iLCJ0b3RhbFJlc3VsdHMiLCJnb3RNMk0iLCJyb3ciLCJtIiwidmVyYiIsInRvZ2V0aGVyIiwic2VuZERhdGEiLCJHT1RfQUxMIiwiZ290TW9kZWwiLCJjYWNoZUtleSIsIm1vZGVsTm90Rm91bmQiLCJhdHRyaWJ1dGVzIiwiYWRkUHJvcGVydHkiLCJ2YWwiLCJrYXR0ciIsInNldCIsImF0dHJzIiwibmV3QXR0cnMiLCJxdWVyeSIsImZpbHRlckZ1bmN0aW9uIiwiZ2V0TW9kZWwiLCJnZXRMb2dnZWRVc2VyIiwidXNlciIsIiRzZW5kVG9FbmRwb2ludCJdLCJtYXBwaW5ncyI6IjZCQUVBLFNBQUFBLEtBQ0FDLEtBQUFDLFlBQ0FELEtBQUFFLGVBeUJBLFFBQUFDLEtBQ0EsR0FBQUMsTUFDQUMsS0FDQUMsRUFBQSxDQUNBTixNQUFBTyxHQUFBLFNBQUFDLEVBQUFDLEdBQ0FELElBQUFKLEtBQ0FBLEVBQUFJLEdBQUEsR0FBQUUsT0FFQSxJQUFBQyxHQUFBTCxHQUdBLE9BRkFGLEdBQUFJLEdBQUFJLEtBQUFILEdBQ0FKLEVBQUFNLEdBQUFGLEVBQ0FFLEdBRUFYLEtBQUFhLEtBQUEsU0FBQUwsR0FDQSxHQUFBQSxJQUFBSixHQUFBLENBQ0EsR0FBQVUsR0FBQUosTUFBQUssVUFBQUMsTUFBQUMsS0FBQUMsVUFBQSxFQUNBZCxHQUFBSSxHQUFBVyxRQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLE1BQUEsS0FBQVAsT0FJQWQsS0FBQXNCLE9BQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBLENBQ0EsSUFBQUQsSUFBQWxCLEdBQUEsQ0FDQSxHQUFBSSxHQUFB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bU8sU0FBQSxTQUFBQyxFQUFBQyxHQUNBLElBQ0FoTSxFQUFBMEssS0FBQW1HLFFBQUEsV0FDQTdRLEVBQUEwSyxLQUFBbUosT0FBQXpOLEVBQUFMLEVBQUFnRyxLQUVBLE1BQUF6SyxHQUNBMEssRUFBQTFLLE9BS0FrSixFQUFBOUwsVUFBQW9iLGNBQUEsV0FDQSxHQUFBOVosR0FBQXJDLElBQ0EsT0FBQUEsTUFBQStNLEtBQUEvSixXQUFBZ0IsYUFBQXVPLFFBQ0F2UyxLQUFBd0MsSUFBQSxZQUFBeEMsS0FBQStNLEtBQUEvSixXQUFBZ0IsYUFBQXVPLFNBRUEsR0FBQXBFLFNBQUEsU0FBQUMsRUFBQUMsR0FDQWhNLEVBQUFILEtBQUEsWUFBQSxTQUFBa2EsR0FDQS9aLEVBQUFHLElBQUEsWUFBQTRaLEdBQUExTCxLQUFBdEMsUUFNQXZCLEVBQUE5TCxVQUFBc2IsZ0JBQUEsU0FBQXBPLEVBQUF2SyxHQUNBLE1BQUExRCxNQUFBK00sS0FBQTFGLE1BQUE0RyxFQUFBdkssSUFHQW1KLEVBQUE5TCxVQUFBMlIsTUFBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUE1UyxNQUFBK00sS0FBQS9KLFdBQUEwUCxNQUFBQyxFQUFBQyIsImZpbGUiOiJyd3QubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBIYW5kbGVyKCl7XG4gICAgdGhpcy5oYW5kbGVycyA9IFtdO1xuICAgIHRoaXMuc3RySGFuZGxlcnMgPSB7fTtcbn07XG5cbkhhbmRsZXIucHJvdG90eXBlLmFkZEhhbmRsZXIgPSBmdW5jdGlvbiAoaGFuZGxlcil7XG4gICAgdmFyIHN0ckhhbmRsZXIgPSB1dGlscy5oYXNoKGhhbmRsZXIudG9TdHJpbmcoKSk7XG4gICAgaWYgKCEoc3RySGFuZGxlciBpbiB0aGlzLnN0ckhhbmRsZXJzKSl7XG4gICAgICAgIHRoaXMuc3RySGFuZGxlcnNbc3RySGFuZGxlcl0gPSBoYW5kbGVyO1xuICAgICAgICB0aGlzLmhhbmRsZXJzLnB1c2goaGFuZGxlcik7XG4gICAgfVxufTtcbkhhbmRsZXIucHJvdG90eXBlLmhhbmRsZSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCk7XG4gICAgdGhpcy5oYW5kbGVycy5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmMpe1xuICAgICAgICBmdW5jLmFwcGx5KG51bGwsYXJncyk7XG4gICAgfSlcbn07XG5IYW5kbGVyLnByb3RvdHlwZS5oYW5kbGVCeSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7XG4gICAgdmFyIHRocyA9IGFyZ3VtZW50c1swXTtcbiAgICB0aGlzLmhhbmRsZXJzLmZvckVhY2goZnVuY3Rpb24oZnVuYyl7XG4gICAgICAgIGZ1bmMuYXBwbHkodGhzLGFyZ3MpO1xuICAgIH0pXG59O1xuXG5cbmZ1bmN0aW9uIE5hbWVkRXZlbnRNYW5hZ2VyICgpe1xuICAgIHZhciBldmVudHMgPSB7fTtcbiAgICB2YXIgaGFuZGxlcklkID0ge307XG4gICAgdmFyIGlkeElkID0gMDtcbiAgICB0aGlzLm9uID0gZnVuY3Rpb24obmFtZSwgZnVuYyl7XG4gICAgICAgIGlmICghKG5hbWUgaW4gZXZlbnRzKSl7XG4gICAgICAgICAgICBldmVudHNbbmFtZV0gPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaWQgPSBpZHhJZCArKztcbiAgICAgICAgZXZlbnRzW25hbWVdLnB1c2goZnVuYyk7XG4gICAgICAgIGhhbmRsZXJJZFtpZF0gPSBmdW5jO1xuICAgICAgICByZXR1cm4gaWQ7XG4gICAgfTtcbiAgICB0aGlzLmVtaXQgPSBmdW5jdGlvbihuYW1lKXtcbiAgICAgICAgaWYgKG5hbWUgaW4gZXZlbnRzKXtcbiAgICAgICAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO1xuICAgICAgICAgICAgZXZlbnRzW25hbWVdLmZvckVhY2goZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgICAgICAgICAgIGV2ZW50LmFwcGx5KG51bGwsYXJncyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy51bmJpbmQgPSBmdW5jdGlvbihoYW5kbGVyKXtcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgaWYgKGhhbmRsZXIgaW4gaGFuZGxlcklkKXtcbiAgICAgICAgICAgIHZhciBmdW5jID0gaGFuZGxlcklkW2hhbmRsZXIgKyAnJ107XG4gICAgICAgICAgICBMYXp5KGV2ZW50cykuZWFjaChmdW5jdGlvbih2LGspe1xuICAgICAgICAgICAgICAgIHZhciBpZHggPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBuIGluIHYpe1xuICAgICAgICAgICAgICAgICAgICBpZiAodltuXSA9PT0gZnVuYyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZHgucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWR4LnJldmVyc2UoKS5mb3JFYWNoKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICB2LnNwbGljZSh4LDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlIGhhbmRsZXJJZFtoYW5kbGVyXTtcbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2FsbCBldmVudCBvbmNlXG4gICAgICovXG4gICAgdGhpcy5vbmNlID0gZnVuY3Rpb24oZXZlbnROYW1lLCBoYW5kbGVyRnVuY3Rpb24pIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMub24oZXZlbnROYW1lLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgaGFuZGxlckZ1bmN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICBzZWxmLnVuYmluZChoYW5kbGVyKTtcbiAgICAgICAgfSlcbiAgICB9XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBjYWNoZWRLZXlJZHggPSAwO1xuXG52YXIgbnVsbFN0cmluZyA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gJyd9O1xuXG5mdW5jdGlvbiBtb2NrT2JqZWN0KCl7XG4gICAgcmV0dXJuIG5ldyBQcm94eSh7fSwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKHRhcmdldCwgbmFtZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBuYW1lICA9PT0gJ3N0cmluZycpe1xuICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAndG9TdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsU3RyaW5nO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1dGlscy5tb2NrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFtuYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59XG5cbi8qXG52YXIgJFBPU1QgPSBmdW5jdGlvbih1cmwsIGRhdGEsIGNhbGxCYWNrLCBlcnJvckJhY2ssaGVhZGVycyl7XG4gICAgdmFyIG9wdHMgPSB7XG4gICAgICAgIGFjY2VwdHMgOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIHVybCA6IHVybCxcbiAgICAgICAgZGF0YSA6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgICAgICBkYXRhVHlwZSA6ICdqc29uJyxcbiAgICAgICAgc3VjY2VzcyA6IGNhbGxCYWNrLFxuICAgICAgICBlcnJvciA6IGVycm9yQmFjayxcbiAgICAgICAgbWV0aG9kIDogJ1BPU1QnLFxuICAgICAgICBjb250ZW50VHlwZSA6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgIH07XG4gICAgaWYgKGhlYWRlcnMpe1xuICAgICAgICBvcHRzLmhlYWRlcnMgPSBoZWFkZXJzO1xuICAgICAgICBvcHRzLmNyb3NzRG9tYWluID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuICQuYWpheChvcHRzKTtcbn1cblxuXG5mdW5jdGlvbiByZVdoZWVsQ29ubmVjdGlvbihlbmRQb2ludCwgZ2V0TG9naW4pe1xuICAgIC8vIG1haW4gXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuZ2V0TG9naW4gPSBnZXRMb2dpbjtcbiAgICB0aGlzLmV2ZW50cyA9IG5ldyBOYW1lZEV2ZW50TWFuYWdlcigpXG4gICAgdGhpcy4kUE9TVCA9ICRQT1NULmJpbmQodGhpcyk7XG4gICAgdGhpcy5vcHRpb25zID0ge2VuZFBvaW50IDogZW5kUG9pbnR9O1xuICAgIHRoaXMub24gPSB0aGlzLmV2ZW50cy5vbi5iaW5kKHRoaXMpO1xufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLnVwZGF0ZVN0YXR1cyA9IGZ1bmN0aW9uKHN0YXR1cywgY2FsbEJhY2ssIGVycm9yKSB7XG4gICAgaWYgKHN0YXR1cykge1xuICAgICAgICB2YXIgaXNMb2dnZWQgPSAoc3RhdHVzLnVzZXJfaWQgJiYgIXRoaXMub3B0aW9ucy51c2VyX2lkICk7XG4gICAgICAgIGZvciAodmFyIHggaW4gc3RhdHVzKXsgdGhpcy5vcHRpb25zW3hdID0gc3RhdHVzW3hdOyB9XG4gICAgICAgIGxvY2FsU3RvcmFnZS5sYXN0UldUU3RhdHVzID0gSlNPTi5zdHJpbmdpZnkoc3RhdHVzKTtcbiAgICAgICAgaWYgKGlzTG9nZ2VkKSB7XG4gICAgICAgICAgICB0aGlzLmV2ZW50cy5lbWl0KCdsb2dpbicsIHRoaXMub3B0aW9ucy51c2VyX2lkKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXRoaXMub3B0aW9ucy51c2VyX2lkICYmIHRoaXMuZ2V0TG9naW4pe1xuICAgICAgICB2YXIgbG9nSW5mbyA9IHRoaXMuZ2V0TG9naW4oZXJyb3IpO1xuICAgICAgICBpZiAobG9nSW5mby5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KXtcbiAgICAgICAgICAgIHRoaXMubG9naW4obG9nSW5mby51c2VybmFtZSwgbG9nSW5mby5wYXNzd29yZClcbiAgICAgICAgICAgIC50aGVuKChmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzKHN0YXR1cywgY2FsbEJhY2spO1xuICAgICAgICAgICAgfSkuYmluZCh0aGlzKSk7XG4gICAgICAgIH0gZWxzZSBpZiAobG9nSW5mby5jb25zdHJ1Y3RvciA9PT0gUHJvbWlzZSkge1xuICAgICAgICAgICAgbG9nSW5mby50aGVuKChmdW5jdGlvbihvYmope1xuICAgICAgICAgICAgICAgIHZhciB4ID0gdGhpcy5sb2dpbihvYmoudXNlcm5hbWUsb2JqLnBhc3N3b3JkKTtcbiAgICAgICAgICAgICAgICB2YXIgbWFuYWdlRXJyb3IgPSAoZnVuY3Rpb24oYmFkKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0dXMobnVsbCxjYWxsQmFjayxiYWQuZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxCYWNrKXtcbiAgICAgICAgICAgICAgICAgICAgeC50aGVuKGNhbGxCYWNrLG1hbmFnZUVycm9yKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB4LnRoZW4obnVsbCwgbWFuYWdlRXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2sodGhpcy5vcHRpb25zKTtcbiAgICB9ICAgIFxufVxuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuc3RhdHVzID0gZnVuY3Rpb24oY2FsbEJhY2ssIGZvcmNlKXtcbiAgICBpZiAoKCdsYXN0UldUU3RhdHVzJyBpbiBsb2NhbFN0b3JhZ2UpICYmICFmb3JjZSkge1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICB2YXIgc3RhdHVzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UubGFzdFJXVFN0YXR1cyk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1cyhzdGF0dXMsY2FsbEJhY2spO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXR1cyhjYWxsQmFjaywgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhbGxCYWNrICYmIGNhbGxCYWNrKHN0YXR1cyk7XG4gICAgfVxuICAgIGlmICh0aGlzLl9zdGF0dXNfY2FsbGluZyl7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNlbGYuc3RhdHVzKGNhbGxCYWNrKTtcbiAgICAgICAgfSw1MCk7XG4gICAgfVxuICAgIGlmICh0aGlzLm9wdGlvbnMgJiYgdGhpcy5vcHRpb25zLnRpbWVzdGFtcCl7XG4gICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHRoaXMub3B0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fc3RhdHVzX2NhbGxpbmcgPSB0cnVlO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLiRwb3N0KCdhcGkvc3RhdHVzJyxudWxsLGZ1bmN0aW9uKHN0YXR1cyl7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UubGFzdFJXVFN0YXR1cyA9IEpTT04uc3RyaW5naWZ5KHN0YXR1cyk7XG4gICAgICAgICAgICBzZWxmLl9zdGF0dXNfY2FsbGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVTdGF0dXMoc3RhdHVzLGNhbGxCYWNrKTtcbiAgICAgICAgfSk7ICAgICAgICBcbiAgICB9XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuJHBvc3QgPSBmdW5jdGlvbih1cmwsIGRhdGEsY2FsbEJhY2spe1xuICAgIHZhciB0aHMgPSB0aGlzO1xuICAgIGlmICh0aGlzLm9wdGlvbnMgJiYgdGhpcy5vcHRpb25zLnRva2VuKXtcbiAgICAgICAgaWYgKCFkYXRhKXtcbiAgICAgICAgICAgIGRhdGEgPSB7fTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAodGhpcy5vcHRpb25zLnRva2VuKXtcbiAgICAgICAgdmFyIGhlYWRlcnMgPSB7IFxuICAgICAgICAgICAgdG9rZW4gOiB0aGlzLm9wdGlvbnMudG9rZW4sXG4gICAgICAgICAgICBhcHBsaWNhdGlvbiA6IHRoaXMub3B0aW9ucy5hcHBsaWNhdGlvblxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBoZWFkZXJzID0gbnVsbDtcbiAgICB9XG5cbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCxyZWplY3Qpe1xuICAgICAgICB1dGlscy54ZHIodGhzLm9wdGlvbnMuZW5kUG9pbnQgKyB1cmwsIGRhdGEsIHRocy5vcHRpb25zLmFwcGxpY2F0aW9uLCB0aHMub3B0aW9ucy50b2tlbilcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdodHRwLXJlc3BvbnNlJywgeGhyLnJlc3BvbnNlVGV4dCwgeGhyLnN0YXR1cywgdXJsLCBkYXRhKTtcbiAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2h0dHAtcmVzcG9uc2UtJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZVRleHQsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZURhdGEpe1xuICAgICAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2h0dHAtcmVzcG9uc2UtJyArIHhoci5zdGF0dXMgKyAnLWpzb24nLCB4aHIucmVzcG9uc2VEYXRhLCB1cmwsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY2FsbEJhY2spIHsgY2FsbEJhY2soIHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCApfTtcbiAgICAgICAgICAgICAgICBhY2NlcHQoeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHhocikge1xuICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VEYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1qc29uJywgeGhyLnJlc3BvbnNlRGF0YSwgeGhyLnN0YXR1cywgdXJsLCBkYXRhLCB4aHIpO1xuICAgICAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2Vycm9yLWpzb24tJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZURhdGEsdXJsLCBkYXRhLCB4aHIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2Vycm9yLWh0dHAnLHhoci5yZXNwb25zZVRleHQsIHhoci5zdGF0dXMsdXJsLGRhdGEseGhyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1odHRwLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VUZXh0LHVybCxkYXRhLHhocik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlamVjdCh4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIHJldHVybiBwcm9taXNlO1xufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcbiAgICB2YXIgdXJsID0gdGhpcy5vcHRpb25zLmVuZFBvaW50ICsgJ2FwaS9sb2dpbic7XG4gICAgdmFyIGNvbm5lY3Rpb24gPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQscmVqZWN0KXtcbiAgICAgICAgdXRpbHMueGRyKHVybCx7IHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQgOiBwYXNzd29yZH0sIG51bGwsY29ubmVjdGlvbi5vcHRpb25zLnRva2VuLCB0cnVlKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oeGhyKXtcbiAgICAgICAgICAgICAgICBjb25uZWN0aW9uLnVwZGF0ZVN0YXR1cyh4aHIucmVzcG9uc2VEYXRhKTtcbiAgICAgICAgICAgICAgICBhY2NlcHQoc3RhdHVzKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgcmVqZWN0KHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24oY2FsbEJhY2spe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgd3Njb25uZWN0ID0gZnVuY3Rpb24oc2VsZil7XG4gICAgICAgIHNlbGYud3NDb25uZWN0aW9uID0gbmV3IHV0aWxzLndzQ29ubmVjdChzZWxmLm9wdGlvbnMpO1xuICAgICAgICBzZWxmLndzQ29ubmVjdGlvbi5vbkNvbm5lY3QoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNlbGYuZXZlbnRzLmVtaXQoJ3dzLWNvbm5lY3RlZCcsIHNlbGYud3NDb25uZWN0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYud3NDb25uZWN0aW9uLm9uRGlzY29ubmVjdChmdW5jdGlvbigpeyBcbiAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMgJiYgc2VsZi5vcHRpb25zLnJlYWx0aW1lRW5kUG9pbnQpe1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgd3Njb25uZWN0KHNlbGYpOyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9LDEwMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzKChmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICBpZiAoJ3Rva2VuJyBpbiBzZWxmLm9wdGlvbnMpe1xuICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2soc3RhdHVzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb25uZWN0aW5nIHRvICcgKyBzZWxmLm9wdGlvbnMuZW5kUG9pbnQpO1xuICAgICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy51c2VybmFtZSAmJiBzZWxmLm9wdGlvbnMucGFzc3dvcmQpe1xuICAgICAgICAgICAgICAgIHNlbGYubG9naW4oXG4gICAgICAgICAgICAgICAgICAgIHNlbGYub3B0aW9ucy51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5vcHRpb25zLnBhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlbmV3aW5nIGNvbm5lY3Rpb24nKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLm9wdGlvbnMudG9rZW4gJiYgc2VsZi5vcHRpb25zLnJlYWx0aW1lRW5kUG9pbnQgJiYgKCFzZWxmLndzQ29ubmVjdGlvbikpe1xuICAgICAgICAgICAgd3Njb25uZWN0KHNlbGYpO1xuICAgICAgICB9XG4gICAgfSkuYmluZCh0aGlzKSk7XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUubG9nT3V0ID0gZnVuY3Rpb24odXJsLCBjYWxsQmFjayl7XG4gICAgcmV0dXJuIHRoaXMuJHBvc3QoJ2FwaS9sb2dvdXQnLHt9LChmdW5jdGlvbihzdGF0dXMpIHtcbiAgICAgICAgaWYgKCdsYXN0UldUU3RhdHVzJyBpbiBsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2UubGFzdFJXVFN0YXR1cztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9wdGlvbnMgPSB7ZW5kUG9pbnQ6IHRoaXMub3B0aW9ucy5lbmRQb2ludH07XG4gICAgICAgIGlmICh0aGlzLndzQ29ubmVjdGlvbikgeyBcbiAgICAgICAgICAgIHRoaXMud3NDb25uZWN0aW9uLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLndzQ29ubmVjdGlvbiA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybCkgeyBsb2NhdGlvbiA9IHVybDsgfVxuICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjaygpO1xuICAgIH0pLmJpbmQodGhpcykpO1xufVxuKi9cbnZhciB1dGlscyA9IHtcbiAgICByZW5hbWVGdW5jdGlvbiA6IGZ1bmN0aW9uIChuYW1lLCBmbikge1xuICAgICAgICByZXR1cm4gKG5ldyBGdW5jdGlvbihcInJldHVybiBmdW5jdGlvbiAoY2FsbCkgeyByZXR1cm4gZnVuY3Rpb24gXCIgKyBuYW1lICtcbiAgICAgICAgICAgIFwiICgpIHsgcmV0dXJuIGNhbGwodGhpcywgYXJndW1lbnRzKSB9OyB9O1wiKSgpKShGdW5jdGlvbi5hcHBseS5iaW5kKGZuKSk7XG4gICAgfSxcbiAgICBjYWNoZWQgOiBmdW5jdGlvbihmdW5jLCBrZXkpe1xuICAgICAgICBpZiAoIWtleSl7ICAgIFxuICAgICAgICAgICAga2V5ID0gJ18nICsgY2FjaGVkS2V5SWR4Kys7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gd3JhcHBlcigpe1xuICAgICAgICAgICAgaWYgKCF0aGlzW2tleV0pe1xuICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IGZ1bmMuY2FsbCh0aGlzLFthcmd1bWVudHNdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzW2tleV07XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB3cmFwcGVyO1xuICAgIH0sXG4vLyAgICAkUE9TVCA6ICRQT1NULFxuLy8gICAgcmVXaGVlbENvbm5lY3Rpb246IHJlV2hlZWxDb25uZWN0aW9uLFxuICAgIGxvZzogZnVuY3Rpb24oKXsgXG4gICAgICAgIGNvbnNvbGUubG9nKGFyZ3VtZW50cyk7XG4gICAgfSxcblxuICAgIHhkcjogZnVuY3Rpb24gKHVybCwgZGF0YSwgYXBwbGljYXRpb24sdG9rZW4sIGZvcm1FbmNvZGUpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2UgYW4gSFRUUCBSZXF1ZXN0IGFuZCByZXR1cm4gaXRzIHByb21pc2UuXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciByZXE7XG4gICAgICAgICAgICBpZiAoIWRhdGEpIHsgZGF0YSA9IHt9O31cblxuICAgICAgICAgICAgaWYoWE1MSHR0cFJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICByZXEgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICByZXEub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXEucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBKU09OLnBhcnNlKHJlcS5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoYSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlRGF0YSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSB7cmVzcG9uc2VEYXRhOiByZXNwb25zZURhdGEsIHJlc3BvbnNlVGV4dDogcmVxLnJlc3BvbnNlVGV4dCxzdGF0dXM6IHJlcS5zdGF0dXMsIHJlcXVlc3Q6IHJlcX07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVxLnN0YXR1cyA+PSAyMDAgJiYgcmVxLnN0YXR1cyA8IDQwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VwdChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmKFhEb21haW5SZXF1ZXN0KXtcbiAgICAgICAgICAgICAgICByZXEgPSBuZXcgWERvbWFpblJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICByZXEub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjY2VwdChyZXEucmVzcG9uc2VUZXh0LHJlcS5zdGF0dXNUZXh0LCByZXEpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ0NPUlMgbm90IHN1cHBvcnRlZCcpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVxLm9wZW4oJ1BPU1QnLCB1cmwsIHRydWUpO1xuICAgICAgICAgICAgcmVxLm9uZXJyb3IgPSByZWplY3Q7XG4gICAgICAgICAgICByZXEuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgICAgICAgaWYgKHRva2VuKSB7IGRhdGEuX190b2tlbl9fID0gdG9rZW4gfVxuICAgICAgICAgICAgaWYgKCFmb3JtRW5jb2RlKXtcbiAgICAgICAgICAgICAgICByZXEuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywndGV4dC9wbGFpbicpO1xuICAgICAgICAgICAgICAgIGRhdGEgPSBMYXp5KGRhdGEpLnNpemUoKT9KU09OLnN0cmluZ2lmeShkYXRhKTonJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpO1xuICAgICAgICAgICAgICAgIGRhdGEgPSBMYXp5KGRhdGEpLm1hcChmdW5jdGlvbih2LGspe1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGsgKyAnPScgKyBlbmNvZGVVUkkodi50b1N0cmluZygpKTsgIFxuICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKS5qb2luKCcmJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXEuc2VuZChkYXRhKTtcbiAgICAvLyAgICAgICAgcmVxLnNlbmQobnVsbCk7XG4gICAgICAgIH0pXG4gICAgfSxcbiAgICBcbiAgICBjYXBpdGFsaXplIDogZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgcmV0dXJuIHNbMF0udG9VcHBlckNhc2UoKSArIHMuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcbiAgICB9LFxuXG4gICAgaGFzaCA6IGZ1bmN0aW9uKHN0cil7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIYXNoZWQgZnVuY3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIHN0ciA9IHN0ci50b1N0cmluZygpO1xuICAgICAgICB2YXIgcmV0ID0gMTtcbiAgICAgICAgZm9yICh2YXIgeCA9IDA7eDxzdHIubGVuZ3RoO3grKyl7XG4gICAgICAgICAgICByZXQgKj0gKDEgKyBzdHIuY2hhckNvZGVBdCh4KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChyZXQgJSAzNDk1ODM3NDk1NykudG9TdHJpbmcoKTtcbiAgICB9LFxuXG4gICAgbWFrZUZpbHRlciA6IGZ1bmN0aW9uIChtb2RlbCwgZmlsdGVyLCB1bmlmaWVyLCBkb250VHJhbnNsYXRlRmlsdGVyKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlIGZpbHRlciBmb3IgQXJyYXkuZmlsdGVyIGZ1bmN0aW9uIGFzIGFuIGFuZCBvZiBvclxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCF1bmlmaWVyKSB7IHVuaWZpZXIgPSAnICYmICc7fVxuICAgICAgICBpZiAoTGF6eShmaWx0ZXIpLnNpemUoKSA9PT0gMCl7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oeCl7IHJldHVybiB0cnVlIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNvdXJjZSA9IExhenkoZmlsdGVyKS5tYXAoZnVuY3Rpb24odmFscywgZmllbGQpe1xuICAgICAgICAgICAgaWYgKCF2YWxzKSB7IHZhbHMgPSBbbnVsbF19XG4gICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFscykpe1xuICAgICAgICAgICAgICAgIHZhbHMgPSBbdmFsc107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWRvbnRUcmFuc2xhdGVGaWx0ZXIgJiYgKG1vZGVsLmZpZWxkc1tmaWVsZF0udHlwZSA9PT0gJ3JlZmVyZW5jZScpKSB7XG4gICAgICAgICAgICAgICAgZmllbGQgPSAnXycgKyBmaWVsZDtcbiAgICAgICAgICAgICAgICB2YWxzID0gTGF6eSh2YWxzKS5tYXAoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4ICYmICh4LmNvbnN0cnVjdG9yICE9PSBOdW1iZXIpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4LmlkO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geDtcbiAgICAgICAgICAgICAgICB9KS50b0FycmF5KCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1vZGVsLmZpZWxkc1tmaWVsZF0udHlwZSA9PT0gJ3N0cmluZycpe1xuICAgICAgICAgICAgICAgIHZhbHMgPSB2YWxzLm1hcChKU09OLnN0cmluZ2lmeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJygnICsgIExhenkodmFscykubWFwKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgIGlmICgheCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdtYWtlRmlsdGVyIHggaXMgbnVsbCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZih4ID09PSBvcm0udXRpbHMubW9jaykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdtYWtlRmlsdGVyIHdpdGggTW9jayBPYmplY3QnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICcoeC4nICsgZmllbGQgKyAnID09PSAnICsgeCArICcpJztcbiAgICAgICAgICAgIH0pLmpvaW4oJyB8fCAnKSAgKycpJztcbiAgICAgICAgfSkudG9BcnJheSgpLmpvaW4odW5pZmllcik7XG4gICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oXCJ4XCIsIFwicmV0dXJuIFwiICsgc291cmNlKTtcbiAgICB9LFxuXG4gICAgc2FtZUFzIDogZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlZXAgZXF1YWxcbiAgICAgICAgICovXG4gICAgICAgIGZvciAodmFyIGsgaW4geCkge1xuICAgICAgICAgICAgaWYgKHlba10gIT0geFtrXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIFxuICAgIHBsdXJhbGl6ZSA6IGZ1bmN0aW9uKHN0ciwgbW9kZWwpe1xuICAgICAgICAvKipcbiAgICAgICAgICogTGV4aWNhbGx5IHJldHVybnMgZW5nbGlzaCBwbHVyYWwgZm9ybVxuICAgICAgICAgKi9cbiAgICAgICAgcmV0dXJuIHN0ciArICdzJztcbiAgICB9LFxuXG4gICAgYmVmb3JlQ2FsbCA6IGZ1bmN0aW9uKGZ1bmMsIGJlZm9yZSl7XG4gICAgICAgIHZhciBkZWNvcmF0b3IgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgYmVmb3JlKCkudGhlbihmdW5jKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZGVjb3JhdG9yO1xuICAgIH0sXG5cbiAgICBjbGVhblN0b3JhZ2UgOiBmdW5jdGlvbigpe1xuICAgICAgICAvKipcbiAgICAgICAgICogQ2xlYW4gbG9jYWxTdG9yYWdlIG9iamVjdFxuICAgICAgICAgKi9cbiAgICAgICAgTGF6eShsb2NhbFN0b3JhZ2UpLmtleXMoKS5lYWNoKGZ1bmN0aW9uKGspe1xuICAgICAgICAgICAgZGVsZXRlIGxvY2FsU3RvcmFnZVtrXTtcbiAgICAgICAgfSlcbiAgICB9LFxuXG4gICAgY2xlYW5EZXNjcmlwdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIExhenkobG9jYWxTdG9yYWdlKVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbih2LCBuKSB7IHJldHVybiBMYXp5KG4pLnN0YXJ0c1dpdGgoJ2Rlc2NyaXB0aW9uOicpfSlcbiAgICAgICAgICAgIC5rZXlzKClcbiAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uKG4pIHsgZGVsZXRlIGxvY2FsU3RvcmFnZVtuXSB9KTtcbiAgICB9LFxuICAgIFxuICAgIHJldmVyc2UgOiBmdW5jdGlvbiAoY2hyLCBzdHIpIHtcbiAgICAgICAgcmV0dXJuIHN0ci5zcGxpdChjaHIpLnJldmVyc2UoKS5qb2luKGNocik7XG4gICAgfSxcbiAgICBwZXJtdXRhdGlvbnM6IGZ1bmN0aW9uKGFycil7XG4gICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgeCA9IGFyci5sZW5ndGgtMTsgeCA+PSAwO3gtLSl7XG4gICAgICAgICAgICBmb3IgKHZhciB5ID0gYXJyLmxlbmd0aC0xOyB5ID49IDA7IHktLSl7XG4gICAgICAgICAgICAgICAgaWYgKHggIT09IHkpXG4gICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKFthcnJbeF0sIGFyclt5XV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfSxcblxuICAgIHdhaXRGb3I6IGZ1bmN0aW9uKGZ1bmMsIGNhbGxCYWNrKSB7XG4gICAgICAgIHZhciB3YWl0ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChmdW5jKCkpIHtcbiAgICAgICAgICAgICAgICBjYWxsQmFjaygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHdhaXRlciw1MDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNldFRpbWVvdXQod2FpdGVyLCA1MDApO1xuICAgIH0sXG5cbiAgICBib29sOiBCb29sZWFuLFxuXG4gICAgbm9vcCA6IGZ1bmN0aW9uKCl7fSxcblxuICAgIHR6T2Zmc2V0OiBuZXcgRGF0ZSgpLmdldFRpbWV6b25lT2Zmc2V0KCkgKiA2MDAwMCxcblxuICAgIHRyYW5zRmllbGRUeXBlOiB7XG4gICAgICAgIGRhdGU6IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIG5ldyBEYXRlKHggKiAxMDAwICsgdXRpbHMudHpPZmZzZXQgKSB9LFxuICAgICAgICBkYXRldGltZTogZnVuY3Rpb24oeCkgeyByZXR1cm4gbmV3IERhdGUoeCAqIDEwMDAgKyB1dGlscy50ek9mZnNldCApIH0sXG4gICAgICAgIHN0cmluZzogZnVuY3Rpb24oeCkgeyByZXR1cm4geC50b1N0cmluZygpOyB9LFxuICAgICAgICB0ZXh0OiBmdW5jdGlvbih4KSB7IHJldHVybiB4LnRvU3RyaW5nKCk7IH0sXG4gICAgICAgIGludGVnZXI6IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHBhcnNlSW50KHgpOyB9LFxuICAgICAgICBmbG9hdDogZnVuY3Rpb24oeCkgeyByZXR1cm4gcGFyc2VGbG9hdCh4KTsgfVxuICAgIH0sIFxuICAgIG1vY2sgOiBtb2NrT2JqZWN0KClcbn07XG5cblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgU1RBVFVTS0VZID0gJ2xhc3RSV1RDb25uZWN0aW9uU3RhdHVzJztcblxuZnVuY3Rpb24gUmVhbHRpbWVDb25uZWN0aW9uKGVuZFBvaW50LCByd3RDb25uZWN0aW9uKXtcbiAgICAvKipcbiAgICAgKiBDb25uZWN0cyBhIHdlYnNvY2tldCB3aXRoIHJlV2hlZWwgY29ubmVjdGlvblxuICAgICAqL1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHZhciBjb25uZWN0aW9uID0gbmV3IFNvY2tKUyhlbmRQb2ludCk7XG4gICAgY29ubmVjdGlvbi5vbm9wZW4gPSBmdW5jdGlvbiAoeCkge1xuICAgICAgICBjb25zb2xlLmxvZygnb3BlbiA6ICcgKyB4KTtcbiAgICAgICAgY29ubmVjdGlvbi50ZW5hbnQoKTtcbiAgICAgICAgcnd0Q29ubmVjdGlvbi5lbWl0KCdyZWFsdGltZS1jb25uZWN0aW9uLW9wZW4nLHgpO1xuICAgIH07XG4gICAgY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgICBpZiAoeC50eXBlID09ICdtZXNzYWdlJykge1xuICAgICAgICAgICAgLy8kLm5vdGlmeSh4LmRhdGEpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvL1RPRE8gc2V0IGZyb21SZWFsdGltZVxuICAgICAgICAgICAgICAgIHJ3dENvbm5lY3Rpb24uZW1pdCgncmVhbHRpbWUtbWVzc2FnZS1qc29uJywgSlNPTi5wYXJzZSh4LmRhdGEpKTtcbiAgICAgICAgICAgICAgICAvL1RPRE8gdW5zZXQgZnJvbVJlYWx0aW1lXG4gICAgICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgICAgICByd3RDb25uZWN0aW9uLmVtaXQoJ3JlYWx0aW1lLW1lc3NhZ2UtdGV4dCcsIEpTT04ucGFyc2UoeC5kYXRhKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZnJvbSByZWFsdGltZSAnLHgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25uZWN0aW9uLm9uY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNldFRpbWVvdXQodXRpbHMud3NDb25uZWN0LDEwMDApO1xuICAgICAgICByd3RDb25uZWN0aW9uLmVtaXQoJ3JlYWx0aW1lLWNvbm5lY3Rpb24tY2xvc2VkJyk7XG4gICAgfTtcbiAgICBjb25uZWN0aW9uLnRlbmFudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29ubmVjdGlvbi5zZW5kKCdURU5BTlQ6JyArIHJ3dENvbm5lY3Rpb24uY2FjaGVkU3RhdHVzLmFwcGxpY2F0aW9uICsgJzonICsgcnd0Q29ubmVjdGlvbi5jYWNoZWRTdGF0dXMudG9rZW4pO1xuICAgIH1cbiAgICB0aGlzLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbm5lY3Rpb24uY2xvc2UoKTtcbiAgICB9XG59ICAgIFxuXG5mdW5jdGlvbiByZVdoZWVsQ29ubmVjdGlvbihlbmRQb2ludCwgZ2V0TG9naW4pe1xuICAgIC8qKlxuICAgICAqIENvbm5lY3Rpb24gYmFzaWMgZm9yIHJlV2hlZWxcbiAgICAgKiBAcGFyYW0gZW5kUG9pbnQ6IHN0cmluZyBiYXNlIHVybCBmb3IgYWxsIGNvbXVuaWNhdGlvblxuICAgICAqIEBwYXJhbSBnZXRMb2dpbjogZnVuY3Rpb24gdG8gYmUgY2FsbGVkIGluIGNhc2Ugb2YgbWlzc2luZyBsb2dpbi5cbiAgICAgKiAgdGhpcyBmdW5jdGlvbiBjb3VsZCByZXR1cm4gOlxuICAgICAqICAtICAgYSB7IHVzZXJuYW1lIDogPHVzZXJuYW1lPiAsIHBhc3N3b3JkOiA8cGFzc3dvcmQ+fSBvclxuICAgICAqICAtICAgYiBQcm9taXNlIC0+IHsgdXNlcm5hbWUgOiA8dXNlcm5hbWU+ICwgcGFzc3dvcmQ6IDxwYXNzd29yZD59XG4gICAgICovXG4gICAgLy8gbWFpbiBpbml0aWFsaXphdGlvblxuICAgIHZhciBldmVudHMgPSBuZXcgTmFtZWRFdmVudE1hbmFnZXIoKTtcbiAgICB0aGlzLmdldExvZ2luID0gZ2V0TG9naW47XG4gICAgdGhpcy5lbmRQb2ludCA9IGVuZFBvaW50LmVuZHNXaXRoKCcvJyk/IGVuZFBvaW50OiAoZW5kUG9pbnQgKyAnLycpO1xuICAgIHRoaXMub24gPSBldmVudHMub247XG4gICAgdGhpcy51bmJpbmQgPSBldmVudHMudW5iaW5kO1xuICAgIHRoaXMuZW1pdCA9IGV2ZW50cy5lbWl0O1xuICAgIHRoaXMub25jZSA9IGV2ZW50cy5vbmNlO1xuICAgIHRoaXMuY2FjaGVkU3RhdHVzID0ge307XG4gICAgdGhpcy5pc0Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgIHRoaXMuaXNMb2dnZWRJbiA9IGZhbHNlO1xuICAgIC8vIHJlZ2lzdGVyaW5nIHVwZGF0ZSBzdGF0dXNcbiAgICB2YXIgdGhzID0gdGhpcztcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS4kcG9zdCA9IGZ1bmN0aW9uKHVybCwgZGF0YSxjYWxsQmFjayl7XG4gICAgLyoqXG4gICAgICogQUpBWCBjYWxsIGZvciBmZXRjaCBhbGwgZGF0YSBmcm9tIHNlcnZlclxuICAgICAqIEBwYXJhbSB1cmw6IGxhc3QgdXJsIHBhcnQgZm9yIGFqYXggY2FsbFxuICAgICAqIEBwYXJhbSBkYXRhOiBkYXRhIG9iamVjdCB0byBiZSBzZW50XG4gICAgICogQHBhcmFtIGNhbGxCYWNrOiBmdW5jdGlvbih4aHIpIHdpbGwgYmUgY2FsbGVkIHdoZW4gZGF0YSBhcnJpdmVzXG4gICAgICogQHJldHVybnMgUHJvbWlzZTx4aHI+IHNhbWUgb2YgY2FsbEJhY2tcbiAgICAgKi9cbiAgICAvLyBpbml0aWFsaXphdGlvblxuICAgIHZhciB0aHMgPSB0aGlzO1xuICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LHJlamVjdCl7XG4gICAgICAgIHV0aWxzLnhkcih0aHMuZW5kUG9pbnQgKyB1cmwsIGRhdGEsIHRocy5jYWNoZWRTdGF0dXMuYXBwbGljYXRpb24sIHRocy5jYWNoZWRTdGF0dXMudG9rZW4pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbih4aHIpe1xuICAgICAgICAgICAgICAgIHRocy5lbWl0KCdodHRwLXJlc3BvbnNlJywgeGhyLnJlc3BvbnNlVGV4dCwgeGhyLnN0YXR1cywgdXJsLCBkYXRhKTtcbiAgICAgICAgICAgICAgICB0aHMuZW1pdCgnaHR0cC1yZXNwb25zZS0nICsgeGhyLnN0YXR1cywgeGhyLnJlc3BvbnNlVGV4dCwgdXJsLCBkYXRhKTtcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlRGF0YSl7XG4gICAgICAgICAgICAgICAgICAgIHRocy5lbWl0KCdodHRwLXJlc3BvbnNlLScgKyB4aHIuc3RhdHVzICsgJy1qc29uJywgeGhyLnJlc3BvbnNlRGF0YSwgdXJsLCBkYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxCYWNrKSB7IGNhbGxCYWNrKCB4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQgKX07XG4gICAgICAgICAgICAgICAgYWNjZXB0KHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbih4aHIpIHtcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlRGF0YSl7XG4gICAgICAgICAgICAgICAgICAgIHRocy5lbWl0KCdlcnJvci1qc29uJywgeGhyLnJlc3BvbnNlRGF0YSwgeGhyLnN0YXR1cywgdXJsLCBkYXRhLCB4aHIpO1xuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnZXJyb3ItanNvbi0nICsgeGhyLnN0YXR1cywgeGhyLnJlc3BvbnNlRGF0YSx1cmwsIGRhdGEsIHhocik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHsgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHRocy5lbWl0KCdlcnJvci1odHRwJyx4aHIucmVzcG9uc2VUZXh0LCB4aHIuc3RhdHVzLHVybCxkYXRhLHhocik7XG4gICAgICAgICAgICAgICAgICAgIHRocy5lbWl0KCdlcnJvci1odHRwLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VUZXh0LHVybCxkYXRhLHhocik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlamVjdCh4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIHJldHVybiBwcm9taXNlO1xufTtcblxuLyoqXG4gKiBDaGVjayBjdXJyZW50IHN0YXR1cyBhbmQgY2FsbGJhY2sgZm9yIHJlc3VsdHMuXG4gKiBJdCBjYWNoZXMgcmVzdWx0cyBmb3IgZnVydGhlci5cbiAqIEBwYXJhbSBjYWxsYmFjazogKHN0YXR1cyBvYmplY3QpXG4gKiBAcGFyYW0gZm9yY2U6IGJvb2xlYW4gaWYgdHJ1ZSBlbXB0aWVzIGNhY2hlICBcbiAqIEByZXR1cm4gdm9pZFxuICovXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuc3RhdHVzID0gZnVuY3Rpb24oY2FsbEJhY2ssIGZvcmNlKSB7XG4gICAgLy8gaWYgZm9yY2UsIGNsZWFyIGFsbCBjYWNoZWQgdmFsdWVzXG4gICAgdmFyIGtleSA9ICd0b2tlbjonICsgdGhpcy5lbmRQb2ludDtcbiAgICB2YXIgdGhzID0gdGhpcztcbiAgICBpZiAoZm9yY2UpIHtcbiAgICAgICAgdGhpcy5jYWNoZWRTdGF0dXMgPSB7fTtcbiAgICAgICAgZGVsZXRlIGxvY2FsU3RvcmFnZVtrZXldO1xuICAgIH1cbiAgICBpZiAodGhpcy5zdGF0dXNXYWl0aW5nKSB7XG4gICAgICAgIC8vIHdhaXQgZm9yIHN0YXR1c1xuICAgICAgICB1dGlscy53YWl0Rm9yKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICF0aHMuc3RhdHVzV2FpdGluZztcbiAgICAgICAgfSwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHRocy5zdGF0dXMoY2FsbEJhY2ssZm9yY2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyB0cnkgZm9yIHZhbHVlIHJlc29sdXRpb25cbiAgICAvLyBmaXJzdCBvbiBtZW1vcnlcbiAgICBpZiAoTGF6eSh0aGlzLmNhY2hlZFN0YXR1cykuc2l6ZSgpKXtcbiAgICAgICAgY2FsbEJhY2sodGhpcy5jYWNoZWRTdGF0dXMpXG4gICAgLy8gdGhlbiBpbiBsb2NhbFN0b3JhZ2VcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgZGF0YSA9IHt9O1xuICAgICAgICBpZiAoa2V5IGluIGxvY2FsU3RvcmFnZSkge1xuICAgICAgICAgICAgZGF0YS5fX3Rva2VuX18gPSBsb2NhbFN0b3JhZ2Vba2V5XTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN0YXR1c1dhaXRpbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLiRwb3N0KCdhcGkvc3RhdHVzJyxkYXRhLCBmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICAgICAgdGhzLnVwZGF0ZVN0YXR1cyhzdGF0dXMpO1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlW2tleV0gPSBzdGF0dXMudG9rZW47XG4gICAgICAgICAgICBjYWxsQmFjayhzdGF0dXMpO1xuICAgICAgICAgICAgdGhzLnN0YXR1c1dhaXRpbmcgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGRvZXNuJ3QgY2FsbCBjYWxsYmFja1xuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgY2FsbEJhY2sodGhpcy5jYWNoZWRTdGF0dXMpO1xufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLnVwZGF0ZVN0YXR1cyA9IGZ1bmN0aW9uKHN0YXR1cyl7XG4gICAgdmFyIGxhc3RCdWlsZCA9IHBhcnNlRmxvYXQobG9jYWxTdG9yYWdlLmxhc3RCdWlsZCkgfHwgMTtcbiAgICBpZiAobGFzdEJ1aWxkIDwgc3RhdHVzLmxhc3RfYnVpbGQpe1xuICAgICAgICB1dGlscy5jbGVhbkRlc2NyaXB0aW9uKCk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5sYXN0QnVpbGQgPSBzdGF0dXMubGFzdF9idWlsZDtcbiAgICB9XG4gICAgdGhpcy5pc0Nvbm5lY3RlZCA9IEJvb2xlYW4oc3RhdHVzLnRva2VuKTtcbiAgICB0aGlzLmlzTG9nZ2VkSW4gPSBCb29sZWFuKHN0YXR1cy51c2VyX2lkKTtcbiAgICB2YXIgb2xkU3RhdHVzID0gdGhpcy5jYWNoZWRTdGF0dXM7XG4gICAgdGhpcy5jYWNoZWRTdGF0dXMgPSBzdGF0dXM7XG4gICAgaWYgKCFvbGRTdGF0dXMudXNlcl9pZCAmJiBzdGF0dXMudXNlcl9pZCl7XG4gICAgICAgIHRoaXMuZW1pdCgnbG9nZ2VkLWluJyxzdGF0dXMudXNlcl9pZCk7XG4gICAgfSBlbHNlIGlmIChvbGRTdGF0dXMudXNlcl9pZCAmJiAhc3RhdHVzLnVzZXJfaWQpe1xuICAgICAgICB0aGlzLmVtaXQoJ2xvZ2dlZC1vdXQnKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuaXNDb25uZWN0ZWQgJiYgIXRoaXMuaXNMb2dnZWRJbil7XG4gICAgICAgIHRoaXMuZW1pdCgnbG9naW4tcmVxdWlyZWQnKTtcbiAgICAgICAgaWYgKHRoaXMuZ2V0TG9naW4pe1xuICAgICAgICAgICAgdmFyIGxvZ2luSW5mbyA9IHRoaXMuZ2V0TG9naW4oKTtcbiAgICAgICAgICAgIGlmIChsb2dpbkluZm8uY29uc3RydWN0b3IgPT09IE9iamVjdCl7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dpbihsb2dpbkluZm8udXNlcm5hbWUsIGxvZ2luSW5mby5wYXNzd29yZCwgbG9naW5JbmZvLmNhbGxCYWNrKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobG9naW5JbmZvLmNvbnN0cnVjdG9yID09PSBQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgbG9naW5JbmZvLnRoZW4oZnVuY3Rpb24ob2JqKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dpbihvYmoudXNlcm5hbWUsIG9iai5wYXNzd29yZCwgb2JqLmNhbGxCYWNrKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8vIHJlYWx0aW1lIGNvbm5lY3Rpb24gaXMgc2V0dGVkXG4gICAgaWYgKCFvbGRTdGF0dXMucmVhbHRpbWVFbmRQb2ludCAmJiBzdGF0dXMucmVhbHRpbWVFbmRQb2ludCkge1xuICAgICAgICB0aGlzLndzQ29ubmVjdGlvbiA9IG5ldyBSZWFsdGltZUNvbm5lY3Rpb24oc3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQsIHRoaXMpO1xuICAgIC8vIHJlYWx0aW1lIGNvbm5lY3Rpb24gaXMgY2xvc2VkXG4gICAgfSBlbHNlIGlmIChvbGRTdGF0dXMucmVhbHRpbWVFbmRQb2ludCAmJiAhc3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQpIHtcbiAgICAgICAgdGhpcy53c0Nvbm5lY3Rpb24uY2xvc2UoKTtcbiAgICAgICAgZGVsZXRlIHRoaXMud3NDb25uZWN0aW9uO1xuICAgIH1cbiAgICB0aGlzLmVtaXQoJ3VwZGF0ZS1jb25uZWN0aW9uLXN0YXR1cycsIHN0YXR1cywgb2xkU3RhdHVzKTtcbiAgICBsb2NhbFN0b3JhZ2VbU1RBVFVTS0VZXSA9IEpTT04uc3RyaW5naWZ5KHN0YXR1cyk7XG59XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCl7XG4gICAgLyoqXG4gICAgICogbWFrZSBsb2dpbiBhbmQgcmV0dXJuIGEgcHJvbWlzZS4gSWYgbG9naW4gc3VjY2VkLCBwcm9taXNlIHdpbGwgYmUgYWNjZXB0ZWRcbiAgICAgKiBJZiBsb2dpbiBmYWlscyBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQgd2l0aCBlcnJvclxuICAgICAqIEBwYXJhbSB1c2VybmFtZTogdXNlcm5hbWVcbiAgICAgKiBAcGFyYW0gcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICogQHJldHVybiBQcm9taXNlICh1c2VyIG9iamVjdClcbiAgICAgKi9cbiAgICB2YXIgdGhzID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3Qpe1xuICAgICAgICB1dGlscy54ZHIodGhzLmVuZFBvaW50ICsgJ2FwaS9sb2dpbicsIHt1c2VybmFtZTogdXNlcm5hbWUgfHwgJycsIHBhc3N3b3JkOiBwYXNzd29yZCB8fCAnJ30sbnVsbCx0aHMuY2FjaGVkU3RhdHVzLnRva2VuLCB0cnVlKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oeGhyKXtcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgc3RhdHVzXG4gICAgICAgICAgICAgICAgdGhzLnVwZGF0ZVN0YXR1cyh4aHIucmVzcG9uc2VEYXRhKTtcbiAgICAgICAgICAgICAgICAvLyBjYWxsIHdpdGggdXNlciBpZFxuICAgICAgICAgICAgICAgIGFjY2VwdCh7c3RhdHVzIDogJ3N1Y2Nlc3MnLCB1c2VyaWQ6IHRocy5jYWNoZWRTdGF0dXMudXNlcl9pZH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oeGhyKSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgZXJyb3IgY2FsbCBlcnJvciBtYW5hZ2VyIHdpdGggZXJyb3JcbiAgICAgICAgICAgICAgICBhY2NlcHQoe2Vycm9yOiB4aHIucmVzcG9uc2VEYXRhLmVycm9yLCBzdGF0dXM6ICdlcnJvcid9KTtcbiAgICAgICAgICAgIH0pO1xuICAgIH0pO1xufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0aHMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQscmVqZWN0KSB7XG4gICAgICAgIHRocy4kcG9zdCgnYXBpL2xvZ291dCcpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbihvayl7XG4gICAgICAgICAgICAgICAgdGhzLnVwZGF0ZVN0YXR1cyh7fSk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGxvY2FsU3RvcmFnZVtTVEFUVVNLRVldO1xuICAgICAgICAgICAgICAgIGFjY2VwdCgpXG4gICAgICAgICAgICB9LCByZWplY3QpO1xuICAgIH0pO1xufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbihjYWxsQmFjaykge1xuICAgIGlmICh0aGlzLmlzTG9nZ2VkSW4pIHtcbiAgICAgICAgY2FsbEJhY2sodGhpcy5jYWNoZWRTdGF0dXMudXNlcl9pZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gd2FpdCBmb3IgbG9naW5cbiAgICAgICAgdGhpcy5vbmNlKCdsb2dnZWQtaW4nLGZ1bmN0aW9uKHVzZXJfaWQpe1xuICAgICAgICAgICAgY2FsbEJhY2sodXNlcl9pZCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN0YXR1cyhjYWxsQmFjayB8fCB1dGlscy5ub29wKTtcbiAgICB9XG59XG5cbnV0aWxzLnJlV2hlZWxDb25uZWN0aW9uID0gcmVXaGVlbENvbm5lY3Rpb247IiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBUb3VjaGVyKCl7XG4gICAgdmFyIHRvdWNoZWQgPSBmYWxzZVxuICAgIHRoaXMudG91Y2ggPSBmdW5jdGlvbigpe1xuICAgICAgICB0b3VjaGVkID0gdHJ1ZTtcbiAgICB9O1xuICAgIHRoaXMudG91Y2hlZCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciB0ID0gdG91Y2hlZDtcbiAgICAgICAgdG91Y2hlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG59XG4iLCIndXNlIHN0cmljdCc7XG5cblxuZnVuY3Rpb24gVmFjdXVtQ2FjaGVyKHRvdWNoLCBhc2tlZCwgbmFtZSwgcGtJbmRleCl7XG4vKlxuICAgIGlmIChuYW1lKXtcbiAgICAgICAgY29uc29sZS5pbmZvKCdjcmVhdGVkIFZhY3V1bUNhY2hlciBhcyAnICsgbmFtZSk7XG4gICAgfVxuKi9cbiAgICBpZiAoIWFza2VkKXtcbiAgICAgICAgdmFyIGFza2VkID0gW107XG4gICAgfVxuICAgIHZhciBtaXNzaW5nID0gW107XG4gICAgXG4gICAgdGhpcy5hc2sgPSBmdW5jdGlvbiAoaWQsbGF6eSl7XG4gICAgICAgIGlmIChwa0luZGV4ICYmIChpZCBpbiBwa0luZGV4LnNvdXJjZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIUxhenkoYXNrZWQpLmNvbnRhaW5zKGlkKSl7XG4gICAgICAgICAgICBjb25zb2xlLmluZm8oJ2Fza2luZyAoJyArIGlkICsgJykgZnJvbSAnICsgbmFtZSk7XG4gICAgICAgICAgICBtaXNzaW5nLnB1c2goaWQpO1xuICAgICAgICAgICAgaWYgKCFsYXp5KVxuICAgICAgICAgICAgICAgIGFza2VkLnB1c2goaWQpO1xuICAgICAgICAgICAgdG91Y2gudG91Y2goKTtcbiAgICAgICAgfSBcbi8vICAgICAgICBlbHNlIGNvbnNvbGUud2FybignKCcgKyBpZCArICcpIHdhcyBqdXN0IGFza2VkIG9uICcgKyBuYW1lKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRBc2tlZEluZGV4ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGFza2VkO1xuICAgIH1cblxuICAgIHRoaXMubWlzc2luZ3MgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gTGF6eShtaXNzaW5nLnNwbGljZSgwLG1pc3NpbmcubGVuZ3RoKSkudW5pcXVlKCkudG9BcnJheSgpO1xuICAgIH1cbn1cbiIsImZ1bmN0aW9uIEF1dG9MaW5rZXIoYWN0aXZlcywgSURCLCBXMlBSRVNPVVJDRSwgbGlzdENhY2hlKXtcbiAgICB2YXIgdG91Y2ggPSBuZXcgVG91Y2hlcigpO1xuICAgIHZhciBtYWluSW5kZXggPSB7fTtcbiAgICB2YXIgZm9yZWlnbktleXMgPSB7fTtcbiAgICB2YXIgbTJtID0ge307XG4gICAgdmFyIG0ybUluZGV4ID0ge307XG4gICAgdmFyIHBlcm1pc3Npb25zID0ge307XG4gICAgdGhpcy5tYWluSW5kZXggPSBtYWluSW5kZXg7XG4gICAgdGhpcy5mb3JlaWduS2V5cyA9IGZvcmVpZ25LZXlzO1xuICAgIHRoaXMubTJtID0gbTJtO1xuICAgIHRoaXMubTJtSW5kZXggPSBtMm1JbmRleDtcbiAgICB0aGlzLnBlcm1pc3Npb25zID0gcGVybWlzc2lvbnM7XG5cbiAgICBXMlBSRVNPVVJDRS5vbignbW9kZWwtZGVmaW5pdGlvbicsZnVuY3Rpb24obW9kZWwsIGluZGV4KXtcbiAgICAgICAgLy8gZGVmaW5pbmcgYWxsIGluZGV4ZXMgZm9yIHByaW1hcnkga2V5XG4gICAgICAgIHZhciBwa0luZGV4ID0gbGlzdENhY2hlLmdldEluZGV4Rm9yKG1vZGVsLm5hbWUsICdpZCcpO1xuICAgICAgICBtYWluSW5kZXhbbW9kZWwubmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLCBwa0luZGV4LCAnbWFpbkluZGV4LicgKyBtb2RlbC5uYW1lLCBpbmRleCk7XG4gICAgICAgIFxuICAgICAgICAvLyBjcmVhdGluZyBwZXJtaXNzaW9uIGluZGV4ZXNcbiAgICAgICAgcGVybWlzc2lvbnNbbW9kZWwubmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLG51bGwsICdwZXJtaXNzaW9ucy4nICsgbW9kZWwubmFtZSk7XG5cbiAgICAgICAgLy8gY3JlYXRpbmcgaW5kZXhlcyBmb3IgZm9yZWlnbiBrZXlzXG4gICAgICAgIExhenkobW9kZWwucmVmZXJlbmNlcykuZWFjaChmdW5jdGlvbihyZWZlcmVuY2Upe1xuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IG1vZGVsLm5hbWUgKyAnXycgKyByZWZlcmVuY2UuaWQ7XG4gICAgICAgICAgICBmb3JlaWduS2V5c1tpbmRleE5hbWVdID0gbmV3IFZhY3V1bUNhY2hlcih0b3VjaCwgbGlzdENhY2hlLmdldEluZGV4Rm9yKHJlZmVyZW5jZS50bywgJ2lkJyksIHJlZmVyZW5jZS50byArICcuaWQgZm9yZWlnbktleXMuJyArIGluZGV4TmFtZSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBjcmVhdGluZyByZXZlcnNlIGZvcmVpZ24ga2V5c1xuICAgICAgICBMYXp5KG1vZGVsLnJlZmVyZW5jZWRCeSkuZWFjaChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gZmllbGQuYnkgKyAnLicgKyBmaWVsZC5pZDtcbiAgICAgICAgICAgIGZvcmVpZ25LZXlzW2luZGV4TmFtZV0gPSBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLCBsaXN0Q2FjaGUuZ2V0SW5kZXhGb3IoZmllbGQuYnksZmllbGQuaWQpLCBmaWVsZC5ieSArICcuJyArIGZpZWxkLmlkICsgJyBmb3JlaWduS2V5cy4nICsgaW5kZXhOYW1lKTtcbiAgICAgICAgfSk7XG4gICAgICAgIExhenkobW9kZWwubWFueVRvTWFueSkuZWFjaChmdW5jdGlvbihyZWxhdGlvbil7XG4gICAgICAgICAgICBpZiAoIShyZWxhdGlvbi5pbmRleE5hbWUgaW4gbTJtKSlcbiAgICAgICAgICAgICAgICBtMm1bcmVsYXRpb24uaW5kZXhOYW1lXSA9IFtuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLG51bGwsJ20ybS4nICsgcmVsYXRpb24uaW5kZXhOYW1lICsgJ1swXScpLCBuZXcgVmFjdXVtQ2FjaGVyKHRvdWNoLG51bGwsJ20ybS4nICsgcmVsYXRpb24uaW5kZXhOYW1lKydbMV0nKV07XG4gICAgICAgICAgICBpZiAoIShyZWxhdGlvbi5pbmRleE5hbWUgaW4gbTJtSW5kZXgpKVxuICAgICAgICAgICAgICAgIG0ybUluZGV4W3JlbGF0aW9uLmluZGV4TmFtZV0gPSBuZXcgTWFueVRvTWFueVJlbGF0aW9uKHJlbGF0aW9uLG0ybVtyZWxhdGlvbi5pbmRleE5hbWVdKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgdmFyIG0ybUdldCA9IGZ1bmN0aW9uKGluZGV4TmFtZSwgbiwgY29sbGVjdGlvbiwgY2FsbEJhY2spe1xuICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdCgobiA/IHV0aWxzLnJldmVyc2UoJy8nLCBpbmRleE5hbWUpIDogaW5kZXhOYW1lKSArICdzJyArICcvbGlzdCcsIHtjb2xsZWN0aW9uOiBjb2xsZWN0aW9ufSwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKGRhdGEsIGNhbGxCYWNrKTtcbiAgICAgICAgICAgIGRlbGV0ZSBhY3RpdmVzW2luZGV4TmFtZV1cbiAgICAgICAgfSk7ICAgICAgICBcbiAgICB9O1xuXG4gICAgdmFyIGdldE0yTSA9IGZ1bmN0aW9uKGluZGV4TmFtZSwgY29sbGVjdGlvbiwgbiwgY2FsbEJhY2spe1xuICAgICAgICAvLyBhc2sgYWxsIGl0ZW1zIGluIGNvbGxlY3Rpb24gdG8gbTJtIGluZGV4XG4gICAgICAgIExhenkoY29sbGVjdGlvbikuZWFjaChtMm1baW5kZXhOYW1lXVtuXS5hc2suYmluZChtMm1baW5kZXhOYW1lXVtuXSkpO1xuICAgICAgICAvLyByZW5ld2luZyBjb2xsZWN0aW9uIHdpdGhvdXQgYXNrZWRcbiAgICAgICAgY29sbGVjdGlvbiA9IG0ybVtpbmRleE5hbWVdW25dLm1pc3NpbmdzKCk7XG4gICAgICAgIC8vIGNhbGxpbmcgcmVtb3RlIGZvciBtMm0gY29sbGVjdGlvbiBpZiBhbnlcbiAgICAgICAgaWYgKGNvbGxlY3Rpb24ubGVuZ3RoKXtcbiAgICAgICAgICAgIGFjdGl2ZXNbaW5kZXhOYW1lXSA9IDE7XG4gICAgICAgICAgICBtMm1HZXQoaW5kZXhOYW1lLCBuLCBjb2xsZWN0aW9uLCBjYWxsQmFjayk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjaygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmdldE0yTSA9IGdldE0yTTtcblxuICAgIHZhciBsaW5rVW5saW5rZWQgPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyBwZXJmb3JtIGEgRGF0YUJhc2Ugc3luY2hyb25pemF0aW9uIHdpdGggc2VydmVyIGxvb2tpbmcgZm9yIHVua25vd24gZGF0YVxuICAgICAgICBpZiAoIXRvdWNoLnRvdWNoZWQoKSkgcmV0dXJuO1xuICAgICAgICBpZiAoTGF6eShhY3RpdmVzKS52YWx1ZXMoKS5zdW0oKSkge1xuICAgICAgICAgICAgdG91Y2gudG91Y2goKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICBMYXp5KG0ybSkuZWFjaChmdW5jdGlvbihpbmRleGVzLCBpbmRleE5hbWUpe1xuICAgICAgICAgICAgTGF6eShpbmRleGVzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCxuKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBpbmRleC5taXNzaW5ncygpO1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24gPSBMYXp5KGNvbGxlY3Rpb24pLmZpbHRlcihCb29sZWFuKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHgpXG4gICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIGlmIChjb2xsZWN0aW9uLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBJTkRFWCA9IG0ybUluZGV4W2luZGV4TmFtZV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBnZXR0ZXIgPSBJTkRFWFsnZ2V0JyArICgxIC0gbildLmJpbmQoSU5ERVgpO1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbTJtR2V0KGluZGV4TmFtZSwgbiwgY29sbGVjdGlvbiwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWRzID0gY29sbGVjdGlvbi5tYXAoZ2V0dGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3RoZXJJbmRleCA9IGluZGV4TmFtZS5zcGxpdCgnLycpWzEgLSBuXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5kZXNjcmliZShvdGhlckluZGV4LGZ1bmN0aW9uKCl7XG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGF6eShpZHMpLmZsYXR0ZW4oKS51bmlxdWUoKS5lYWNoKG1haW5JbmRleFtvdGhlckluZGV4XS5hc2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMYXp5KGlkcykuZmxhdHRlbigpLnVuaXF1ZSgpLmVhY2goZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWluSW5kZXhbb3RoZXJJbmRleF0uYXNrKHgsdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIExhenkobWFpbkluZGV4KS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgbW9kZWxOYW1lKSB7XG4gICAgICAgICAgICB2YXIgaWRzID0gaW5kZXgubWlzc2luZ3MoKTtcbiAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIGlkYiA9IG1vZGVsTmFtZSBpbiBJREIgPyBJREJbbW9kZWxOYW1lXS5rZXlzKCkgOiBMYXp5KCk7XG4gICAgICAgICAgICAgICAgLy9sb2coJ2xpbmtpbmcuJyArIG1vZGVsTmFtZSArICcgPSAnICsgVzJQUkVTT1VSQ0UubGlua2luZy5zb3VyY2VbbW9kZWxOYW1lXSk7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gobW9kZWxOYW1lLCB7aWQ6IGlkc30sbnVsbCx1dGlscy5ub29wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIEZvcmVpZ24ga2V5c1xuICAgICAgICBMYXp5KGZvcmVpZ25LZXlzKVxuICAgICAgICAubWFwKGZ1bmN0aW9uKHYsayl7XG4gICAgICAgICAgICByZXR1cm4gW2ssIHYubWlzc2luZ3MoKV1cbiAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uKHYpe1xuICAgICAgICAgICAgcmV0dXJuIHZbMV0ubGVuZ3RoXG4gICAgICAgIH0pLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIGlkcyA9IHhbMV07XG4gICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0geFswXTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGluZGV4TmFtZS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgdmFyIG1haW5SZXNvdXJjZSA9IGluZGV4WzBdO1xuICAgICAgICAgICAgdmFyIGZpZWxkTmFtZSA9IGluZGV4WzFdO1xuICAgICAgICAgICAgdmFyIGZpbHRlciA9IHt9O1xuICAgICAgICAgICAgZmlsdGVyW2ZpZWxkTmFtZV0gPSBpZHM7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5mZXRjaChtYWluUmVzb3VyY2UsIGZpbHRlcik7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgTGF6eShMYXp5KHBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24odixrKXtcbiAgICAgICAgICAgIHJldHVybiBbaywgdi5taXNzaW5ncygpXVxuICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIHJldHVybiB2WzFdLmxlbmd0aFxuICAgICAgICB9KS50b09iamVjdCgpKS5lYWNoKGZ1bmN0aW9uIChpZHMsIHJlc291cmNlTmFtZSkge1xuICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgYWN0aXZlc1tyZXNvdXJjZU5hbWVdID0gMTtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdChyZXNvdXJjZU5hbWUgKyAnL215X3Blcm1zJywge2lkczogTGF6eShpZHMpLnVuaXF1ZSgpLnRvQXJyYXkoKX0sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdFBlcm1pc3Npb25zKGRhdGEuUEVSTUlTU0lPTlMpO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgYWN0aXZlc1tyZXNvdXJjZU5hbWVdXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRJbnRlcnZhbChsaW5rVW5saW5rZWQsNTApO1xufTtcblxuXG4iLCJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gTGlzdENhY2hlcigpe1xuICAgIHZhciBnb3RBbGwgPSB7fTtcbiAgICB2YXIgYXNrZWQgPSB7fTsgLy8gbWFwIG9mIGFycmF5XG4gICAgdmFyIGNvbXBvc2l0ZUFza2VkID0ge307XG4gICAgdmFyIGNhcnRlc2lhblByb2R1Y3QxID0gZnVuY3Rpb24oeCx5LGlzQXJyYXkpe1xuICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgIGlmIChpc0FycmF5KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBhIGluIHgpe1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGIgaW4geSl7XG4gICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKExhenkoW3hbYV0seVtiXV0pLmZsYXR0ZW4oKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAodmFyIGEgaW4geCl7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYiBpbiB5KXtcbiAgICAgICAgICAgICAgICAgICAgcmV0LnB1c2goW3hbYV0seVtiXV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH07XG4gICAgdmFyIGNhcnRlc2lhblByb2R1Y3QgPSBmdW5jdGlvbihhcnIpe1xuICAgICAgICB2YXIgaXNBcnJheSA9IGZhbHNlO1xuICAgICAgICB2YXIgcmV0ID0gYXJyWzBdOyBcbiAgICAgICAgZm9yICh2YXIgeCA9IDE7IHggPCBhcnIubGVuZ3RoOyArK3gpe1xuICAgICAgICAgICAgcmV0ID0gY2FydGVzaWFuUHJvZHVjdDEocmV0LCBhcnJbeF0sIGlzQXJyYXkpO1xuICAgICAgICAgICAgaXNBcnJheSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG4gICAgdmFyIGV4cGxvZGVGaWx0ZXIgPSBmdW5jdGlvbihmaWx0ZXIpIHtcbiAgICAgICAgdmFyIHByb2R1Y3QgPSBjYXJ0ZXNpYW5Qcm9kdWN0KExhenkoZmlsdGVyKS52YWx1ZXMoKS50b0FycmF5KCkpO1xuICAgICAgICB2YXIga2V5cyA9IExhenkoZmlsdGVyKS5rZXlzKCkudG9BcnJheSgpO1xuICAgICAgICByZXR1cm4gcHJvZHVjdC5tYXAoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICB2YXIgciA9IHt9O1xuICAgICAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGEsbil7XG4gICAgICAgICAgICAgICAgclthXSA9IHhbbl07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICB9O1xuICAgIHZhciBmaWx0ZXJTaW5nbGUgPSBmdW5jdGlvbihtb2RlbCwgZmlsdGVyLCB0ZXN0T25seSl7XG4gICAgICAgIC8vIExhenkgYXV0byBjcmVhdGUgaW5kZXhlc1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gbW9kZWwubW9kZWxOYW1lO1xuICAgICAgICB2YXIgZ2V0SW5kZXhGb3IgPSB0aGlzLmdldEluZGV4Rm9yO1xuICAgICAgICB2YXIga2V5cyA9IExhenkoZmlsdGVyKS5tYXAoZnVuY3Rpb24odixrZXkpeyByZXR1cm4gW2tleSwgbW9kZWxOYW1lICsgJy4nICsga2V5XTsgfSkudG9PYmplY3QoKTtcbiAgICAgICAgdmFyIGluZGV4ZXMgPSBMYXp5KGZpbHRlcikua2V5cygpLm1hcChmdW5jdGlvbihrZXkpeyByZXR1cm4gW2tleSwgZ2V0SW5kZXhGb3IobW9kZWxOYW1lLCBrZXkpXX0pLnRvT2JqZWN0KCk7IFxuICAgICAgICAvLyBmYWtlIGZvciAoaXQgd2lsbCBjeWNsZSBvbmNlKVxuICAgICAgICBmb3IgKHZhciB4IGluIGZpbHRlcil7XG4gICAgICAgICAgICAvLyBnZXQgYXNrZWQgaW5kZXggYW5kIGNoZWNrIHByZXNlbmNlXG4gICAgICAgICAgICB2YXIgZGlmZmVyZW5jZSA9IExhenkoZmlsdGVyW3hdKS5kaWZmZXJlbmNlKGluZGV4ZXNbeF0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIGlmIChkaWZmZXJlbmNlLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgLy8gZ2VuZXJhdGUgbmV3IGZpbHRlclxuICAgICAgICAgICAgICAgIHZhciByZXQgPSBMYXp5KFtbeCwgZGlmZmVyZW5jZV1dKS50b09iamVjdCgpO1xuICAgICAgICAgICAgICAgIC8vIHJlbWVtYmVyIGFza2VkXG4gICAgICAgICAgICAgICAgaWYgKCF0ZXN0T25seSlcbiAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoaW5kZXhlc1t4XSwgZGlmZmVyZW5jZSk7XG4vLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlIGZpbHRlciA6ICcgKyBKU09OLnN0cmluZ2lmeShmaWx0ZXIpICsgJ1xcbk91dCA6JyArIEpTT04uc3RyaW5naWZ5KHJldCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuLy8gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NpbmdsZSBmaWx0ZXIgOiAnICsgSlNPTi5zdHJpbmdpZnkoZmlsdGVyKSArICdcXG5PdXQgOiBudWxsJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIGNsZWFuQ29tcG9zaXRlcyA9IGZ1bmN0aW9uKG1vZGVsLGZpbHRlcil7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjbGVhbiBjb21wb3NpdGVBc2tlZFxuICAgICAgICAgKi9cbiAgICAgICAgLy8gbGF6eSBjcmVhdGUgY29uZGl0aW9uYWwgYXNrZWQgaW5kZXhcbiAgICAgICAgaWYgKCEobW9kZWwubmFtZSBpbiBjb21wb3NpdGVBc2tlZCkpIHsgY29tcG9zaXRlQXNrZWRbbW9kZWwubmFtZV0gPSBbXSB9O1xuICAgICAgICB2YXIgaW5kZXggPSBjb21wb3NpdGVBc2tlZFttb2RlbC5uYW1lXTtcbiAgICAgICAgLy8gc2VhcmNoIGZvciBhbGwgZWxlbWVudHMgd2hvIGhhdmUgc2FtZSBwYXJ0aWFsXG4gICAgICAgIHZhciBmaWx0ZXJMZW4gPSBMYXp5KGZpbHRlcikuc2l6ZSgpO1xuICAgICAgICB2YXIgaXRlbXMgPSBpbmRleC5maWx0ZXIodXRpbHMubWFrZUZpbHRlcihtb2RlbCwgZmlsdGVyLCAnICYmICcsdHJ1ZSkpLmZpbHRlcihmdW5jdGlvbihpdGVtKXsgTGF6eShpdGVtKS5zaXplKCkgPiBmaWx0ZXJMZW4gfSk7XG4vLyAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0aW5nIDonICsgSlNPTi5zdHJpbmdpZnkoaXRlbXMpKTtcbiAgICB9O1xuXG4gICAgdGhpcy5maWx0ZXIgPSBmdW5jdGlvbihtb2RlbCwgZmlsdGVyKXtcbi8vICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tXFxuZmlsdGVyIDogJyArIEpTT04uc3RyaW5naWZ5KGZpbHRlcikpO1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gbW9kZWwubW9kZWxOYW1lO1xuXG4gICAgICAgIC8vIGlmIHlvdSBmZXRjaCBhbGwgb2JqZWN0cyBmcm9tIHNlcnZlciwgdGhpcyBtb2RlbCBoYXMgdG8gYmUgbWFya2VkIGFzIGdvdCBhbGw7XG4gICAgICAgIHZhciBmaWx0ZXJMZW4gID0gTGF6eShmaWx0ZXIpLnNpemUoKTtcbiAgICAgICAgc3dpdGNoIChmaWx0ZXJMZW4pIHtcbiAgICAgICAgICAgIGNhc2UgMCA6IHtcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gbnVsbCBvciBhbGxcbiAgICAgICAgICAgICAgICB2YXIgZ290ID0gZ290QWxsW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgZ290QWxsW21vZGVsTmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gYXNrZWQpe1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgYXNrZWRbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnb3V0IDogbnVsbCAoZ290IGFsbCknKTtcbiAgICAgICAgICAgICAgICAvLyBjb25kaXRpb25hbCBjbGVhblxuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gY29tcG9zaXRlQXNrZWQpeyBcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnb3QpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgMSA6IHtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gZmlsdGVyU2luZ2xlLmNhbGwodGhpcywgbW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICAgICAgY2xlYW5Db21wb3NpdGVzLmNhbGwodGhpcywgbW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgdmFyIHNpbmdsZSA9IExhenkoZmlsdGVyKS5rZXlzKCkuc29tZShmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIHZhciBmID0ge307XG4gICAgICAgICAgICBmW2tleV0gPSBmaWx0ZXJba2V5XTtcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJTaW5nbGUuY2FsbCh0aHMsIG1vZGVsLCBmLCB0cnVlKSA9PSBudWxsO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHNpbmdsZSkgeyByZXR1cm4gbnVsbCB9XG4gICAgICAgIC8vIGxhenkgY3JlYXRlIGNvbXBvc2l0ZUFza2VkXG4gICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBjb21wb3NpdGVBc2tlZCkpeyBjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdID0gW107IH1cbiAgICAgICAgLy8gZXhwbG9kZSBmaWx0ZXJcbiAgICAgICAgdmFyIGV4cGxvZGVkID0gZXhwbG9kZUZpbHRlcihmaWx0ZXIpO1xuICAgICAgICAvLyBjb2xsZWN0IHBhcnRpYWxzXG4gICAgICAgIHZhciBwYXJ0aWFscyA9IGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV0uZmlsdGVyKHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIGZpbHRlciwgJyB8fCAnLHRydWUpKTtcbiAgICAgICAgLy8gY29sbGVjdCBtaXNzaW5ncyAoZXhwbG9kZWQgLSBwYXJ0aWFscylcbiAgICAgICAgaWYgKHBhcnRpYWxzLmxlbmd0aCl7XG4gICAgICAgICAgICB2YXIgYmFkICA9IFtdO1xuICAgICAgICAgICAgLy8gcGFydGlhbCBkaWZmZXJlbmNlXG4gICAgICAgICAgICBmb3IgKHZhciB4IGluIHBhcnRpYWxzKXtcbiAgICAgICAgICAgICAgICBiYWQucHVzaC5hcHBseShiYWQsZXhwbG9kZWQuZmlsdGVyKHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIHBhcnRpYWxzW3hdLCcgJiYgJywgdHJ1ZSkpKTtcbiAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgY29uc29sZS5sb2coJ2V4cGxvZGVkIC0gcGFydGlhbCA6ICcgKyBKU09OLnN0cmluZ2lmeShiYWQpKTtcbiAgICAgICAgICAgIHZhciBtaXNzaW5ncyA9IExhenkoZXhwbG9kZWQpLmRpZmZlcmVuY2UoYmFkKS50b0FycmF5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgbWlzc2luZ3MgPSBleHBsb2RlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZpbHRlciBwYXJ0aWFsc1xuICAgICAgICBpZiAobWlzc2luZ3MubGVuZ3RoKXtcbiAgICAgICAgICAgIGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV0ucHVzaC5hcHBseShjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdLG1pc3NpbmdzKTtcbiAgICAgICAgICAgIC8vIGFnZ3JlZ2F0ZSBtaXNzaW5nc1xuICAgICAgICAgICAgdmFyIG1pc3NpbmdzID0gTGF6eShmaWx0ZXIpLmtleXMoKS5tYXAoZnVuY3Rpb24oa2V5KXtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gTGF6eShtaXNzaW5ncykucGx1Y2soa2V5KS51bmlxdWUoKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtrZXksIHJldC5sZW5ndGg/cmV0OmZpbHRlcltrZXldXTtcbiAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4vLyAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvdXQgOiAnICsgSlNPTi5zdHJpbmdpZnkobWlzc2luZ3MpKTtcbiAgICAgICAgICAgIC8vIGNsZWFuIGNvbmRpdGlvbmFsXG4gICAgICAgICAgICBjbGVhbkNvbXBvc2l0ZXMobW9kZWwsIG1pc3NpbmdzKTtcbiAgICAgICAgICAgIHJldHVybiBtaXNzaW5ncztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRJbmRleEZvciA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgZmllbGROYW1lKXtcbiAgICAgICAgdmFyIGluZGV4TmFtZSA9IG1vZGVsTmFtZSArICcuJyArIGZpZWxkTmFtZTtcbiAgICAgICAgaWYgKCEoaW5kZXhOYW1lIGluIGFza2VkKSl7XG4gICAgICAgICAgICBhc2tlZFtpbmRleE5hbWVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFza2VkW2luZGV4TmFtZV07XG4gICAgfVxufTsiLCIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIE1hbnlUb01hbnlSZWxhdGlvbihyZWxhdGlvbixtMm0pe1xuICAgIHZhciBpdGVtcyA9IFtdO1xuICAgIHRoaXMuYWRkID0gaXRlbXMucHVzaC5iaW5kKGl0ZW1zKTtcbiAgICB0aGlzLmFkZCA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAvLyAgICAgIGNvbnNvbGUubG9nKCdhZGRpbmcgJyArIGl0ZW0pO1xuICAgICAgICBpZiAoIShMYXp5KGl0ZW1zKS5maW5kKGl0ZW0pKSl7XG4gICAgICAgICAgICBpdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5nZXQwID0gZnVuY3Rpb24oaWQpe1xuICAgICAgICBtMm1bMV0uYXNrKGlkKTtcbiAgICAgICAgcmV0dXJuIExhenkoaXRlbXMpLmZpbHRlcihmdW5jdGlvbih4KXtcbiAgICAgICAgICAgIHJldHVybiB4WzBdID09PSBpZDtcbiAgICAgICAgfSkucGx1Y2soXCIxXCIpLnRvQXJyYXkoKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXQxID0gZnVuY3Rpb24oaWQpe1xuICAgICAgICBtMm1bMF0uYXNrKGlkKTtcbiAgICAgICAgcmV0dXJuIExhenkoaXRlbXMpLmZpbHRlcihmdW5jdGlvbih4KXtcbiAgICAgICAgICAgIHJldHVybiB4WzFdID09PSBpZDtcbiAgICAgICAgfSkucGx1Y2soXCIwXCIpLnRvQXJyYXkoKTtcbiAgICB9O1xuICAgIHRoaXNbJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKHJlbGF0aW9uLmluZGV4TmFtZS5zcGxpdCgnLycpWzFdKV0gPSB0aGlzLmdldDE7XG4gICAgdGhpc1snZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUocmVsYXRpb24uaW5kZXhOYW1lLnNwbGl0KCcvJylbMF0pXSA9IHRoaXMuZ2V0MDtcblxuICAgIHRoaXMuZGVsID0gZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgIHZhciBsID0gaXRlbXMubGVuZ3RoO1xuICAgICAgICB2YXIgaWR4ID0gbnVsbDtcbiAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCBsOyBhKyspeyBcbiAgICAgICAgICAgIGlmICgoaXRlbXNbYV1bMF0gPT09IGl0ZW1bMF0pICYmIChpdGVtc1thXVsxXSA9PT0gaXRlbVsxXSkpe1xuICAgICAgICAgICAgICAgIGlkeCA9IGE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlkeCl7XG4gICAgICAgICAgICBpdGVtcy5zcGxpY2UoYSwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0aW5nICcsIGl0ZW0pO1xuICAgIH07XG59IiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBjYWNoZWRQcm9wZXJ0eUJ5RXZlbnRzKHByb3RvLCBwcm9wZXJ0eU5hbWUsZ2V0dGVyLCBzZXR0ZXIpe1xuICAgIHZhciBldmVudHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNCk7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIFxuICAgIExhenkoZXZlbnRzKS5lYWNoKGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgcHJvdG8ub3JtLm9uKGV2ZW50LGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICByZXN1bHQgPSB7fTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgdmFyIHByb3BlcnR5RGVmID0ge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGNhY2hlZCgpe1xuLy8gICAgICAgICAgICByZXR1cm4gZ2V0dGVyLmNhbGwodGhpcyk7XG4gICAgICAgICAgICBpZiAoISh0aGlzLmlkIGluIHJlc3VsdCkpe1xuICAgICAgICAgICAgICAgIHJlc3VsdFt0aGlzLmlkXSA9IGdldHRlci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFt0aGlzLmlkXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgaWYgKHNldHRlcil7XG4gICAgICAgIHByb3BlcnR5RGVmWydzZXQnXSA9IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgICAgIGlmICghaXNGaW5pdGUodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaWQgaW4gcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSByZXN1bHRbdGhpcy5pZF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgICAgaWYgKHZhbHVlICE9PSByZXN1bHRbdGhpcy5pZF0pe1xuICAgICAgICAgICAgICAgIHNldHRlci5jYWxsKHRoaXMsdmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlkIGluIHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSByZXN1bHRbdGhpcy5pZF07XG4gICAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvLCBwcm9wZXJ0eU5hbWUscHJvcGVydHlEZWYpO1xufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBWYWxpZGF0aW9uRXJyb3IoZGF0YSl7XG4gICAgdGhpcy5yZXNvdXJjZSA9IGRhdGEuX3Jlc291cmNlO1xuICAgIHRoaXMuZm9ybUlkeCA9IGRhdGEuZm9ybUlkeDtcbiAgICB0aGlzLmZpZWxkcyA9IGRhdGEuZXJyb3JzO1xufVxudmFyIGJhc2VPUk0gPSBmdW5jdGlvbihvcHRpb25zLCBleHRPUk0pe1xuICAgIFxuICAgIC8vIGNyZWF0aW5nIHJld2hlZWwgY29ubmVjdGlvblxuICAgIGlmIChvcHRpb25zLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpe1xuICAgICAgICB2YXIgY29ubmVjdGlvbiA9IG5ldyByZVdoZWVsQ29ubmVjdGlvbihvcHRpb25zKTtcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMuY29uc3RydWN0b3IgPT09IHV0aWxzLnJlV2hlZWxDb25uZWN0aW9uKXtcbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBvcHRpb25zO1xuICAgIH1cbiAgICB0aGlzLmNvbm5lY3Rpb24gPSBjb25uZWN0aW9uO1xuICAgIGNvbm5lY3Rpb24ub24oJ2Nvbm5lY3RlZCcsIGZ1bmN0aW9uKCl7IFxuICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IHRydWU7XG4gICAgfSk7XG4gICAgdGhpcy5vbiA9IGNvbm5lY3Rpb24ub247XG4gICAgdGhpcy5lbWl0ID0gY29ubmVjdGlvbi5lbWl0O1xuICAgIHRoaXMudW5iaW5kID0gY29ubmVjdGlvbi51bmJpbmQ7XG4gICAgdGhpcy5vbmNlID0gY29ubmVjdGlvbi5vbmNlO1xuICAgIHRoaXMuJHBvc3QgPSBjb25uZWN0aW9uLiRwb3N0LmJpbmQoY29ubmVjdGlvbik7XG5cbiAgICAvLyBoYW5kbGluZyB3ZWJzb2NrZXQgZXZlbnRzXG4gICAgdGhpcy5vbignd3MtY29ubmVjdGVkJyxmdW5jdGlvbih3cyl7XG4gICAgICAgIGNvbnNvbGUuaW5mbygnV2Vic29ja2V0IGNvbm5lY3RlZCcpO1xuICAgICAgICAvLyBhbGwganNvbiBkYXRhIGhhcyB0byBiZSBwYXJzZWQgYnkgZ290RGF0YVxuICAgICAgICB3cy5vbk1lc3NhZ2VKc29uKFcyUFJFU09VUkNFLmdvdERhdGEuYmluZChXMlBSRVNPVVJDRSkpO1xuICAgICAgICAvL1xuICAgICAgICB3cy5vbk1lc3NhZ2VUZXh0KGZ1bmN0aW9uKG1lc3NhZ2Upe1xuICAgICAgICAgICAgY29uc29sZS5pbmZvKCdXUyBtZXNzYWdlIDogJyArIG1lc3NhZ2UpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHRoaXMub24oJ3dzLWRpc2Nvbm5lY3RlZCcsIGZ1bmN0aW9uKHdzKXtcbiAgICAgICAgY29uc29sZS5lcnJvcignV2Vic29ja2V0IGRpc2Nvbm5lY3RlZCcpXG4gICAgfSk7XG4gICAgdGhpcy5vbignZXJyb3ItanNvbi00MDQnLGZ1bmN0aW9uKGVycm9yLHVybCwgc2VudERhdGEsIHhocil7IFxuICAgICAgICBjb25zb2xlLmVycm9yKCdKU09OIGVycm9yICcsIEpTT04uc3RyaW5naWZ5KGVycm9yKSk7XG4gICAgICAgIGRlbGV0ZSB3YWl0aW5nQ29ubmVjdGlvbnNbdXJsLnNwbGl0KCcvJylbMF1dO1xuICAgIH0pO1xuICAgIHRoaXMub24oJ3JlYWx0aW1lLW1lc3NhZ2UtanNvbicsIGZ1bmN0aW9uKG1lc3NhZ2Upe1xuICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKG1lc3NhZ2UpO1xuICAgIH0pO1xuXG4gICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICB2YXIgVzJQUkVTT1VSQ0UgPSB0aGlzO1xuICAgIHZhciBJREIgPSB7YXV0aF9ncm91cCA6IExhenkoe30pfTsgLy8gdGFibGVOYW1lIC0+IGRhdGEgYXMgQXJyYXlcbiAgICB2YXIgSURYID0ge307IC8vIHRhYmxlTmFtZSAtPiBMYXp5KGluZGV4QnkoJ2lkJykpIC0+IElEQltkYXRhXVxuICAgIHZhciBSRVZJRFggPSB7fTsgLy8gdGFibGVOYW1lIC0+IGZpZWxkTmFtZSAtPiBMYXp5Lmdyb3VwQnkoKSAtPiBJREJbREFUQV1cbiAgICB2YXIgYnVpbGRlckhhbmRsZXJzID0ge307XG4gICAgdmFyIGJ1aWxkZXJIYW5kbGVyVXNlZCA9IHt9O1xuICAgIHZhciBwZXJzaXN0ZW50QXR0cmlidXRlcyA9IHt9O1xuICAgIHZhciBldmVudEhhbmRsZXJzID0ge307XG4gICAgdmFyIHBlcm1pc3Npb25XYWl0aW5nID0ge307XG4gICAgdmFyIG1vZGVsQ2FjaGUgPSB7fTtcbiAgICB2YXIgZmFpbGVkTW9kZWxzID0ge307XG4gICAgdmFyIHdhaXRpbmdDb25uZWN0aW9ucyA9IHt9IC8vIGFjdHVhbCBjb25uZWN0aW9uIHdobyBpJ20gd2FpdGluZyBmb3JcbiAgICB2YXIgbGlzdENhY2hlID0gbmV3IExpc3RDYWNoZXIoTGF6eSk7XG4gICAgdmFyIGxpbmtlciA9IG5ldyBBdXRvTGlua2VyKHdhaXRpbmdDb25uZWN0aW9ucyxJREIsIHRoaXMsIGxpc3RDYWNoZSk7XG4vKiAgICB3aW5kb3cubGwgPSBsaW5rZXI7XG4gICAgd2luZG93LmxjID0gbGlzdENhY2hlO1xuKi9cbiAgICB3aW5kb3cuSURCID0gSURCO1xuICAgIHRoaXMudmFsaWRhdGlvbkV2ZW50ID0gdGhpcy5vbignZXJyb3ItanNvbi01MTMnLCBmdW5jdGlvbihkYXRhLCB1cmwsIHNlbnREYXRhLCB4aHIpe1xuICAgICAgICBpZiAoY3VycmVudENvbnRleHQuc2F2aW5nRXJyb3JIYW5sZGVyKXtcbiAgICAgICAgICAgIGN1cnJlbnRDb250ZXh0LnNhdmluZ0Vycm9ySGFubGRlcihuZXcgVmFsaWRhdGlvbkVycm9yKGRhdGEpKTtcbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICB2YXIgZ2V0SW5kZXggPSBmdW5jdGlvbiAoaW5kZXhOYW1lKSB7XG4gICAgICAgIGlmIChpbmRleE5hbWUgaW4gSURCKVxuICAgICAgICAgICAgcmV0dXJuIElEQltpbmRleE5hbWVdO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIElEQltpbmRleE5hbWVdID0gTGF6eSh7fSk7XG4gICAgICAgICAgICByZXR1cm4gSURCW2luZGV4TmFtZV07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBnZXRVbmxpbmtlZCA9IGZ1bmN0aW9uIChpbmRleE5hbWUpIHtcbiAgICAgICAgaWYgKGluZGV4TmFtZSBpbiBVTkxJTktFRClcbiAgICAgICAgICAgIHJldHVybiBVTkxJTktFRFtpbmRleE5hbWVdO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIFVOTElOS0VEW2luZGV4TmFtZV0gPSB7fTtcbiAgICAgICAgICAgIHJldHVybiBVTkxJTktFRFtpbmRleE5hbWVdO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFBlcm1pc3Npb25UYWJsZShpZCwga2xhc3MsIHBlcm1pc3Npb25zKSB7XG4gICAgICAgIC8vIGNyZWF0ZSBQZXJtaXNzaW9uVGFibGUgY2xhc3NcbiAgICAgICAgdGhpcy5rbGFzcyA9IGtsYXNzO1xuICAgICAgICB0aGlzLnBlcm1pc3Npb25zID0gW107XG4gICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgZm9yICh2YXIgayBpbiBwZXJtaXNzaW9ucykge1xuICAgICAgICAgICAgdGhpcy5wdXNoLmFwcGx5KHRoaXMsIFtrLCBwZXJtaXNzaW9uc1trXV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIFBlcm1pc3Npb25UYWJsZS5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAvLyBzYXZlIE9iamVjdCB0byBzZXJ2ZXJcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBwZXJtaXNzaW9uczogTGF6eSh0aGlzLnBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW3hbMF0uaWQsIHhbMV1dXG4gICAgICAgICAgICB9KS50b09iamVjdCgpXG4gICAgICAgIH07XG4gICAgICAgIGRhdGEuaWQgPSB0aGlzLmlkO1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gdGhpcy5rbGFzcy5tb2RlbE5hbWU7XG4gICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KHRoaXMua2xhc3MubW9kZWxOYW1lICsgJy9zZXRfcGVybWlzc2lvbnMnLCBkYXRhLCBmdW5jdGlvbiAobXlQZXJtcywgYSwgYiwgcmVxKSB7XG4gICAgICAgICAgICBjYihteVBlcm1zKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBQZXJtaXNzaW9uVGFibGUucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAoZ3JvdXBfaWQsIHBlcm1pc3Npb25MaXN0KSB7XG4gICAgICAgIHZhciBwID0gTGF6eShwZXJtaXNzaW9uTGlzdCk7XG4gICAgICAgIHZhciBwZXJtcyA9IExhenkodGhpcy5rbGFzcy5hbGxQZXJtaXNzaW9ucykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4gW3gsIHAuY29udGFpbnMoeCldXG4gICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgIHZhciBsID0gTGF6eSh0aGlzLnBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHJldHVybiB4WzBdLmlkXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAobC5jb250YWlucyhncm91cF9pZCkpXG4gICAgICAgICAgICB0aGlzLnBlcm1pc3Npb25zW2wuaW5kZXhPZihncm91cF9pZCldWzFdID0gcGVybXM7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRoaXMucGVybWlzc2lvbnMucHVzaChbSURCLmF1dGhfZ3JvdXAuZ2V0KGdyb3VwX2lkKSwgcGVybXNdKTtcbiAgICB9O1xuXG4gICAgLy8gY3JlYXRlcyBkeW5hbWljYWwgbW9kZWxzXG4gICAgdmFyIG1ha2VNb2RlbENsYXNzID0gZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgICAgIHZhciBfbW9kZWwgPSBtb2RlbDtcbiAgICAgICAgbW9kZWwuZmllbGRzLmlkLnJlYWRhYmxlID0gZmFsc2U7XG4gICAgICAgIG1vZGVsLmZpZWxkcy5pZC53cml0YWJsZSA9IGZhbHNlO1xuICAgICAgICB2YXIgZmllbGRzID0gTGF6eShtb2RlbC5maWVsZHMpO1xuICAgICAgICBpZiAobW9kZWwucHJpdmF0ZUFyZ3MpIHtcbiAgICAgICAgICAgIGZpZWxkcyA9IGZpZWxkcy5tZXJnZShtb2RlbC5wcml2YXRlQXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgnbW9kZWwtZGVmaW5pdGlvbicsIG1vZGVsLCBnZXRJbmRleChtb2RlbC5uYW1lKSk7XG4gICAgICAgIC8vIGdldHRpbmcgZmllbGRzIG9mIHR5cGUgZGF0ZSBhbmQgZGF0ZXRpbWVcbi8qXG4gICAgICAgIHZhciBEQVRFRklFTERTID0gZmllbGRzLmZpbHRlcihmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuICh4LnR5cGUgPT0gJ2RhdGUnKSB8fCAoeC50eXBlID09ICdkYXRldGltZScpXG4gICAgICAgIH0pLm1hcChmdW5jdGlvbiAoeCwgdikge1xuICAgICAgICAgICAgcmV0dXJuIFt2LCB0cnVlXVxuICAgICAgICB9KS50b09iamVjdCgpO1xuXG4gICAgICAgIC8vIGdldHRpbmcgYm9vbGVhbiBmaWVsZHNcbiAgICAgICAgdmFyIEJPT0xGSUVMRFMgPSBmaWVsZHMuZmlsdGVyKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4gKHgudHlwZSA9PSAnYm9vbGVhbicpXG4gICAgICAgIH0pLm1hcChmdW5jdGlvbiAoeCwgdikge1xuICAgICAgICAgICAgcmV0dXJuIFt2LCB0cnVlXVxuICAgICAgICB9KS50b09iamVjdCgpO1xuXG4gICAgICAgIC8vIGJvb2xlYW5zIGFuZCBkYXRldGltZXMgc3RvcmFnZSBleHRlcm5hbCBcbiAgICAgICAgTU9ERUxfREFURUZJRUxEU1ttb2RlbC5uYW1lXSA9IERBVEVGSUVMRFM7XG4gICAgICAgIE1PREVMX0JPT0xGSUVMRFNbbW9kZWwubmFtZV0gPSBCT09MRklFTERTO1xuKi9cbiAgICAgICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICAgICAgdmFyIGZ1bmNTdHJpbmcgPSBcImlmICghcm93KSB7IHJvdyA9IHt9fTtcXG5cIjtcbiAgICAgICAgZnVuY1N0cmluZyArPSBtb2RlbC5yZWZlcmVuY2VzLm1hcChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICByZXR1cm4gJ3RoaXMuXycgKyBmaWVsZC5pZCArICcgPSByb3cuJyArIGZpZWxkLmlkICsgJzsnO1xuICAgICAgICB9KS5qb2luKCc7XFxuJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBkYXRlZmllbGQgY29udmVyc2lvblxuICAgICAgICBmdW5jU3RyaW5nICs9IGZpZWxkcy5tYXAoZnVuY3Rpb24gKHgsaykge1xuICAgICAgICAgICAgaWYgKCh4LnR5cGUgPT0gJ2RhdGUnKSB8fCAoeC50eXBlID09ICdkYXRldGltZScpKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ3RoaXMuJyArIGsgKyAnID0gcm93LicgKyBrICsgJz9uZXcgRGF0ZShyb3cuJyArIGsgKyAnICogMTAwMCAtICcgKyB1dGlscy50ek9mZnNldCArICcpOm51bGw7XFxuJzsgXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHgudHlwZSA9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ3RoaXMuJyArIGsgKyAnID0gKHJvdy4nICsgayArICcgPT09IFwiVFwiKSB8fCAocm93LicgKyBrICsgJyA9PT0gdHJ1ZSk7XFxuJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICd0aGlzLicgKyBrICsgJyA9IHJvdy4nICsgayArICc7XFxuJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkudG9TdHJpbmcoJ1xcbicpOyArICdcXG4nO1xuXG4gICAgICAgIGZ1bmNTdHJpbmcgKz0gXCJpZiAocGVybWlzc2lvbnMpIHt0aGlzLl9wZXJtaXNzaW9ucyA9IHBlcm1pc3Npb25zICYmIExhenkocGVybWlzc2lvbnMpLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gW3gsIHRydWVdIH0pLnRvT2JqZWN0KCk7fVwiXG5cbiAgICAgICAgXG4gICAgICAgIC8vIG1hc3RlciBjbGFzcyBmdW5jdGlvblxuICAgICAgICB2YXIgS2xhc3MgPSBuZXcgRnVuY3Rpb24oJ3JvdycsICdwZXJtaXNzaW9ucycsZnVuY1N0cmluZylcblxuICAgICAgICBLbGFzcy5wcm90b3R5cGUub3JtID0gZXh0T1JNO1xuICAgICAgICBLbGFzcy5yZWZfdHJhbnNsYXRpb25zID0ge307XG4gICAgICAgIEtsYXNzLm1vZGVsTmFtZSA9IG1vZGVsLm5hbWU7XG4gICAgICAgIEtsYXNzLnJlZmVyZW5jZXMgPSBMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLnBsdWNrKCdpZCcpLnRvQXJyYXkoKTtcblxuICAgICAgICBLbGFzcy5pbnZlcnNlX3JlZmVyZW5jZXMgPSBtb2RlbC5yZWZlcmVuY2VkQnkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAvLyBtYW5hZ2luZyByZWZlcmVuY2VzIHdoZXJlIFxuICAgICAgICAgICAgcmV0dXJuIHguYnkgKyAnXycgKyB4LmlkICsgJ19zZXQnXG4gICAgICAgIH0pO1xuICAgICAgICBLbGFzcy5yZWZlcmVudHMgPSBtb2RlbC5yZWZlcmVuY2VkQnkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4gW3guYnksIHguaWRdXG4gICAgICAgIH0pO1xuICAgICAgICBLbGFzcy5maWVsZHNPcmRlciA9IG1vZGVsLmZpZWxkT3JkZXI7XG4gICAgICAgIEtsYXNzLmFsbFBlcm1pc3Npb25zID0gbW9kZWwucGVybWlzc2lvbnM7XG5cbiAgICAgICAgLy8gcmVkZWZpbmluZyB0b1N0cmluZyBtZXRob2RcbiAgICAgICAgaWYgKExhenkobW9kZWwucmVwcmVzZW50YXRpb24pLnNpemUoKSl7XG4gICAgICAgICAgICBLbGFzcy5wcm90b3R5cGUudG9TdHJpbmcgPSBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzLicgKyBMYXp5KG1vZGVsLnJlcHJlc2VudGF0aW9uKS50b1N0cmluZygnICsgXCIgXCIgKyB0aGlzLicpKTtcbiAgICAgICAgfVxuICAgICAgICBLbGFzcy5wcm90b3R5cGUudG9VcHBlckNhc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyByZWRlZmluZSB0byBVcHBlckNhc2VcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKTtcbiAgICAgICAgfTtcbiAgICAgIFxuICAgICAgICBLbGFzcy5wcm90b3R5cGUudG9Mb3dlckNhc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICBLbGFzcy5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gZGVsZXRlIGluc3RhbmNlIGZyb20gc2VydmVyXG4gICAgICAgICAgICByZXR1cm4gZXh0T1JNLmRlbGV0ZSh0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZSwgW3RoaXMuaWRdKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwZXJtaXNzaW9uIGdldHRlciBwcm9wZXJ0eVxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoS2xhc3MucHJvdG90eXBlLCAncGVybWlzc2lvbnMnLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcGVybWlzc2lvbnMpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wZXJtaXNzaW9ucztcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGlua2VyLnBlcm1pc3Npb25zW3RoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lXS5hc2sodGhpcy5pZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gZ2V0dGluZyBmdWxsIHBlcm1pc3Npb24gdGFibGUgZm9yIGFuIG9iamVjdFxuICAgICAgICBLbGFzcy5wcm90b3R5cGUuYWxsX3Blcm1zID0gZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgICAgICB2YXIgb2JqZWN0X2lkID0gdGhpcy5pZDtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KHRoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lICsgJy9hbGxfcGVybXMnLCB7aWQ6IHRoaXMuaWR9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBwZXJtaXNzaW9ucyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwZWQgPSB7fTtcbiAgICAgICAgICAgICAgICB2YXIgdW5rbm93bl9ncm91cHMgPSBMYXp5KHBlcm1pc3Npb25zKS5wbHVjaygnZ3JvdXBfaWQnKS51bmlxdWUoKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnICsgeFxuICAgICAgICAgICAgICAgIH0pLmRpZmZlcmVuY2UoSURCLmF1dGhfZ3JvdXAua2V5cygpKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgTGF6eShwZXJtaXNzaW9ucykuZ3JvdXBCeShmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geC5ncm91cF9pZFxuICAgICAgICAgICAgICAgIH0pLmVhY2goZnVuY3Rpb24gKHYsIGspIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBlZFtrXSA9IExhenkodikucGx1Y2soJ25hbWUnKS50b0FycmF5KClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgY2FsbCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIGNiKG5ldyBQZXJtaXNzaW9uVGFibGUob2JqZWN0X2lkLCBLbGFzcywgZ3JvdXBlZCkpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHVua25vd25fZ3JvdXBzLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ2V0KCdhdXRoX2dyb3VwJyx1bmtub3duX2dyb3VwcyxjYWxsKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGNhbGwoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBvID0gdGhpcy5hc1JhdygpO1xuICAgICAgICAgICAgdmFyIGZpZWxkcyA9IEtsYXNzLmZpZWxkcztcbiAgICAgICAgICAgIHZhciBJRCA9IHRoaXMuaWQ7XG4gICAgICAgICAgICB2YXIgbW9kZWxOYW1lID0gdGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWU7XG4gICAgICAgICAgICBpZiAoYXJncykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGFyZyBpbiBhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIG9bYXJnXSA9IGFyZ3NbYXJnXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBlbGltaW5hdGUgdW53cml0YWJsZXNcbiAgICAgICAgICAgIExhenkoS2xhc3MuZmllbGRzT3JkZXIpLmZpbHRlcihmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICByZXR1cm4gIWZpZWxkc1t4XS53cml0YWJsZTtcbiAgICAgICAgICAgIH0pLmVhY2goZnVuY3Rpb24oZmllbGROYW1lKXtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGROYW1lIGluIG8pIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9bZmllbGROYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChJRCkgeyBvLmlkID0gSUQ7IH1cbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gVzJQUkVTT1VSQ0UuJHBvc3QobW9kZWxOYW1lICsgKElEID8gJy9wb3N0JyA6ICcvcHV0JyksIG8pO1xuICAgICAgICAgICAgaWYgKGFyZ3MgJiYgKGFyZ3MuY29uc3RydWN0b3IgPT09IEZ1bmN0aW9uKSl7XG4gICAgICAgICAgICAgICAgLy8gcGxhY2luZyBjYWxsYmFjayBpbiBhIGNvbW1vbiBwbGFjZVxuICAgICAgICAgICAgICAgIHByb21pc2UuY29udGV4dC5zYXZpbmdFcnJvckhhbmxkZXIgPSBhcmdzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHByb21pc2VcbiAgICAgICAgfTtcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb2JqID0gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5hc1JhdygpKTtcbiAgICAgICAgICAgIG9iai5fcGVybWlzc2lvbnMgPSB0aGlzLl9wZXJtaXNzaW9ucztcbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gYnVpbGRpbmcgc2VyaWFsaXphdGlvbiBmdW5jdGlvblxuICAgICAgICB2YXIgYXNyID0gJ3JldHVybiB7XFxuJyArIExhenkobW9kZWwucmVmZXJlbmNlcykubWFwKGZ1bmN0aW9uKGZpZWxkKXtcbiAgICAgICAgICAgIHJldHVybiBmaWVsZC5pZCArICcgOiB0aGlzLl8nICsgZmllbGQuaWQ7XG4gICAgICAgIH0pLmNvbmNhdChmaWVsZHMubWFwKGZ1bmN0aW9uICh4LGspIHtcbiAgICAgICAgICAgIGlmICgoeC50eXBlID09ICdkYXRlJykgfHwgKHgudHlwZSA9PSAnZGF0ZXRpbWUnKSl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGsgKyAnIDogKHRoaXMuJyArIGsgKyAnPyhNYXRoLnJvdW5kKHRoaXMuJyArIGsgKyAnLmdldFRpbWUoKSAtIHRoaXMuJyArIGsgKyAnLmdldFRpbWV6b25lT2Zmc2V0KCkgKiA2MDAwMCkgLyAxMDAwKTpudWxsKSc7IFxuICAgICAgICAgICAgfSBlbHNlIGlmICh4LnR5cGUgPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGsgKyAnIDogdGhpcy4nICsgayArICc/XCJUXCI6XCJGXCInO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gayArICcgOiB0aGlzLicgKyBrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSkudG9TdHJpbmcoJyxcXG4nKSArICd9Oyc7XG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS5hc1JhdyA9IG5ldyBGdW5jdGlvbihhc3IpO1xuXG4gICAgICAgIEtsYXNzLnNhdmVNdWx0aSA9IGZ1bmN0aW9uIChvYmplY3RzLCBjYiwgc2NvcGUpIHtcbiAgICAgICAgICAgIHZhciByYXcgPSBbXTtcbiAgICAgICAgICAgIHZhciBkZWxldGFibGUgPSBMYXp5KEtsYXNzLmZpZWxkcylcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAheC53cml0YWJsZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnBsdWNrKCdpZCcpXG4gICAgICAgICAgICAgICAgLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIExhenkob2JqZWN0cylcbiAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4LmFzUmF3KClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIExhenkoZGVsZXRhYmxlKS5lYWNoKGZ1bmN0aW9uICh5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgeFt5XTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJhdy5wdXNoKHgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QoS2xhc3MubW9kZWxOYW1lLCAncHV0Jywge211bHRpcGxlOiByYXcsIGZvcm1JZHggOiBXMlBSRVNPVVJDRS5mb3JtSWR4Kyt9LCBmdW5jdGlvbiAoZWxlbXMpIHtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3REYXRhKGVsZW1zKTtcbiAgICAgICAgICAgICAgICB2YXIgdGFiID0gSURCW0tsYXNzLm1vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgdmFyIG9ianMgPSBMYXp5KGVsZW1zW0tsYXNzLm1vZGVsTmFtZV0ucmVzdWx0cykucGx1Y2soJ2lkJykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YWIuZ2V0KHgpXG4gICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIGlmIChjYikge1xuICAgICAgICAgICAgICAgICAgICBjYihvYmpzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBzY29wZSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmICgnZXh0cmFfdmVyYnMnIGluIG1vZGVsKVxuICAgICAgICAgICAgTGF6eShtb2RlbC5leHRyYV92ZXJicykuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgIHZhciBmdW5jTmFtZSA9IHhbMF07XG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSB4WzFdO1xuICAgICAgICAgICAgICAgIHZhciBkZGF0YSA9ICdkYXRhID0ge2lkIDogdGhpcy5pZCc7XG4gICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBkZGF0YSArPSAnLCAnICsgTGF6eShhcmdzKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geCArICcgOiAnICsgeDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmpvaW4oJywnKTtcbiAgICAgICAgICAgICAgICBkZGF0YSArPSAnfTsnO1xuICAgICAgICAgICAgICAgIGFyZ3MucHVzaCgnY2InKTtcbiAgICAgICAgICAgICAgICBLbGFzcy5wcm90b3R5cGVbZnVuY05hbWVdID0gbmV3IEZ1bmN0aW9uKGFyZ3MsIGRkYXRhICsgJ1cyUy5XMlBfUE9TVCh0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZSxcIicgKyBmdW5jTmFtZSArICdcIiwgZGF0YSxmdW5jdGlvbihkYXRhLHN0YXR1cyxoZWFkZXJzLHgpeycgK1xuICAgICAgICAgICAgICAgICAgICAndHJ5e1xcbicgK1xuICAgICAgICAgICAgICAgICAgICAnICAgaWYgKCFoZWFkZXJzKFwibm9tb2RlbFwiKSkge3dpbmRvdy5XMlMuZ290RGF0YShkYXRhLGNiKTt9XFxuJyArXG4gICAgICAgICAgICAgICAgICAgICcgICBlbHNlIHtpZiAoY2IpIHtjYihkYXRhKX19XFxuJyArXG4gICAgICAgICAgICAgICAgICAgICd9IGNhdGNoKGUpe1xcbicgK1xuICAgICAgICAgICAgICAgICAgICAnaWYgKGNiKSB7Y2IoZGF0YSk7fVxcbicgK1xuICAgICAgICAgICAgICAgICAgICAnfVxcbicgK1xuICAgICAgICAgICAgICAgICAgICAnfSk7XFxuJ1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgaWYgKCdwcml2YXRlQXJncycgaW4gbW9kZWwpIHtcbiAgICAgICAgICAgIEtsYXNzLnByaXZhdGVBcmdzID0gTGF6eShtb2RlbC5wcml2YXRlQXJncykua2V5cygpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbeCwgdHJ1ZV07XG4gICAgICAgICAgICB9KS50b09iamVjdCgpO1xuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlLnNhdmVQQSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgICAgICAgICAgdmFyIFQgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBvbyA9IHtpZDogdGhpcy5pZH07XG4gICAgICAgICAgICAgICAgdmFyIFBBID0gdGhpcy5jb25zdHJ1Y3Rvci5wcml2YXRlQXJncztcbiAgICAgICAgICAgICAgICB2YXIgRnMgPSB0aGlzLmNvbnN0cnVjdG9yLmZpZWxkcztcbiAgICAgICAgICAgICAgICB2YXIgdCA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKG8pLmFzUmF3KCk7XG4gICAgICAgICAgICAgICAgdmFyIGZpZWxkSWR4ID0gTGF6eShQQSkua2V5cygpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3gsIEZzW3hdXVxuICAgICAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgICAgICAgICAgTGF6eShvKS5lYWNoKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoayBpbiBQQSkgJiYgZmllbGRJZHhba10ud3JpdGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9vW2tdID0gdjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KHRoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lICsgJy9zYXZlUEEnLCBvbywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBMYXp5KG9vKS5lYWNoKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBUW2tdID0gdjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgbW9kZWxDYWNoZVtLbGFzcy5tb2RlbE5hbWVdID0gS2xhc3M7XG4gICAgICAgIC8vIGFkZGluZyBpZCB0byBmaWVsZHNcbiAgICAgICAgZm9yICh2YXIgZiBpbiBtb2RlbC5maWVsZHMpIHtcbiAgICAgICAgICAgIG1vZGVsLmZpZWxkc1tmXS5pZCA9IGY7XG4gICAgICAgIH1cbiAgICAgICAgS2xhc3MuZmllbGRzID0gTGF6eShtb2RlbC5maWVsZHMpLmNvbmNhdChMYXp5KG1vZGVsLnByaXZhdGVBcmdzKSkuY29uY2F0KExhenkobW9kZWwucmVmZXJlbmNlcykudGFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICB4LnR5cGUgPSB4LnR5cGUgfHwgJ3JlZmVyZW5jZSdcbiAgICAgICAgfSkpLmluZGV4QnkoJ2lkJykudG9PYmplY3QoKTtcbiAgICAgICAgLy8gc2V0dGluZyB3aWRnZXRzIGZvciBmaWVsZHNcbiAgICAgICAgTGF6eShLbGFzcy5maWVsZHMpLmVhY2goZnVuY3Rpb24oZmllbGQpe1xuICAgICAgICAgICAgaWYgKCFmaWVsZC53aWRnZXQpe1xuICAgICAgICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSAncmVmZXJlbmNlJyl7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLndpZGdldCA9ICdjaG9pY2VzJ1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkLndpZGdldCA9IGZpZWxkLnR5cGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gYnVpbGRpbmcgcmVmZXJlbmNlcyB0byAobWFueSB0byBvbmUpIGZpZWxkc1xuICAgICAgICBMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLmVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgICAgICAgdmFyIGV4dF9yZWYgPSByZWYudG87XG4gICAgICAgICAgICB2YXIgbG9jYWxfcmVmID0gJ18nICsgcmVmLmlkO1xuICAgICAgICAgICAgY2FjaGVkUHJvcGVydHlCeUV2ZW50cyhLbGFzcy5wcm90b3R5cGUsIHJlZi5pZCxmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzW2xvY2FsX3JlZl0pIHsgcmV0dXJuIG51bGwgfTtcbiAgICAgICAgICAgICAgICBpZiAoIShleHRfcmVmIGluIElEQikpe1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUoZXh0X3JlZixmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtlci5tYWluSW5kZXhbZXh0X3JlZl0uYXNrKHRoc1tsb2NhbF9yZWZdLHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IChleHRfcmVmIGluIElEQikgJiYgdGhpc1tsb2NhbF9yZWZdICYmIElEQltleHRfcmVmXS5nZXQodGhpc1tsb2NhbF9yZWZdKTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCAmJiAoZXh0X3JlZiBpbiBsaW5rZXIubWFpbkluZGV4KSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBhc2tpbmcgdG8gbGlua2VyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpc1tsb2NhbF9yZWZdID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlua2VyLm1haW5JbmRleFtleHRfcmVmXS5hc2sodGhpc1tsb2NhbF9yZWZdLHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdudWxsIHJlZmVyZW5jZSBmb3IgJyArIGxvY2FsX3JlZiArICcoJyArIHRoaXMuaWQgKyAnKSByZXNvdXJjZSAnICsgS2xhc3MubW9kZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXRpbHMubW9jaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKHZhbHVlLmNvbnN0cnVjdG9yICE9PSB1dGlscy5tb2NrKSAmJiAodmFsdWUuY29uc3RydWN0b3IubW9kZWxOYW1lICE9PSBleHRfcmVmKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignWW91IGNhbiBhc3NpZ24gb25seSAnICsgZXh0X3JlZiArICcgdG8gJyArIHJlZi5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpc1tsb2NhbF9yZWZdID0gdmFsdWUuaWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1tsb2NhbF9yZWZdID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAnbmV3LScgKyBleHRfcmVmLCAnZGVsZXRlZC0nICsgZXh0X3JlZiwndXBkYXRlZC0nICsgZXh0X3JlZiwgJ25ldy1tb2RlbC0nICsgZXh0X3JlZi8qLCAndXBkYXRlZC0nICsgS2xhc3MubW9kZWxOYW1lKi8pO1xuXG5cbiAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZVsnZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUocmVmLmlkKV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4dE9STS5nZXQoZXh0X3JlZix0aGlzW2xvY2FsX3JlZl0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9idWlsZGluZyByZWZlcmVuY2VzIHRvIChvbmUgdG8gbWFueSkgZmllbGRzXG4gICAgICAgIExhenkobW9kZWwucmVmZXJlbmNlZEJ5KS5lYWNoKGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgICAgICAgIHZhciBpbmRleE5hbWUgPSByZWYuYnkgKyAnLicgKyByZWYuaWQ7XG4gICAgICAgICAgICB2YXIgcHJvcGVydHlOYW1lID0gcmVmLmJ5ICsgJ18nICsgdXRpbHMucGx1cmFsaXplKHJlZi5pZCk7XG4gICAgICAgICAgICB2YXIgcmV2SW5kZXggPSByZWYuYnk7XG4gICAgICAgICAgICBpZiAoS2xhc3MucHJvdG90eXBlLmhhc093blByb3BlcnR5KHByb3BlcnR5TmFtZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdUcnllZCB0byByZWRlZmluZSBwcm9wZXJ0eSAnICsgcHJvcGVydHlOYW1lICsgJ3MnICsgJyBmb3IgJyArIEtsYXNzLm1vZGVsTmFtZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNhY2hlZFByb3BlcnR5QnlFdmVudHMoS2xhc3MucHJvdG90eXBlLCBwcm9wZXJ0eU5hbWUsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJldCA9IChyZXZJbmRleCBpbiBJREIpID8gUkVWSURYW2luZGV4TmFtZV0uZ2V0KHRoaXMuaWQgKyAnJyk6bnVsbDtcbiAgICAgICAgICAgICAgICAgICAgbGlua2VyLmZvcmVpZ25LZXlzW2luZGV4TmFtZV0uYXNrKHRoaXMuaWQsdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICAgICAgfSwgbnVsbCwgJ25ldy0nICsgcmV2SW5kZXgsICd1cGRhdGVkLScgKyByZXZJbmRleCwgJ2RlbGV0ZWQtJyArIHJldkluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZVsnZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUodXRpbHMucGx1cmFsaXplKHJlZi5ieSkpXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3B0cyA9IHt9O1xuICAgICAgICAgICAgICAgIG9wdHNbcmVmLmlkXSA9IFt0aGlzLmlkXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXh0T1JNLmdldChyZWYuYnksb3B0cyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2J1aWxkaW5nIHJlZmVyZW5jZSB0byAobWFueSB0byBtYW55KSBmaWVsZHNcbiAgICAgICAgaWYgKG1vZGVsLm1hbnlUb01hbnkpIHtcbiAgICAgICAgICAgIExhenkobW9kZWwubWFueVRvTWFueSkuZWFjaChmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IHJlZi5pbmRleE5hbWU7XG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0ID0gcmVmLmZpcnN0PyAwIDogMTtcbiAgICAgICAgICAgICAgICB2YXIgb21vZGVsTmFtZSA9IHJlZi5tb2RlbDtcbi8vICAgICAgICAgICAgICAgIHZhciBvbW9kZWwgPSBnZXRJbmRleChvbW9kZWxOYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgZ2V0dGVyID0gbGlua2VyLm0ybUluZGV4W2luZGV4TmFtZV1bJ2dldCcgKyAoMSAtIGZpcnN0KV07XG5cbiAgICAgICAgICAgICAgICBjYWNoZWRQcm9wZXJ0eUJ5RXZlbnRzKEtsYXNzLnByb3RvdHlwZSwgcmVmLm1vZGVsICsgJ3MnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHMgPSBnZXR0ZXIodGhzLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnZXQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkcy5sZW5ndGgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vVzJQUkVTT1VSQ0UuZmV0Y2gob21vZGVsTmFtZSwge2lkIDogaWRzfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0ID0gZ2V0SW5kZXgob21vZGVsTmFtZSkuZ2V0LmJpbmQoSURCW29tb2RlbE5hbWVdKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkcyAmJiBnZXQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gTGF6eShpZHMpLm1hcChnZXQpLmZpbHRlcih1dGlscy5ib29sKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgICAgICAgICB9LCBudWxsLCAncmVjZWl2ZWQtbTJtLScgKyBpbmRleE5hbWUsICdyZWNlaXZlZC0nICsgb21vZGVsTmFtZSk7XG5cbiAgICAgICAgICAgICAgICBLbGFzcy5wcm90b3R5cGVbJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKHV0aWxzLnBsdXJhbGl6ZShvbW9kZWxOYW1lKSldID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua2VyLmdldE0yTShpbmRleE5hbWUsIFt0aHMuaWRdLCBmaXJzdCxmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkcyA9IGdldHRlcih0aHMuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5mZXRjaChvbW9kZWxOYW1lLCB7aWQgOiBpZHN9LG51bGwsZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0ID0gSURCW29tb2RlbE5hbWVdLmdldC5iaW5kKElEQltvbW9kZWxOYW1lXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0KExhenkoaWRzKS5tYXAoZ2V0KS5maWx0ZXIodXRpbHMuYm9vbCkudG9BcnJheSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0KFtdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgICAgIEtsYXNzLmZpZWxkc1t1dGlscy5jYXBpdGFsaXplKG9tb2RlbE5hbWUpXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHV0aWxzLmNhcGl0YWxpemUob21vZGVsTmFtZSksXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHV0aWxzLmNhcGl0YWxpemUob21vZGVsTmFtZSksXG4gICAgICAgICAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICByZWFkYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ00yTScsXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRvcnM6IFtdXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZS51bmxpbmtSZWZlcmVuY2UgPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbXVsdGlwbGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgSUQgPSB0aGlzLmlkO1xuICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2UuY29uc3RydWN0b3IubmFtZSA9PSAnQXJyYXknKSB7XG4gICAgICAgICAgICAgICAgICAgIG11bHRpcGxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VzID0gaW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlID0gaW5zdGFuY2VzWzBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgb21vZGVsID0gaW5zdGFuY2UuY29uc3RydWN0b3IubW9kZWxOYW1lO1xuICAgICAgICAgICAgICAgIGlmIChtdWx0aXBsZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sbGVjdGlvbiA9IExhenkoaW5zdGFuY2VzKS5wbHVjaygnaWQnKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbSUQsIHhdXG4gICAgICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sbGVjdGlvbiA9IFtbSUQsIGluc3RhbmNlLmlkXV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KEtsYXNzLm1vZGVsTmFtZSArICcvJyArIG9tb2RlbCArICdzL2RlbGV0ZScsIHtjb2xsZWN0aW9uOiBjb2xsZWN0aW9ufSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBLbGFzcy5wcm90b3R5cGUubGlua1JlZmVyZW5jZSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHZhciBtdWx0aXBsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBJRCA9IHRoaXMuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5jb25zdHJ1Y3Rvci5uYW1lID09ICdBcnJheScpIHtcbiAgICAgICAgICAgICAgICAgICAgbXVsdGlwbGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZXMgPSBpbnN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBpbnN0YW5jZXNbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBvbW9kZWwgPSBpbnN0YW5jZS5jb25zdHJ1Y3Rvci5tb2RlbE5hbWU7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IEtsYXNzLm1vZGVsTmFtZSArICcvJyArIG9tb2RlbDtcbiAgICAgICAgICAgICAgICBpZiAobXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4TmFtZSBpbiBJTkRFWF9NMk0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnMgPSBMYXp5KGluc3RhbmNlcykucGx1Y2soJ2lkJykuZGlmZmVyZW5jZShMYXp5KElOREVYX00yTVtpbmRleE5hbWVdWzBdLmdldCh0aGlzLmlkKSkpLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpbmRleE5hbWUgPSBvbW9kZWwgKyAnLycgKyBLbGFzcy5tb2RlbE5hbWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleE5hbWUgaW4gSU5ERVhfTTJNKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWZzID0gTGF6eShpbnN0YW5jZXMpLnBsdWNrKCdpZCcpLmRpZmZlcmVuY2UoTGF6eShJTkRFWF9NMk1baW5kZXhOYW1lXVswXS5nZXQodGhpcy5pZCkpKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlZnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sbGVjdGlvbiA9IExhenkocmVmcykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtJRCwgeF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFcyUF9QT1NUKEtsYXNzLm1vZGVsTmFtZSwgb21vZGVsICsgJ3MvcHV0Jywge2NvbGxlY3Rpb246IGNvbGxlY3Rpb259LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKGluZGV4TmFtZSBpbiBsaW5rZXIubTJtSW5kZXgpICYmIExhenkobGlua2VyLm0ybUluZGV4W2luZGV4TmFtZV1bJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKG9tb2RlbCldKGluc3RhbmNlLmlkKSkuZmluZCh0aGlzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KEtsYXNzLm1vZGVsTmFtZSArICcvJyArIG9tb2RlbCArICdzL3B1dCcsIHtjb2xsZWN0aW9uOiBbW3RoaXMuaWQsIGluc3RhbmNlLmlkXV19KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ25ldy1tb2RlbCcsIEtsYXNzKTtcbiAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgnbmV3LW1vZGVsLScgKyBLbGFzcy5tb2RlbE5hbWUpO1xuICAgICAgICByZXR1cm4gS2xhc3M7XG4gICAgfTtcblxuICAgIHRoaXMuZ290RGF0YSA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsQmFjaykge1xuICAgICAgICAvLyByZWNlaXZlIGFsbCBkYXRhIGZyb20gZXZlcnkgZW5kIHBvaW50XG4gICAgICAgIGNvbnNvbGUuaW5mbygnZ290RGF0YScpO1xuICAgICAgICBpZiAodHlwZW9mKGRhdGEpID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZGF0YSAnICsgZGF0YSArICcgcmVmdXNlZCBmcm9tIGdvdERhdGEoKScpO1xuICAgICAgICAgICAgaWYgKGNhbGxCYWNrKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxCYWNrKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIGNsZWFuIGRhdGEgZnJvbSByZWxhdGlvbnMgYW5kIHBlcm1pc3Npb25zIGZvciB1c2luZyBpdCBhZnRlciBtb2RlbCBwYXJzaW5nXG4gICAgICAgIGlmICgnX2V4dHJhJyBpbiBkYXRhKXsgZGVsZXRlIGRhdGEuX2V4dHJhIH1cbiAgICAgICAgdmFyIFRPT05FID0gZGF0YS5UT09ORTtcbiAgICAgICAgdmFyIFRPTUFOWSA9IGRhdGEuVE9NQU5ZO1xuICAgICAgICB2YXIgTUFOWVRPTUFOWSA9IGRhdGEuTUFOWVRPTUFOWTtcbiAgICAgICAgdmFyIFBFUk1JU1NJT05TID0gZGF0YS5QRVJNSVNTSU9OUztcbiAgICAgICAgdmFyIFBBID0gZGF0YS5QQTtcbiAgICAgICAgZGVsZXRlIGRhdGEuVE9PTkU7XG4gICAgICAgIGRlbGV0ZSBkYXRhLlRPTUFOWTtcbiAgICAgICAgZGVsZXRlIGRhdGEuTUFOWVRPTUFOWTtcbiAgICAgICAgZGVsZXRlIGRhdGEuUEVSTUlTU0lPTlM7XG4gICAgICAgIGRlbGV0ZSBkYXRhLlBBO1xuICAgICAgICBpZiAoIVBBKSB7IFBBID0ge307IH1cblxuICAgICAgICAvLyBjbGVhbmluZyBmcm9tIHVzZWxlc3MgZGVsZXRlZCBkYXRhXG4gICAgICAgIGRhdGEgPSBMYXp5KGRhdGEpLmZpbHRlcihmdW5jdGlvbiAodiwgaykge1xuICAgICAgICAgICAgcmV0dXJuICghKCdkZWxldGVkJyBpbiB2KSB8fCAoKGsgaW4gbW9kZWxDYWNoZSkpKTtcbiAgICAgICAgfSkudG9PYmplY3QoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICgnbTJtJyBpbiBkYXRhKSB7XG4gICAgICAgICAgICB2YXIgbTJtID0gZGF0YS5tMm07XG4gICAgICAgICAgICBkZWxldGUgZGF0YVsnbTJtJ107XG4gICAgICAgIH1cbiAgICAgICAgTGF6eShkYXRhKS5lYWNoKGZ1bmN0aW9uIChkYXRhLCBtb2RlbE5hbWUpIHtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmRlc2NyaWJlKG1vZGVsTmFtZSwgZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsQ2xhc3MgPSBtb2RlbDtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5yZXN1bHRzICYmIChkYXRhLnJlc3VsdHMubGVuZ3RoID4gMCkgJiYgKGRhdGEucmVzdWx0c1swXS5jb25zdHJ1Y3RvciA9PSBBcnJheSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5yZXN1bHRzID0gTGF6eShkYXRhLnJlc3VsdHMpLm1hcChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBMYXp5KG1vZGVsQ2xhc3MuZmllbGRzT3JkZXIpLnppcCh4KS50b09iamVjdCgpXG4gICAgICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBMYXp5KGRhdGEucmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgdmFyIGRlbGV0ZWQgPSBkYXRhLmRlbGV0ZWQ7XG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBQQSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgTVBBID0gUEFbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgTGF6eShyZXN1bHRzKS5lYWNoKGZ1bmN0aW9uIChyZWNvcmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWNvcmQuaWQgaW4gTVBBKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTGF6eShNUEFbcmVjb3JkLmlkXSkuZWFjaChmdW5jdGlvbiAodiwgaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNvcmRba10gPSB2O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGluZGV4aW5nIHJlZmVyZW5jZXMgYnkgaXRzIElEXG4gICAgICAgICAgICAgICAgdmFyIGl0YWIgPSBnZXRJbmRleChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciB0YWJsZSA9IGl0YWIuc291cmNlO1xuXG4gICAgICAgICAgICAgICAgLy8gb2JqZWN0IGRlbGV0aW9uXG4gICAgICAgICAgICAgICAgaWYgKGRlbGV0ZWQpe1xuICAgICAgICAgICAgICAgICAgICBkZWxldGVkLmZvckVhY2goZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFibGVbeF07XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuLypcbiAgICAgICAgICAgICAgICBMYXp5KGRlbGV0ZWQpLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRhYmxlW3hdO1xuICAgICAgICAgICAgICAgIH0pO1xuKi9cbiAgICAgICAgICAgICAgICB2YXIgaWR4ID0gcmVzdWx0cy5pbmRleEJ5KCdpZCcpO1xuICAgICAgICAgICAgICAgIHZhciBpayA9IGlkeC5rZXlzKCk7XG4gICAgICAgICAgICAgICAgdmFyIG5uZXcgPSBpay5kaWZmZXJlbmNlKGl0YWIua2V5cygpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoeClcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWQgPSBpay5kaWZmZXJlbmNlKG5uZXcpO1xuICAgICAgICAgICAgICAgIC8vIHJlbW92aW5nIG9sZCBpZGVudGljYWwgdmFsdWVzXG4gICAgICAgICAgICAgICAgdXBkYXRlZCA9IHVwZGF0ZWQuZmlsdGVyKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhdXRpbHMuc2FtZUFzKGlkeC5nZXQoeCksIGl0YWIuZ2V0KHgpLmFzUmF3KCkpO1xuICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAvLyBjbGFzc2lmeSByZWNvcmRzXG4gICAgICAgICAgICAgICAgdmFyIHBlcm1zID0gZGF0YS5wZXJtaXNzaW9ucyA/IExhenkoZGF0YS5wZXJtaXNzaW9ucykgOiBMYXp5KHt9KTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3T2JqZWN0cyA9IG5uZXcubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgbW9kZWxDbGFzcyhpZHguZ2V0KHgpLCBwZXJtcy5nZXQoeCkpXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLy8vIGNsYXNzaWZ5aW5nIHVwZGF0ZWRcbiAgICAgICAgICAgICAgICAvL3ZhciB1cGRhdGVkT2JqZWN0cyA9IHVwZGF0ZWQubWFwKGZ1bmN0aW9uKHgpe3JldHVybiBuZXcgbW9kZWxDbGFzcyhpZHguZ2V0KHgpLHBlcm1zLmdldCh4KSl9KTtcbiAgICAgICAgICAgICAgICAvL3ZhciB1byA9IHVwZGF0ZWRPYmplY3RzLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAvL3VwZGF0ZWRPYmplY3RzID0gTGF6eSh1bykubWFwKGZ1bmN0aW9uKHgpe3JldHVybiBbeCx0YWJsZVt4LmlkXV19KS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgLy8gVXBkYXRpbmcgc2luZ2xlIG9iamVjdHNcbiAgICAgICAgICAgICAgICB2YXIgY2hhbmdlZCA9IFtdO1xuLy8gICAgICAgICAgICAgICAgdmFyIERBVEVGSUVMRFMgPSBNT0RFTF9EQVRFRklFTERTW21vZGVsTmFtZV07XG4vLyAgICAgICAgICAgICAgICB2YXIgQk9PTEZJRUxEUyA9IE1PREVMX0JPT0xGSUVMRFNbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWxSZWZlcmVuY2VzID0gTGF6eShtb2RlbC5yZWZlcmVuY2VzKS5tYXAoZnVuY3Rpb24oaykgeyByZXR1cm4gW2ssMV19KS50b09iamVjdCgpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZWQuZm9yRWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkSXRlbSA9IHRhYmxlW3hdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkQ29weSA9IG9sZEl0ZW0uY29weSgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3SXRlbSA9IGlkeC5nZXQoeCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGluZyBlYWNoIGF0dHJpYnV0ZSBzaW5ndWxhcmx5XG5cbiAgICAgICAgICAgICAgICAgICAgTGF6eShtb2RlbC5maWVsZHMpLmVhY2goZnVuY3Rpb24oZmllbGQsIGZpZWxkTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGZpZWxkLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdyZWZlcmVuY2UnIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRJdGVtWydfJyArIGZpZWxkTmFtZV0gPSBuZXdJdGVtW2ZpZWxkTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5hTiBpcyBjb252bnRpb25hbGx5IGEgY2FjaGUgZGVsZXRlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRJdGVtW2ZpZWxkTmFtZV0gPSBOYU47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdkYXRlJzoge29sZEl0ZW1bZmllbGROYW1lXSA9IG5ldyBEYXRlKG5ld0l0ZW1bZmllbGROYW1lXSAqIDEwMDApOyBicmVha307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGF0ZXRpbWUnOiB7b2xkSXRlbVtmaWVsZE5hbWVdID0gbmV3IERhdGUobmV3SXRlbVtmaWVsZE5hbWVdICogMTAwMCk7IGJyZWFrfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib29sZWFuJyA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChuZXdJdGVtW2ZpZWxkTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgbnVsbCA6IHsgb2xkSXRlbVtmaWVsZE5hbWVdID0gbnVsbDsgYnJlYWs7IH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdUJyA6IHsgb2xkSXRlbVtmaWVsZE5hbWVdID0gdHJ1ZTsgYnJlYWs7IH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdGJyA6IHsgb2xkSXRlbVtmaWVsZE5hbWVdID0gZmFsc2U7IGJyZWFrOyB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSB0cnVlIDogeyBvbGRJdGVtW2ZpZWxkTmFtZV0gPSB0cnVlOyBicmVhazsgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgZmFsc2UgOiB7IG9sZEl0ZW1bZmllbGROYW1lXSA9IGZhbHNlOyBicmVhazsgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHtvbGRJdGVtW2ZpZWxkTmFtZV0gPSBuZXdJdGVtW2ZpZWxkTmFtZV19XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICAgICAgICAgICAgIG9sZEl0ZW1bZmllbGROYW1lXSA9IG5ld0l0ZW1bZmllbGROYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWQucHVzaChbbmV3SXRlbSwgb2xkQ29weV0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8vLyBzZW5kaW5nIHNpZ25hbCBmb3IgdXBkYXRlZCB2YWx1ZXNcbiAgICAgICAgICAgICAgICBpZiAoY2hhbmdlZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgndXBkYXRlZC0nICsgbW9kZWxOYW1lLCBjaGFuZ2VkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8qKioqKioqKiBVcGRhdGUgdW5pdmVyc2UgKioqKioqKipcbiAgICAgICAgICAgICAgICB2YXIgbm8gPSBuZXdPYmplY3RzLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICBMYXp5KG5vKS5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlW3guaWRdID0geFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIHJlYnVsZGluZyByZXZlcnNlIGluZGV4ZXNcbiAgICAgICAgICAgICAgICBMYXp5KG1vZGVsQ2FjaGVbbW9kZWxOYW1lXS5yZWZlcmVuY2VzKS5lYWNoKGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgUkVWSURYW21vZGVsTmFtZSArICcuJyArIHJlZl0gPSBJREJbbW9kZWxOYW1lXS5ncm91cEJ5KCdfJyArIHJlZik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gc2VuZGluZyBldmVudHMgZm9yIG5ldyB2YWx1ZXNcbiAgICAgICAgICAgICAgICBpZiAobm8ubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCduZXctJyArIG1vZGVsTmFtZSwgTGF6eShubyksIGRhdGEudG90YWxSZXN1bHRzKTtcbiAgICAgICAgICAgICAgICBpZiAoZGVsZXRlZCkge1xuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCdkZWxldGVkLScgKyBtb2RlbE5hbWUsIGRlbGV0ZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBzZW5kaW5nIGV2ZW50cyBmb3IgZGF0YSBhcnJpdmVkXG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgncmVjZWl2ZWQtJyArIG1vZGVsTmFtZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbi8qICAgICAgICBcbiAgICAgICAgaWYgKFRPT05FKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdUT09ORScpO1xuICAgICAgICAgICAgTGF6eShUT09ORSkuZWFjaChmdW5jdGlvbiAodmFscywgbW9kZWxOYW1lKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cobW9kZWxOYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgdWR4ID0gZ2V0VW5saW5rZWQobW9kZWxOYW1lKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChUT01BTlkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RPTUFOWScpO1xuICAgICAgICAgICAgTGF6eShUT01BTlkpLmVhY2goZnVuY3Rpb24gKHZhbHMsIGluZGV4TmFtZSkge1xuICAgICAgICAgICAgICAgIGlmICghKGluZGV4TmFtZSBpbiBBU0tFRF9VTkxJTktFRCkpIHtcbiAgICAgICAgICAgICAgICAgICAgQVNLRURfVU5MSU5LRURbaW5kZXhOYW1lXSA9IExhenkoW10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBMYXp5KHZhbHMpLmVhY2goZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIEFTS0VEX1VOTElOS0VEW2luZGV4TmFtZV0uc291cmNlLnB1c2goaWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE1BTllUT01BTlkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ01BTllUT01BTlknKTtcbiAgICAgICAgICAgIExhenkoTUFOWVRPTUFOWSkuZWFjaChmdW5jdGlvbiAodmFscywgaW5kZXhOYW1lKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0ID0gcGFyc2VJbnQoaW5kZXhOYW1lLnNwbGl0KCd8JylbMV0pO1xuICAgICAgICAgICAgICAgIGluZGV4TmFtZSA9IGluZGV4TmFtZS5zcGxpdCgnfCcpWzBdO1xuICAgICAgICAgICAgICAgIGlmICghKGluZGV4TmFtZSBpbiBBU0tFRF9NMk0pKSB7XG4gICAgICAgICAgICAgICAgICAgIEFTS0VEX00yTVtpbmRleE5hbWVdID0gW3t9LCB7fV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBNSURYID0gQVNLRURfTTJNW2luZGV4TmFtZV1bZmlyc3RdO1xuICAgICAgICAgICAgICAgIExhenkodmFscykuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICBNSURYW3ggKyAnJ10gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBNSURYW3hdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICBcbiovXG4gICAgICAgIGlmIChtMm0pIHtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdE0yTShtMm0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChQRVJNSVNTSU9OUykge1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290UGVybWlzc2lvbnMoUEVSTUlTU0lPTlMpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNhbGxCYWNrKSB7XG4gICAgICAgICAgICBjYWxsQmFjayhkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCdnb3QtZGF0YScpO1xuICAgIH07XG4gICAgdGhpcy5nb3RQZXJtaXNzaW9ucyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIExhenkoZGF0YSkuZWFjaChmdW5jdGlvbiAodiwgcmVzb3VyY2VOYW1lKSB7XG4gICAgICAgICAgICBMYXp5KHZbMF0pLmVhY2goZnVuY3Rpb24gKHJvdywgaWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoKHJlc291cmNlTmFtZSBpbiBJREIpICYmIChpZCBpbiBJREJbcmVzb3VyY2VOYW1lXS5zb3VyY2UpKXtcbiAgICAgICAgICAgICAgICAgICAgSURCW3Jlc291cmNlTmFtZV0uZ2V0KGlkKS5fcGVybWlzc2lvbnMgPSBMYXp5KHJvdykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3gsIHRydWVdXG4gICAgICAgICAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoTGF6eSh2WzBdKS5zaXplKCkpe1xuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ3VwZGF0ZS1wZXJtaXNzaW9ucy0nICsgcmVzb3VyY2VOYW1lLCBMYXp5KHZbMF0pLmtleXMoKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5lbWl0KCd1cGRhdGUtcGVybWlzc2lvbnMnKTtcbiAgICB9O1xuXG5cbiAgICB0aGlzLmdvdE0yTSA9IGZ1bmN0aW9uKG0ybSl7XG4gICAgICAgIExhenkobTJtKS5lYWNoKGZ1bmN0aW9uKGRhdGEsIGluZGV4TmFtZSl7XG4gICAgICAgICAgICB2YXIgbTJtSW5kZXggPSBsaW5rZXIubTJtSW5kZXhbaW5kZXhOYW1lXTtcbiAgICAgICAgICAgIExhenkoZGF0YSkuZWFjaChmdW5jdGlvbihtKXtcbiAgICAgICAgICAgICAgICBMYXp5KG0pLmVhY2goZnVuY3Rpb24oZGF0YSx2ZXJiKXtcbiAgICAgICAgICAgICAgICAgICAgbTJtSW5kZXhbdmVyYl0oZGF0YSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ3JlY2VpdmVkLW0ybScpO1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgncmVjZWl2ZWQtbTJtLScgKyBpbmRleE5hbWUpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLmZldGNoID0gZnVuY3Rpb24gKG1vZGVsTmFtZSwgZmlsdGVyLCB0b2dldGhlciwgY2FsbEJhY2spIHsgIC8vXG4gICAgICAgIC8vIGlmIGEgY29ubmVjdGlvbiBpcyBjdXJyZW50bHkgcnVubmluZywgd2FpdCBmb3IgY29ubmVjdGlvbi5cbiAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiB3YWl0aW5nQ29ubmVjdGlvbnMpe1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmZldGNoKG1vZGVsTmFtZSwgZmlsdGVyLCB0b2dldGhlciwgY2FsbEJhY2spO1xuICAgICAgICAgICAgfSw1MDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZmV0Y2hpbmcgYXN5bmNocm9tb3VzIG1vZGVsIGZyb20gc2VydmVyXG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5kZXNjcmliZShtb2RlbE5hbWUsIChmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgICAgICAgICAgLy8gaWYgZGF0YSBjYW1lcyBmcm9tIHJlYWx0aW1lIGNvbm5lY3Rpb25cbiAgICAgICAgICAgICAgICBpZiAoVzJQUkVTT1VSQ0UuY29ubmVjdGlvbi5jYWNoZWRTdGF0dXMucmVhbHRpbWVFbmRQb2ludCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBnZXR0aW5nIGZpbHRlciBmaWx0ZXJlZCBieSBjYWNoaW5nIHN5c3RlbVxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXIgPSBsaXN0Q2FjaGUuZmlsdGVyKG1vZGVsLGZpbHRlcik7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgc29tdGhpbmcgaXMgbWlzc2luZyBvbiBteSBsb2NhbCBEQiBcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbHRlcil7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhc2sgZm9yIG1pc3NpbmdzIGFuZCBwYXJzZSBzZXJ2ZXIgcmVzcG9uc2UgaW4gb3JkZXIgdG8gZW5yaWNoIG15IGxvY2FsIERCLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGxhY2luZyBsb2NrIGZvciB0aGlzIG1vZGVsXG4gICAgICAgICAgICAgICAgICAgICAgICB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdChtb2RlbE5hbWUgKyAnL2xpc3QnLCB7ZmlsdGVyIDogZmlsdGVyfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShkYXRhLGNhbGxCYWNrKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZWxlYXNlIGxvY2tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHdhaXRpbmdDb25uZWN0aW9uc1ttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJldCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbGVhc2UgbG9ja1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2FpdGluZ0Nvbm5lY3Rpb25zW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmaWx0ZXI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcG9zdChtb2RlbE5hbWUgKyAnL2xpc3QnLCBzZW5kRGF0YSxmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZmlsdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdPVF9BTEwuc291cmNlLnB1c2gobW9kZWxOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShkYXRhLCBjYWxsQmFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmdldCA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgaWRzLCBjYWxsQmFjayl7XG4gICAgICAgIC8vIHNlYXJjaCBvYmplY3RzIGZyb20gSURCLiBJZiBzb21lIGlkIGlzIG1pc3NpbmcsIGl0IHJlc29sdmUgaXQgYnkgdGhlIHNlcnZlclxuICAgICAgICAvLyBpZiBhIHJlcXVlc3QgdG8gdGhlIHNhbWUgbW9kZWwgaXMgcGVuZGluZywgd2FpdCBmb3IgaXRzIGNvbXBsZXRpb25cbiAgICAgICAgXG4gICAgICAgIGlmIChpZHMuY29uc3RydWN0b3IgIT09IEFycmF5KXtcbiAgICAgICAgICAgIGlkcyA9IFtpZHNdO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIHNvbWUgZW50aXR5IGlzIG1pc3NpbmcgXG4gICAgICAgIFcyUFJFU09VUkNFLmZldGNoKG1vZGVsTmFtZSAsIHtpZDogaWRzfSwgbnVsbCxmdW5jdGlvbigpe1xuICAgICAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICAgICAgdmFyIGl0YWIgPSBJREJbbW9kZWxOYW1lXVxuICAgICAgICAgICAgZm9yICh2YXIgaWQgaW4gaWRzKXtcbiAgICAgICAgICAgICAgICByZXQucHVzaChpdGFiLnNvdXJjZVtpZHNbaWRdXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYWxsQmFjayhyZXQpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdGhpcy5nb3RNb2RlbCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGZvciAodmFyIG1vZGVsTmFtZSBpbiBkYXRhKSB7XG4gICAgICAgICAgICB2YXIgbW9kZWwgPSBkYXRhW21vZGVsTmFtZV07XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2VbJ2Rlc2NyaXB0aW9uOicgKyBtb2RlbE5hbWVdID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG4gICAgICAgICAgICBtb2RlbENhY2hlW21vZGVsTmFtZV0gPSBtYWtlTW9kZWxDbGFzcyhtb2RlbCk7XG4gICAgICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gSURCKSkge1xuICAgICAgICAgICAgICAgIElEQlttb2RlbE5hbWVdID0gTGF6eSh7fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5kZXNjcmliZSA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgY2FsbEJhY2spe1xuICAgICAgICB2YXIgcmV0ID0gbW9kZWxDYWNoZVttb2RlbE5hbWVdO1xuICAgICAgICBpZiAocmV0KSB7XG4gICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayhyZXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKCEobW9kZWxOYW1lIGluIHdhaXRpbmdDb25uZWN0aW9ucykpe1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gZmFpbGVkTW9kZWxzKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjYWNoZUtleSA9ICdkZXNjcmlwdGlvbjonICsgbW9kZWxOYW1lO1xuICAgICAgICAgICAgICAgIGlmIChjYWNoZUtleSBpbiBsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nb3RNb2RlbChKU09OLnBhcnNlKGxvY2FsU3RvcmFnZVtjYWNoZUtleV0pKTtcbiAgICAgICAgICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2sobW9kZWxDYWNoZVttb2RlbE5hbWVdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJHBvc3QobW9kZWxOYW1lICsgJy9kZXNjcmliZScsbnVsbCwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3RNb2RlbChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKG1vZGVsQ2FjaGVbbW9kZWxOYW1lXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2FpdGluZ0Nvbm5lY3Rpb25zW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2RlbE5vdEZvdW5kLmhhbmRsZShtb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbGVkTW9kZWxzW21vZGVsTmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHdhaXQgZm9yIGNvbm5lY3Rpb25cbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmRlc2NyaWJlKG1vZGVsTmFtZSwgY2FsbEJhY2spO1xuICAgICAgICAgICAgICAgIH0sIDUwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gICAgICAgIFxuICAgIH07XG4gICAgdGhpcy5hZGRNb2RlbEhhbmRsZXIgPSBmdW5jdGlvbiAobW9kZWxOYW1lLCBkZWNvcmF0b3IpIHtcbiAgICAgICAgdmFyIGtleSA9IHV0aWxzLmhhc2goZGVjb3JhdG9yKTtcbiAgICAgICAgaWYgKCEobW9kZWxOYW1lIGluIGJ1aWxkZXJIYW5kbGVycykpIGJ1aWxkZXJIYW5kbGVyc1ttb2RlbE5hbWVdID0gbmV3IEhhbmRsZXIoKTtcbiAgICAgICAgaWYgKCEobW9kZWxOYW1lIGluIGJ1aWxkZXJIYW5kbGVyVXNlZCkpIGJ1aWxkZXJIYW5kbGVyVXNlZFttb2RlbE5hbWVdID0ge307XG4gICAgICAgIGlmIChrZXkgaW4gYnVpbGRlckhhbmRsZXJVc2VkW21vZGVsTmFtZV0pe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVpbGRlckhhbmRsZXJVc2VkW21vZGVsTmFtZV1ba2V5XSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBtb2RlbENhY2hlKSB7XG4gICAgICAgICAgICBkZWNvcmF0b3IobW9kZWxDYWNoZVttb2RlbE5hbWVdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1aWxkZXJIYW5kbGVyc1ttb2RlbE5hbWVdLmFkZEhhbmRsZXIoZGVjb3JhdG9yKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5hZGRQZXJzaXN0ZW50QXR0cmlidXRlcyA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgYXR0cmlidXRlcyl7XG4gICAgICAgIHZhciBhZGRQcm9wZXJ0eSA9IGZ1bmN0aW9uKG1vZGVsLCBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbCl7XG4gICAgICAgICAgICB2YXIga2V5ID0gJ3BBOicgKyBtb2RlbC5tb2RlbE5hbWUgKyAnOicgKyB2YWw7XG4gICAgICAgICAgICB2YXIga2F0dHIgPSAnX18nICsgdmFsO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZGVsLnByb3RvdHlwZSwgdmFsLCB7XG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZiAoIShrYXR0ciBpbiB0aGlzKSl7XG4gICAgICAgICAgICAgICAgICB2YXIgdiA9IGxvY2FsU3RvcmFnZVtrZXkgKyB0aGlzLmlkXTtcbiAgICAgICAgICAgICAgICAgIHRoaXNba2F0dHJdID0gdj9KU09OLnBhcnNlKHYpOm51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW2thdHRyXTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgICAgICAgICAgdGhpc1trYXR0cl0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Vba2V5ICsgdGhpcy5pZF0gPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gcGVyc2lzdGVudEF0dHJpYnV0ZXMpKSB7IHBlcnNpc3RlbnRBdHRyaWJ1dGVzW21vZGVsTmFtZV0gPSBbXTsgfVxuICAgICAgICB2YXIgYXR0cnMgPSBwZXJzaXN0ZW50QXR0cmlidXRlc1ttb2RlbE5hbWVdO1xuICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgdmFyIG5ld0F0dHJzID0gTGF6eShhdHRyaWJ1dGVzKS5kaWZmZXJlbmNlKGF0dHJzKS50b0FycmF5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgbmV3QXR0cnMgPSBhdHRycztcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3QXR0cnMubGVuZ3RoKXtcbiAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gbW9kZWxDYWNoZSl7XG4gICAgICAgICAgICAgICAgYWRkUHJvcGVydHkobW9kZWxDYWNoZVttb2RlbE5hbWVdLCBuZXdBdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcyl7XG4gICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoYXR0cnMsbmV3QXR0cnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICB0aGlzLm9uKCduZXctbW9kZWwnLCBmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgIGlmIChtb2RlbC5tb2RlbE5hbWUgaW4gYnVpbGRlckhhbmRsZXJzKXtcbiAgICAgICAgICAgIGJ1aWxkZXJIYW5kbGVyc1ttb2RlbC5tb2RlbE5hbWVdLmhhbmRsZShtb2RlbENhY2hlW21vZGVsLm1vZGVsTmFtZV0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb2RlbC5tb2RlbE5hbWUgaW4gcGVyc2lzdGVudEF0dHJpYnV0ZXMpe1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuYWRkUGVyc2lzdGVudEF0dHJpYnV0ZXMobW9kZWwubW9kZWxOYW1lKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5xdWVyeSA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgZmlsdGVyLCB0b2dldGhlciwgY2FsbEJhY2spe1xuICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgdGhpcy5kZXNjcmliZShtb2RlbE5hbWUsZnVuY3Rpb24obW9kZWwpe1xuICAgICAgICAgICAgLy8gYXJyYXlmaXkgYWxsIGZpbHRlciB2YWx1ZXNcbiAgICAgICAgICAgIGZpbHRlciA9IExhenkoZmlsdGVyKS5tYXAoZnVuY3Rpb24odixrKXsgcmV0dXJuIFtrLEFycmF5LmlzQXJyYXkodik/djpbdl1dfSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgIHZhciBmaWx0ZXJGdW5jdGlvbiA9IHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICB2YXIgaWR4ID0gZ2V0SW5kZXgobW9kZWxOYW1lKTtcbiAgICAgICAgICAgIHRocy5mZXRjaChtb2RlbE5hbWUsZmlsdGVyLHRvZ2V0aGVyLCBmdW5jdGlvbihlKXtcbiAgICAgICAgICAgICAgICBjYWxsQmFjayhpZHguZmlsdGVyKGZpbHRlckZ1bmN0aW9uKS52YWx1ZXMoKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgfTtcbiAgICB0aGlzLmRlbGV0ZSA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgaWRzLCBjYWxsQmFjayl7XG4gICAgICAgIHJldHVybiB0aGlzLiRwb3N0KG1vZGVsTmFtZSArICcvZGVsZXRlJywgeyBpZCA6IGlkc30sIGNhbGxCYWNrKTtcbiAgICB9O1xuXG4gICAgdGhpcy5jb25uZWN0ID0gZnVuY3Rpb24gKGNhbGxCYWNrKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbm5lY3Rpb24uaXNMb2dnZWRJbikge1xuICAgICAgICAgICAgY2FsbEJhY2soKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdGlvbi5jb25uZWN0KGNhbGxCYWNrKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmZ1bmN0aW9uIHJlV2hlZWxPUk0oZW5kUG9pbnQsIGxvZ2luRnVuYyl7XG4gICAgdGhpcy4kb3JtID0gbmV3IGJhc2VPUk0obmV3IHV0aWxzLnJlV2hlZWxDb25uZWN0aW9uKGVuZFBvaW50LCBsb2dpbkZ1bmMpLHRoaXMpO1xuICAgIHRoaXMub24gPSB0aGlzLiRvcm0ub24uYmluZCh0aGlzLiRvcm0pO1xuICAgIHRoaXMuZW1pdCA9IHRoaXMuJG9ybS5lbWl0LmJpbmQodGhpcy4kb3JtKTtcbiAgICB0aGlzLnVuYmluZCA9IHRoaXMuJG9ybS51bmJpbmQuYmluZCh0aGlzLiRvcm0pO1xuICAgIHRoaXMub25jZSA9IHRoaXMuJG9ybS5vbmNlO1xuICAgIHRoaXMuYWRkTW9kZWxIYW5kbGVyID0gdGhpcy4kb3JtLmFkZE1vZGVsSGFuZGxlci5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy5hZGRQZXJzaXN0ZW50QXR0cmlidXRlcyA9IHRoaXMuJG9ybS5hZGRQZXJzaXN0ZW50QXR0cmlidXRlcy5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy51dGlscyA9IHV0aWxzO1xuICAgIHRoaXMubG9nb3V0ID0gdGhpcy4kb3JtLmNvbm5lY3Rpb24ubG9nb3V0LmJpbmQodGhpcy4kb3JtLmNvbm5lY3Rpb24pO1xufVxuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgY29ubmVjdGlvbiA9IHRoaXMuJG9ybS5jb25uZWN0aW9uO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24oY2FsbEJhY2sscmVqZWN0KXtcbiAgICAgICAgY29ubmVjdGlvbi5jb25uZWN0KGNhbGxCYWNrKTtcbiAgICB9KSk7XG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihhY2NlcHQscmVqZWN0KXtcbiAgICAgICAgdGhpcy4kb3JtLmNvbm5lY3Rpb24ubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkLCBhY2NlcHQpOyAgICBcbiAgICB9KS5iaW5kKHRoaXMpKTtcbiAgICBcbn07XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmxvZ291dCA9IGZ1bmN0aW9uKHVybCl7XG4gICAgcmV0dXJuIHRoaXMuJG9ybS5jb25uZWN0aW9uLmxvZ291dCgpO1xufVxuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5nZXRNb2RlbCA9IGZ1bmN0aW9uKG1vZGVsTmFtZSl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBzZWxmLiRvcm0uY29ubmVjdChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5kZXNjcmliZShtb2RlbE5hbWUsYWNjZXB0KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gY2F0Y2goZSkge1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9XG4gICAgfSlcbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24obW9kZWxOYW1lLCBpZHMpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgc2luZ2xlID0gZmFsc2U7XG4gICAgdmFyIG1vZE5hbWUgPSBtb2RlbE5hbWU7XG4gICAgdmFyIGZpbHRlcjtcbiAgICBpZiAodHlwZW9mIGlkcyA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgc2luZ2xlID0gdHJ1ZTtcbiAgICAgICAgZmlsdGVyID0geyBpZCA6IFtpZHNdfTtcbiAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaWRzKSl7XG4gICAgICAgIGZpbHRlciA9IHsgaWQgOiBpZHMgfTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBpZHMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGZpbHRlciA9IGlkcztcbiAgICB9IGVsc2UgaWYgKGlkcyA9PT0gbnVsbCkge1xuICAgICAgICBmaWx0ZXIgPSB7fTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgc2VsZi4kb3JtLmNvbm5lY3QoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBzZWxmLiRvcm0ucXVlcnkobW9kZWxOYW1lLCBmaWx0ZXIsIG51bGwsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNpbmdsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0KGRhdGEubGVuZ3RoID8gZGF0YVswXSA6IG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0KGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn07XG5cbi8qXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5xdWVyeSA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIGZpbHRlciwgcmVsYXRlZCl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCl7XG4gICAgICAgIHZhciB0b2dldGhlciA9IG51bGw7XG4gICAgICAgIGlmIChyZWxhdGVkICYmIChyZWxhdGVkLmNvbnN0cnVjdG9yID09PSBBcnJheSkgJiYgKHJlbGF0ZWQubGVuZ3RoKSl7XG4gICAgICAgICAgICB0b2dldGhlciA9IHJlbGF0ZWQ7XG4gICAgICAgIH0gZWxzZSBpZiAocmVsYXRlZCAmJiAocmVsYXRlZC5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSAmJiAocmVsYXRlZC5sZW5ndGgpKXtcbiAgICAgICAgICAgIHRvZ2V0aGVyID0gcmVsYXRlZC5zcGxpdCgnLCcpO1xuICAgICAgICB9XG4gICAgICAgIHRyeXtcbiAgICAgICAgICAgIHNlbGYuJG9ybS5jb25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgc2VsZi4kb3JtLnF1ZXJ5KG1vZGVsTmFtZSwgZmlsdGVyLCB0b2dldGhlciwgYWNjZXB0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfVxuICAgIH0pXG59O1xuKi9cblxucmVXaGVlbE9STS5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKG1vZGVsTmFtZSwgaWRzKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgc2VsZi4kb3JtLmNvbm5lY3QoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBzZWxmLiRvcm0uZGVsZXRlKG1vZGVsTmFtZSwgaWRzLCBhY2NlcHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9XG4gICAgfSlcbn07XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmdldExvZ2dlZFVzZXIgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgaWYgKHRoaXMuJG9ybS5jb25uZWN0aW9uLmNhY2hlZFN0YXR1cy51c2VyX2lkKVxuICAgICAgICByZXR1cm4gdGhpcy5nZXQoJ2F1dGhfdXNlcicsdGhpcy4kb3JtLmNvbm5lY3Rpb24uY2FjaGVkU3RhdHVzLnVzZXJfaWQpO1xuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3QpIHtcbiAgICAgICAgICAgIHNlbGYub25jZSgnbG9nZ2VkLWluJyxmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5nZXQoJ2F1dGhfdXNlcicsIHVzZXIpLnRoZW4oYWNjZXB0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLiRzZW5kVG9FbmRwb2ludCA9IGZ1bmN0aW9uICh1cmwsIGRhdGEpe1xuICAgIHJldHVybiB0aGlzLiRvcm0uJHBvc3QodXJsLCBkYXRhKTtcbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpe1xuICAgIHJldHVybiB0aGlzLiRvcm0uY29ubmVjdGlvbi5sb2dpbih1c2VybmFtZSxwYXNzd29yZCk7XG59XG4iXX0=
