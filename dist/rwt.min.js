!function(t,e,n){"use strict";function i(){this.handlers=[],this.strHandlers={}}function o(){var t={},n={},i=0;if(this.on=function(e,o){e in t||(t[e]=new Array);var r=i++;return t[e].push(o),n[r]=o,r},this.emit=function(e){if(e in t){var n=Array.prototype.slice.call(arguments,1);t[e].forEach(function(t){t.apply(null,n)})}},this.unbind=function(i){var o=0;if(i in n){var r=n[i+""];e(t).each(function(t,e){var n=[];for(var i in t)t[i]===r&&(n.push(i),o++);n.reverse().forEach(function(e){t.splice(e,1)})})}return delete n[i],o},this.once=function(t,e){var n=this,i=this.on(t,function(){e.apply(this,arguments),n.unbind(i)})},"DEBUG"in window){var o=this.emit;this.emit=function(){var t=Array.prototype.slice.call(arguments,0);return o.apply(this,t)}.bind(this)}}function r(t,e){var i=new n(t);i.onopen=function(t){console.log("open : websocket"),i.tenant(),e.emit("realtime-connection-open",t)},i.onmessage=function(t){if("message"==t.type)try{e.emit("realtime-message-json",JSON.parse(t.data))}catch(n){e.emit("realtime-message-text",JSON.parse(t.data))}else console.log("from realtime ",t)},i.onclose=function(){setTimeout(w.wsConnect,1e3),e.emit("realtime-connection-closed")},i.tenant=function(){i.send("TENANT:"+e.cachedStatus.application+":"+e.cachedStatus.token)},this.close=function(){i.close()}}function s(t,e){var n=new o;this.getLogin=e,this.endPoint=t.endsWith("/")?t:t+"/",this.on=n.on,this.unbind=n.unbind,this.emit=n.emit,this.once=n.once,this.cachedStatus={},this.isConnected=!1,this.isLoggedIn=!1}function a(){var t=!1;this.touch=function(){t=!0},this.touched=function(){var e=t;return t=!1,e}}function c(t,n,i,o){if(!n)var n=[];var r=[];this.ask=function(i,s){o&&i in o.source||e(n).contains(i)||(r.push(i),s||n.push(i),t.touch())},this.getAskedIndex=function(){return n},this.missings=function(){return e(r.splice(0,r.length)).unique().toArray()}}function u(t,n,i,o){var r=new a,s={},u={},l={},f={},h={};this.mainIndex=s,this.foreignKeys=u,this.m2m=l,this.m2mIndex=f,this.permissions=h,i.on("model-definition",function(t,n){var i=o.getIndexFor(t.name,"id");s[t.name]=new c(r,i,"mainIndex."+t.name,n),h[t.name]=new c(r,null,"permissions."+t.name),e(t.references).each(function(e){var n=t.name+"_"+e.id;u[n]=new c(r,o.getIndexFor(e.to,"id"),e.to+".id foreignKeys."+n)}),e(t.referencedBy).each(function(t){var e=t.by+"."+t.id;u[e]=new c(r,o.getIndexFor(t.by,t.id),t.by+"."+t.id+" foreignKeys."+e)}),e(t.manyToMany).each(function(t){t.indexName in l||(l[t.indexName]=[new c(r,null,"m2m."+t.indexName+"[0]"),new c(r,null,"m2m."+t.indexName+"[1]")]),t.indexName in f||(f[t.indexName]=new d(t,l[t.indexName]))})});var p=function(e,n,o,r){i.$post((n?w.reverse("/",e):e)+"s/list",{collection:o},function(n){i.gotData(n,r),delete t[e]})},m=function(n,i,o,r){e(i).each(l[n][o].ask.bind(l[n][o])),i=l[n][o].missings(),i.length?(t[n]=1,p(n,o,i,r)):r&&r()};this.getM2M=m;var g=function(){if(r.touched()){if(e(t).values().sum())return void r.touch();var o=!1;e(l).each(function(t,n){e(t).each(function(t,r){var a=t.missings();if(a=e(a).filter(Boolean).map(function(t){return parseInt(t)}).toArray(),a.length){var c=f[n],u=c["get"+(1-r)].bind(c);o=!0,p(n,r,a,function(t){var o=a.map(u);if(o.length){var c=n.split("/")[1-r];i.describe(c,function(){e(o).flatten().unique().each(function(t){s[c].ask(t,!0)})})}})}})}),e(s).each(function(t,r){var s=t.missings();if(s.length){o=!0;r in n?n[r].keys():e();i.fetch(r,{id:s},null,w.noop)}}),e(u).map(function(t,e){return[e,t.missings()]}).filter(function(t){return t[1].length}).each(function(t){o=!0;var e=t[1],n=t[0],r=n.split("."),s=r[0],a=r[1],c={};c[a]=e,i.fetch(s,c)}),e(e(h).map(function(t,e){return[e,t.missings()]}).filter(function(t){return t[1].length}).toObject()).each(function(n,r){o=!0,n.length&&(t[r]=1,i.$post(r+"/my_perms",{ids:e(n).unique().toArray()},function(e){i.gotPermissions(e.PERMISSIONS),delete t[r]}))})}};setInterval(g,50)}function l(){function t(t){return t in i||(i[t]=new f),i[t]}var e={},n={},i={};this.filter=function(i,o){var r=i.modelName;return e[r]?null:0===_.size(o)?(e[r]=!0,r in n&&delete n[r],{}):t(r).getFilters(o)},this.getIndexFor=function(t,e){var i=t+"."+e;return i in n||(n[i]=[]),n[i]}}function f(){this.explodedFilters={id:[]},this.askedFilters=[]}function d(t,n){var i=[];this.add=i.push.bind(i),this.add=function(t){e(i).find(t)||i.push(t)},this.get0=function(t){return n[1].ask(t),e(i).filter(function(e){return e[0]===t}).pluck("1").toArray()},this.get1=function(t){return n[0].ask(t),e(i).filter(function(e){return e[1]===t}).pluck("0").toArray()},this["get"+w.capitalize(t.indexName.split("/")[1])]=this.get1,this["get"+w.capitalize(t.indexName.split("/")[0])]=this.get0,this.del=function(t){for(var e=i.length,n=null,o=0;o<e;o++)if(i[o][0]===t[0]&&i[o][1]===t[1]){n=o;break}n&&i.splice(o,1),console.log("deleting ",t)}}function h(t,n,i,o){var r=Array.prototype.slice.call(arguments,4),s={};e(r).each(function(e){t.orm.on(e,function(){s={}})});var a={get:function(){return this.id in s||(s[this.id]=i.call(this)),s[this.id]}};o&&(a.set=function(t){isFinite(t)?(o.call(this,t),this.id in s&&delete s[this.id]):this.id in s&&delete s[this.id]}),Object.defineProperty(t,n,a)}function p(t,e,n,o,r,s){var a=this,c=null,u=new i,l=t.$orm;this.updateData=u.addHandler.bind(u),this.items=[],l.describe(e,function(t){a.model=t,c=w.makeFilter(t,n)}),this.modelName=e,this.initialFilter=n,this.partial=o||!1;l.query(e,n,null,function(t){a.items=t}),t.on("updated-"+e,function(t){console.warn("collection update "+e,t)}),t.on("new-"+e,function(t){console.warn("collection new "+e,t),t=t.toArray(),a.items=_.union(a.items,t.filter(c)),u.handle(a)}),t.on("deleted-"+e,function(t){console.warn("collection delete "+e,t)})}function m(t){this.resource=t._resource,this.formIdx=t.formIdx,this.fields=t.errors}function g(t,e){this.$orm=new b(new w.reWheelConnection(t,e),this),this.on=this.$orm.on.bind(this.$orm),this.emit=this.$orm.emit.bind(this.$orm),this.unbind=this.$orm.unbind.bind(this.$orm),this.once=this.$orm.once,this.addModelHandler=this.$orm.addModelHandler.bind(this.$orm),this.addPersistentAttributes=this.$orm.addPersistentAttributes.bind(this.$orm),this.utils=w,this.logout=this.$orm.connection.logout.bind(this.$orm.connection)}i.prototype.addHandler=function(t){var e=w.hash(t.toString());e in this.strHandlers||(this.strHandlers[e]=t,this.handlers.push(t))},i.prototype.handle=function(){var t=Array.prototype.slice.call(arguments,0);this.handlers.forEach(function(e){e.apply(null,t)})},i.prototype.handleBy=function(){var t=Array.prototype.slice.call(arguments,1),e=arguments[0];this.handlers.forEach(function(n){n.apply(e,t)})};var y=0,v=function(){return""},w={renameFunction:function(t,e){return new Function("return function (call) { return function "+t+" () { return call(this, arguments) }; };")()(Function.apply.bind(e))},cached:function(t,e){function n(){return this[e]||(this[e]=t.call(this,[arguments])),this[e]}return e||(e="_"+y++),n},log:function(){console.log(arguments)},xdr:function(t,n,i,o,r){return new Promise(function(i,s){var a;n||(n={}),XMLHttpRequest?(a=new XMLHttpRequest,a.onreadystatechange=function(){if(4===a.readyState){try{var t=JSON.parse(a.responseText)}catch(e){var t=null}var e={responseData:t,responseText:a.responseText,status:a.status,request:a};a.status>=200&&a.status<400?i(e):s(e)}}):XDomainRequest?(a=new XDomainRequest,a.onload=function(){i(a.responseText,a.statusText,a)}):s(new Error("CORS not supported")),a.open("POST",t,!0),a.onerror=s,a.setRequestHeader("Accept","application/json"),o&&(n.__token__=o),r?(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n=e(n).map(function(t,e){return e+"="+encodeURI(t.toString())}).toArray().join("&")):(a.setRequestHeader("Content-Type","text/plain"),n=e(n).size()?JSON.stringify(n):""),a.send(n)})},capitalize:function(t){return t[0].toUpperCase()+t.slice(1).toLowerCase()},hash:function(t){t=t.toString();for(var e=1,n=0;n<t.length;n++)e*=1+t.charCodeAt(n);return(e%34958374957).toString()},makeFilter:function(t,n,i,o){if(i||(i=" && "),0===e(n).size())return function(t){return!0};var r=e(n).map(function(n,i){return n||(n=[null]),Array.isArray(n)||(n=[n]),o||"reference"!==t.fields[i].type?"string"===t.fields[i].type&&(n=n.map(JSON.stringify)):(i="_"+i,n=e(n).map(function(t){return t&&t.constructor!==Number?t.id:t}).toArray()),"("+e(n).map(function(t){return t?t===orm.utils.mock&&console.error("makeFilter with Mock Object"):console.error("makeFilter x is null"),"(x."+i+" === "+t+")"}).join(" || ")+")"}).toArray().join(i);return new Function("x","return "+r)},sameAs:function(t,e){for(var n in t)if(e[n]!=t[n])return!1;return!0},pluralize:function(t,e){return t+"s"},beforeCall:function(t,e){return function(){e().then(t)}},cleanStorage:function(){e(localStorage).keys().each(function(t){delete localStorage[t]})},cleanDescription:function(){e(localStorage).filter(function(t,n){return e(n).startsWith("description:")}).keys().each(function(t){delete localStorage[t]})},reverse:function(t,e){return e.split(t).reverse().join(t)},permutations:function(t){for(var e=[],n=t.length-1;n>=0;n--)for(var i=t.length-1;i>=0;i--)n!==i&&e.push([t[n],t[i]]);return e},waitFor:function(t,e){var n=function(){t()?e():setTimeout(n,500)};setTimeout(n,500)},bool:Boolean,noop:function(){},tzOffset:6e4*(new Date).getTimezoneOffset(),transFieldType:{date:function(t){return new Date(1e3*t+w.tzOffset)},datetime:function(t){return new Date(1e3*t+w.tzOffset)},string:function(t){return t.toString()},text:function(t){return t.toString()},integer:function(t){return parseInt(t)},float:function(t){return parseFloat(t)}},mock:function(){return new Proxy({},{get:function(t,e){return"string"==typeof e?"toString"===e?v:w.mock:t[e]}})}()};s.prototype.$post=function(t,e,n){var i=this;return new Promise(function(o,r){w.xdr(i.endPoint+t,e,i.cachedStatus.application,i.cachedStatus.token).then(function(r){i.emit("http-response",r.responseText,r.status,t,e),i.emit("http-response-"+r.status,r.responseText,t,e),r.responseData&&i.emit("http-response-"+r.status+"-json",r.responseData,t,e),n&&n(r.responseData||r.responseText),o(r.responseData||r.responseText)},function(n){n.responseData?(i.emit("error-json",n.responseData,n.status,t,e,n),i.emit("error-json-"+n.status,n.responseData,t,e,n)):(i.emit("error-http",n.responseText,n.status,t,e,n),i.emit("error-http-"+n.status,n.responseText,t,e,n)),r(n.responseData||n.responseText)})})},s.prototype.status=function(t,n){var i="token:"+this.endPoint,o=this;if(n&&(this.cachedStatus={},delete localStorage[i]),this.statusWaiting)return void w.waitFor(function(){return!o.statusWaiting},function(){o.status(t,n)});if(!e(this.cachedStatus).size()){var r={};return i in localStorage&&(r.__token__=localStorage[i]),this.statusWaiting=!0,void this.$post("api/status",r,function(e){o.updateStatus(e),localStorage[i]=e.token,t(e),o.statusWaiting=!1})}t(this.cachedStatus),t(this.cachedStatus)},s.prototype.updateStatus=function(t){(parseFloat(localStorage.lastBuild)||1)<t.last_build&&(w.cleanDescription(),localStorage.lastBuild=t.last_build),this.isConnected=Boolean(t.token),this.isLoggedIn=Boolean(t.user_id);var e=this.cachedStatus;if(this.cachedStatus=t,!e.user_id&&t.user_id)this.emit("logged-in",t.user_id);else if(e.user_id&&!t.user_id)this.emit("logged-out");else if(this.isConnected&&!this.isLoggedIn&&(this.emit("login-required"),this.getLogin)){var n=this.getLogin();n.constructor===Object?this.login(n.username,n.password,n.callBack):n.constructor===Promise&&n.then(function(t){this.login(t.username,t.password,t.callBack)})}!e.realtimeEndPoint&&t.realtimeEndPoint?this.wsConnection=new r(t.realtimeEndPoint,this):e.realtimeEndPoint&&!t.realtimeEndPoint&&(this.wsConnection.close(),delete this.wsConnection),this.emit("update-connection-status",t,e),localStorage.lastRWTConnectionStatus=JSON.stringify(t)},s.prototype.login=function(t,e){var n=this;return new Promise(function(i,o){w.xdr(n.endPoint+"api/login",{username:t||"",password:e||""},null,n.cachedStatus.token,!0).then(function(t){n.updateStatus(t.responseData),i({status:"success",userid:n.cachedStatus.user_id})},function(t){i({error:t.responseData.error,status:"error"})})})},s.prototype.logout=function(){var t=this;return new Promise(function(e,n){t.$post("api/logout").then(function(n){t.updateStatus({}),delete localStorage.lastRWTConnectionStatus,e()},n)})},s.prototype.connect=function(t){this.isLoggedIn?t(this.cachedStatus.user_id):(this.once("logged-in",function(e){t(e)}),this.status(t||w.noop))},w.reWheelConnection=s,f.prototype.add=function(t){this.askedFilters.push(t)},f.prototype.explode=function(t){var e=[],n=[];return _.forIn(t,function(t,i){e.push(i),n.push(t)}),Combinatorics.cartesianProduct.apply(this,n).toArray()},f.prototype.getFilters=function(t){var e=_.keys(t).sort(),n=_.join(e,"|"),i=this.explode(t),o=_.keys(this.explodedFilters),r=this;i.slice(0);if(n in this.explodedFilters||(this.explodedFilters[n]=[]),o.length){_.intersection(o,Combinatorics.power(e,function(t){return t.join("|")}).slice(1)).forEach(function(t,o){var s=_.split(t,"|"),a=null,c=s.map(_.partial(_.indexOf,e));a=t!==n?_.uniqWith(i.map(function(t){var e=[];for(var n in c)e.push(t[c[n]]);return e}),_.identity):i;var u=_.intersectionBy(r.explodedFilters[t],a,JSON.stringify);u.length&&u.forEach(function(t){if(i.length){var e=new Function("x","return "+c.map(function(e,n){return"(x["+e+"] === "+t[n]+")"}).join(" && "));_.remove(i,e)}})})}Array.prototype.push.apply(this.explodedFilters[n],i);var s=o.map(function(t){return t.split("|")}).filter(function(t){return _.every(e,function(e){return _.includes(t,e)})}).filter(function(t){return!_.isEqual(t,e)});return s.length&&s.forEach(function(t){var n=r.explodedFilters[t.join("|")],o=e.map(_.partial(_.indexOf,t));i.forEach(function(t){var e=new Function("x","return "+o.map(function(e,n){return"(x["+e+"] === "+t[n]+")"}).join(" && "));_.remove(n,e)})}),this.implode(i,e)},f.prototype.implode=function(t,e){return t.length?_.zipObject(e,_.unzip(t).map(_.uniq)):null},p.prototype.forEach=function(t){return this.items.forEach(t)};var b=function(t,n){function o(t,e,n){this.klass=e,this.permissions=[],this.id=t;for(var i in n)this.push.apply(this,[i,n[i]])}if(t.constructor===String)var r=new s(t);else if(t.constructor===w.reWheelConnection)var r=t;this.connection=r,r.on("connected",function(){this.connected=!0}),this.on=r.on,this.emit=r.emit,this.unbind=r.unbind,this.once=r.once,this.$post=r.$post.bind(r),this.on("ws-connected",function(t){console.info("Websocket connected"),t.onMessageJson(a.gotData.bind(a)),t.onMessageText(function(t){console.info("WS message : "+t)})}),this.on("ws-disconnected",function(t){console.error("Websocket disconnected")}),this.on("error-json-404",function(t,e,n,i){console.error("JSON error ",JSON.stringify(t)),delete b[e.split("/")[0]]}),this.on("realtime-message-json",function(t){a.gotData(t)});var a=this,c={auth_group:e({})},f={},d={},p={},g={},y={},v={},b={},_=new l(e),S=new u(b,c,this,_);this.IDB=c,this.validationEvent=this.on("error-json-513",function(t,e,n,i){currentContext.savingErrorHanlder&&currentContext.savingErrorHanlder(new m(t))});var x=function(t){return t in c?c[t]:(c[t]=e({}),c[t])};o.prototype.save=function(t){var n={permissions:e(this.permissions).map(function(t){return[t[0].id,t[1]]}).toObject()};n.id=this.id;this.klass.modelName;a.$post(this.klass.modelName+".set_permissions",n,function(e,n,i,o){t(e)})},o.prototype.push=function(t,n){var i=e(n),o=e(this.klass.allPermissions).map(function(t){return[t,i.contains(t)]}).toObject(),r=e(this.permissions).map(function(t){return t[0].id});r.contains(t)?this.permissions[r.indexOf(t)][1]=o:this.permissions.push([c.auth_group.get(t),o])};var N=function(t){t.fields.id.readable=!1,t.fields.id.writable=!1;var i=e(t.fields);t.privateArgs&&(i=i.merge(t.privateArgs)),a.emit("model-definition",t,x(t.name));var r="if (!row) { row = {}};\n";r+=t.references.map(function(t){return"this._"+t.id+" = row."+t.id+";"}).join(";\n"),r+=i.map(function(t,e){return"date"==t.type||"datetime"==t.type?"this."+e+" = row."+e+"?new Date(row."+e+" * 1000 - "+w.tzOffset+"):null;\n":"boolean"==t.type?"this."+e+" = (row."+e+' === "T") || (row.'+e+" === true);\n":"this."+e+" = row."+e+";\n"}).toString("\n"),r+="if (permissions) {this._permissions = permissions && Lazy(permissions).map(function (x) { return [x, true] }).toObject();}";var s=w.renameFunction(w.capitalize(t.name),new Function("row","permissions",r));s.prototype.orm=n,s.ref_translations={},s.modelName=t.name,s.references=e(t.references).pluck("id").toArray(),s.inverse_references=t.referencedBy.map(function(t){return t.by+"_"+t.id+"_set"}),s.referents=t.referencedBy.map(function(t){return[t.by,t.id]}),s.fieldsOrder=t.fieldOrder,s.allPermissions=t.permissions,e(t.representation).size()&&(s.prototype.toString=new Function("return this."+e(t.representation).toString(' + " " + this.'))),s.prototype.toUpperCase=function(){return this.toString().toUpperCase()},s.prototype.toLowerCase=function(){return this.toString().toLowerCase()},s.prototype.delete=function(){return n.delete(this.constructor.modelName,[this.id])},Object.defineProperty(s.prototype,"permissions",{get:function(){if(this._permissions)return this._permissions;S.permissions[this.constructor.modelName].ask(this.id)}}),s.prototype.all_perms=function(t){var n=this.id;a.$post(this.constructor.modelName+".all_perms",{id:this.id},function(i){var r=i,u={},l=e(r).pluck("group_id").unique().map(function(t){return""+t}).difference(c.auth_group.keys()).toArray();e(r).groupBy(function(t){return t.group_id}).each(function(t,n){u[n]=e(t).pluck("name").toArray()});var f=function(e){t(new o(n,s,u))};l.length?a.get("auth_group",l,f):f()})},s.prototype.save=function(t){var n=this.asRaw(),i=s.fields,o=this.id,r=this.constructor.modelName;if(t)for(var c in t)n[c]=t[c];e(s.fieldsOrder).filter(function(t){return!i[t].writable}).each(function(t){t in n&&delete n[t]}),o&&(n.id=o);var u=a.$post(r+(o?".post":".put"),n);return t&&t.constructor===Function&&(u.context.savingErrorHanlder=t),u},s.prototype.copy=function(){var t=new this.constructor(this.asRaw());return t._permissions=this._permissions,t};var u="return {\n"+e(t.references).map(function(t){return t.id+" : this._"+t.id}).concat(i.map(function(t,e){return"date"==t.type||"datetime"==t.type?e+" : (this."+e+"?(Math.round(this."+e+".getTime() - this."+e+".getTimezoneOffset() * 60000) / 1000):null)":"boolean"==t.type?e+" : this."+e+'?"T":"F"':e+" : this."+e})).toString(",\n")+"};";s.prototype.asRaw=new Function(u),s.saveMulti=function(t,n,i){var o=[],r=e(s.fields).filter(function(t){return!t.writable}).pluck("id").toArray();e(t).map(function(t){return t.asRaw()}).each(function(t){e(r).each(function(e){delete t[e]}),o.push(t)}),a.$post(s.modelName,"put",{multiple:o,formIdx:a.formIdx++},function(t){a.gotData(t);var i=c[s.modelName],o=e(t[s.modelName].results).pluck("id").map(function(t){return i.get(t)}).toArray();n&&n(o)},i)},"extra_verbs"in t&&e(t.extra_verbs).each(function(t){var n=t[0],i=t[1],o="var data = {id : this.id";i.length&&(o+=", "+e(i).map(function(t){return t+" : "+t}).join(",")),o+="};\n",i=["post","gotData"].concat(i),i.push("cb");var r=o+' return post("'+s.modelName+"."+n+'", data,cb);',c=new Function(i,r);s.prototype[n]=function(){var t=[a.$post,a.gotData].concat(Array.prototype.slice.call(arguments,0));return c.apply(this,t)}}),"privateArgs"in t&&(s.privateArgs=e(t.privateArgs).keys().map(function(t){return[t,!0]}).toObject(),s.prototype.savePA=function(t){var n=this,i={id:this.id},o=this.constructor.privateArgs,r=this.constructor.fields,s=(new this.constructor(t).asRaw(),e(o).keys().map(function(t){return[t,r[t]]}).toObject());e(t).each(function(t,e){e in o&&s[e].writable&&(i[e]=t)}),a.$post(this.constructor.modelName+".savePA",i,function(){e(i).each(function(t,e){n[e]=t})})}),y[s.modelName]=s;for(var l in t.fields)t.fields[l].id=l;return s.fields=e(t.fields).concat(e(t.privateArgs)).concat(e(t.references).tap(function(t){t.type=t.type||"reference"})).indexBy("id").toObject(),e(s.fields).each(function(t){t.widget||("reference"===t.type?t.widget="choices":t.widget=t.type)}),e(t.references).each(function(t){var e=t.to,i="_"+t.id;h(s.prototype,t.id,function(){if(!this[i])return w.mock;if(!(e in c)){var t=this;a.describe(e,function(n){S.mainIndex[e].ask(t[i],!0)})}var n=e in c&&this[i]&&c[e].get(this[i]);return!n&&e in S.mainIndex?("number"==typeof this[i]?S.mainIndex[e].ask(this[i],!0):console.warn("null reference for "+i+"("+this.id+") resource "+s.modelName),w.mock):n},function(n){if(n){if(n.constructor!==w.mock&&n.constructor.modelName!==e)throw new TypeError("You can assign only "+e+" to "+t.id);this[i]=n.id}else this[i]=null},"new-"+e,"deleted-"+e,"updated-"+e,"new-model-"+e),s.prototype["get"+w.capitalize(t.id)]=function(){return n.get(e,this[i])}}),e(t.referencedBy).each(function(t){var e=t.by+"."+t.id,i=t.by+"_"+w.pluralize(t.id),o=t.by;s.prototype.hasOwnProperty(i)?console.error("Tryed to redefine property "+i+"s for "+s.modelName):h(s.prototype,i,function(){var t=o in c?f[e].get(this.id+""):null;return S.foreignKeys[e].ask(this.id,!0),t},null),s.prototype["get"+w.capitalize(w.pluralize(t.by))]=function(){var e={};return e[t.id]=[this.id],n.get(t.by,e)}}),t.manyToMany&&(e(t.manyToMany).each(function(t){var n=t.indexName,i=t.first?0:1,o=t.model,r=S.m2mIndex[n]["get"+(1-i)];h(s.prototype,t.model+"s",function(){var t=this,n=[],i=r(t.id),s=null;return i.length&&(s=x(o).get.bind(c[o])),i&&s&&(n=e(i).map(s).filter(w.bool).toArray()),n},null,"received-m2m-"+n,"received-"+o),s.prototype["get"+w.capitalize(w.pluralize(o))]=function(){var t=this;return new Promise(function(s,u){try{S.getM2M(n,[t.id],i,function(n){var i=r(t.id);i.length?a.fetch(o,{id:i},null,function(){var t=c[o].get.bind(c[o]);s(e(i).map(t).filter(w.bool).toArray())}):s([])})}catch(t){console.error(t),u(t)}})},s.fields[w.capitalize(o)]={id:w.capitalize(o),name:w.capitalize(o),writable:!0,readable:!0,type:"M2M",validators:[]}}),s.prototype.unlinkReference=function(t){var n=!1,i=this.id,o=[];"Array"==t.constructor.name&&(n=!0,o=t,t=o[0]);var r=t.constructor.modelName;if(n)var c=e(o).pluck("id").map(function(t){return[i,t]}).toArray();else var c=[[i,t.id]];a.$post(s.modelName+"/"+r+"s/delete",{collection:c})},s.prototype.linkReference=function(t){var n=!1,i=this.id,o=[];"Array"==t.constructor.name&&(n=!0,o=t,t=o[0]);var r=t.constructor.modelName,c=s.modelName+"/"+r;if(n){var u=[];if(c in INDEX_M2M&&(u=e(o).pluck("id").difference(e(INDEX_M2M[c][0].get(this.id))).toArray()),c=r+"/"+s.modelName,c in INDEX_M2M&&(u=e(o).pluck("id").difference(e(INDEX_M2M[c][0].get(this.id))).toArray()),u.length){var l=e(u).map(function(t){return[i,t]}).toArray();W2P_POST(s.modelName,r+"s/put",{collection:l},function(t){})}}else{if(c in S.m2mIndex&&e(S.m2mIndex[c]["get"+w.capitalize(r)](t.id)).find(this))return;a.$post(s.modelName+"/"+r+"s.put",{collection:[[this.id,t.id]]})}}),a.emit("new-model",s),a.emit("new-model-"+s.modelName),s};this.gotData=function(t,n){if(console.info("gotData"),"string"!=typeof t){"_extra"in t&&delete t._extra;var i=(t.TOONE,t.TOMANY,t.MANYTOMANY,t.PERMISSIONS),o=t.PA;if(delete t.TOONE,delete t.TOMANY,delete t.MANYTOMANY,delete t.PERMISSIONS,delete t.PA,o||(o={}),"m2m"in(t=e(t).filter(function(t,e){return!("deleted"in t)||e in y}).toObject())){var r=t.m2m;delete t.m2m}e(t).each(function(t,n){a.describe(n,function(i){var r=i;t.results&&t.results.length>0&&t.results[0].constructor==Array&&(t.results=e(t.results).map(function(t){return e(r.fieldsOrder).zip(t).toObject()}).toArray());var s=e(t.results),u=t.deleted;if(n in o){var l=o[n];e(s).each(function(t){t.id in l&&e(l[t.id]).each(function(e,n){t[n]=e})})}var d=x(n),h=d.source;u&&u.forEach(function(t){delete h[t]});var p=s.indexBy("id").toObject(),m=e(p).keys(),g=m.difference(d.keys().map(function(t){return parseInt(t)})),v=m.difference(g);v=v.filter(function(t){return!w.sameAs(p[t],h[t].asRaw())}).toArray();var b=e(t.permissions?t.permissions:{}),_=g.map(function(t){return new r(p[t],b.get(t))}),S=[];e(i.references).map(function(t){return[t,1]}).toObject();v.forEach(function(t){var n=h[t],o=n.copy(),r=p.get(t);e(i.fields).each(function(t,e){switch(t.type){case"reference":n["_"+e]=r[e],n[e]=NaN;break;case"date":case"datetime":n[e]=new Date(1e3*r[e]);break;case"boolean":switch(r[e]){case null:n[e]=null;break;case"T":n[e]=!0;break;case"F":n[e]=!1;break;case!0:n[e]=!0;break;case!1:n[e]=!1}break;default:n[e]=r[e]}}),S.push([r,o])}),S.length&&a.emit("updated-"+n,S);var N=_.toArray();e(N).each(function(t){h[t.id]=t}),e(y[n].references).each(function(t){f[n+"."+t]=c[n].groupBy("_"+t)}),N.length&&a.emit("new-"+n,e(N),t.totalResults),u&&a.emit("deleted-"+n,u),a.emit("received-"+n)})}),r&&a.gotM2M(r),i&&a.gotPermissions(i),n&&n(t),a.emit("got-data")}else if(console.log("data "+t+" refused from gotData()"),n)return n(t)},this.gotPermissions=function(t){e(t).each(function(t,n){e(t[0]).each(function(t,i){n in c&&i in c[n].source&&(c[n].get(i)._permissions=e(t).map(function(t){return[t,!0]}).toObject())}),e(t[0]).size()&&a.emit("update-permissions-"+n,e(t[0]).keys().toArray())}),this.emit("update-permissions")},this.gotM2M=function(t){e(t).each(function(t,n){var i=S.m2mIndex[n];e(t).each(function(t){e(t).each(function(t,e){i[e](t)})}),a.emit("received-m2m"),a.emit("received-m2m-"+n)})},this.fetch=function(t,e,n,i){t in b?setTimeout(function(){a.fetch(t,e,n,i)},500):a.describe(t,function(n){if(a.connection.cachedStatus.realtimeEndPoint)return e=_.filter(n,e),e?(b[t]=!0,a.$post(t+".list",{filter:e}).then(function(e){a.gotData(e,i),delete b[t]},function(e){delete b[t]})):i&&i(),e;this.$post(t+".list",sendData,function(n){e||GOT_ALL.source.push(t),a.gotData(n,i)})}.bind(this))},this.get=function(t,e,n){e.constructor!==Array&&(e=[e]),a.fetch(t,{id:e},null,function(){var i=[],o=c[t];for(var r in e)i.push(o.source[e[r]]);n(i)})},this.gotModel=function(t){for(var n in t){var i=t[n];localStorage["description:"+n]=JSON.stringify(t),y[n]=N(i),n in c||(c[n]=e({}))}},this.describe=function(t,e){var n=y[t];if(n)e&&e(n);else if(!this.connection.isConnected||t in b)setTimeout(function(){a.describe(t,e)},500);else{if(t in v)return;var i="description:"+t;i in localStorage?(this.gotModel(JSON.parse(localStorage[i])),e&&e(y[t])):(b[t]=!0,this.$post(t+".describe",null,function(n){a.gotModel(n),e&&e(y[t]),delete b[t]},function(e){this.modelNotFound.handle(t),v[t]=!0}))}},this.addModelHandler=function(t,e){var n=w.hash(e);t in d||(d[t]=new i),t in p||(p[t]={}),n in p[t]||(p[t][n]=!0,t in y?e(y[t]):d[t].addHandler(e))},this.addPersistentAttributes=function(t,n){t in g||(g[t]=[]);var i=g[t];if(n)var o=e(n).difference(i).toArray();else var o=i;o.length&&(t in y&&function(t,e){e.forEach(function(e){var n="pA:"+t.modelName+":"+e,i="__"+e;Object.defineProperty(t.prototype,e,{get:function(){if(!(i in this)){var t=localStorage[n+this.id];this[i]=t?JSON.parse(t):null}return this[i]},set:function(t){this[i]=t,localStorage[n+this.id]=JSON.stringify(t)}})})}(y[t],o),n&&Array.prototype.push.apply(i,o))},this.on("new-model",function(t){t.modelName in d&&d[t.modelName].handle(y[t.modelName]),t.modelName in g&&a.addPersistentAttributes(t.modelName)}),this.query=function(t,n,i,o){var r=this;this.describe(t,function(s){n=e(n).map(function(t,e){return[e,Array.isArray(t)?t:[t]]}).toObject();var a=w.makeFilter(s,n),c=x(t);r.fetch(t,n,i,function(t){o(c.filter(a).values().toArray())})})},this.delete=function(t,e,n){return this.$post(t+".delete",{id:e},n)},this.connect=function(t){this.connection.isLoggedIn?t():this.connection.connect(t)}};g.prototype.connect=function(){var t=this.$orm.connection;return new Promise(function(e,n){t.connect(e)})},g.prototype.login=function(t,e){return new Promise(function(n,i){this.$orm.connection.login(t,e,n)}.bind(this))},g.prototype.logout=function(t){return this.$orm.connection.logout()},g.prototype.getModel=function(t){var e=this;return new Promise(function(n,i){try{e.$orm.connect(function(){e.$orm.describe(t,n)})}catch(t){i(t)}})},g.prototype.get=function(t,e){var n,i=this,o=!1;return"number"==typeof e?(o=!0,n={id:[e]}):Array.isArray(e)?n={id:e}:"object"==typeof e?n=e:null===e&&(n={}),new Promise(function(e,r){try{i.$orm.connect(function(){i.$orm.query(t,n,null,function(t){e(o?t.length?t[0]:null:t)})})}catch(t){r(t)}})},g.prototype.delete=function(t,e){var n=this;return new Promise(function(i,o){try{n.$orm.connect(function(){n.$orm.delete(t,e,i)})}catch(t){o(t)}})},g.prototype.getLoggedUser=function(){var t=this;return this.$orm.connection.cachedStatus.user_id?this.get("auth_user",this.$orm.connection.cachedStatus.user_id):new Promise(function(e,n){t.once("logged-in",function(n){t.get("auth_user",n).then(e)})})},g.prototype.$sendToEndpoint=function(t,e){return this.$orm.$post(t,e)},g.prototype.login=function(t,e){return this.$orm.connection.login(t,e)},g.prototype.getResources=function(){var t=this.$orm;return new Promise(function(e,n){var i=t.connection;w.xdr(i.endPoint+"api/resources",null).then(function(t){t.responseData?e(t.responseData.sort()):n(t)})})},g.prototype.getCollection=function(t,e){return new p(orm.$orm,e||{})},t.rwt=g}(window,Lazy,SockJS);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhbmRsZXJzLmpzIiwiY29ubmVjdGlvbi5qcyIsInRvdWNoZXIuanMiLCJ2YWN1dW1jYWNoZXIuanMiLCJhdXRvbGlua2VyLmpzIiwibGlzdGNhY2hlci5qcyIsIm1hbnl0b21hbnkuanMiLCJjYWNoZXIuanMiLCJjb2xsZWN0aW9ucy5qcyIsIm9ybS5qcyIsInV0aWxzLmpzIl0sIm5hbWVzIjpbIkhhbmRsZXIiLCJ0aGlzIiwiaGFuZGxlcnMiLCJzdHJIYW5kbGVycyIsIk5hbWVkRXZlbnRNYW5hZ2VyIiwiZXZlbnRzIiwiaGFuZGxlcklkIiwiaWR4SWQiLCJvbiIsIm5hbWUiLCJmdW5jIiwiQXJyYXkiLCJpZCIsInB1c2giLCJlbWl0IiwiYXJncyIsInByb3RvdHlwZSIsInNsaWNlIiwiY2FsbCIsImFyZ3VtZW50cyIsImZvckVhY2giLCJldmVudCIsImFwcGx5IiwidW5iaW5kIiwiaGFuZGxlciIsImNvdW50IiwiTGF6eSIsImVhY2giLCJ2IiwiayIsImlkeCIsIm4iLCJyZXZlcnNlIiwieCIsInNwbGljZSIsIm9uY2UiLCJldmVudE5hbWUiLCJoYW5kbGVyRnVuY3Rpb24iLCJzZWxmIiwid2luZG93IiwiYmluZCIsIlJlYWx0aW1lQ29ubmVjdGlvbiIsImVuZFBvaW50Iiwicnd0Q29ubmVjdGlvbiIsImNvbm5lY3Rpb24iLCJTb2NrSlMiLCJvbm9wZW4iLCJjb25zb2xlIiwibG9nIiwidGVuYW50Iiwib25tZXNzYWdlIiwidHlwZSIsIkpTT04iLCJwYXJzZSIsImRhdGEiLCJlIiwib25jbG9zZSIsInNldFRpbWVvdXQiLCJ1dGlscyIsIndzQ29ubmVjdCIsInNlbmQiLCJjYWNoZWRTdGF0dXMiLCJhcHBsaWNhdGlvbiIsInRva2VuIiwiY2xvc2UiLCJyZVdoZWVsQ29ubmVjdGlvbiIsImdldExvZ2luIiwiZW5kc1dpdGgiLCJpc0Nvbm5lY3RlZCIsImlzTG9nZ2VkSW4iLCJUb3VjaGVyIiwidG91Y2hlZCIsInRvdWNoIiwidCIsIlZhY3V1bUNhY2hlciIsImFza2VkIiwicGtJbmRleCIsIm1pc3NpbmciLCJhc2siLCJsYXp5Iiwic291cmNlIiwiY29udGFpbnMiLCJnZXRBc2tlZEluZGV4IiwibWlzc2luZ3MiLCJsZW5ndGgiLCJ1bmlxdWUiLCJ0b0FycmF5IiwiQXV0b0xpbmtlciIsImFjdGl2ZXMiLCJJREIiLCJXMlBSRVNPVVJDRSIsImxpc3RDYWNoZSIsIm1haW5JbmRleCIsImZvcmVpZ25LZXlzIiwibTJtIiwibTJtSW5kZXgiLCJwZXJtaXNzaW9ucyIsIm1vZGVsIiwiaW5kZXgiLCJnZXRJbmRleEZvciIsInJlZmVyZW5jZXMiLCJyZWZlcmVuY2UiLCJpbmRleE5hbWUiLCJ0byIsInJlZmVyZW5jZWRCeSIsImZpZWxkIiwiYnkiLCJtYW55VG9NYW55IiwicmVsYXRpb24iLCJNYW55VG9NYW55UmVsYXRpb24iLCJtMm1HZXQiLCJjb2xsZWN0aW9uIiwiY2FsbEJhY2siLCIkcG9zdCIsImdvdERhdGEiLCJnZXRNMk0iLCJsaW5rVW5saW5rZWQiLCJ2YWx1ZXMiLCJzdW0iLCJjaGFuZ2VkIiwiaW5kZXhlcyIsImZpbHRlciIsIkJvb2xlYW4iLCJtYXAiLCJwYXJzZUludCIsIklOREVYIiwiZ2V0dGVyIiwiaWRzIiwib3RoZXJJbmRleCIsInNwbGl0IiwiZGVzY3JpYmUiLCJmbGF0dGVuIiwibW9kZWxOYW1lIiwia2V5cyIsImZldGNoIiwibm9vcCIsIm1haW5SZXNvdXJjZSIsImZpZWxkTmFtZSIsInRvT2JqZWN0IiwicmVzb3VyY2VOYW1lIiwiZ290UGVybWlzc2lvbnMiLCJQRVJNSVNTSU9OUyIsInNldEludGVydmFsIiwiTGlzdENhY2hlciIsImdldFRyYWNlciIsInRyYWNlcnMiLCJGaWx0ZXJUcmFjZXIiLCJnb3RBbGwiLCJfIiwic2l6ZSIsImdldEZpbHRlcnMiLCJleHBsb2RlZEZpbHRlcnMiLCJhc2tlZEZpbHRlcnMiLCJpdGVtcyIsImFkZCIsIml0ZW0iLCJmaW5kIiwiZ2V0MCIsInBsdWNrIiwiZ2V0MSIsImNhcGl0YWxpemUiLCJkZWwiLCJsIiwiYSIsImNhY2hlZFByb3BlcnR5QnlFdmVudHMiLCJwcm90byIsInByb3BlcnR5TmFtZSIsInNldHRlciIsInJlc3VsdCIsIm9ybSIsInByb3BlcnR5RGVmIiwiZ2V0IiwidmFsdWUiLCJpc0Zpbml0ZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiQ29sbGVjdGlvbiIsInBhcnRpYWwiLCJvcmRlcmJ5IiwiaXBwIiwiZmlsdGVyRnVuY3Rpb24iLCJ1cGRhdGVEYXRhIiwiJG9ybSIsImFkZEhhbmRsZXIiLCJNb2RlbCIsIm1ha2VGaWx0ZXIiLCJpbml0aWFsRmlsdGVyIiwicXVlcnkiLCJ3YXJuIiwidW5pb24iLCJoYW5kbGUiLCJWYWxpZGF0aW9uRXJyb3IiLCJyZXNvdXJjZSIsIl9yZXNvdXJjZSIsImZvcm1JZHgiLCJmaWVsZHMiLCJlcnJvcnMiLCJyZVdoZWVsT1JNIiwibG9naW5GdW5jIiwiYmFzZU9STSIsImFkZE1vZGVsSGFuZGxlciIsImFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzIiwibG9nb3V0Iiwic3RySGFuZGxlciIsImhhc2giLCJ0b1N0cmluZyIsImhhbmRsZUJ5IiwidGhzIiwiY2FjaGVkS2V5SWR4IiwibnVsbFN0cmluZyIsInJlbmFtZUZ1bmN0aW9uIiwiZm4iLCJGdW5jdGlvbiIsImNhY2hlZCIsImtleSIsIndyYXBwZXIiLCJ4ZHIiLCJ1cmwiLCJmb3JtRW5jb2RlIiwiUHJvbWlzZSIsImFjY2VwdCIsInJlamVjdCIsInJlcSIsIlhNTEh0dHBSZXF1ZXN0Iiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInJlc3BvbnNlRGF0YSIsInJlc3BvbnNlVGV4dCIsInJlc3BvbnNlIiwic3RhdHVzIiwicmVxdWVzdCIsIlhEb21haW5SZXF1ZXN0Iiwib25sb2FkIiwic3RhdHVzVGV4dCIsIkVycm9yIiwib3BlbiIsIm9uZXJyb3IiLCJzZXRSZXF1ZXN0SGVhZGVyIiwiX190b2tlbl9fIiwiZW5jb2RlVVJJIiwiam9pbiIsInN0cmluZ2lmeSIsInMiLCJ0b1VwcGVyQ2FzZSIsInRvTG93ZXJDYXNlIiwic3RyIiwicmV0IiwiY2hhckNvZGVBdCIsInVuaWZpZXIiLCJkb250VHJhbnNsYXRlRmlsdGVyIiwidmFscyIsImlzQXJyYXkiLCJjb25zdHJ1Y3RvciIsIk51bWJlciIsIm1vY2siLCJlcnJvciIsInNhbWVBcyIsInkiLCJwbHVyYWxpemUiLCJiZWZvcmVDYWxsIiwiYmVmb3JlIiwidGhlbiIsImNsZWFuU3RvcmFnZSIsImxvY2FsU3RvcmFnZSIsImNsZWFuRGVzY3JpcHRpb24iLCJzdGFydHNXaXRoIiwiY2hyIiwicGVybXV0YXRpb25zIiwiYXJyIiwid2FpdEZvciIsIndhaXRlciIsImJvb2wiLCJ0ek9mZnNldCIsIkRhdGUiLCJnZXRUaW1lem9uZU9mZnNldCIsInRyYW5zRmllbGRUeXBlIiwiZGF0ZSIsImRhdGV0aW1lIiwic3RyaW5nIiwidGV4dCIsImludGVnZXIiLCJmbG9hdCIsInBhcnNlRmxvYXQiLCJQcm94eSIsInRhcmdldCIsInhociIsImZvcmNlIiwic3RhdHVzV2FpdGluZyIsInVwZGF0ZVN0YXR1cyIsImxhc3RCdWlsZCIsImxhc3RfYnVpbGQiLCJ1c2VyX2lkIiwib2xkU3RhdHVzIiwibG9naW5JbmZvIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwib2JqIiwicmVhbHRpbWVFbmRQb2ludCIsIndzQ29ubmVjdGlvbiIsInVzZXJpZCIsIm9rIiwiY29ubmVjdCIsImV4cGxvZGUiLCJmb3JJbiIsIkNvbWJpbmF0b3JpY3MiLCJjYXJ0ZXNpYW5Qcm9kdWN0Iiwic29ydCIsImtleXNLZXkiLCJleHBsb2RlZCIsImtleXNldCIsImludGVyc2VjdGlvbiIsInBvd2VyIiwia2tleXMiLCJjb21wYXRpYmxlRXhwbG9kZWQiLCJmcm9tSW5kZXgiLCJpbmRleE9mIiwidW5pcVdpdGgiLCJpIiwiaWRlbnRpdHkiLCJ0b1JlbW92ZSIsImludGVyc2VjdGlvbkJ5IiwicmYiLCJyZW1vdmUiLCJzdXBlcnNldHMiLCJldmVyeSIsImluY2x1ZGVzIiwiaXNFcXVhbCIsIm9sZFZhbHVlcyIsImltcGxvZGUiLCJ6aXBPYmplY3QiLCJ1bnppcCIsInVuaXEiLCJmIiwib3B0aW9ucyIsImV4dE9STSIsIlBlcm1pc3Npb25UYWJsZSIsImtsYXNzIiwiU3RyaW5nIiwiY29ubmVjdGVkIiwid3MiLCJpbmZvIiwib25NZXNzYWdlSnNvbiIsIm9uTWVzc2FnZVRleHQiLCJtZXNzYWdlIiwic2VudERhdGEiLCJ3YWl0aW5nQ29ubmVjdGlvbnMiLCJhdXRoX2dyb3VwIiwiUkVWSURYIiwiYnVpbGRlckhhbmRsZXJzIiwiYnVpbGRlckhhbmRsZXJVc2VkIiwicGVyc2lzdGVudEF0dHJpYnV0ZXMiLCJtb2RlbENhY2hlIiwiZmFpbGVkTW9kZWxzIiwibGlua2VyIiwidmFsaWRhdGlvbkV2ZW50IiwiY3VycmVudENvbnRleHQiLCJzYXZpbmdFcnJvckhhbmxkZXIiLCJnZXRJbmRleCIsInNhdmUiLCJjYiIsIm15UGVybXMiLCJiIiwiZ3JvdXBfaWQiLCJwZXJtaXNzaW9uTGlzdCIsInAiLCJwZXJtcyIsImFsbFBlcm1pc3Npb25zIiwibWFrZU1vZGVsQ2xhc3MiLCJyZWFkYWJsZSIsIndyaXRhYmxlIiwicHJpdmF0ZUFyZ3MiLCJtZXJnZSIsImZ1bmNTdHJpbmciLCJLbGFzcyIsInJlZl90cmFuc2xhdGlvbnMiLCJpbnZlcnNlX3JlZmVyZW5jZXMiLCJyZWZlcmVudHMiLCJmaWVsZHNPcmRlciIsImZpZWxkT3JkZXIiLCJyZXByZXNlbnRhdGlvbiIsImRlbGV0ZSIsIl9wZXJtaXNzaW9ucyIsImFsbF9wZXJtcyIsIm9iamVjdF9pZCIsImdyb3VwZWQiLCJ1bmtub3duX2dyb3VwcyIsImRpZmZlcmVuY2UiLCJncm91cEJ5IiwibyIsImFzUmF3IiwiSUQiLCJhcmciLCJwcm9taXNlIiwiY29udGV4dCIsImNvcHkiLCJhc3IiLCJjb25jYXQiLCJzYXZlTXVsdGkiLCJvYmplY3RzIiwic2NvcGUiLCJyYXciLCJkZWxldGFibGUiLCJtdWx0aXBsZSIsImVsZW1zIiwidGFiIiwib2JqcyIsInJlc3VsdHMiLCJleHRyYV92ZXJicyIsImZ1bmNOYW1lIiwiZGRhdGEiLCJjb2RlIiwic2F2ZVBBIiwiVCIsIm9vIiwiUEEiLCJGcyIsImZpZWxkSWR4IiwidGFwIiwiaW5kZXhCeSIsIndpZGdldCIsInJlZiIsImV4dF9yZWYiLCJsb2NhbF9yZWYiLCJUeXBlRXJyb3IiLCJyZXZJbmRleCIsImhhc093blByb3BlcnR5Iiwib3B0cyIsImZpcnN0Iiwib21vZGVsTmFtZSIsInZhbGlkYXRvcnMiLCJ1bmxpbmtSZWZlcmVuY2UiLCJpbnN0YW5jZSIsImluc3RhbmNlcyIsIm9tb2RlbCIsImxpbmtSZWZlcmVuY2UiLCJyZWZzIiwiSU5ERVhfTTJNIiwiVzJQX1BPU1QiLCJfZXh0cmEiLCJUT09ORSIsIlRPTUFOWSIsIk1BTllUT01BTlkiLCJtb2RlbENsYXNzIiwiemlwIiwiZGVsZXRlZCIsIk1QQSIsInJlY29yZCIsIml0YWIiLCJ0YWJsZSIsImlrIiwibm5ldyIsInVwZGF0ZWQiLCJuZXdPYmplY3RzIiwib2xkSXRlbSIsIm9sZENvcHkiLCJuZXdJdGVtIiwiTmFOIiwibm8iLCJ0b3RhbFJlc3VsdHMiLCJnb3RNMk0iLCJyb3ciLCJtIiwidmVyYiIsInRvZ2V0aGVyIiwic2VuZERhdGEiLCJHT1RfQUxMIiwiZ290TW9kZWwiLCJjYWNoZUtleSIsIm1vZGVsTm90Rm91bmQiLCJkZWNvcmF0b3IiLCJhdHRyaWJ1dGVzIiwiYXR0cnMiLCJuZXdBdHRycyIsInZhbCIsImthdHRyIiwic2V0IiwiZ2V0TW9kZWwiLCJzaW5nbGUiLCJnZXRMb2dnZWRVc2VyIiwidXNlciIsIiRzZW5kVG9FbmRwb2ludCIsImdldFJlc291cmNlcyIsImdldENvbGxlY3Rpb24iLCJmaWx0ZXJPcklkcyJdLCJtYXBwaW5ncyI6IjZCQUVBLFNBQUFBLEtBQ0FDLEtBQUFDLFlBQ0FELEtBQUFFLGVBeUJBLFFBQUFDLEtBQ0EsR0FBQUMsTUFDQUMsS0FDQUMsRUFBQSxDQWlEQSxJQWhEQU4sS0FBQU8sR0FBQSxT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RUFBQTNELGFBQUFpRixRQUVBdEYsRUFBQWdFLFFBTUF4RixFQUFBckwsVUFBQW1kLGNBQUEsU0FBQS9WLEVBQUFnVyxHQUNBLE1BQUEsSUFBQXBULEdBQUFQLElBQUFhLEtBQUE4UyIsImZpbGUiOiJyd3QubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBIYW5kbGVyKCl7XG4gICAgdGhpcy5oYW5kbGVycyA9IFtdO1xuICAgIHRoaXMuc3RySGFuZGxlcnMgPSB7fTtcbn07XG5cbkhhbmRsZXIucHJvdG90eXBlLmFkZEhhbmRsZXIgPSBmdW5jdGlvbiAoaGFuZGxlcil7XG4gICAgdmFyIHN0ckhhbmRsZXIgPSB1dGlscy5oYXNoKGhhbmRsZXIudG9TdHJpbmcoKSk7XG4gICAgaWYgKCEoc3RySGFuZGxlciBpbiB0aGlzLnN0ckhhbmRsZXJzKSl7XG4gICAgICAgIHRoaXMuc3RySGFuZGxlcnNbc3RySGFuZGxlcl0gPSBoYW5kbGVyO1xuICAgICAgICB0aGlzLmhhbmRsZXJzLnB1c2goaGFuZGxlcik7XG4gICAgfVxufTtcbkhhbmRsZXIucHJvdG90eXBlLmhhbmRsZSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCk7XG4gICAgdGhpcy5oYW5kbGVycy5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmMpe1xuICAgICAgICBmdW5jLmFwcGx5KG51bGwsYXJncyk7XG4gICAgfSlcbn07XG5IYW5kbGVyLnByb3RvdHlwZS5oYW5kbGVCeSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7XG4gICAgdmFyIHRocyA9IGFyZ3VtZW50c1swXTtcbiAgICB0aGlzLmhhbmRsZXJzLmZvckVhY2goZnVuY3Rpb24oZnVuYyl7XG4gICAgICAgIGZ1bmMuYXBwbHkodGhzLGFyZ3MpO1xuICAgIH0pXG59O1xuXG5cbmZ1bmN0aW9uIE5hbWVkRXZlbnRNYW5hZ2VyICgpe1xuICAgIHZhciBldmVudHMgPSB7fTtcbiAgICB2YXIgaGFuZGxlcklkID0ge307XG4gICAgdmFyIGlkeElkID0gMDtcbiAgICB0aGlzLm9uID0gZnVuY3Rpb24obmFtZSwgZnVuYyl7XG4gICAgICAgIGlmICghKG5hbWUgaW4gZXZlbnRzKSl7XG4gICAgICAgICAgICBldmVudHNbbmFtZV0gPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaWQgPSBpZHhJZCArKztcbiAgICAgICAgZXZlbnRzW25hbWVdLnB1c2goZnVuYyk7XG4gICAgICAgIGhhbmRsZXJJZFtpZF0gPSBmdW5jO1xuICAgICAgICByZXR1cm4gaWQ7XG4gICAgfTtcbiAgICB0aGlzLmVtaXQgPSBmdW5jdGlvbihuYW1lKXtcbiAgICAgICAgaWYgKG5hbWUgaW4gZXZlbnRzKXtcbiAgICAgICAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO1xuICAgICAgICAgICAgZXZlbnRzW25hbWVdLmZvckVhY2goZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgICAgICAgICAgIGV2ZW50LmFwcGx5KG51bGwsYXJncyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy51bmJpbmQgPSBmdW5jdGlvbihoYW5kbGVyKXtcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgaWYgKGhhbmRsZXIgaW4gaGFuZGxlcklkKXtcbiAgICAgICAgICAgIHZhciBmdW5jID0gaGFuZGxlcklkW2hhbmRsZXIgKyAnJ107XG4gICAgICAgICAgICBMYXp5KGV2ZW50cykuZWFjaChmdW5jdGlvbih2LGspe1xuICAgICAgICAgICAgICAgIHZhciBpZHggPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBuIGluIHYpe1xuICAgICAgICAgICAgICAgICAgICBpZiAodltuXSA9PT0gZnVuYyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZHgucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWR4LnJldmVyc2UoKS5mb3JFYWNoKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICB2LnNwbGljZSh4LDEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlIGhhbmRsZXJJZFtoYW5kbGVyXTtcbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2FsbCBldmVudCBvbmNlXG4gICAgICovXG4gICAgdGhpcy5vbmNlID0gZnVuY3Rpb24oZXZlbnROYW1lLCBoYW5kbGVyRnVuY3Rpb24pIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMub24oZXZlbnROYW1lLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgaGFuZGxlckZ1bmN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICBzZWxmLnVuYmluZChoYW5kbGVyKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBpZiAoJ0RFQlVHJyBpbiB3aW5kb3cpIHtcbiAgICAgICAgdmFyIGVtaXQgPSB0aGlzLmVtaXQ7XG4gICAgICAgIHRoaXMuZW1pdCA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApO1xuICAgICAgICAgICAgLy9jb25zb2xlLmluZm8oJ0V2ZW50IDogJyArIGFyZ3MpXG4gICAgICAgICAgICByZXR1cm4gZW1pdC5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgfSkuYmluZCh0aGlzKTtcbiAgICB9XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBTVEFUVVNLRVkgPSAnbGFzdFJXVENvbm5lY3Rpb25TdGF0dXMnO1xuXG5mdW5jdGlvbiBSZWFsdGltZUNvbm5lY3Rpb24oZW5kUG9pbnQsIHJ3dENvbm5lY3Rpb24pe1xuICAgIC8qKlxuICAgICAqIENvbm5lY3RzIGEgd2Vic29ja2V0IHdpdGggcmVXaGVlbCBjb25uZWN0aW9uXG4gICAgICovXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgdmFyIGNvbm5lY3Rpb24gPSBuZXcgU29ja0pTKGVuZFBvaW50KTtcbiAgICBjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdvcGVuIDogd2Vic29ja2V0Jyk7XG4gICAgICAgIGNvbm5lY3Rpb24udGVuYW50KCk7XG4gICAgICAgIHJ3dENvbm5lY3Rpb24uZW1pdCgncmVhbHRpbWUtY29ubmVjdGlvbi1vcGVuJyx4KTtcbiAgICB9O1xuICAgIGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgaWYgKHgudHlwZSA9PSAnbWVzc2FnZScpIHtcbiAgICAgICAgICAgIC8vJC5ub3RpZnkoeC5kYXRhKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy9UT0RPIHNldCBmcm9tUmVhbHRpbWVcbiAgICAgICAgICAgICAgICByd3RDb25uZWN0aW9uLmVtaXQoJ3JlYWx0aW1lLW1lc3NhZ2UtanNvbicsIEpTT04ucGFyc2UoeC5kYXRhKSk7XG4gICAgICAgICAgICAgICAgLy9UT0RPIHVuc2V0IGZyb21SZWFsdGltZVxuICAgICAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAgICAgcnd0Q29ubmVjdGlvbi5lbWl0KCdyZWFsdGltZS1tZXNzYWdlLXRleHQnLCBKU09OLnBhcnNlKHguZGF0YSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Zyb20gcmVhbHRpbWUgJyx4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29ubmVjdGlvbi5vbmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBzZXRUaW1lb3V0KHV0aWxzLndzQ29ubmVjdCwxMDAwKTtcbiAgICAgICAgcnd0Q29ubmVjdGlvbi5lbWl0KCdyZWFsdGltZS1jb25uZWN0aW9uLWNsb3NlZCcpO1xuICAgIH07XG4gICAgY29ubmVjdGlvbi50ZW5hbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbm5lY3Rpb24uc2VuZCgnVEVOQU5UOicgKyByd3RDb25uZWN0aW9uLmNhY2hlZFN0YXR1cy5hcHBsaWNhdGlvbiArICc6JyArIHJ3dENvbm5lY3Rpb24uY2FjaGVkU3RhdHVzLnRva2VuKTtcbiAgICB9XG4gICAgdGhpcy5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25uZWN0aW9uLmNsb3NlKCk7XG4gICAgfVxufSAgICBcblxuZnVuY3Rpb24gcmVXaGVlbENvbm5lY3Rpb24oZW5kUG9pbnQsIGdldExvZ2luKXtcbiAgICAvKipcbiAgICAgKiBDb25uZWN0aW9uIGJhc2ljIGZvciByZVdoZWVsXG4gICAgICogQHBhcmFtIGVuZFBvaW50OiBzdHJpbmcgYmFzZSB1cmwgZm9yIGFsbCBjb211bmljYXRpb25cbiAgICAgKiBAcGFyYW0gZ2V0TG9naW46IGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBpbiBjYXNlIG9mIG1pc3NpbmcgbG9naW4uXG4gICAgICogIHRoaXMgZnVuY3Rpb24gY291bGQgcmV0dXJuIDpcbiAgICAgKiAgLSAgIGEgeyB1c2VybmFtZSA6IDx1c2VybmFtZT4gLCBwYXNzd29yZDogPHBhc3N3b3JkPn0gb3JcbiAgICAgKiAgLSAgIGIgUHJvbWlzZSAtPiB7IHVzZXJuYW1lIDogPHVzZXJuYW1lPiAsIHBhc3N3b3JkOiA8cGFzc3dvcmQ+fVxuICAgICAqL1xuICAgIC8vIG1haW4gaW5pdGlhbGl6YXRpb25cbiAgICB2YXIgZXZlbnRzID0gbmV3IE5hbWVkRXZlbnRNYW5hZ2VyKCk7XG4gICAgdGhpcy5nZXRMb2dpbiA9IGdldExvZ2luO1xuICAgIHRoaXMuZW5kUG9pbnQgPSBlbmRQb2ludC5lbmRzV2l0aCgnLycpPyBlbmRQb2ludDogKGVuZFBvaW50ICsgJy8nKTtcbiAgICB0aGlzLm9uID0gZXZlbnRzLm9uO1xuICAgIHRoaXMudW5iaW5kID0gZXZlbnRzLnVuYmluZDtcbiAgICB0aGlzLmVtaXQgPSBldmVudHMuZW1pdDtcbiAgICB0aGlzLm9uY2UgPSBldmVudHMub25jZTtcbiAgICB0aGlzLmNhY2hlZFN0YXR1cyA9IHt9O1xuICAgIHRoaXMuaXNDb25uZWN0ZWQgPSBmYWxzZTtcbiAgICB0aGlzLmlzTG9nZ2VkSW4gPSBmYWxzZTtcbiAgICAvLyByZWdpc3RlcmluZyB1cGRhdGUgc3RhdHVzXG4gICAgdmFyIHRocyA9IHRoaXM7XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuJHBvc3QgPSBmdW5jdGlvbih1cmwsIGRhdGEsY2FsbEJhY2spe1xuICAgIC8qKlxuICAgICAqIEFKQVggY2FsbCBmb3IgZmV0Y2ggYWxsIGRhdGEgZnJvbSBzZXJ2ZXJcbiAgICAgKiBAcGFyYW0gdXJsOiBsYXN0IHVybCBwYXJ0IGZvciBhamF4IGNhbGxcbiAgICAgKiBAcGFyYW0gZGF0YTogZGF0YSBvYmplY3QgdG8gYmUgc2VudFxuICAgICAqIEBwYXJhbSBjYWxsQmFjazogZnVuY3Rpb24oeGhyKSB3aWxsIGJlIGNhbGxlZCB3aGVuIGRhdGEgYXJyaXZlc1xuICAgICAqIEByZXR1cm5zIFByb21pc2U8eGhyPiBzYW1lIG9mIGNhbGxCYWNrXG4gICAgICovXG4gICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICB2YXIgdGhzID0gdGhpcztcbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCxyZWplY3Qpe1xuICAgICAgICB1dGlscy54ZHIodGhzLmVuZFBvaW50ICsgdXJsLCBkYXRhLCB0aHMuY2FjaGVkU3RhdHVzLmFwcGxpY2F0aW9uLCB0aHMuY2FjaGVkU3RhdHVzLnRva2VuKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oeGhyKXtcbiAgICAgICAgICAgICAgICB0aHMuZW1pdCgnaHR0cC1yZXNwb25zZScsIHhoci5yZXNwb25zZVRleHQsIHhoci5zdGF0dXMsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgdGhzLmVtaXQoJ2h0dHAtcmVzcG9uc2UtJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZVRleHQsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZURhdGEpe1xuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnaHR0cC1yZXNwb25zZS0nICsgeGhyLnN0YXR1cyArICctanNvbicsIHhoci5yZXNwb25zZURhdGEsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjYWxsQmFjaykgeyBjYWxsQmFjayggeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0ICl9O1xuICAgICAgICAgICAgICAgIGFjY2VwdCh4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oeGhyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZURhdGEpe1xuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnZXJyb3ItanNvbicsIHhoci5yZXNwb25zZURhdGEsIHhoci5zdGF0dXMsIHVybCwgZGF0YSwgeGhyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmVtaXQoJ2Vycm9yLWpzb24tJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZURhdGEsdXJsLCBkYXRhLCB4aHIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnZXJyb3ItaHR0cCcseGhyLnJlc3BvbnNlVGV4dCwgeGhyLnN0YXR1cyx1cmwsZGF0YSx4aHIpO1xuICAgICAgICAgICAgICAgICAgICB0aHMuZW1pdCgnZXJyb3ItaHR0cC0nICsgeGhyLnN0YXR1cywgeGhyLnJlc3BvbnNlVGV4dCx1cmwsZGF0YSx4aHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZWplY3QoeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICByZXR1cm4gcHJvbWlzZTtcbn07XG5cbi8qKlxuICogQ2hlY2sgY3VycmVudCBzdGF0dXMgYW5kIGNhbGxiYWNrIGZvciByZXN1bHRzLlxuICogSXQgY2FjaGVzIHJlc3VsdHMgZm9yIGZ1cnRoZXIuXG4gKiBAcGFyYW0gY2FsbGJhY2s6IChzdGF0dXMgb2JqZWN0KVxuICogQHBhcmFtIGZvcmNlOiBib29sZWFuIGlmIHRydWUgZW1wdGllcyBjYWNoZSAgXG4gKiBAcmV0dXJuIHZvaWRcbiAqL1xucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLnN0YXR1cyA9IGZ1bmN0aW9uKGNhbGxCYWNrLCBmb3JjZSkge1xuICAgIC8vIGlmIGZvcmNlLCBjbGVhciBhbGwgY2FjaGVkIHZhbHVlc1xuICAgIHZhciBrZXkgPSAndG9rZW46JyArIHRoaXMuZW5kUG9pbnQ7XG4gICAgdmFyIHRocyA9IHRoaXM7XG4gICAgaWYgKGZvcmNlKSB7XG4gICAgICAgIHRoaXMuY2FjaGVkU3RhdHVzID0ge307XG4gICAgICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2Vba2V5XTtcbiAgICB9XG4gICAgaWYgKHRoaXMuc3RhdHVzV2FpdGluZykge1xuICAgICAgICAvLyB3YWl0IGZvciBzdGF0dXNcbiAgICAgICAgdXRpbHMud2FpdEZvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAhdGhzLnN0YXR1c1dhaXRpbmc7XG4gICAgICAgIH0sIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB0aHMuc3RhdHVzKGNhbGxCYWNrLGZvcmNlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gdHJ5IGZvciB2YWx1ZSByZXNvbHV0aW9uXG4gICAgLy8gZmlyc3Qgb24gbWVtb3J5XG4gICAgaWYgKExhenkodGhpcy5jYWNoZWRTdGF0dXMpLnNpemUoKSl7XG4gICAgICAgIGNhbGxCYWNrKHRoaXMuY2FjaGVkU3RhdHVzKVxuICAgIC8vIHRoZW4gaW4gbG9jYWxTdG9yYWdlXG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7fTtcbiAgICAgICAgaWYgKGtleSBpbiBsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgIGRhdGEuX190b2tlbl9fID0gbG9jYWxTdG9yYWdlW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdGF0dXNXYWl0aW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy4kcG9zdCgnYXBpL3N0YXR1cycsZGF0YSwgZnVuY3Rpb24oc3RhdHVzKXtcbiAgICAgICAgICAgIHRocy51cGRhdGVTdGF0dXMoc3RhdHVzKTtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZVtrZXldID0gc3RhdHVzLnRva2VuO1xuICAgICAgICAgICAgY2FsbEJhY2soc3RhdHVzKTtcbiAgICAgICAgICAgIHRocy5zdGF0dXNXYWl0aW5nID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBkb2Vzbid0IGNhbGwgY2FsbGJhY2tcbiAgICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNhbGxCYWNrKHRoaXMuY2FjaGVkU3RhdHVzKTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS51cGRhdGVTdGF0dXMgPSBmdW5jdGlvbihzdGF0dXMpe1xuICAgIHZhciBsYXN0QnVpbGQgPSBwYXJzZUZsb2F0KGxvY2FsU3RvcmFnZS5sYXN0QnVpbGQpIHx8IDE7XG4gICAgaWYgKGxhc3RCdWlsZCA8IHN0YXR1cy5sYXN0X2J1aWxkKXtcbiAgICAgICAgdXRpbHMuY2xlYW5EZXNjcmlwdGlvbigpO1xuICAgICAgICBsb2NhbFN0b3JhZ2UubGFzdEJ1aWxkID0gc3RhdHVzLmxhc3RfYnVpbGQ7XG4gICAgfVxuICAgIHRoaXMuaXNDb25uZWN0ZWQgPSBCb29sZWFuKHN0YXR1cy50b2tlbik7XG4gICAgdGhpcy5pc0xvZ2dlZEluID0gQm9vbGVhbihzdGF0dXMudXNlcl9pZCk7XG4gICAgdmFyIG9sZFN0YXR1cyA9IHRoaXMuY2FjaGVkU3RhdHVzO1xuICAgIHRoaXMuY2FjaGVkU3RhdHVzID0gc3RhdHVzO1xuICAgIGlmICghb2xkU3RhdHVzLnVzZXJfaWQgJiYgc3RhdHVzLnVzZXJfaWQpe1xuICAgICAgICB0aGlzLmVtaXQoJ2xvZ2dlZC1pbicsc3RhdHVzLnVzZXJfaWQpO1xuICAgIH0gZWxzZSBpZiAob2xkU3RhdHVzLnVzZXJfaWQgJiYgIXN0YXR1cy51c2VyX2lkKXtcbiAgICAgICAgdGhpcy5lbWl0KCdsb2dnZWQtb3V0Jyk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzQ29ubmVjdGVkICYmICF0aGlzLmlzTG9nZ2VkSW4pe1xuICAgICAgICB0aGlzLmVtaXQoJ2xvZ2luLXJlcXVpcmVkJyk7XG4gICAgICAgIGlmICh0aGlzLmdldExvZ2luKXtcbiAgICAgICAgICAgIHZhciBsb2dpbkluZm8gPSB0aGlzLmdldExvZ2luKCk7XG4gICAgICAgICAgICBpZiAobG9naW5JbmZvLmNvbnN0cnVjdG9yID09PSBPYmplY3Qpe1xuICAgICAgICAgICAgICAgIHRoaXMubG9naW4obG9naW5JbmZvLnVzZXJuYW1lLCBsb2dpbkluZm8ucGFzc3dvcmQsIGxvZ2luSW5mby5jYWxsQmFjayk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGxvZ2luSW5mby5jb25zdHJ1Y3RvciA9PT0gUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgIGxvZ2luSW5mby50aGVuKGZ1bmN0aW9uKG9iail7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9naW4ob2JqLnVzZXJuYW1lLCBvYmoucGFzc3dvcmQsIG9iai5jYWxsQmFjayk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyByZWFsdGltZSBjb25uZWN0aW9uIGlzIHNldHRlZFxuICAgIGlmICghb2xkU3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQgJiYgc3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQpIHtcbiAgICAgICAgdGhpcy53c0Nvbm5lY3Rpb24gPSBuZXcgUmVhbHRpbWVDb25uZWN0aW9uKHN0YXR1cy5yZWFsdGltZUVuZFBvaW50LCB0aGlzKTtcbiAgICAvLyByZWFsdGltZSBjb25uZWN0aW9uIGlzIGNsb3NlZFxuICAgIH0gZWxzZSBpZiAob2xkU3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQgJiYgIXN0YXR1cy5yZWFsdGltZUVuZFBvaW50KSB7XG4gICAgICAgIHRoaXMud3NDb25uZWN0aW9uLmNsb3NlKCk7XG4gICAgICAgIGRlbGV0ZSB0aGlzLndzQ29ubmVjdGlvbjtcbiAgICB9XG4gICAgdGhpcy5lbWl0KCd1cGRhdGUtY29ubmVjdGlvbi1zdGF0dXMnLCBzdGF0dXMsIG9sZFN0YXR1cyk7XG4gICAgbG9jYWxTdG9yYWdlW1NUQVRVU0tFWV0gPSBKU09OLnN0cmluZ2lmeShzdGF0dXMpO1xufVxuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpe1xuICAgIC8qKlxuICAgICAqIG1ha2UgbG9naW4gYW5kIHJldHVybiBhIHByb21pc2UuIElmIGxvZ2luIHN1Y2NlZCwgcHJvbWlzZSB3aWxsIGJlIGFjY2VwdGVkXG4gICAgICogSWYgbG9naW4gZmFpbHMgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIHdpdGggZXJyb3JcbiAgICAgKiBAcGFyYW0gdXNlcm5hbWU6IHVzZXJuYW1lXG4gICAgICogQHBhcmFtIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAqIEByZXR1cm4gUHJvbWlzZSAodXNlciBvYmplY3QpXG4gICAgICovXG4gICAgdmFyIHRocyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdXRpbHMueGRyKHRocy5lbmRQb2ludCArICdhcGkvbG9naW4nLCB7dXNlcm5hbWU6IHVzZXJuYW1lIHx8ICcnLCBwYXNzd29yZDogcGFzc3dvcmQgfHwgJyd9LG51bGwsdGhzLmNhY2hlZFN0YXR1cy50b2tlbiwgdHJ1ZSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHN0YXR1c1xuICAgICAgICAgICAgICAgIHRocy51cGRhdGVTdGF0dXMoeGhyLnJlc3BvbnNlRGF0YSk7XG4gICAgICAgICAgICAgICAgLy8gY2FsbCB3aXRoIHVzZXIgaWRcbiAgICAgICAgICAgICAgICBhY2NlcHQoe3N0YXR1cyA6ICdzdWNjZXNzJywgdXNlcmlkOiB0aHMuY2FjaGVkU3RhdHVzLnVzZXJfaWR9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHhocikge1xuICAgICAgICAgICAgICAgIC8vIGlmIGVycm9yIGNhbGwgZXJyb3IgbWFuYWdlciB3aXRoIGVycm9yXG4gICAgICAgICAgICAgICAgYWNjZXB0KHtlcnJvcjogeGhyLnJlc3BvbnNlRGF0YS5lcnJvciwgc3RhdHVzOiAnZXJyb3InfSk7XG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5sb2dvdXQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdGhzID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LHJlamVjdCkge1xuICAgICAgICB0aHMuJHBvc3QoJ2FwaS9sb2dvdXQnKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ob2spe1xuICAgICAgICAgICAgICAgIHRocy51cGRhdGVTdGF0dXMoe30pO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2VbU1RBVFVTS0VZXTtcbiAgICAgICAgICAgICAgICBhY2NlcHQoKVxuICAgICAgICAgICAgfSwgcmVqZWN0KTtcbiAgICB9KTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24oY2FsbEJhY2spIHtcbiAgICBpZiAodGhpcy5pc0xvZ2dlZEluKSB7XG4gICAgICAgIGNhbGxCYWNrKHRoaXMuY2FjaGVkU3RhdHVzLnVzZXJfaWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHdhaXQgZm9yIGxvZ2luXG4gICAgICAgIHRoaXMub25jZSgnbG9nZ2VkLWluJyxmdW5jdGlvbih1c2VyX2lkKXtcbiAgICAgICAgICAgIGNhbGxCYWNrKHVzZXJfaWQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zdGF0dXMoY2FsbEJhY2sgfHwgdXRpbHMubm9vcCk7XG4gICAgfVxufVxuXG51dGlscy5yZVdoZWVsQ29ubmVjdGlvbiA9IHJlV2hlZWxDb25uZWN0aW9uOyIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gVG91Y2hlcigpe1xuICAgIHZhciB0b3VjaGVkID0gZmFsc2VcbiAgICB0aGlzLnRvdWNoID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdG91Y2hlZCA9IHRydWU7XG4gICAgfTtcbiAgICB0aGlzLnRvdWNoZWQgPSBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgdCA9IHRvdWNoZWQ7XG4gICAgICAgIHRvdWNoZWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfVxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5cbmZ1bmN0aW9uIFZhY3V1bUNhY2hlcih0b3VjaCwgYXNrZWQsIG5hbWUsIHBrSW5kZXgpe1xuLypcbiAgICBpZiAobmFtZSl7XG4gICAgICAgIGNvbnNvbGUuaW5mbygnY3JlYXRlZCBWYWN1dW1DYWNoZXIgYXMgJyArIG5hbWUpO1xuICAgIH1cbiovXG4gICAgaWYgKCFhc2tlZCl7XG4gICAgICAgIHZhciBhc2tlZCA9IFtdO1xuICAgIH1cbiAgICB2YXIgbWlzc2luZyA9IFtdO1xuICAgIFxuICAgIHRoaXMuYXNrID0gZnVuY3Rpb24gKGlkLGxhenkpe1xuICAgICAgICBpZiAocGtJbmRleCAmJiAoaWQgaW4gcGtJbmRleC5zb3VyY2UpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFMYXp5KGFza2VkKS5jb250YWlucyhpZCkpe1xuLy8gICAgICAgICAgICBjb25zb2xlLmluZm8oJ2Fza2luZyAoJyArIGlkICsgJykgZnJvbSAnICsgbmFtZSk7XG4gICAgICAgICAgICBtaXNzaW5nLnB1c2goaWQpO1xuICAgICAgICAgICAgaWYgKCFsYXp5KVxuICAgICAgICAgICAgICAgIGFza2VkLnB1c2goaWQpO1xuICAgICAgICAgICAgdG91Y2gudG91Y2goKTtcbiAgICAgICAgfSBcbi8vICAgICAgICBlbHNlIGNvbnNvbGUud2FybignKCcgKyBpZCArICcpIHdhcyBqdXN0IGFza2VkIG9uICcgKyBuYW1lKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRBc2tlZEluZGV4ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGFza2VkO1xuICAgIH1cblxuICAgIHRoaXMubWlzc2luZ3MgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gTGF6eShtaXNzaW5nLnNwbGljZSgwLG1pc3NpbmcubGVuZ3RoKSkudW5pcXVlKCkudG9BcnJheSgpO1xuICAgIH1cbn1cbiIsImZ1bmN0aW9uIEF1dG9MaW5rZXIoYWN0aXZlcywgSURCLCBXMlBSRVNPVVJDRSwgbGlzdENhY2hlKXtcbiAgICB2YXIgdG91Y2ggPSBuZXcgVG91Y2hlcigpO1xuICAgIHZhciBtYWluSW5kZXggPSB7fTtcbiAgICB2YXIgZm9yZWlnbktleXMgPSB7fTtcbiAgICB2YXIgbTJtID0ge307XG4gICAgdmFyIG0ybUluZGV4ID0ge307XG4gICAgdmFyIHBlcm1pc3Npb25zID0ge307XG4gICAgdGhpcy5tYWluSW5kZXggPSBtYWluSW5kZXg7XG4gICAgdGhpcy5mb3JlaWduS2V5cyA9IGZvcmVpZ25LZXlzO1xuICAgIHRoaXMubTJtID0gbTJtO1xuICAgIHRoaXMubTJtSW5kZXggPSBtMm1JbmRleDtcbiAgICB0aGlzLnBlcm1pc3Npb25zID0gcGVybWlzc2lvbnM7XG4vKlxuICAgIHRoaXMuZ2V0TTJtSW5kZXggPSBmdW5jdGlvbihpbmRleE5hbWUsIHJlbGF0aW9uKSB7XG4gICAgICAgIGlmICghKGluZGV4TmFtZSBpbiBtMm1JbmRleCkpIHtcbiAgICAgICAgICAgIG0ybUluZGV4W2luZGV4TmFtZV0gPSBuZXcgTWFueVRvTWFueVJlbGF0aW9uKHJlbGF0aW9uLG0ybVtyZWxhdGlvbi5pbmRleE5hbWVdKTtcbiAgICAgICAgfVxuICAgIH1cbiovXG4gICAgVzJQUkVTT1VSQ0Uub24oJ21vZGVsLWRlZmluaXRpb24nLGZ1bmN0aW9uKG1vZGVsLCBpbmRleCl7XG4gICAgICAgIC8vIGRlZmluaW5nIGFsbCBpbmRleGVzIGZvciBwcmltYXJ5IGtleVxuICAgICAgICB2YXIgcGtJbmRleCA9IGxpc3RDYWNoZS5nZXRJbmRleEZvcihtb2RlbC5uYW1lLCAnaWQnKTtcbiAgICAgICAgbWFpbkluZGV4W21vZGVsLm5hbWVdID0gbmV3IFZhY3V1bUNhY2hlcih0b3VjaCwgcGtJbmRleCwgJ21haW5JbmRleC4nICsgbW9kZWwubmFtZSwgaW5kZXgpO1xuICAgICAgICBcbiAgICAgICAgLy8gY3JlYXRpbmcgcGVybWlzc2lvbiBpbmRleGVzXG4gICAgICAgIHBlcm1pc3Npb25zW21vZGVsLm5hbWVdID0gbmV3IFZhY3V1bUNhY2hlcih0b3VjaCxudWxsLCAncGVybWlzc2lvbnMuJyArIG1vZGVsLm5hbWUpO1xuXG4gICAgICAgIC8vIGNyZWF0aW5nIGluZGV4ZXMgZm9yIGZvcmVpZ24ga2V5c1xuICAgICAgICBMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLmVhY2goZnVuY3Rpb24ocmVmZXJlbmNlKXtcbiAgICAgICAgICAgIHZhciBpbmRleE5hbWUgPSBtb2RlbC5uYW1lICsgJ18nICsgcmVmZXJlbmNlLmlkO1xuICAgICAgICAgICAgZm9yZWlnbktleXNbaW5kZXhOYW1lXSA9IG5ldyBWYWN1dW1DYWNoZXIodG91Y2gsIGxpc3RDYWNoZS5nZXRJbmRleEZvcihyZWZlcmVuY2UudG8sICdpZCcpLCByZWZlcmVuY2UudG8gKyAnLmlkIGZvcmVpZ25LZXlzLicgKyBpbmRleE5hbWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gY3JlYXRpbmcgcmV2ZXJzZSBmb3JlaWduIGtleXNcbiAgICAgICAgTGF6eShtb2RlbC5yZWZlcmVuY2VkQnkpLmVhY2goZnVuY3Rpb24oZmllbGQpe1xuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IGZpZWxkLmJ5ICsgJy4nICsgZmllbGQuaWQ7XG4gICAgICAgICAgICBmb3JlaWduS2V5c1tpbmRleE5hbWVdID0gbmV3IFZhY3V1bUNhY2hlcih0b3VjaCwgbGlzdENhY2hlLmdldEluZGV4Rm9yKGZpZWxkLmJ5LGZpZWxkLmlkKSwgZmllbGQuYnkgKyAnLicgKyBmaWVsZC5pZCArICcgZm9yZWlnbktleXMuJyArIGluZGV4TmFtZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBMYXp5KG1vZGVsLm1hbnlUb01hbnkpLmVhY2goZnVuY3Rpb24ocmVsYXRpb24pe1xuICAgICAgICAgICAgaWYgKCEocmVsYXRpb24uaW5kZXhOYW1lIGluIG0ybSkpXG4gICAgICAgICAgICAgICAgbTJtW3JlbGF0aW9uLmluZGV4TmFtZV0gPSBbbmV3IFZhY3V1bUNhY2hlcih0b3VjaCxudWxsLCdtMm0uJyArIHJlbGF0aW9uLmluZGV4TmFtZSArICdbMF0nKSwgbmV3IFZhY3V1bUNhY2hlcih0b3VjaCxudWxsLCdtMm0uJyArIHJlbGF0aW9uLmluZGV4TmFtZSsnWzFdJyldO1xuICAgICAgICAgICAgaWYgKCEocmVsYXRpb24uaW5kZXhOYW1lIGluIG0ybUluZGV4KSlcbiAgICAgICAgICAgICAgICBtMm1JbmRleFtyZWxhdGlvbi5pbmRleE5hbWVdID0gbmV3IE1hbnlUb01hbnlSZWxhdGlvbihyZWxhdGlvbixtMm1bcmVsYXRpb24uaW5kZXhOYW1lXSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHZhciBtMm1HZXQgPSBmdW5jdGlvbihpbmRleE5hbWUsIG4sIGNvbGxlY3Rpb24sIGNhbGxCYWNrKXtcbiAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QoKG4gPyB1dGlscy5yZXZlcnNlKCcvJywgaW5kZXhOYW1lKSA6IGluZGV4TmFtZSkgKyAncycgKyAnL2xpc3QnLCB7Y29sbGVjdGlvbjogY29sbGVjdGlvbn0sIGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShkYXRhLCBjYWxsQmFjayk7XG4gICAgICAgICAgICBkZWxldGUgYWN0aXZlc1tpbmRleE5hbWVdXG4gICAgICAgIH0pOyAgICAgICAgXG4gICAgfTtcblxuICAgIHZhciBnZXRNMk0gPSBmdW5jdGlvbihpbmRleE5hbWUsIGNvbGxlY3Rpb24sIG4sIGNhbGxCYWNrKXtcbiAgICAgICAgLy8gYXNrIGFsbCBpdGVtcyBpbiBjb2xsZWN0aW9uIHRvIG0ybSBpbmRleFxuICAgICAgICBMYXp5KGNvbGxlY3Rpb24pLmVhY2gobTJtW2luZGV4TmFtZV1bbl0uYXNrLmJpbmQobTJtW2luZGV4TmFtZV1bbl0pKTtcbiAgICAgICAgLy8gcmVuZXdpbmcgY29sbGVjdGlvbiB3aXRob3V0IGFza2VkXG4gICAgICAgIGNvbGxlY3Rpb24gPSBtMm1baW5kZXhOYW1lXVtuXS5taXNzaW5ncygpO1xuICAgICAgICAvLyBjYWxsaW5nIHJlbW90ZSBmb3IgbTJtIGNvbGxlY3Rpb24gaWYgYW55XG4gICAgICAgIGlmIChjb2xsZWN0aW9uLmxlbmd0aCl7XG4gICAgICAgICAgICBhY3RpdmVzW2luZGV4TmFtZV0gPSAxO1xuICAgICAgICAgICAgbTJtR2V0KGluZGV4TmFtZSwgbiwgY29sbGVjdGlvbiwgY2FsbEJhY2spO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2soKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5nZXRNMk0gPSBnZXRNMk07XG5cbiAgICB2YXIgbGlua1VubGlua2VkID0gZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gcGVyZm9ybSBhIERhdGFCYXNlIHN5bmNocm9uaXphdGlvbiB3aXRoIHNlcnZlciBsb29raW5nIGZvciB1bmtub3duIGRhdGFcbiAgICAgICAgaWYgKCF0b3VjaC50b3VjaGVkKCkpIHJldHVybjtcbiAgICAgICAgaWYgKExhenkoYWN0aXZlcykudmFsdWVzKCkuc3VtKCkpIHtcbiAgICAgICAgICAgIHRvdWNoLnRvdWNoKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgTGF6eShtMm0pLmVhY2goZnVuY3Rpb24oaW5kZXhlcywgaW5kZXhOYW1lKXtcbiAgICAgICAgICAgIExhenkoaW5kZXhlcykuZWFjaChmdW5jdGlvbiAoaW5kZXgsbikge1xuICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gaW5kZXgubWlzc2luZ3MoKTtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uID0gTGF6eShjb2xsZWN0aW9uKS5maWx0ZXIoQm9vbGVhbikubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh4KVxuICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICBpZiAoY29sbGVjdGlvbi5sZW5ndGgpe1xuICAgICAgICAgICAgICAgICAgICB2YXIgSU5ERVggPSBtMm1JbmRleFtpbmRleE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0dGVyID0gSU5ERVhbJ2dldCcgKyAoMSAtIG4pXS5iaW5kKElOREVYKTtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG0ybUdldChpbmRleE5hbWUsIG4sIGNvbGxlY3Rpb24sIGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkcyA9IGNvbGxlY3Rpb24ubWFwKGdldHRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG90aGVySW5kZXggPSBpbmRleE5hbWUuc3BsaXQoJy8nKVsxIC0gbl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUob3RoZXJJbmRleCxmdW5jdGlvbigpe1xuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExhenkoaWRzKS5mbGF0dGVuKCkudW5pcXVlKCkuZWFjaChtYWluSW5kZXhbb3RoZXJJbmRleF0uYXNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTGF6eShpZHMpLmZsYXR0ZW4oKS51bmlxdWUoKS5lYWNoKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFpbkluZGV4W290aGVySW5kZXhdLmFzayh4LHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBMYXp5KG1haW5JbmRleCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIG1vZGVsTmFtZSkge1xuICAgICAgICAgICAgdmFyIGlkcyA9IGluZGV4Lm1pc3NpbmdzKCk7XG4gICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBpZGIgPSBtb2RlbE5hbWUgaW4gSURCID8gSURCW21vZGVsTmFtZV0ua2V5cygpIDogTGF6eSgpO1xuICAgICAgICAgICAgICAgIC8vbG9nKCdsaW5raW5nLicgKyBtb2RlbE5hbWUgKyAnID0gJyArIFcyUFJFU09VUkNFLmxpbmtpbmcuc291cmNlW21vZGVsTmFtZV0pO1xuICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmZldGNoKG1vZGVsTmFtZSwge2lkOiBpZHN9LG51bGwsdXRpbHMubm9vcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBGb3JlaWduIGtleXNcbiAgICAgICAgTGF6eShmb3JlaWduS2V5cylcbiAgICAgICAgLm1hcChmdW5jdGlvbih2LGspe1xuICAgICAgICAgICAgcmV0dXJuIFtrLCB2Lm1pc3NpbmdzKCldXG4gICAgICAgIH0pLmZpbHRlcihmdW5jdGlvbih2KXtcbiAgICAgICAgICAgIHJldHVybiB2WzFdLmxlbmd0aFxuICAgICAgICB9KS5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBpZHMgPSB4WzFdO1xuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IHhbMF07XG4gICAgICAgICAgICB2YXIgaW5kZXggPSBpbmRleE5hbWUuc3BsaXQoJy4nKTtcbiAgICAgICAgICAgIHZhciBtYWluUmVzb3VyY2UgPSBpbmRleFswXTtcbiAgICAgICAgICAgIHZhciBmaWVsZE5hbWUgPSBpbmRleFsxXTtcbiAgICAgICAgICAgIHZhciBmaWx0ZXIgPSB7fTtcbiAgICAgICAgICAgIGZpbHRlcltmaWVsZE5hbWVdID0gaWRzO1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZmV0Y2gobWFpblJlc291cmNlLCBmaWx0ZXIpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIExhenkoTGF6eShwZXJtaXNzaW9ucykubWFwKGZ1bmN0aW9uKHYsayl7XG4gICAgICAgICAgICByZXR1cm4gW2ssIHYubWlzc2luZ3MoKV1cbiAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICByZXR1cm4gdlsxXS5sZW5ndGhcbiAgICAgICAgfSkudG9PYmplY3QoKSkuZWFjaChmdW5jdGlvbiAoaWRzLCByZXNvdXJjZU5hbWUpIHtcbiAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGlkcy5sZW5ndGgpe1xuICAgICAgICAgICAgICAgIGFjdGl2ZXNbcmVzb3VyY2VOYW1lXSA9IDE7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QocmVzb3VyY2VOYW1lICsgJy9teV9wZXJtcycsIHtpZHM6IExhenkoaWRzKS51bmlxdWUoKS50b0FycmF5KCl9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3RQZXJtaXNzaW9ucyhkYXRhLlBFUk1JU1NJT05TKTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGFjdGl2ZXNbcmVzb3VyY2VOYW1lXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2V0SW50ZXJ2YWwobGlua1VubGlua2VkLDUwKTtcbn07XG5cblxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIExpc3RDYWNoZXIoKXtcbiAgICB2YXIgZ290QWxsID0ge307XG4gICAgdmFyIGFza2VkID0ge307IC8vIG1hcCBvZiBhcnJheVxuICAgIHZhciBjb21wb3NpdGVBc2tlZCA9IHt9O1xuICAgIHZhciB0cmFjZXJzID0ge307XG5cbiAgICBmdW5jdGlvbiBnZXRUcmFjZXIobW9kZWxOYW1lKSB7XG4gICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiB0cmFjZXJzKSkge1xuICAgICAgICAgICAgdHJhY2Vyc1ttb2RlbE5hbWVdID0gbmV3IEZpbHRlclRyYWNlcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cmFjZXJzW21vZGVsTmFtZV07XG4gICAgfVxuXG4gICAgdGhpcy5maWx0ZXIgPSBmdW5jdGlvbihtb2RlbCwgZmlsdGVyKXtcbi8vICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tXFxuZmlsdGVyIDogJyArIEpTT04uc3RyaW5naWZ5KGZpbHRlcikpO1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gbW9kZWwubW9kZWxOYW1lO1xuXG4gICAgICAgIC8vIGlmIHlvdSBmZXRjaCBhbGwgb2JqZWN0cyBmcm9tIHNlcnZlciwgdGhpcyBtb2RlbCBoYXMgdG8gYmUgbWFya2VkIGFzIGdvdCBhbGw7XG4gICAgICAgIHZhciBnb3QgPSBnb3RBbGxbbW9kZWxOYW1lXTtcbiAgICAgICAgaWYgKGdvdCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpbHRlckxlbiAgPSBfLnNpemUoZmlsdGVyKTtcbiAgICAgICAgaWYgKGZpbHRlckxlbiA9PT0gMCl7XG4gICAgICAgICAgICBnb3RBbGxbbW9kZWxOYW1lXSA9IHRydWU7XG4gICAgICAgICAgICBpZiAobW9kZWxOYW1lIGluIGFza2VkKXtcbiAgICAgICAgICAgICAgICBkZWxldGUgYXNrZWRbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmV0ID0gZ2V0VHJhY2VyKG1vZGVsTmFtZSkuZ2V0RmlsdGVycyhmaWx0ZXIpO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH07XG5cbiAgICB0aGlzLmdldEluZGV4Rm9yID0gZnVuY3Rpb24obW9kZWxOYW1lLCBmaWVsZE5hbWUpe1xuICAgICAgICB2YXIgaW5kZXhOYW1lID0gbW9kZWxOYW1lICsgJy4nICsgZmllbGROYW1lO1xuICAgICAgICBpZiAoIShpbmRleE5hbWUgaW4gYXNrZWQpKXtcbiAgICAgICAgICAgIGFza2VkW2luZGV4TmFtZV0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXNrZWRbaW5kZXhOYW1lXTtcbiAgICB9XG59O1xuXG5mdW5jdGlvbiBGaWx0ZXJUcmFjZXIoKSB7XG4gICAgLyoqXG4gICAgKiAgYXNrZWQgZmlsdGVyIHN0b3JhZ2VcbiAgICAqICB7IDxwaXBlIHNlcGFyYXRlZCBhc2tlZCBmaWVsZHM+IDogPGFycmF5IG9mIGFycmF5IG9mIGFza2VkIHZhbHVlcz4gfVxuICAgICovXG4gICAgdGhpcy5leHBsb2RlZEZpbHRlcnMgPSB7aWQ6IFtdfTsgXG4gICAgdGhpcy5hc2tlZEZpbHRlcnMgPSBbXTtcbn1cblxuLyoqXG4qIHByZXBhcmUgYSBmaWx0ZXIgdG8gYmUgZmV0Y2hlZFxuKiBAcGFyYW0gZmlsdGVyOiBmaWx0ZXIgdG8gYWRkXG4qL1xuRmlsdGVyVHJhY2VyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbihmaWx0ZXIpIHtcbiAgICB0aGlzLmFza2VkRmlsdGVycy5wdXNoKGZpbHRlcik7XG59XG5cblxuLyoqXG4qIEV4cGxvZGUgZmlsdGVyIGluIHNpbmdsZSBlbGVtZW50IGZpbHRlclxuKiBAcGFyYW0gZmlsdGVyIGNvbXBsZXggZmlsdGVyXG4qIEByZXR1cm4gbGlzdG8gb2Ygc2luZ2xlIGVsZW1lbnQgZmlsdGVyXG4qL1xuXG5GaWx0ZXJUcmFjZXIucHJvdG90eXBlLmV4cGxvZGUgPSBmdW5jdGlvbihmaWx0ZXIpIHtcbiAgICB2YXIgcmV0ID0gW107XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICB2YXIgdmFsdWVzID0gW107XG4gICAgLy8ga2V5IGFuZCB2YWx1ZXMgc3BsaXRcbiAgICBfLmZvckluKGZpbHRlciwgZnVuY3Rpb24odixrKXtcbiAgICAgICAga2V5cy5wdXNoKGspOyBcbiAgICAgICAgdmFsdWVzLnB1c2godik7XG4gICAgfSk7XG4gICAgdmFyIHZhbHMgPSBDb21iaW5hdG9yaWNzLmNhcnRlc2lhblByb2R1Y3QuYXBwbHkodGhpcywgdmFsdWVzKTtcbiAgICByZXR1cm4gdmFscy50b0FycmF5KCk7IC8vIHZhbHMubWFwKF8ucGFydGlhbChfLnppcE9iamVjdCwga2V5cykpOyAgICAgICAgXG59XG5cbi8qKlxuKiBSZWR1Y2UgYSBmaWx0ZXIgZXhjbHVkaW5nIHByZXZpb3VzbHkgY2FsbGVkIGZpbHRlclxuKiBBIGZpbHRlciBpcyBhbiBvYmplY3QgbGlrZSB3aGVyZSBrZXlzIGFyZSBmaWVsZHMgYW5kIHZhbHVlcyBcbiogYXJlIGFycmF5IG9mIHZhbHVlc1xuKiBAcGFyYW0gZmlsdGVyIGZpbHRlclxuKiBAcmV0dXJuIGEgbmV3IGZpbHRlciBvciBudWxsIGlmIG5vdGhpbmcgaGFzIHRvIGJlIGFza2VkXG4qL1xuRmlsdGVyVHJhY2VyLnByb3RvdHlwZS5nZXRGaWx0ZXJzID0gZnVuY3Rpb24oZmlsdGVyKSB7XG4gICAgdmFyIGtleXMgPSBfLmtleXMoZmlsdGVyKS5zb3J0KCk7XG4gICAgdmFyIGtleXNLZXkgPSBfLmpvaW4oa2V5cywgJ3wnKTtcbiAgICB2YXIgZXhwbG9kZWQgPSB0aGlzLmV4cGxvZGUoZmlsdGVyKTtcbiAgICB2YXIga2V5c2V0ID0gXy5rZXlzKHRoaXMuZXhwbG9kZWRGaWx0ZXJzKTtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgXG4gICAgLy8gY2xvbmluZyBvcmlnaW5hbCBleHBsb2RlZFxuICAgIHZhciBvcmlnaW5hbEV4cGxvZGVkID0gZXhwbG9kZWQuc2xpY2UoMCk7XG4gICAgXG4gICAgaWYgKCEoa2V5c0tleSBpbiB0aGlzLmV4cGxvZGVkRmlsdGVycykpIHtcbiAgICAgICAgdGhpcy5leHBsb2RlZEZpbHRlcnNba2V5c0tleV0gPSBbXTtcbiAgICB9XG4gICAgXG4gICAgaWYgKGtleXNldC5sZW5ndGgpIHtcbiAgICAgICAgLy8gZ2V0dGluZyBhbGwgc3Vic2V0c1xuICAgICAgICB2YXIgc3Vic2V0cyA9IF8uaW50ZXJzZWN0aW9uKGtleXNldCwgQ29tYmluYXRvcmljcy5wb3dlcihrZXlzLGZ1bmN0aW9uKHgpIHsgXG4gICAgICAgICAgICByZXR1cm4geC5qb2luKCd8Jyl9XG4gICAgICAgICkuc2xpY2UoMSkpO1xuICAgICAgICAvLyByZW1vdmluZyByb3dzIGZyb20gZm91bmQgc3Vic2V0c1xuICAgICAgICBzdWJzZXRzLmZvckVhY2goZnVuY3Rpb24oa2V5LCBpbmRleCkge1xuICAgICAgICAgICAgdmFyIGtrZXlzID0gXy5zcGxpdChrZXksJ3wnKTtcbiAgICAgICAgICAgIHZhciBjb21wYXRpYmxlRXhwbG9kZWQgPSBudWxsO1xuICAgICAgICAgICAgdmFyIGZyb21JbmRleCA9IGtrZXlzLm1hcChfLnBhcnRpYWwoXy5pbmRleE9mLGtleXMpKTtcbiAgICAgICAgICAgIC8vIHRyYW5zZm9ybWluZyBleHBsb2RlZCB0byBzdWJzZXQgZXhwbG9kZWRcbiAgICAgICAgICAgIGlmIChrZXkgIT09IGtleXNLZXkpIHtcbiAgICAgICAgICAgICAgICBjb21wYXRpYmxlRXhwbG9kZWQgPSBfLnVuaXFXaXRoKGV4cGxvZGVkLm1hcChmdW5jdGlvbih4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBmcm9tSW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKHhbZnJvbUluZGV4W2ldXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgICAgICB9KSxfLmlkZW50aXR5KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29tcGF0aWJsZUV4cGxvZGVkID0gZXhwbG9kZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdG9SZW1vdmUgPSBfLmludGVyc2VjdGlvbkJ5KHNlbGYuZXhwbG9kZWRGaWx0ZXJzW2tleV0sY29tcGF0aWJsZUV4cGxvZGVkLCBKU09OLnN0cmluZ2lmeSk7XG4gICAgICAgICAgICBpZiAodG9SZW1vdmUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygncmVtb3ZlICcgKyB0b1JlbW92ZSk7XG4gICAgICAgICAgICAgICAgdG9SZW1vdmUuZm9yRWFjaChmdW5jdGlvbih5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHBsb2RlZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZiA9IG5ldyBGdW5jdGlvbigneCcsICdyZXR1cm4gJyArIGZyb21JbmRleC5tYXAoZnVuY3Rpb24oaSxuKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyh4WycgKyBpICsgJ10gPT09ICcgKyB5W25dICsgJyknO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkuam9pbignICYmICcpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF8ucmVtb3ZlKGV4cGxvZGVkLCByZik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIGxvb2tpbmcgZm9yIHByZXZpb3VzbHkgYXNrZWQga2V5IHN1YnNldFxuICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHRoaXMuZXhwbG9kZWRGaWx0ZXJzW2tleXNLZXldLCBleHBsb2RlZCk7XG4gICAgXG4gICAgLy8gY2xlYW5pbmcgc3VwZXJzZXRzXG4gICAgdmFyIHN1cGVyc2V0cyA9IGtleXNldFxuICAgICAgICAubWFwKGZ1bmN0aW9uKHgpIHtcbiAgICAgICAgICAgIHJldHVybiB4LnNwbGl0KCd8Jyk7XG4gICAgICAgIH0pXG4gICAgICAgIC5maWx0ZXIoZnVuY3Rpb24oeCkge1xuICAgICAgICAgICAgcmV0dXJuIF8uZXZlcnkoa2V5cywgZnVuY3Rpb24odikge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLmluY2x1ZGVzKHgsdik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICAgICAgLmZpbHRlcihmdW5jdGlvbih4KSB7XG4gICAgICAgICAgICByZXR1cm4gIV8uaXNFcXVhbCh4LCBrZXlzKTtcbiAgICAgICAgfSk7XG4gICAgaWYgKHN1cGVyc2V0cy5sZW5ndGgpIHtcbiAgICAgICAgLy8gcmVtb3ZpbmcgYWxsIHZhbHVlcyBmcm9tIHN1cGVyc2V0c1xuICAgICAgICBzdXBlcnNldHMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIHZhciBvbGRWYWx1ZXMgPSBzZWxmLmV4cGxvZGVkRmlsdGVyc1trZXkuam9pbignfCcpXTtcbiAgICAgICAgICAgIHZhciBmcm9tSW5kZXggPSBrZXlzLm1hcChfLnBhcnRpYWwoXy5pbmRleE9mLGtleSkpO1xuICAgICAgICAgICAgZXhwbG9kZWQuZm9yRWFjaChmdW5jdGlvbih5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHJmID0gbmV3IEZ1bmN0aW9uKCd4JywgJ3JldHVybiAnICsgZnJvbUluZGV4Lm1hcChmdW5jdGlvbihpLG4pIHsgXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnKHhbJyArIGkgICsgJ10gPT09ICcgKyB5W25dICsgJyknIFxuICAgICAgICAgICAgICAgIH0pLmpvaW4oJyAmJiAnKSk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnb2xkIHJlbW92ZSBmcm9tICcgKyBrZXkgKyAnID0+ICcgKyBvbGRWYWx1ZXMuZmlsdGVyKHJmKS5qc29uKTtcbiAgICAgICAgICAgICAgICBfLnJlbW92ZShvbGRWYWx1ZXMsIHJmKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBmdXNpbmcgcmVzdWx0IGZpbHRlclxuICAgIHJldHVybiB0aGlzLmltcGxvZGUoZXhwbG9kZWQsa2V5cyk7XG59O1xuXG5GaWx0ZXJUcmFjZXIucHJvdG90eXBlLmltcGxvZGUgPSBmdW5jdGlvbiAoZXhwbG9kZWQsIGtleXMpIHtcbiAgICBpZiAoIWV4cGxvZGVkLmxlbmd0aCkgeyByZXR1cm4gbnVsbDsgfVxuICAgIHJldHVybiBfLnppcE9iamVjdChrZXlzLF8udW56aXAoZXhwbG9kZWQpLm1hcChfLnVuaXEpKTtcbn1cblxuXG5cbi8qXG50aGlzIHdhcyBwYXJ0IG9mIGxpc3RDYWNoZS5maWx0ZXIgbWV0aG9kXG4gICAgICAgIHN3aXRjaCAoZmlsdGVyTGVuKSB7XG4gICAgICAgICAgICBjYXNlIDAgOiB7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIG51bGwgb3IgYWxsXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgZ290QWxsW21vZGVsTmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gYXNrZWQpe1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgYXNrZWRbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnb3V0IDogbnVsbCAoZ290IGFsbCknKTtcbiAgICAgICAgICAgICAgICAvLyBjb25kaXRpb25hbCBjbGVhblxuICAgICAgICAgICAgICAgIGlmIChtb2RlbE5hbWUgaW4gY29tcG9zaXRlQXNrZWQpeyBcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnb3QpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgMSA6IHtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gZmlsdGVyU2luZ2xlLmNhbGwodGhpcywgbW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICAgICAgY2xlYW5Db21wb3NpdGVzLmNhbGwodGhpcywgbW9kZWwsIGZpbHRlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgdGhzID0gdGhpcztcbiAgICAgICAgdmFyIHNpbmdsZSA9IExhenkoZmlsdGVyKS5rZXlzKCkuc29tZShmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIHZhciBmID0ge307XG4gICAgICAgICAgICBmW2tleV0gPSBmaWx0ZXJba2V5XTtcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJTaW5nbGUuY2FsbCh0aHMsIG1vZGVsLCBmLCB0cnVlKSA9PSBudWxsO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHNpbmdsZSkgeyByZXR1cm4gbnVsbCB9XG4gICAgICAgIC8vIGxhenkgY3JlYXRlIGNvbXBvc2l0ZUFza2VkXG4gICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBjb21wb3NpdGVBc2tlZCkpeyBjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdID0gW107IH1cbiAgICAgICAgLy8gZXhwbG9kZSBmaWx0ZXJcbiAgICAgICAgdmFyIGV4cGxvZGVkID0gZXhwbG9kZUZpbHRlcihmaWx0ZXIpO1xuICAgICAgICAvLyBjb2xsZWN0IHBhcnRpYWxzXG4gICAgICAgIHZhciBwYXJ0aWFscyA9IGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV0uZmlsdGVyKHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIGZpbHRlciwgJyB8fCAnLHRydWUpKTtcbiAgICAgICAgLy8gY29sbGVjdCBtaXNzaW5ncyAoZXhwbG9kZWQgLSBwYXJ0aWFscylcbiAgICAgICAgaWYgKHBhcnRpYWxzLmxlbmd0aCl7XG4gICAgICAgICAgICB2YXIgYmFkICA9IFtdO1xuICAgICAgICAgICAgLy8gcGFydGlhbCBkaWZmZXJlbmNlXG4gICAgICAgICAgICBmb3IgKHZhciB4IGluIHBhcnRpYWxzKXtcbiAgICAgICAgICAgICAgICBiYWQucHVzaC5hcHBseShiYWQsZXhwbG9kZWQuZmlsdGVyKHV0aWxzLm1ha2VGaWx0ZXIobW9kZWwsIHBhcnRpYWxzW3hdLCcgJiYgJywgdHJ1ZSkpKTtcbiAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgY29uc29sZS5sb2coJ2V4cGxvZGVkIC0gcGFydGlhbCA6ICcgKyBKU09OLnN0cmluZ2lmeShiYWQpKTtcbiAgICAgICAgICAgIHZhciBtaXNzaW5ncyA9IExhenkoZXhwbG9kZWQpLmRpZmZlcmVuY2UoYmFkKS50b0FycmF5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgbWlzc2luZ3MgPSBleHBsb2RlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZpbHRlciBwYXJ0aWFsc1xuICAgICAgICBpZiAobWlzc2luZ3MubGVuZ3RoKXtcbiAgICAgICAgICAgIGNvbXBvc2l0ZUFza2VkW21vZGVsTmFtZV0ucHVzaC5hcHBseShjb21wb3NpdGVBc2tlZFttb2RlbE5hbWVdLG1pc3NpbmdzKTtcbiAgICAgICAgICAgIC8vIGFnZ3JlZ2F0ZSBtaXNzaW5nc1xuICAgICAgICAgICAgdmFyIG1pc3NpbmdzID0gTGF6eShmaWx0ZXIpLmtleXMoKS5tYXAoZnVuY3Rpb24oa2V5KXtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gTGF6eShtaXNzaW5ncykucGx1Y2soa2V5KS51bmlxdWUoKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtrZXksIHJldC5sZW5ndGg/cmV0OmZpbHRlcltrZXldXTtcbiAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4vLyAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvdXQgOiAnICsgSlNPTi5zdHJpbmdpZnkobWlzc2luZ3MpKTtcbiAgICAgICAgICAgIC8vIGNsZWFuIGNvbmRpdGlvbmFsXG4gICAgICAgICAgICBjbGVhbkNvbXBvc2l0ZXMobW9kZWwsIG1pc3NpbmdzKTtcbiAgICAgICAgICAgIHJldHVybiBtaXNzaW5ncztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiovXG5cbi8qXG4gICAgdmFyIGNhcnRlc2lhblByb2R1Y3QxID0gZnVuY3Rpb24oeCx5LGlzQXJyYXkpe1xuICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgIGlmIChpc0FycmF5KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBhIGluIHgpe1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGIgaW4geSl7XG4gICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKExhenkoW3hbYV0seVtiXV0pLmZsYXR0ZW4oKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAodmFyIGEgaW4geCl7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYiBpbiB5KXtcbiAgICAgICAgICAgICAgICAgICAgcmV0LnB1c2goW3hbYV0seVtiXV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH07XG4gICAgdmFyIGNhcnRlc2lhblByb2R1Y3QgPSBmdW5jdGlvbihhcnIpe1xuICAgICAgICB2YXIgaXNBcnJheSA9IGZhbHNlO1xuICAgICAgICB2YXIgcmV0ID0gYXJyWzBdOyBcbiAgICAgICAgZm9yICh2YXIgeCA9IDE7IHggPCBhcnIubGVuZ3RoOyArK3gpe1xuICAgICAgICAgICAgcmV0ID0gY2FydGVzaWFuUHJvZHVjdDEocmV0LCBhcnJbeF0sIGlzQXJyYXkpO1xuICAgICAgICAgICAgaXNBcnJheSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG4gICAgdmFyIGV4cGxvZGVGaWx0ZXIgPSBmdW5jdGlvbihmaWx0ZXIpIHtcbiAgICAgICAgdmFyIHByb2R1Y3QgPSBjYXJ0ZXNpYW5Qcm9kdWN0KExhenkoZmlsdGVyKS52YWx1ZXMoKS50b0FycmF5KCkpO1xuICAgICAgICB2YXIga2V5cyA9IExhenkoZmlsdGVyKS5rZXlzKCkudG9BcnJheSgpO1xuICAgICAgICByZXR1cm4gcHJvZHVjdC5tYXAoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICB2YXIgciA9IHt9O1xuICAgICAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGEsbil7XG4gICAgICAgICAgICAgICAgclthXSA9IHhbbl07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgZmlsdGVyU2luZ2xlID0gZnVuY3Rpb24obW9kZWwsIGZpbHRlciwgdGVzdE9ubHkpe1xuICAgICAgICAvLyBMYXp5IGF1dG8gY3JlYXRlIGluZGV4ZXNcbiAgICAgICAgdmFyIG1vZGVsTmFtZSA9IG1vZGVsLm1vZGVsTmFtZTtcbiAgICAgICAgdmFyIGdldEluZGV4Rm9yID0gdGhpcy5nZXRJbmRleEZvcjtcbiAgICAgICAgdmFyIGtleXMgPSBMYXp5KGZpbHRlcikubWFwKGZ1bmN0aW9uKHYsa2V5KXsgcmV0dXJuIFtrZXksIG1vZGVsTmFtZSArICcuJyArIGtleV07IH0pLnRvT2JqZWN0KCk7XG4gICAgICAgIHZhciBpbmRleGVzID0gTGF6eShmaWx0ZXIpLmtleXMoKS5tYXAoZnVuY3Rpb24oa2V5KXsgcmV0dXJuIFtrZXksIGdldEluZGV4Rm9yKG1vZGVsTmFtZSwga2V5KV19KS50b09iamVjdCgpOyBcbiAgICAgICAgLy8gZmFrZSBmb3IgKGl0IHdpbGwgY3ljbGUgb25jZSlcbiAgICAgICAgZm9yICh2YXIgeCBpbiBmaWx0ZXIpe1xuICAgICAgICAgICAgLy8gZ2V0IGFza2VkIGluZGV4IGFuZCBjaGVjayBwcmVzZW5jZVxuICAgICAgICAgICAgdmFyIGRpZmZlcmVuY2UgPSBMYXp5KGZpbHRlclt4XSkuZGlmZmVyZW5jZShpbmRleGVzW3hdKS50b0FycmF5KCk7XG4gICAgICAgICAgICBpZiAoZGlmZmVyZW5jZS5sZW5ndGgpe1xuICAgICAgICAgICAgICAgIC8vIGdlbmVyYXRlIG5ldyBmaWx0ZXJcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gTGF6eShbW3gsIGRpZmZlcmVuY2VdXSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgICAgICAvLyByZW1lbWJlciBhc2tlZFxuICAgICAgICAgICAgICAgIGlmICghdGVzdE9ubHkpXG4gICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGluZGV4ZXNbeF0sIGRpZmZlcmVuY2UpO1xuLy8gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NpbmdsZSBmaWx0ZXIgOiAnICsgSlNPTi5zdHJpbmdpZnkoZmlsdGVyKSArICdcXG5PdXQgOicgKyBKU09OLnN0cmluZ2lmeShyZXQpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzaW5nbGUgZmlsdGVyIDogJyArIEpTT04uc3RyaW5naWZ5KGZpbHRlcikgKyAnXFxuT3V0IDogbnVsbCcpO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHZhciBjbGVhbkNvbXBvc2l0ZXMgPSBmdW5jdGlvbihtb2RlbCxmaWx0ZXIpe1xuICAgICAgICAvLyBsYXp5IGNyZWF0ZSBjb25kaXRpb25hbCBhc2tlZCBpbmRleFxuICAgICAgICBpZiAoIShtb2RlbC5uYW1lIGluIGNvbXBvc2l0ZUFza2VkKSkgeyBjb21wb3NpdGVBc2tlZFttb2RlbC5uYW1lXSA9IFtdIH07XG4gICAgICAgIHZhciBpbmRleCA9IGNvbXBvc2l0ZUFza2VkW21vZGVsLm5hbWVdO1xuICAgICAgICAvLyBzZWFyY2ggZm9yIGFsbCBlbGVtZW50cyB3aG8gaGF2ZSBzYW1lIHBhcnRpYWxcbiAgICAgICAgdmFyIGZpbHRlckxlbiA9IExhenkoZmlsdGVyKS5zaXplKCk7XG4gICAgICAgIHZhciBpdGVtcyA9IGluZGV4LmZpbHRlcih1dGlscy5tYWtlRmlsdGVyKG1vZGVsLCBmaWx0ZXIsICcgJiYgJyx0cnVlKSkuZmlsdGVyKGZ1bmN0aW9uKGl0ZW0peyBMYXp5KGl0ZW0pLnNpemUoKSA+IGZpbHRlckxlbiB9KTtcbi8vICAgICAgICBjb25zb2xlLmxvZygnZGVsZXRpbmcgOicgKyBKU09OLnN0cmluZ2lmeShpdGVtcykpO1xuICAgIH07XG5cbiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBNYW55VG9NYW55UmVsYXRpb24ocmVsYXRpb24sbTJtKXtcbiAgICB2YXIgaXRlbXMgPSBbXTtcbiAgICB0aGlzLmFkZCA9IGl0ZW1zLnB1c2guYmluZChpdGVtcyk7XG4gICAgdGhpcy5hZGQgPSBmdW5jdGlvbihpdGVtKXtcbiAgLy8gICAgICBjb25zb2xlLmxvZygnYWRkaW5nICcgKyBpdGVtKTtcbiAgICAgICAgaWYgKCEoTGF6eShpdGVtcykuZmluZChpdGVtKSkpe1xuICAgICAgICAgICAgaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZ2V0MCA9IGZ1bmN0aW9uKGlkKXtcbiAgICAgICAgbTJtWzFdLmFzayhpZCk7XG4gICAgICAgIHJldHVybiBMYXp5KGl0ZW1zKS5maWx0ZXIoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICByZXR1cm4geFswXSA9PT0gaWQ7XG4gICAgICAgIH0pLnBsdWNrKFwiMVwiKS50b0FycmF5KCk7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0MSA9IGZ1bmN0aW9uKGlkKXtcbiAgICAgICAgbTJtWzBdLmFzayhpZCk7XG4gICAgICAgIHJldHVybiBMYXp5KGl0ZW1zKS5maWx0ZXIoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICByZXR1cm4geFsxXSA9PT0gaWQ7XG4gICAgICAgIH0pLnBsdWNrKFwiMFwiKS50b0FycmF5KCk7XG4gICAgfTtcbiAgICB0aGlzWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZShyZWxhdGlvbi5pbmRleE5hbWUuc3BsaXQoJy8nKVsxXSldID0gdGhpcy5nZXQxO1xuICAgIHRoaXNbJ2dldCcgKyB1dGlscy5jYXBpdGFsaXplKHJlbGF0aW9uLmluZGV4TmFtZS5zcGxpdCgnLycpWzBdKV0gPSB0aGlzLmdldDA7XG5cbiAgICB0aGlzLmRlbCA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICB2YXIgbCA9IGl0ZW1zLmxlbmd0aDtcbiAgICAgICAgdmFyIGlkeCA9IG51bGw7XG4gICAgICAgIGZvciAodmFyIGEgPSAwOyBhIDwgbDsgYSsrKXsgXG4gICAgICAgICAgICBpZiAoKGl0ZW1zW2FdWzBdID09PSBpdGVtWzBdKSAmJiAoaXRlbXNbYV1bMV0gPT09IGl0ZW1bMV0pKXtcbiAgICAgICAgICAgICAgICBpZHggPSBhO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpZHgpe1xuICAgICAgICAgICAgaXRlbXMuc3BsaWNlKGEsIDEpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKCdkZWxldGluZyAnLCBpdGVtKTtcbiAgICB9O1xufSIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gY2FjaGVkUHJvcGVydHlCeUV2ZW50cyhwcm90bywgcHJvcGVydHlOYW1lLGdldHRlciwgc2V0dGVyKXtcbiAgICB2YXIgZXZlbnRzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDQpO1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICBcbiAgICBMYXp5KGV2ZW50cykuZWFjaChmdW5jdGlvbihldmVudCl7XG4gICAgICAgIHByb3RvLm9ybS5vbihldmVudCxmdW5jdGlvbigpe1xuICAgICAgICAgICAgcmVzdWx0ID0ge307XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHZhciBwcm9wZXJ0eURlZiA9IHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBjYWNoZWQoKXtcbi8vICAgICAgICAgICAgcmV0dXJuIGdldHRlci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgaWYgKCEodGhpcy5pZCBpbiByZXN1bHQpKXtcbiAgICAgICAgICAgICAgICByZXN1bHRbdGhpcy5pZF0gPSBnZXR0ZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHRbdGhpcy5pZF07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGlmIChzZXR0ZXIpe1xuICAgICAgICBwcm9wZXJ0eURlZlsnc2V0J10gPSBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgICAgICBpZiAoIWlzRmluaXRlKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlkIGluIHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgcmVzdWx0W3RoaXMuaWRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gcmVzdWx0W3RoaXMuaWRdKXtcbiAgICAgICAgICAgICAgICBzZXR0ZXIuY2FsbCh0aGlzLHZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pZCBpbiByZXN1bHQpe1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgcmVzdWx0W3RoaXMuaWRdO1xuICAgICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm90bywgcHJvcGVydHlOYW1lLHByb3BlcnR5RGVmKTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gTGF6eUxpbmtlcihhY3RpdmVzLCBJREIsIG9ybSwgbGlzdENhY2hlKSB7XG4gICAgdmFyIHVuc29sdmVkRmlsdGVycyA9IHt9O1xuICAgIHRoaXMucmVzb2x2ZSA9IGZ1bmN0aW9uKG1vZGVsTmFtZSwgZmlsdGVyKSB7XG4gICAgICAgIHVuc29sdmVkX2ZpbHRlcnMucHVzaChmaWx0ZXIpO1xuICAgIH07XG4gICAgXG4gICAgZnVuY3Rpb24gbWVyZ2VGaWx0ZXJzKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIGZvciAodmFyIG1vZGVsTmFtZSBpbiB1bnNvbHZlZEZpbHRlcnMpIHtcbiAgICAgICAgICAgIHVuc29sdmVkRmlsdGVyc1ttb2RlbE5hbWVdLmZvckVhY2goZnVuY3Rpb24oZmlsdGVyKSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gQ29sbGVjdGlvbihvcm0sIG1vZGVsTmFtZSwgZmlsdGVyLCBwYXJ0aWFsLCBvcmRlcmJ5LCBpcHApIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGZpbHRlckZ1bmN0aW9uID0gbnVsbDtcbiAgICB2YXIgdXBkYXRlRGF0YSA9IG5ldyBIYW5kbGVyKCk7XG4gICAgdmFyIHBhZ2UgPSAxO1xuICAgIHZhciAkb3JtID0gb3JtLiRvcm07XG4gICAgdGhpcy51cGRhdGVEYXRhID0gdXBkYXRlRGF0YS5hZGRIYW5kbGVyLmJpbmQodXBkYXRlRGF0YSk7XG4gICAgdGhpcy5pdGVtcyA9IFtdO1xuLy8gICAgdGhpcy5mb3JFYWNoID0gdGhpcy5pdGVtcy5mb3JFYWNoLmJpbmQodGhpcy5pdGVtcyk7XG4gICAgJG9ybS5kZXNjcmliZShtb2RlbE5hbWUsIGZ1bmN0aW9uKE1vZGVsKXtcbiAgICAgICAgc2VsZi5tb2RlbCA9IE1vZGVsO1xuICAgICAgICBmaWx0ZXJGdW5jdGlvbiA9IHV0aWxzLm1ha2VGaWx0ZXIoTW9kZWwsIGZpbHRlcik7XG4gICAgfSk7XG4gICAgdGhpcy5tb2RlbE5hbWUgPSBtb2RlbE5hbWU7XG4gICAgdGhpcy5pbml0aWFsRmlsdGVyID0gZmlsdGVyXG4gICAgdGhpcy5wYXJ0aWFsID0gcGFydGlhbCB8fCBmYWxzZTtcblxuXG4gICAgdmFyIHVwZGF0ZVZhbHVlcyA9IGZ1bmN0aW9uKG5ld0l0ZW1zKSB7XG4gICAgICAgIGlmIChvcmRlcmJ5KSB7XG4gICAgICAgICAgICBuZXdJdGVtcyA9IF8ub3JkZXJieShuZXdJdGVtcywgXy5rZXlzKG9yZGVyYnkpLCBfLnZhbHVlcyhvcmRlcmJ5KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlwcCkge1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5mb3JFYWNoID0gc2VsZi5pdGVtcy5mb3JFYWNoLmJpbmQoc2VsZi5pdGVtcyk7XG4gICAgfTtcblxuICAgICRvcm0ucXVlcnkobW9kZWxOYW1lLCBmaWx0ZXIsIG51bGwsIGZ1bmN0aW9uKGl0ZW1zKXtcbiAgICAgICAgc2VsZi5pdGVtcyA9IGl0ZW1zO1xuICAgIH0pO1xuXG4gICAgb3JtLm9uKCd1cGRhdGVkLScgKyBtb2RlbE5hbWUsIGZ1bmN0aW9uKGl0ZW1zKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignY29sbGVjdGlvbiB1cGRhdGUgJyArIG1vZGVsTmFtZSwgaXRlbXMpO1xuICAgIH0pO1xuXG4gICAgb3JtLm9uKCduZXctJyArIG1vZGVsTmFtZSwgZnVuY3Rpb24oaXRlbXMpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdjb2xsZWN0aW9uIG5ldyAnICsgbW9kZWxOYW1lLCBpdGVtcyk7XG4gICAgICAgIGl0ZW1zID0gaXRlbXMudG9BcnJheSgpO1xuICAgICAgICBzZWxmLml0ZW1zID0gXy51bmlvbihzZWxmLml0ZW1zLCBpdGVtcy5maWx0ZXIoZmlsdGVyRnVuY3Rpb24pKTtcbiAgICAgICAgdXBkYXRlRGF0YS5oYW5kbGUoc2VsZik7XG4gICAgfSk7XG5cbiAgICBvcm0ub24oJ2RlbGV0ZWQtJyArIG1vZGVsTmFtZSwgZnVuY3Rpb24oaXRlbXMpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdjb2xsZWN0aW9uIGRlbGV0ZSAnICsgbW9kZWxOYW1lLCBpdGVtcyk7XG4gICAgfSk7XG59O1xuXG5Db2xsZWN0aW9uLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gdGhpcy5pdGVtcy5mb3JFYWNoKGYpO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gVmFsaWRhdGlvbkVycm9yKGRhdGEpe1xuICAgIHRoaXMucmVzb3VyY2UgPSBkYXRhLl9yZXNvdXJjZTtcbiAgICB0aGlzLmZvcm1JZHggPSBkYXRhLmZvcm1JZHg7XG4gICAgdGhpcy5maWVsZHMgPSBkYXRhLmVycm9ycztcbn1cbnZhciBiYXNlT1JNID0gZnVuY3Rpb24ob3B0aW9ucywgZXh0T1JNKXtcbiAgICBcbiAgICAvLyBjcmVhdGluZyByZXdoZWVsIGNvbm5lY3Rpb25cbiAgICBpZiAob3B0aW9ucy5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKXtcbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBuZXcgcmVXaGVlbENvbm5lY3Rpb24ob3B0aW9ucyk7XG4gICAgfSBlbHNlIGlmIChvcHRpb25zLmNvbnN0cnVjdG9yID09PSB1dGlscy5yZVdoZWVsQ29ubmVjdGlvbil7XG4gICAgICAgIHZhciBjb25uZWN0aW9uID0gb3B0aW9ucztcbiAgICB9XG4gICAgdGhpcy5jb25uZWN0aW9uID0gY29ubmVjdGlvbjtcbiAgICBjb25uZWN0aW9uLm9uKCdjb25uZWN0ZWQnLCBmdW5jdGlvbigpeyBcbiAgICAgICAgdGhpcy5jb25uZWN0ZWQgPSB0cnVlO1xuICAgIH0pO1xuICAgIHRoaXMub24gPSBjb25uZWN0aW9uLm9uO1xuICAgIHRoaXMuZW1pdCA9IGNvbm5lY3Rpb24uZW1pdDtcbiAgICB0aGlzLnVuYmluZCA9IGNvbm5lY3Rpb24udW5iaW5kO1xuICAgIHRoaXMub25jZSA9IGNvbm5lY3Rpb24ub25jZTtcbiAgICB0aGlzLiRwb3N0ID0gY29ubmVjdGlvbi4kcG9zdC5iaW5kKGNvbm5lY3Rpb24pO1xuXG4gICAgLy8gaGFuZGxpbmcgd2Vic29ja2V0IGV2ZW50c1xuICAgIHRoaXMub24oJ3dzLWNvbm5lY3RlZCcsZnVuY3Rpb24od3Mpe1xuICAgICAgICBjb25zb2xlLmluZm8oJ1dlYnNvY2tldCBjb25uZWN0ZWQnKTtcbiAgICAgICAgLy8gYWxsIGpzb24gZGF0YSBoYXMgdG8gYmUgcGFyc2VkIGJ5IGdvdERhdGFcbiAgICAgICAgd3Mub25NZXNzYWdlSnNvbihXMlBSRVNPVVJDRS5nb3REYXRhLmJpbmQoVzJQUkVTT1VSQ0UpKTtcbiAgICAgICAgLy9cbiAgICAgICAgd3Mub25NZXNzYWdlVGV4dChmdW5jdGlvbihtZXNzYWdlKXtcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnV1MgbWVzc2FnZSA6ICcgKyBtZXNzYWdlKVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICB0aGlzLm9uKCd3cy1kaXNjb25uZWN0ZWQnLCBmdW5jdGlvbih3cyl7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dlYnNvY2tldCBkaXNjb25uZWN0ZWQnKVxuICAgIH0pO1xuICAgIHRoaXMub24oJ2Vycm9yLWpzb24tNDA0JyxmdW5jdGlvbihlcnJvcix1cmwsIHNlbnREYXRhLCB4aHIpeyBcbiAgICAgICAgY29uc29sZS5lcnJvcignSlNPTiBlcnJvciAnLCBKU09OLnN0cmluZ2lmeShlcnJvcikpO1xuICAgICAgICBkZWxldGUgd2FpdGluZ0Nvbm5lY3Rpb25zW3VybC5zcGxpdCgnLycpWzBdXTtcbiAgICB9KTtcbiAgICB0aGlzLm9uKCdyZWFsdGltZS1tZXNzYWdlLWpzb24nLCBmdW5jdGlvbihtZXNzYWdlKXtcbiAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShtZXNzYWdlKTtcbiAgICB9KTtcblxuICAgIC8vIGluaXRpYWxpemF0aW9uXG4gICAgdmFyIFcyUFJFU09VUkNFID0gdGhpcztcbiAgICB2YXIgSURCID0ge2F1dGhfZ3JvdXAgOiBMYXp5KHt9KX07IC8vIHRhYmxlTmFtZSAtPiBkYXRhIGFzIEFycmF5XG4gICAgdmFyIElEWCA9IHt9OyAvLyB0YWJsZU5hbWUgLT4gTGF6eShpbmRleEJ5KCdpZCcpKSAtPiBJREJbZGF0YV1cbiAgICB2YXIgUkVWSURYID0ge307IC8vIHRhYmxlTmFtZSAtPiBmaWVsZE5hbWUgLT4gTGF6eS5ncm91cEJ5KCkgLT4gSURCW0RBVEFdXG4gICAgdmFyIGJ1aWxkZXJIYW5kbGVycyA9IHt9O1xuICAgIHZhciBidWlsZGVySGFuZGxlclVzZWQgPSB7fTtcbiAgICB2YXIgcGVyc2lzdGVudEF0dHJpYnV0ZXMgPSB7fTtcbiAgICB2YXIgZXZlbnRIYW5kbGVycyA9IHt9O1xuICAgIHZhciBwZXJtaXNzaW9uV2FpdGluZyA9IHt9O1xuICAgIHZhciBtb2RlbENhY2hlID0ge307XG4gICAgdmFyIGZhaWxlZE1vZGVscyA9IHt9O1xuICAgIHZhciB3YWl0aW5nQ29ubmVjdGlvbnMgPSB7fSAvLyBhY3R1YWwgY29ubmVjdGlvbiB3aG8gaSdtIHdhaXRpbmcgZm9yXG4gICAgdmFyIGxpc3RDYWNoZSA9IG5ldyBMaXN0Q2FjaGVyKExhenkpO1xuICAgIHZhciBsaW5rZXIgPSBuZXcgQXV0b0xpbmtlcih3YWl0aW5nQ29ubmVjdGlvbnMsSURCLCB0aGlzLCBsaXN0Q2FjaGUpO1xuLyogICAgd2luZG93LmxsID0gbGlua2VyO1xuICAgIHdpbmRvdy5sYyA9IGxpc3RDYWNoZTtcbiovXG4vKlxuICAgIHdpbmRvdy5JREIgPSBJREI7XG4qL1xuICAgIHRoaXMuSURCID0gSURCO1xuICAgIHRoaXMudmFsaWRhdGlvbkV2ZW50ID0gdGhpcy5vbignZXJyb3ItanNvbi01MTMnLCBmdW5jdGlvbihkYXRhLCB1cmwsIHNlbnREYXRhLCB4aHIpe1xuICAgICAgICBpZiAoY3VycmVudENvbnRleHQuc2F2aW5nRXJyb3JIYW5sZGVyKXtcbiAgICAgICAgICAgIGN1cnJlbnRDb250ZXh0LnNhdmluZ0Vycm9ySGFubGRlcihuZXcgVmFsaWRhdGlvbkVycm9yKGRhdGEpKTtcbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICB2YXIgZ2V0SW5kZXggPSBmdW5jdGlvbiAoaW5kZXhOYW1lKSB7XG4gICAgICAgIGlmIChpbmRleE5hbWUgaW4gSURCKVxuICAgICAgICAgICAgcmV0dXJuIElEQltpbmRleE5hbWVdO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIElEQltpbmRleE5hbWVdID0gTGF6eSh7fSk7XG4gICAgICAgICAgICByZXR1cm4gSURCW2luZGV4TmFtZV07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBnZXRVbmxpbmtlZCA9IGZ1bmN0aW9uIChpbmRleE5hbWUpIHtcbiAgICAgICAgaWYgKGluZGV4TmFtZSBpbiBVTkxJTktFRClcbiAgICAgICAgICAgIHJldHVybiBVTkxJTktFRFtpbmRleE5hbWVdO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIFVOTElOS0VEW2luZGV4TmFtZV0gPSB7fTtcbiAgICAgICAgICAgIHJldHVybiBVTkxJTktFRFtpbmRleE5hbWVdO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFBlcm1pc3Npb25UYWJsZShpZCwga2xhc3MsIHBlcm1pc3Npb25zKSB7XG4gICAgICAgIC8vIGNyZWF0ZSBQZXJtaXNzaW9uVGFibGUgY2xhc3NcbiAgICAgICAgdGhpcy5rbGFzcyA9IGtsYXNzO1xuICAgICAgICB0aGlzLnBlcm1pc3Npb25zID0gW107XG4gICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgZm9yICh2YXIgayBpbiBwZXJtaXNzaW9ucykge1xuICAgICAgICAgICAgdGhpcy5wdXNoLmFwcGx5KHRoaXMsIFtrLCBwZXJtaXNzaW9uc1trXV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIFBlcm1pc3Npb25UYWJsZS5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAvLyBzYXZlIE9iamVjdCB0byBzZXJ2ZXJcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBwZXJtaXNzaW9uczogTGF6eSh0aGlzLnBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW3hbMF0uaWQsIHhbMV1dXG4gICAgICAgICAgICB9KS50b09iamVjdCgpXG4gICAgICAgIH07XG4gICAgICAgIGRhdGEuaWQgPSB0aGlzLmlkO1xuICAgICAgICB2YXIgbW9kZWxOYW1lID0gdGhpcy5rbGFzcy5tb2RlbE5hbWU7XG4gICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KHRoaXMua2xhc3MubW9kZWxOYW1lICsgJy5zZXRfcGVybWlzc2lvbnMnLCBkYXRhLCBmdW5jdGlvbiAobXlQZXJtcywgYSwgYiwgcmVxKSB7XG4gICAgICAgICAgICBjYihteVBlcm1zKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBQZXJtaXNzaW9uVGFibGUucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAoZ3JvdXBfaWQsIHBlcm1pc3Npb25MaXN0KSB7XG4gICAgICAgIHZhciBwID0gTGF6eShwZXJtaXNzaW9uTGlzdCk7XG4gICAgICAgIHZhciBwZXJtcyA9IExhenkodGhpcy5rbGFzcy5hbGxQZXJtaXNzaW9ucykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4gW3gsIHAuY29udGFpbnMoeCldXG4gICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgIHZhciBsID0gTGF6eSh0aGlzLnBlcm1pc3Npb25zKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHJldHVybiB4WzBdLmlkXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAobC5jb250YWlucyhncm91cF9pZCkpXG4gICAgICAgICAgICB0aGlzLnBlcm1pc3Npb25zW2wuaW5kZXhPZihncm91cF9pZCldWzFdID0gcGVybXM7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRoaXMucGVybWlzc2lvbnMucHVzaChbSURCLmF1dGhfZ3JvdXAuZ2V0KGdyb3VwX2lkKSwgcGVybXNdKTtcbiAgICB9O1xuXG4gICAgLy8gY3JlYXRlcyBkeW5hbWljYWwgbW9kZWxzXG4gICAgdmFyIG1ha2VNb2RlbENsYXNzID0gZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgICAgIHZhciBfbW9kZWwgPSBtb2RlbDtcbiAgICAgICAgbW9kZWwuZmllbGRzLmlkLnJlYWRhYmxlID0gZmFsc2U7XG4gICAgICAgIG1vZGVsLmZpZWxkcy5pZC53cml0YWJsZSA9IGZhbHNlO1xuICAgICAgICB2YXIgZmllbGRzID0gTGF6eShtb2RlbC5maWVsZHMpO1xuICAgICAgICBpZiAobW9kZWwucHJpdmF0ZUFyZ3MpIHtcbiAgICAgICAgICAgIGZpZWxkcyA9IGZpZWxkcy5tZXJnZShtb2RlbC5wcml2YXRlQXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgnbW9kZWwtZGVmaW5pdGlvbicsIG1vZGVsLCBnZXRJbmRleChtb2RlbC5uYW1lKSk7XG4gICAgICAgIC8vIGdldHRpbmcgZmllbGRzIG9mIHR5cGUgZGF0ZSBhbmQgZGF0ZXRpbWVcbi8qXG4gICAgICAgIHZhciBEQVRFRklFTERTID0gZmllbGRzLmZpbHRlcihmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuICh4LnR5cGUgPT0gJ2RhdGUnKSB8fCAoeC50eXBlID09ICdkYXRldGltZScpXG4gICAgICAgIH0pLm1hcChmdW5jdGlvbiAoeCwgdikge1xuICAgICAgICAgICAgcmV0dXJuIFt2LCB0cnVlXVxuICAgICAgICB9KS50b09iamVjdCgpO1xuXG4gICAgICAgIC8vIGdldHRpbmcgYm9vbGVhbiBmaWVsZHNcbiAgICAgICAgdmFyIEJPT0xGSUVMRFMgPSBmaWVsZHMuZmlsdGVyKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4gKHgudHlwZSA9PSAnYm9vbGVhbicpXG4gICAgICAgIH0pLm1hcChmdW5jdGlvbiAoeCwgdikge1xuICAgICAgICAgICAgcmV0dXJuIFt2LCB0cnVlXVxuICAgICAgICB9KS50b09iamVjdCgpO1xuXG4gICAgICAgIC8vIGJvb2xlYW5zIGFuZCBkYXRldGltZXMgc3RvcmFnZSBleHRlcm5hbCBcbiAgICAgICAgTU9ERUxfREFURUZJRUxEU1ttb2RlbC5uYW1lXSA9IERBVEVGSUVMRFM7XG4gICAgICAgIE1PREVMX0JPT0xGSUVMRFNbbW9kZWwubmFtZV0gPSBCT09MRklFTERTO1xuKi9cbiAgICAgICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICAgICAgdmFyIGZ1bmNTdHJpbmcgPSBcImlmICghcm93KSB7IHJvdyA9IHt9fTtcXG5cIjtcbiAgICAgICAgZnVuY1N0cmluZyArPSBtb2RlbC5yZWZlcmVuY2VzLm1hcChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICByZXR1cm4gJ3RoaXMuXycgKyBmaWVsZC5pZCArICcgPSByb3cuJyArIGZpZWxkLmlkICsgJzsnO1xuICAgICAgICB9KS5qb2luKCc7XFxuJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBkYXRlZmllbGQgY29udmVyc2lvblxuICAgICAgICBmdW5jU3RyaW5nICs9IGZpZWxkcy5tYXAoZnVuY3Rpb24gKHgsaykge1xuICAgICAgICAgICAgaWYgKCh4LnR5cGUgPT0gJ2RhdGUnKSB8fCAoeC50eXBlID09ICdkYXRldGltZScpKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ3RoaXMuJyArIGsgKyAnID0gcm93LicgKyBrICsgJz9uZXcgRGF0ZShyb3cuJyArIGsgKyAnICogMTAwMCAtICcgKyB1dGlscy50ek9mZnNldCArICcpOm51bGw7XFxuJzsgXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHgudHlwZSA9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ3RoaXMuJyArIGsgKyAnID0gKHJvdy4nICsgayArICcgPT09IFwiVFwiKSB8fCAocm93LicgKyBrICsgJyA9PT0gdHJ1ZSk7XFxuJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICd0aGlzLicgKyBrICsgJyA9IHJvdy4nICsgayArICc7XFxuJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkudG9TdHJpbmcoJ1xcbicpOyArICdcXG4nO1xuXG4gICAgICAgIGZ1bmNTdHJpbmcgKz0gXCJpZiAocGVybWlzc2lvbnMpIHt0aGlzLl9wZXJtaXNzaW9ucyA9IHBlcm1pc3Npb25zICYmIExhenkocGVybWlzc2lvbnMpLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gW3gsIHRydWVdIH0pLnRvT2JqZWN0KCk7fVwiXG5cbiAgICAgICAgXG4gICAgICAgIC8vIG1hc3RlciBjbGFzcyBmdW5jdGlvblxuICAgICAgICB2YXIgS2xhc3MgPSB1dGlscy5yZW5hbWVGdW5jdGlvbih1dGlscy5jYXBpdGFsaXplKG1vZGVsLm5hbWUpLCBuZXcgRnVuY3Rpb24oJ3JvdycsICdwZXJtaXNzaW9ucycsZnVuY1N0cmluZykpO1xuICAgICAgICAvL3ZhciBLbGFzcyA9IG5ldyBGdW5jdGlvbigncm93JywgJ3Blcm1pc3Npb25zJyxmdW5jU3RyaW5nKTtcbiAgICAgICAgXG5cbiAgICAgICAgS2xhc3MucHJvdG90eXBlLm9ybSA9IGV4dE9STTtcbiAgICAgICAgS2xhc3MucmVmX3RyYW5zbGF0aW9ucyA9IHt9O1xuICAgICAgICBLbGFzcy5tb2RlbE5hbWUgPSBtb2RlbC5uYW1lO1xuICAgICAgICBLbGFzcy5yZWZlcmVuY2VzID0gTGF6eShtb2RlbC5yZWZlcmVuY2VzKS5wbHVjaygnaWQnKS50b0FycmF5KCk7XG5cbiAgICAgICAgS2xhc3MuaW52ZXJzZV9yZWZlcmVuY2VzID0gbW9kZWwucmVmZXJlbmNlZEJ5Lm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgLy8gbWFuYWdpbmcgcmVmZXJlbmNlcyB3aGVyZSBcbiAgICAgICAgICAgIHJldHVybiB4LmJ5ICsgJ18nICsgeC5pZCArICdfc2V0J1xuICAgICAgICB9KTtcbiAgICAgICAgS2xhc3MucmVmZXJlbnRzID0gbW9kZWwucmVmZXJlbmNlZEJ5Lm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuIFt4LmJ5LCB4LmlkXVxuICAgICAgICB9KTtcbiAgICAgICAgS2xhc3MuZmllbGRzT3JkZXIgPSBtb2RlbC5maWVsZE9yZGVyO1xuICAgICAgICBLbGFzcy5hbGxQZXJtaXNzaW9ucyA9IG1vZGVsLnBlcm1pc3Npb25zO1xuXG4gICAgICAgIC8vIHJlZGVmaW5pbmcgdG9TdHJpbmcgbWV0aG9kXG4gICAgICAgIGlmIChMYXp5KG1vZGVsLnJlcHJlc2VudGF0aW9uKS5zaXplKCkpe1xuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlLnRvU3RyaW5nID0gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcy4nICsgTGF6eShtb2RlbC5yZXByZXNlbnRhdGlvbikudG9TdHJpbmcoJyArIFwiIFwiICsgdGhpcy4nKSk7XG4gICAgICAgIH1cbiAgICAgICAgS2xhc3MucHJvdG90eXBlLnRvVXBwZXJDYXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gcmVkZWZpbmUgdG8gVXBwZXJDYXNlXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b1N0cmluZygpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIH07XG4gICAgICBcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLnRvTG93ZXJDYXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIGRlbGV0ZSBpbnN0YW5jZSBmcm9tIHNlcnZlclxuICAgICAgICAgICAgcmV0dXJuIGV4dE9STS5kZWxldGUodGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUsIFt0aGlzLmlkXSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gcGVybWlzc2lvbiBnZXR0ZXIgcHJvcGVydHlcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtsYXNzLnByb3RvdHlwZSwgJ3Blcm1pc3Npb25zJywge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Blcm1pc3Npb25zKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcGVybWlzc2lvbnM7XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmtlci5wZXJtaXNzaW9uc1t0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZV0uYXNrKHRoaXMuaWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGdldHRpbmcgZnVsbCBwZXJtaXNzaW9uIHRhYmxlIGZvciBhbiBvYmplY3RcbiAgICAgICAgS2xhc3MucHJvdG90eXBlLmFsbF9wZXJtcyA9IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAgICAgdmFyIG9iamVjdF9pZCA9IHRoaXMuaWQ7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS4kcG9zdCh0aGlzLmNvbnN0cnVjdG9yLm1vZGVsTmFtZSArICcuYWxsX3Blcm1zJywge2lkOiB0aGlzLmlkfSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGVybWlzc2lvbnMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIHZhciBncm91cGVkID0ge307XG4gICAgICAgICAgICAgICAgdmFyIHVua25vd25fZ3JvdXBzID0gTGF6eShwZXJtaXNzaW9ucykucGx1Y2soJ2dyb3VwX2lkJykudW5pcXVlKCkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnJyArIHhcbiAgICAgICAgICAgICAgICB9KS5kaWZmZXJlbmNlKElEQi5hdXRoX2dyb3VwLmtleXMoKSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIExhenkocGVybWlzc2lvbnMpLmdyb3VwQnkoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHguZ3JvdXBfaWRcbiAgICAgICAgICAgICAgICB9KS5lYWNoKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwZWRba10gPSBMYXp5KHYpLnBsdWNrKCduYW1lJykudG9BcnJheSgpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIGNhbGwgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICBjYihuZXcgUGVybWlzc2lvblRhYmxlKG9iamVjdF9pZCwgS2xhc3MsIGdyb3VwZWQpKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmICh1bmtub3duX2dyb3Vwcy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdldCgnYXV0aF9ncm91cCcsdW5rbm93bl9ncm91cHMsY2FsbCk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBjYWxsKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBLbGFzcy5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgbyA9IHRoaXMuYXNSYXcoKTtcbiAgICAgICAgICAgIHZhciBmaWVsZHMgPSBLbGFzcy5maWVsZHM7XG4gICAgICAgICAgICB2YXIgSUQgPSB0aGlzLmlkO1xuICAgICAgICAgICAgdmFyIG1vZGVsTmFtZSA9IHRoaXMuY29uc3RydWN0b3IubW9kZWxOYW1lO1xuICAgICAgICAgICAgaWYgKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBhcmcgaW4gYXJncykge1xuICAgICAgICAgICAgICAgICAgICBvW2FyZ10gPSBhcmdzW2FyZ107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZWxpbWluYXRlIHVud3JpdGFibGVzXG4gICAgICAgICAgICBMYXp5KEtsYXNzLmZpZWxkc09yZGVyKS5maWx0ZXIoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuICFmaWVsZHNbeF0ud3JpdGFibGU7XG4gICAgICAgICAgICB9KS5lYWNoKGZ1bmN0aW9uKGZpZWxkTmFtZSl7XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkTmFtZSBpbiBvKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvW2ZpZWxkTmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoSUQpIHsgby5pZCA9IElEOyB9XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IFcyUFJFU09VUkNFLiRwb3N0KG1vZGVsTmFtZSArIChJRCA/ICcucG9zdCcgOiAnLnB1dCcpLCBvKTtcbiAgICAgICAgICAgIGlmIChhcmdzICYmIChhcmdzLmNvbnN0cnVjdG9yID09PSBGdW5jdGlvbikpe1xuICAgICAgICAgICAgICAgIC8vIHBsYWNpbmcgY2FsbGJhY2sgaW4gYSBjb21tb24gcGxhY2VcbiAgICAgICAgICAgICAgICBwcm9taXNlLmNvbnRleHQuc2F2aW5nRXJyb3JIYW5sZGVyID0gYXJncztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlXG4gICAgICAgIH07XG4gICAgICAgIEtsYXNzLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG9iaiA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuYXNSYXcoKSk7XG4gICAgICAgICAgICBvYmouX3Blcm1pc3Npb25zID0gdGhpcy5fcGVybWlzc2lvbnM7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGJ1aWxkaW5nIHNlcmlhbGl6YXRpb24gZnVuY3Rpb25cbiAgICAgICAgdmFyIGFzciA9ICdyZXR1cm4ge1xcbicgKyBMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLm1hcChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICByZXR1cm4gZmllbGQuaWQgKyAnIDogdGhpcy5fJyArIGZpZWxkLmlkO1xuICAgICAgICB9KS5jb25jYXQoZmllbGRzLm1hcChmdW5jdGlvbiAoeCxrKSB7XG4gICAgICAgICAgICBpZiAoKHgudHlwZSA9PSAnZGF0ZScpIHx8ICh4LnR5cGUgPT0gJ2RhdGV0aW1lJykpe1xuICAgICAgICAgICAgICAgIHJldHVybiBrICsgJyA6ICh0aGlzLicgKyBrICsgJz8oTWF0aC5yb3VuZCh0aGlzLicgKyBrICsgJy5nZXRUaW1lKCkgLSB0aGlzLicgKyBrICsgJy5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDApIC8gMTAwMCk6bnVsbCknOyBcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoeC50eXBlID09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBrICsgJyA6IHRoaXMuJyArIGsgKyAnP1wiVFwiOlwiRlwiJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGsgKyAnIDogdGhpcy4nICsgaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLnRvU3RyaW5nKCcsXFxuJykgKyAnfTsnO1xuICAgICAgICBLbGFzcy5wcm90b3R5cGUuYXNSYXcgPSBuZXcgRnVuY3Rpb24oYXNyKTtcblxuICAgICAgICBLbGFzcy5zYXZlTXVsdGkgPSBmdW5jdGlvbiAob2JqZWN0cywgY2IsIHNjb3BlKSB7XG4gICAgICAgICAgICB2YXIgcmF3ID0gW107XG4gICAgICAgICAgICB2YXIgZGVsZXRhYmxlID0gTGF6eShLbGFzcy5maWVsZHMpXG4gICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXgud3JpdGFibGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5wbHVjaygnaWQnKVxuICAgICAgICAgICAgICAgIC50b0FycmF5KCk7XG4gICAgICAgICAgICBMYXp5KG9iamVjdHMpXG4gICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geC5hc1JhdygpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICBMYXp5KGRlbGV0YWJsZSkuZWFjaChmdW5jdGlvbiAoeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHhbeV07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByYXcucHVzaCh4KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFcyUFJFU09VUkNFLiRwb3N0KEtsYXNzLm1vZGVsTmFtZSwgJ3B1dCcsIHttdWx0aXBsZTogcmF3LCBmb3JtSWR4IDogVzJQUkVTT1VSQ0UuZm9ybUlkeCsrfSwgZnVuY3Rpb24gKGVsZW1zKSB7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290RGF0YShlbGVtcyk7XG4gICAgICAgICAgICAgICAgdmFyIHRhYiA9IElEQltLbGFzcy5tb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgIHZhciBvYmpzID0gTGF6eShlbGVtc1tLbGFzcy5tb2RlbE5hbWVdLnJlc3VsdHMpLnBsdWNrKCdpZCcpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFiLmdldCh4KVxuICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICBpZiAoY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgY2Iob2Jqcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgc2NvcGUpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoJ2V4dHJhX3ZlcmJzJyBpbiBtb2RlbClcbiAgICAgICAgICAgIExhenkobW9kZWwuZXh0cmFfdmVyYnMpLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZnVuY05hbWUgPSB4WzBdO1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0geFsxXTtcbiAgICAgICAgICAgICAgICB2YXIgZGRhdGEgPSAndmFyIGRhdGEgPSB7aWQgOiB0aGlzLmlkJztcbiAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIGRkYXRhICs9ICcsICcgKyBMYXp5KGFyZ3MpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4ICsgJyA6ICcgKyB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkuam9pbignLCcpO1xuICAgICAgICAgICAgICAgIGRkYXRhICs9ICd9O1xcbic7XG4gICAgICAgICAgICAgICAgYXJncyA9IFsncG9zdCcsJ2dvdERhdGEnXS5jb25jYXQoYXJncyk7XG4gICAgICAgICAgICAgICAgYXJncy5wdXNoKCdjYicpO1xuICAgICAgICAgICAgICAgIHZhciBjb2RlID0gZGRhdGEgKyAnIHJldHVybiBwb3N0KFwiJyArIEtsYXNzLm1vZGVsTmFtZSArICcuJyArIGZ1bmNOYW1lICsgJ1wiLCBkYXRhLGNiKTsnO1xuICAgICAgICAgICAgICAgIHZhciBmdW5jID0gbmV3IEZ1bmN0aW9uKGFyZ3MsIGNvZGUpO1xuICAgICAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZVtmdW5jTmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbVzJQUkVTT1VSQ0UuJHBvc3QsIFcyUFJFU09VUkNFLmdvdERhdGFdLmNvbmNhdChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzLCBhcmdzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICBpZiAoJ3ByaXZhdGVBcmdzJyBpbiBtb2RlbCkge1xuICAgICAgICAgICAgS2xhc3MucHJpdmF0ZUFyZ3MgPSBMYXp5KG1vZGVsLnByaXZhdGVBcmdzKS5rZXlzKCkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFt4LCB0cnVlXTtcbiAgICAgICAgICAgIH0pLnRvT2JqZWN0KCk7XG4gICAgICAgICAgICBLbGFzcy5wcm90b3R5cGUuc2F2ZVBBID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgICAgICAgICB2YXIgVCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIG9vID0ge2lkOiB0aGlzLmlkfTtcbiAgICAgICAgICAgICAgICB2YXIgUEEgPSB0aGlzLmNvbnN0cnVjdG9yLnByaXZhdGVBcmdzO1xuICAgICAgICAgICAgICAgIHZhciBGcyA9IHRoaXMuY29uc3RydWN0b3IuZmllbGRzO1xuICAgICAgICAgICAgICAgIHZhciB0ID0gbmV3IHRoaXMuY29uc3RydWN0b3IobykuYXNSYXcoKTtcbiAgICAgICAgICAgICAgICB2YXIgZmllbGRJZHggPSBMYXp5KFBBKS5rZXlzKCkubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbeCwgRnNbeF1dXG4gICAgICAgICAgICAgICAgfSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgICAgICBMYXp5KG8pLmVhY2goZnVuY3Rpb24gKHYsIGspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChrIGluIFBBKSAmJiBmaWVsZElkeFtrXS53cml0YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb29ba10gPSB2O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QodGhpcy5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUgKyAnLnNhdmVQQScsIG9vLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIExhenkob28pLmVhY2goZnVuY3Rpb24gKHYsIGspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFRba10gPSB2O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBtb2RlbENhY2hlW0tsYXNzLm1vZGVsTmFtZV0gPSBLbGFzcztcbiAgICAgICAgLy8gYWRkaW5nIGlkIHRvIGZpZWxkc1xuICAgICAgICBmb3IgKHZhciBmIGluIG1vZGVsLmZpZWxkcykge1xuICAgICAgICAgICAgbW9kZWwuZmllbGRzW2ZdLmlkID0gZjtcbiAgICAgICAgfVxuICAgICAgICBLbGFzcy5maWVsZHMgPSBMYXp5KG1vZGVsLmZpZWxkcykuY29uY2F0KExhenkobW9kZWwucHJpdmF0ZUFyZ3MpKS5jb25jYXQoTGF6eShtb2RlbC5yZWZlcmVuY2VzKS50YXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHgudHlwZSA9IHgudHlwZSB8fCAncmVmZXJlbmNlJ1xuICAgICAgICB9KSkuaW5kZXhCeSgnaWQnKS50b09iamVjdCgpO1xuICAgICAgICAvLyBzZXR0aW5nIHdpZGdldHMgZm9yIGZpZWxkc1xuICAgICAgICBMYXp5KEtsYXNzLmZpZWxkcykuZWFjaChmdW5jdGlvbihmaWVsZCl7XG4gICAgICAgICAgICBpZiAoIWZpZWxkLndpZGdldCl7XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09ICdyZWZlcmVuY2UnKXtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQud2lkZ2V0ID0gJ2Nob2ljZXMnXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQud2lkZ2V0ID0gZmllbGQudHlwZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBidWlsZGluZyByZWZlcmVuY2VzIHRvIChtYW55IHRvIG9uZSkgZmllbGRzXG4gICAgICAgIExhenkobW9kZWwucmVmZXJlbmNlcykuZWFjaChmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgICAgICB2YXIgZXh0X3JlZiA9IHJlZi50bztcbiAgICAgICAgICAgIHZhciBsb2NhbF9yZWYgPSAnXycgKyByZWYuaWQ7XG4gICAgICAgICAgICBjYWNoZWRQcm9wZXJ0eUJ5RXZlbnRzKEtsYXNzLnByb3RvdHlwZSwgcmVmLmlkLGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXNbbG9jYWxfcmVmXSkgeyByZXR1cm4gdXRpbHMubW9jayB9O1xuICAgICAgICAgICAgICAgIGlmICghKGV4dF9yZWYgaW4gSURCKSl7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5kZXNjcmliZShleHRfcmVmLGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlua2VyLm1haW5JbmRleFtleHRfcmVmXS5hc2sodGhzW2xvY2FsX3JlZl0sdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gKGV4dF9yZWYgaW4gSURCKSAmJiB0aGlzW2xvY2FsX3JlZl0gJiYgSURCW2V4dF9yZWZdLmdldCh0aGlzW2xvY2FsX3JlZl0pO1xuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0ICYmIChleHRfcmVmIGluIGxpbmtlci5tYWluSW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFza2luZyB0byBsaW5rZXJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzW2xvY2FsX3JlZl0gPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5rZXIubWFpbkluZGV4W2V4dF9yZWZdLmFzayh0aGlzW2xvY2FsX3JlZl0sdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ251bGwgcmVmZXJlbmNlIGZvciAnICsgbG9jYWxfcmVmICsgJygnICsgdGhpcy5pZCArICcpIHJlc291cmNlICcgKyBLbGFzcy5tb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1dGlscy5tb2NrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUuY29uc3RydWN0b3IgIT09IHV0aWxzLm1vY2spICYmICh2YWx1ZS5jb25zdHJ1Y3Rvci5tb2RlbE5hbWUgIT09IGV4dF9yZWYpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdZb3UgY2FuIGFzc2lnbiBvbmx5ICcgKyBleHRfcmVmICsgJyB0byAnICsgcmVmLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzW2xvY2FsX3JlZl0gPSB2YWx1ZS5pZDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW2xvY2FsX3JlZl0gPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sICduZXctJyArIGV4dF9yZWYsICdkZWxldGVkLScgKyBleHRfcmVmLCd1cGRhdGVkLScgKyBleHRfcmVmLCAnbmV3LW1vZGVsLScgKyBleHRfcmVmLyosICd1cGRhdGVkLScgKyBLbGFzcy5tb2RlbE5hbWUqLyk7XG5cblxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZShyZWYuaWQpXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXh0T1JNLmdldChleHRfcmVmLHRoaXNbbG9jYWxfcmVmXSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2J1aWxkaW5nIHJlZmVyZW5jZXMgdG8gKG9uZSB0byBtYW55KSBmaWVsZHNcbiAgICAgICAgTGF6eShtb2RlbC5yZWZlcmVuY2VkQnkpLmVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgICAgICAgdmFyIGluZGV4TmFtZSA9IHJlZi5ieSArICcuJyArIHJlZi5pZDtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSByZWYuYnkgKyAnXycgKyB1dGlscy5wbHVyYWxpemUocmVmLmlkKTtcbiAgICAgICAgICAgIHZhciByZXZJbmRleCA9IHJlZi5ieTtcbiAgICAgICAgICAgIGlmIChLbGFzcy5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkocHJvcGVydHlOYW1lKSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RyeWVkIHRvIHJlZGVmaW5lIHByb3BlcnR5ICcgKyBwcm9wZXJ0eU5hbWUgKyAncycgKyAnIGZvciAnICsgS2xhc3MubW9kZWxOYW1lKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2FjaGVkUHJvcGVydHlCeUV2ZW50cyhLbGFzcy5wcm90b3R5cGUsIHByb3BlcnR5TmFtZSwgZnVuY3Rpb24gKCkge1xuLypcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbHRlciA9IHt9OyBcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyW3JlZi5pZF0gPSB0aGlzLmlkO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb24oVzJQUkVTT1VSQ0UsIHJlZi5ieSwgZmlsdGVyKTtcbiovXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXQgPSAocmV2SW5kZXggaW4gSURCKSA/IFJFVklEWFtpbmRleE5hbWVdLmdldCh0aGlzLmlkICsgJycpOm51bGw7XG4gICAgICAgICAgICAgICAgICAgIGxpbmtlci5mb3JlaWduS2V5c1tpbmRleE5hbWVdLmFzayh0aGlzLmlkLHRydWUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuXG4gICAgICAgICAgICAgICAgfSwgbnVsbCAvKiwgJ25ldy0nICsgcmV2SW5kZXgsICd1cGRhdGVkLScgKyByZXZJbmRleCwgJ2RlbGV0ZWQtJyArIHJldkluZGV4Ki8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlWydnZXQnICsgdXRpbHMuY2FwaXRhbGl6ZSh1dGlscy5wbHVyYWxpemUocmVmLmJ5KSldID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBvcHRzID0ge307XG4gICAgICAgICAgICAgICAgb3B0c1tyZWYuaWRdID0gW3RoaXMuaWRdO1xuICAgICAgICAgICAgICAgIHJldHVybiBleHRPUk0uZ2V0KHJlZi5ieSxvcHRzKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vYnVpbGRpbmcgcmVmZXJlbmNlIHRvIChtYW55IHRvIG1hbnkpIGZpZWxkc1xuICAgICAgICBpZiAobW9kZWwubWFueVRvTWFueSkge1xuICAgICAgICAgICAgTGF6eShtb2RlbC5tYW55VG9NYW55KS5lYWNoKGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gcmVmLmluZGV4TmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3QgPSByZWYuZmlyc3Q/IDAgOiAxO1xuICAgICAgICAgICAgICAgIHZhciBvbW9kZWxOYW1lID0gcmVmLm1vZGVsO1xuLy8gICAgICAgICAgICAgICAgdmFyIG9tb2RlbCA9IGdldEluZGV4KG9tb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciBnZXR0ZXIgPSBsaW5rZXIubTJtSW5kZXhbaW5kZXhOYW1lXVsnZ2V0JyArICgxIC0gZmlyc3QpXTtcblxuICAgICAgICAgICAgICAgIGNhY2hlZFByb3BlcnR5QnlFdmVudHMoS2xhc3MucHJvdG90eXBlLCByZWYubW9kZWwgKyAncycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkcyA9IGdldHRlcih0aHMuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdldCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRzLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9XMlBSRVNPVVJDRS5mZXRjaChvbW9kZWxOYW1lLCB7aWQgOiBpZHN9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXQgPSBnZXRJbmRleChvbW9kZWxOYW1lKS5nZXQuYmluZChJREJbb21vZGVsTmFtZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRzICYmIGdldClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXQgPSBMYXp5KGlkcykubWFwKGdldCkuZmlsdGVyKHV0aWxzLmJvb2wpLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICAgICAgICAgIH0sIG51bGwsICdyZWNlaXZlZC1tMm0tJyArIGluZGV4TmFtZSwgJ3JlY2VpdmVkLScgKyBvbW9kZWxOYW1lKTtcblxuICAgICAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZVsnZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUodXRpbHMucGx1cmFsaXplKG9tb2RlbE5hbWUpKV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3Qpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rZXIuZ2V0TTJNKGluZGV4TmFtZSwgW3Rocy5pZF0sIGZpcnN0LGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWRzID0gZ2V0dGVyKHRocy5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHMubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmZldGNoKG9tb2RlbE5hbWUsIHtpZCA6IGlkc30sbnVsbCxmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnZXQgPSBJREJbb21vZGVsTmFtZV0uZ2V0LmJpbmQoSURCW29tb2RlbE5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQoTGF6eShpZHMpLm1hcChnZXQpLmZpbHRlcih1dGlscy5ib29sKS50b0FycmF5KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQoW10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAgICAgS2xhc3MuZmllbGRzW3V0aWxzLmNhcGl0YWxpemUob21vZGVsTmFtZSldID0ge1xuICAgICAgICAgICAgICAgICAgICBpZDogdXRpbHMuY2FwaXRhbGl6ZShvbW9kZWxOYW1lKSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogdXRpbHMuY2FwaXRhbGl6ZShvbW9kZWxOYW1lKSxcbiAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHJlYWRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTTJNJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdG9yczogW11cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgS2xhc3MucHJvdG90eXBlLnVubGlua1JlZmVyZW5jZSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHZhciBtdWx0aXBsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBJRCA9IHRoaXMuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5jb25zdHJ1Y3Rvci5uYW1lID09ICdBcnJheScpIHtcbiAgICAgICAgICAgICAgICAgICAgbXVsdGlwbGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZXMgPSBpbnN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBpbnN0YW5jZXNbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBvbW9kZWwgPSBpbnN0YW5jZS5jb25zdHJ1Y3Rvci5tb2RlbE5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKG11bHRpcGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gTGF6eShpbnN0YW5jZXMpLnBsdWNrKCdpZCcpLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtJRCwgeF1cbiAgICAgICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gW1tJRCwgaW5zdGFuY2UuaWRdXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QoS2xhc3MubW9kZWxOYW1lICsgJy8nICsgb21vZGVsICsgJ3MvZGVsZXRlJywge2NvbGxlY3Rpb246IGNvbGxlY3Rpb259KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIEtsYXNzLnByb3RvdHlwZS5saW5rUmVmZXJlbmNlID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG11bHRpcGxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIElEID0gdGhpcy5pZDtcbiAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2VzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLmNvbnN0cnVjdG9yLm5hbWUgPT0gJ0FycmF5Jykge1xuICAgICAgICAgICAgICAgICAgICBtdWx0aXBsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlcyA9IGluc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZSA9IGluc3RhbmNlc1swXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG9tb2RlbCA9IGluc3RhbmNlLmNvbnN0cnVjdG9yLm1vZGVsTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gS2xhc3MubW9kZWxOYW1lICsgJy8nICsgb21vZGVsO1xuICAgICAgICAgICAgICAgIGlmIChtdWx0aXBsZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVmcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXhOYW1lIGluIElOREVYX00yTSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcyA9IExhenkoaW5zdGFuY2VzKS5wbHVjaygnaWQnKS5kaWZmZXJlbmNlKExhenkoSU5ERVhfTTJNW2luZGV4TmFtZV1bMF0uZ2V0KHRoaXMuaWQpKSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGluZGV4TmFtZSA9IG9tb2RlbCArICcvJyArIEtsYXNzLm1vZGVsTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4TmFtZSBpbiBJTkRFWF9NMk0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnMgPSBMYXp5KGluc3RhbmNlcykucGx1Y2soJ2lkJykuZGlmZmVyZW5jZShMYXp5KElOREVYX00yTVtpbmRleE5hbWVdWzBdLmdldCh0aGlzLmlkKSkpLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocmVmcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gTGF6eShyZWZzKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW0lELCB4XVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgVzJQX1BPU1QoS2xhc3MubW9kZWxOYW1lLCBvbW9kZWwgKyAncy9wdXQnLCB7Y29sbGVjdGlvbjogY29sbGVjdGlvbn0sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoaW5kZXhOYW1lIGluIGxpbmtlci5tMm1JbmRleCkgJiYgTGF6eShsaW5rZXIubTJtSW5kZXhbaW5kZXhOYW1lXVsnZ2V0JyArIHV0aWxzLmNhcGl0YWxpemUob21vZGVsKV0oaW5zdGFuY2UuaWQpKS5maW5kKHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QoS2xhc3MubW9kZWxOYW1lICsgJy8nICsgb21vZGVsICsgJ3MucHV0Jywge2NvbGxlY3Rpb246IFtbdGhpcy5pZCwgaW5zdGFuY2UuaWRdXX0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgnbmV3LW1vZGVsJywgS2xhc3MpO1xuICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCduZXctbW9kZWwtJyArIEtsYXNzLm1vZGVsTmFtZSk7XG4gICAgICAgIHJldHVybiBLbGFzcztcbiAgICB9O1xuXG4gICAgdGhpcy5nb3REYXRhID0gZnVuY3Rpb24gKGRhdGEsIGNhbGxCYWNrKSB7XG4gICAgICAgIC8vIHJlY2VpdmUgYWxsIGRhdGEgZnJvbSBldmVyeSBlbmQgcG9pbnRcbiAgICAgICAgY29uc29sZS5pbmZvKCdnb3REYXRhJyk7XG4gICAgICAgIGlmICh0eXBlb2YoZGF0YSkgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkYXRhICcgKyBkYXRhICsgJyByZWZ1c2VkIGZyb20gZ290RGF0YSgpJyk7XG4gICAgICAgICAgICBpZiAoY2FsbEJhY2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbEJhY2soZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gY2xlYW4gZGF0YSBmcm9tIHJlbGF0aW9ucyBhbmQgcGVybWlzc2lvbnMgZm9yIHVzaW5nIGl0IGFmdGVyIG1vZGVsIHBhcnNpbmdcbiAgICAgICAgaWYgKCdfZXh0cmEnIGluIGRhdGEpeyBkZWxldGUgZGF0YS5fZXh0cmEgfVxuICAgICAgICB2YXIgVE9PTkUgPSBkYXRhLlRPT05FO1xuICAgICAgICB2YXIgVE9NQU5ZID0gZGF0YS5UT01BTlk7XG4gICAgICAgIHZhciBNQU5ZVE9NQU5ZID0gZGF0YS5NQU5ZVE9NQU5ZO1xuICAgICAgICB2YXIgUEVSTUlTU0lPTlMgPSBkYXRhLlBFUk1JU1NJT05TO1xuICAgICAgICB2YXIgUEEgPSBkYXRhLlBBO1xuICAgICAgICBkZWxldGUgZGF0YS5UT09ORTtcbiAgICAgICAgZGVsZXRlIGRhdGEuVE9NQU5ZO1xuICAgICAgICBkZWxldGUgZGF0YS5NQU5ZVE9NQU5ZO1xuICAgICAgICBkZWxldGUgZGF0YS5QRVJNSVNTSU9OUztcbiAgICAgICAgZGVsZXRlIGRhdGEuUEE7XG4gICAgICAgIGlmICghUEEpIHsgUEEgPSB7fTsgfVxuXG4gICAgICAgIC8vIGNsZWFuaW5nIGZyb20gdXNlbGVzcyBkZWxldGVkIGRhdGFcbiAgICAgICAgZGF0YSA9IExhenkoZGF0YSkuZmlsdGVyKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICByZXR1cm4gKCEoJ2RlbGV0ZWQnIGluIHYpIHx8ICgoayBpbiBtb2RlbENhY2hlKSkpO1xuICAgICAgICB9KS50b09iamVjdCgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCdtMm0nIGluIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBtMm0gPSBkYXRhLm0ybTtcbiAgICAgICAgICAgIGRlbGV0ZSBkYXRhWydtMm0nXTtcbiAgICAgICAgfVxuICAgICAgICBMYXp5KGRhdGEpLmVhY2goZnVuY3Rpb24gKGRhdGEsIG1vZGVsTmFtZSkge1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUobW9kZWxOYW1lLCBmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWxDbGFzcyA9IG1vZGVsO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLnJlc3VsdHMgJiYgKGRhdGEucmVzdWx0cy5sZW5ndGggPiAwKSAmJiAoZGF0YS5yZXN1bHRzWzBdLmNvbnN0cnVjdG9yID09IEFycmF5KSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMgPSBMYXp5KGRhdGEucmVzdWx0cykubWFwKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIExhenkobW9kZWxDbGFzcy5maWVsZHNPcmRlcikuemlwKHgpLnRvT2JqZWN0KClcbiAgICAgICAgICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IExhenkoZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICB2YXIgZGVsZXRlZCA9IGRhdGEuZGVsZXRlZDtcbiAgICAgICAgICAgICAgICBpZiAobW9kZWxOYW1lIGluIFBBKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBNUEEgPSBQQVttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICBMYXp5KHJlc3VsdHMpLmVhY2goZnVuY3Rpb24gKHJlY29yZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlY29yZC5pZCBpbiBNUEEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMYXp5KE1QQVtyZWNvcmQuaWRdKS5lYWNoKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY29yZFtrXSA9IHY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gaW5kZXhpbmcgcmVmZXJlbmNlcyBieSBpdHMgSURcbiAgICAgICAgICAgICAgICB2YXIgaXRhYiA9IGdldEluZGV4KG1vZGVsTmFtZSk7XG4gICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gaXRhYi5zb3VyY2U7XG5cbiAgICAgICAgICAgICAgICAvLyBvYmplY3QgZGVsZXRpb25cbiAgICAgICAgICAgICAgICBpZiAoZGVsZXRlZCl7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZWQuZm9yRWFjaChmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YWJsZVt4XTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4vKlxuICAgICAgICAgICAgICAgIExhenkoZGVsZXRlZCkuZWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFibGVbeF07XG4gICAgICAgICAgICAgICAgfSk7XG4qL1xuICAgICAgICAgICAgICAgIHZhciBpZHggPSByZXN1bHRzLmluZGV4QnkoJ2lkJykudG9PYmplY3QoKTtcbiAgICAgICAgICAgICAgICB2YXIgaWsgPSBMYXp5KGlkeCkua2V5cygpO1xuICAgICAgICAgICAgICAgIHZhciBubmV3ID0gaWsuZGlmZmVyZW5jZShpdGFiLmtleXMoKS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHgpXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIHZhciB1cGRhdGVkID0gaWsuZGlmZmVyZW5jZShubmV3KTtcbiAgICAgICAgICAgICAgICAvLyByZW1vdmluZyBvbGQgaWRlbnRpY2FsIHZhbHVlc1xuICAgICAgICAgICAgICAgIHVwZGF0ZWQgPSB1cGRhdGVkLmZpbHRlcihmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXV0aWxzLnNhbWVBcyhpZHhbeF0sIHRhYmxlW3hdLmFzUmF3KCkpO1xuICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAvLyBjbGFzc2lmeSByZWNvcmRzXG4gICAgICAgICAgICAgICAgdmFyIHBlcm1zID0gZGF0YS5wZXJtaXNzaW9ucyA/IExhenkoZGF0YS5wZXJtaXNzaW9ucykgOiBMYXp5KHt9KTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3T2JqZWN0cyA9IG5uZXcubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgbW9kZWxDbGFzcyhpZHhbeF0sIHBlcm1zLmdldCh4KSlcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vLy8gY2xhc3NpZnlpbmcgdXBkYXRlZFxuICAgICAgICAgICAgICAgIC8vdmFyIHVwZGF0ZWRPYmplY3RzID0gdXBkYXRlZC5tYXAoZnVuY3Rpb24oeCl7cmV0dXJuIG5ldyBtb2RlbENsYXNzKGlkeC5nZXQoeCkscGVybXMuZ2V0KHgpKX0pO1xuICAgICAgICAgICAgICAgIC8vdmFyIHVvID0gdXBkYXRlZE9iamVjdHMudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIC8vdXBkYXRlZE9iamVjdHMgPSBMYXp5KHVvKS5tYXAoZnVuY3Rpb24oeCl7cmV0dXJuIFt4LHRhYmxlW3guaWRdXX0pLnRvQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGluZyBzaW5nbGUgb2JqZWN0c1xuICAgICAgICAgICAgICAgIHZhciBjaGFuZ2VkID0gW107XG4vLyAgICAgICAgICAgICAgICB2YXIgREFURUZJRUxEUyA9IE1PREVMX0RBVEVGSUVMRFNbbW9kZWxOYW1lXTtcbi8vICAgICAgICAgICAgICAgIHZhciBCT09MRklFTERTID0gTU9ERUxfQk9PTEZJRUxEU1ttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgIHZhciBtb2RlbFJlZmVyZW5jZXMgPSBMYXp5KG1vZGVsLnJlZmVyZW5jZXMpLm1hcChmdW5jdGlvbihrKSB7IHJldHVybiBbaywxXX0pLnRvT2JqZWN0KCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlZC5mb3JFYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRJdGVtID0gdGFibGVbeF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRDb3B5ID0gb2xkSXRlbS5jb3B5KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtID0gaWR4LmdldCh4KTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0aW5nIGVhY2ggYXR0cmlidXRlIHNpbmd1bGFybHlcblxuICAgICAgICAgICAgICAgICAgICBMYXp5KG1vZGVsLmZpZWxkcykuZWFjaChmdW5jdGlvbihmaWVsZCwgZmllbGROYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goZmllbGQudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JlZmVyZW5jZScgOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZEl0ZW1bJ18nICsgZmllbGROYW1lXSA9IG5ld0l0ZW1bZmllbGROYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmFOIGlzIGNvbnZudGlvbmFsbHkgYSBjYWNoZSBkZWxldGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZEl0ZW1bZmllbGROYW1lXSA9IE5hTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RhdGUnOiB7b2xkSXRlbVtmaWVsZE5hbWVdID0gbmV3IERhdGUobmV3SXRlbVtmaWVsZE5hbWVdICogMTAwMCk7IGJyZWFrfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdkYXRldGltZSc6IHtvbGRJdGVtW2ZpZWxkTmFtZV0gPSBuZXcgRGF0ZShuZXdJdGVtW2ZpZWxkTmFtZV0gKiAxMDAwKTsgYnJlYWt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Jvb2xlYW4nIDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG5ld0l0ZW1bZmllbGROYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBudWxsIDogeyBvbGRJdGVtW2ZpZWxkTmFtZV0gPSBudWxsOyBicmVhazsgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ1QnIDogeyBvbGRJdGVtW2ZpZWxkTmFtZV0gPSB0cnVlOyBicmVhazsgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0YnIDogeyBvbGRJdGVtW2ZpZWxkTmFtZV0gPSBmYWxzZTsgYnJlYWs7IH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIHRydWUgOiB7IG9sZEl0ZW1bZmllbGROYW1lXSA9IHRydWU7IGJyZWFrOyB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBmYWxzZSA6IHsgb2xkSXRlbVtmaWVsZE5hbWVdID0gZmFsc2U7IGJyZWFrOyB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoge29sZEl0ZW1bZmllbGROYW1lXSA9IG5ld0l0ZW1bZmllbGROYW1lXX1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbi8vICAgICAgICAgICAgICAgICAgICAgICAgb2xkSXRlbVtmaWVsZE5hbWVdID0gbmV3SXRlbVtmaWVsZE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZC5wdXNoKFtuZXdJdGVtLCBvbGRDb3B5XSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLy8vIHNlbmRpbmcgc2lnbmFsIGZvciB1cGRhdGVkIHZhbHVlc1xuICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VkLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCd1cGRhdGVkLScgKyBtb2RlbE5hbWUsIGNoYW5nZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyoqKioqKioqIFVwZGF0ZSB1bml2ZXJzZSAqKioqKioqKlxuICAgICAgICAgICAgICAgIHZhciBubyA9IG5ld09iamVjdHMudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgIExhenkobm8pLmVhY2goZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVbeC5pZF0gPSB4XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gcmVidWxkaW5nIHJldmVyc2UgaW5kZXhlc1xuICAgICAgICAgICAgICAgIExhenkobW9kZWxDYWNoZVttb2RlbE5hbWVdLnJlZmVyZW5jZXMpLmVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgICAgICAgICAgICAgICBSRVZJRFhbbW9kZWxOYW1lICsgJy4nICsgcmVmXSA9IElEQlttb2RlbE5hbWVdLmdyb3VwQnkoJ18nICsgcmVmKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBzZW5kaW5nIGV2ZW50cyBmb3IgbmV3IHZhbHVlc1xuICAgICAgICAgICAgICAgIGlmIChuby5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ25ldy0nICsgbW9kZWxOYW1lLCBMYXp5KG5vKSwgZGF0YS50b3RhbFJlc3VsdHMpO1xuICAgICAgICAgICAgICAgIGlmIChkZWxldGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ2RlbGV0ZWQtJyArIG1vZGVsTmFtZSwgZGVsZXRlZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHNlbmRpbmcgZXZlbnRzIGZvciBkYXRhIGFycml2ZWRcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCdyZWNlaXZlZC0nICsgbW9kZWxOYW1lKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuLyogICAgICAgIFxuICAgICAgICBpZiAoVE9PTkUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RPT05FJyk7XG4gICAgICAgICAgICBMYXp5KFRPT05FKS5lYWNoKGZ1bmN0aW9uICh2YWxzLCBtb2RlbE5hbWUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtb2RlbE5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciB1ZHggPSBnZXRVbmxpbmtlZChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFRPTUFOWSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignVE9NQU5ZJyk7XG4gICAgICAgICAgICBMYXp5KFRPTUFOWSkuZWFjaChmdW5jdGlvbiAodmFscywgaW5kZXhOYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoaW5kZXhOYW1lIGluIEFTS0VEX1VOTElOS0VEKSkge1xuICAgICAgICAgICAgICAgICAgICBBU0tFRF9VTkxJTktFRFtpbmRleE5hbWVdID0gTGF6eShbXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIExhenkodmFscykuZWFjaChmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgQVNLRURfVU5MSU5LRURbaW5kZXhOYW1lXS5zb3VyY2UucHVzaChpZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoTUFOWVRPTUFOWSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignTUFOWVRPTUFOWScpO1xuICAgICAgICAgICAgTGF6eShNQU5ZVE9NQU5ZKS5lYWNoKGZ1bmN0aW9uICh2YWxzLCBpbmRleE5hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3QgPSBwYXJzZUludChpbmRleE5hbWUuc3BsaXQoJ3wnKVsxXSk7XG4gICAgICAgICAgICAgICAgaW5kZXhOYW1lID0gaW5kZXhOYW1lLnNwbGl0KCd8JylbMF07XG4gICAgICAgICAgICAgICAgaWYgKCEoaW5kZXhOYW1lIGluIEFTS0VEX00yTSkpIHtcbiAgICAgICAgICAgICAgICAgICAgQVNLRURfTTJNW2luZGV4TmFtZV0gPSBbe30sIHt9XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIE1JRFggPSBBU0tFRF9NMk1baW5kZXhOYW1lXVtmaXJzdF07XG4gICAgICAgICAgICAgICAgTGF6eSh2YWxzKS5lYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIE1JRFhbeCArICcnXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIE1JRFhbeF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIFxuKi9cbiAgICAgICAgaWYgKG0ybSkge1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZ290TTJNKG0ybSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFBFUk1JU1NJT05TKSB7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5nb3RQZXJtaXNzaW9ucyhQRVJNSVNTSU9OUyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2FsbEJhY2spIHtcbiAgICAgICAgICAgIGNhbGxCYWNrKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIFcyUFJFU09VUkNFLmVtaXQoJ2dvdC1kYXRhJyk7XG4gICAgfTtcbiAgICB0aGlzLmdvdFBlcm1pc3Npb25zID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgTGF6eShkYXRhKS5lYWNoKGZ1bmN0aW9uICh2LCByZXNvdXJjZU5hbWUpIHtcbiAgICAgICAgICAgIExhenkodlswXSkuZWFjaChmdW5jdGlvbiAocm93LCBpZCkge1xuICAgICAgICAgICAgICAgIGlmICgocmVzb3VyY2VOYW1lIGluIElEQikgJiYgKGlkIGluIElEQltyZXNvdXJjZU5hbWVdLnNvdXJjZSkpe1xuICAgICAgICAgICAgICAgICAgICBJREJbcmVzb3VyY2VOYW1lXS5nZXQoaWQpLl9wZXJtaXNzaW9ucyA9IExhenkocm93KS5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbeCwgdHJ1ZV1cbiAgICAgICAgICAgICAgICAgICAgfSkudG9PYmplY3QoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChMYXp5KHZbMF0pLnNpemUoKSl7XG4gICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgndXBkYXRlLXBlcm1pc3Npb25zLScgKyByZXNvdXJjZU5hbWUsIExhenkodlswXSkua2V5cygpLnRvQXJyYXkoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmVtaXQoJ3VwZGF0ZS1wZXJtaXNzaW9ucycpO1xuICAgIH07XG5cblxuICAgIHRoaXMuZ290TTJNID0gZnVuY3Rpb24obTJtKXtcbiAgICAgICAgTGF6eShtMm0pLmVhY2goZnVuY3Rpb24oZGF0YSwgaW5kZXhOYW1lKXtcbiAgICAgICAgICAgIHZhciBtMm1JbmRleCA9IGxpbmtlci5tMm1JbmRleFtpbmRleE5hbWVdO1xuICAgICAgICAgICAgTGF6eShkYXRhKS5lYWNoKGZ1bmN0aW9uKG0pe1xuICAgICAgICAgICAgICAgIExhenkobSkuZWFjaChmdW5jdGlvbihkYXRhLHZlcmIpe1xuICAgICAgICAgICAgICAgICAgICBtMm1JbmRleFt2ZXJiXShkYXRhKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZW1pdCgncmVjZWl2ZWQtbTJtJyk7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5lbWl0KCdyZWNlaXZlZC1tMm0tJyArIGluZGV4TmFtZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGZldGNoIHJlcXVlc3RlZCBkYXRhIHdpdGggYSBzaW5nbGUgZmlsdGVyXG4gICAgICovXG4gICAgdGhpcy5mZXRjaCA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIGZpbHRlciwgdG9nZXRoZXIsIGNhbGxCYWNrKSB7ICAvL1xuICAgICAgICAvLyBpZiBhIGNvbm5lY3Rpb24gaXMgY3VycmVudGx5IHJ1bm5pbmcsIHdhaXQgZm9yIGNvbm5lY3Rpb24uXG4gICAgICAgIGlmIChtb2RlbE5hbWUgaW4gd2FpdGluZ0Nvbm5lY3Rpb25zKXtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBXMlBSRVNPVVJDRS5mZXRjaChtb2RlbE5hbWUsIGZpbHRlciwgdG9nZXRoZXIsIGNhbGxCYWNrKTtcbiAgICAgICAgICAgIH0sNTAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGZldGNoaW5nIGFzeW5jaHJvbW91cyBtb2RlbCBmcm9tIHNlcnZlclxuICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUobW9kZWxOYW1lLCAoZnVuY3Rpb24obW9kZWwpe1xuICAgICAgICAgICAgICAgIC8vIGlmIGRhdGEgY2FtZXMgZnJvbSByZWFsdGltZSBjb25uZWN0aW9uXG4gICAgICAgICAgICAgICAgaWYgKFcyUFJFU09VUkNFLmNvbm5lY3Rpb24uY2FjaGVkU3RhdHVzLnJlYWx0aW1lRW5kUG9pbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0dGluZyBmaWx0ZXIgZmlsdGVyZWQgYnkgY2FjaGluZyBzeXN0ZW1cbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyID0gbGlzdENhY2hlLmZpbHRlcihtb2RlbCxmaWx0ZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHNvbXRoaW5nIGlzIG1pc3Npbmcgb24gbXkgbG9jYWwgREIgXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXNrIGZvciBtaXNzaW5ncyBhbmQgcGFyc2Ugc2VydmVyIHJlc3BvbnNlIGluIG9yZGVyIHRvIGVucmljaCBteSBsb2NhbCBEQi5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBsYWNpbmcgbG9jayBmb3IgdGhpcyBtb2RlbFxuICAgICAgICAgICAgICAgICAgICAgICAgd2FpdGluZ0Nvbm5lY3Rpb25zW21vZGVsTmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuJHBvc3QobW9kZWxOYW1lICsgJy5saXN0Jywge2ZpbHRlciA6IGZpbHRlcn0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdERhdGEoZGF0YSxjYWxsQmFjayk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVsZWFzZSBsb2NrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihyZXQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZWxlYXNlIGxvY2tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHdhaXRpbmdDb25uZWN0aW9uc1ttb2RlbE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJHBvc3QobW9kZWxOYW1lICsgJy5saXN0Jywgc2VuZERhdGEsZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZpbHRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHT1RfQUxMLnNvdXJjZS5wdXNoKG1vZGVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdERhdGEoZGF0YSwgY2FsbEJhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5nZXQgPSBmdW5jdGlvbihtb2RlbE5hbWUsIGlkcywgY2FsbEJhY2spe1xuICAgICAgICAvLyBzZWFyY2ggb2JqZWN0cyBmcm9tIElEQi4gSWYgc29tZSBpZCBpcyBtaXNzaW5nLCBpdCByZXNvbHZlIGl0IGJ5IHRoZSBzZXJ2ZXJcbiAgICAgICAgLy8gaWYgYSByZXF1ZXN0IHRvIHRoZSBzYW1lIG1vZGVsIGlzIHBlbmRpbmcsIHdhaXQgZm9yIGl0cyBjb21wbGV0aW9uXG4gICAgICAgIFxuICAgICAgICBpZiAoaWRzLmNvbnN0cnVjdG9yICE9PSBBcnJheSl7XG4gICAgICAgICAgICBpZHMgPSBbaWRzXTtcbiAgICAgICAgfVxuICAgICAgICAvLyBpZiBzb21lIGVudGl0eSBpcyBtaXNzaW5nIFxuICAgICAgICBXMlBSRVNPVVJDRS5mZXRjaChtb2RlbE5hbWUgLCB7aWQ6IGlkc30sIG51bGwsZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgICAgIHZhciBpdGFiID0gSURCW21vZGVsTmFtZV1cbiAgICAgICAgICAgIGZvciAodmFyIGlkIGluIGlkcyl7XG4gICAgICAgICAgICAgICAgcmV0LnB1c2goaXRhYi5zb3VyY2VbaWRzW2lkXV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FsbEJhY2socmV0KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRoaXMuZ290TW9kZWwgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBmb3IgKHZhciBtb2RlbE5hbWUgaW4gZGF0YSkge1xuICAgICAgICAgICAgdmFyIG1vZGVsID0gZGF0YVttb2RlbE5hbWVdO1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlWydkZXNjcmlwdGlvbjonICsgbW9kZWxOYW1lXSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICAgICAgbW9kZWxDYWNoZVttb2RlbE5hbWVdID0gbWFrZU1vZGVsQ2xhc3MobW9kZWwpO1xuICAgICAgICAgICAgaWYgKCEobW9kZWxOYW1lIGluIElEQikpIHtcbiAgICAgICAgICAgICAgICBJREJbbW9kZWxOYW1lXSA9IExhenkoe30pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuZGVzY3JpYmUgPSBmdW5jdGlvbihtb2RlbE5hbWUsIGNhbGxCYWNrKXtcbiAgICAgICAgdmFyIHJldCA9IG1vZGVsQ2FjaGVbbW9kZWxOYW1lXTtcbiAgICAgICAgaWYgKHJldCkge1xuICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2socmV0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbm5lY3Rpb24uaXNDb25uZWN0ZWQgJiYgIShtb2RlbE5hbWUgaW4gd2FpdGluZ0Nvbm5lY3Rpb25zKSl7XG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBmYWlsZWRNb2RlbHMpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNhY2hlS2V5ID0gJ2Rlc2NyaXB0aW9uOicgKyBtb2RlbE5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlS2V5IGluIGxvY2FsU3RvcmFnZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdvdE1vZGVsKEpTT04ucGFyc2UobG9jYWxTdG9yYWdlW2NhY2hlS2V5XSkpO1xuICAgICAgICAgICAgICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjayhtb2RlbENhY2hlW21vZGVsTmFtZV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdhaXRpbmdDb25uZWN0aW9uc1ttb2RlbE5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcG9zdChtb2RlbE5hbWUgKyAnLmRlc2NyaWJlJyxudWxsLCBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFcyUFJFU09VUkNFLmdvdE1vZGVsKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2sobW9kZWxDYWNoZVttb2RlbE5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB3YWl0aW5nQ29ubmVjdGlvbnNbbW9kZWxOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGVsTm90Rm91bmQuaGFuZGxlKG1vZGVsTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmYWlsZWRNb2RlbHNbbW9kZWxOYW1lXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gd2FpdCBmb3IgY29ubmVjdGlvblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgVzJQUkVTT1VSQ0UuZGVzY3JpYmUobW9kZWxOYW1lLCBjYWxsQmFjayk7XG4gICAgICAgICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSAgICAgICAgXG4gICAgfTtcbiAgICB0aGlzLmFkZE1vZGVsSGFuZGxlciA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIGRlY29yYXRvcikge1xuICAgICAgICB2YXIga2V5ID0gdXRpbHMuaGFzaChkZWNvcmF0b3IpO1xuICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gYnVpbGRlckhhbmRsZXJzKSkgYnVpbGRlckhhbmRsZXJzW21vZGVsTmFtZV0gPSBuZXcgSGFuZGxlcigpO1xuICAgICAgICBpZiAoIShtb2RlbE5hbWUgaW4gYnVpbGRlckhhbmRsZXJVc2VkKSkgYnVpbGRlckhhbmRsZXJVc2VkW21vZGVsTmFtZV0gPSB7fTtcbiAgICAgICAgaWYgKGtleSBpbiBidWlsZGVySGFuZGxlclVzZWRbbW9kZWxOYW1lXSl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidWlsZGVySGFuZGxlclVzZWRbbW9kZWxOYW1lXVtrZXldID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobW9kZWxOYW1lIGluIG1vZGVsQ2FjaGUpIHtcbiAgICAgICAgICAgIGRlY29yYXRvcihtb2RlbENhY2hlW21vZGVsTmFtZV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVpbGRlckhhbmRsZXJzW21vZGVsTmFtZV0uYWRkSGFuZGxlcihkZWNvcmF0b3IpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICB0aGlzLmFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzID0gZnVuY3Rpb24obW9kZWxOYW1lLCBhdHRyaWJ1dGVzKXtcbiAgICAgICAgdmFyIGFkZFByb3BlcnR5ID0gZnVuY3Rpb24obW9kZWwsIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICBhdHRyaWJ1dGVzLmZvckVhY2goZnVuY3Rpb24odmFsKXtcbiAgICAgICAgICAgIHZhciBrZXkgPSAncEE6JyArIG1vZGVsLm1vZGVsTmFtZSArICc6JyArIHZhbDtcbiAgICAgICAgICAgIHZhciBrYXR0ciA9ICdfXycgKyB2YWw7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kZWwucHJvdG90eXBlLCB2YWwsIHtcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGlmICghKGthdHRyIGluIHRoaXMpKXtcbiAgICAgICAgICAgICAgICAgIHZhciB2ID0gbG9jYWxTdG9yYWdlW2tleSArIHRoaXMuaWRdO1xuICAgICAgICAgICAgICAgICAgdGhpc1trYXR0cl0gPSB2P0pTT04ucGFyc2Uodik6bnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNba2F0dHJdO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgICAgICAgICB0aGlzW2thdHRyXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZVtrZXkgKyB0aGlzLmlkXSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmICghKG1vZGVsTmFtZSBpbiBwZXJzaXN0ZW50QXR0cmlidXRlcykpIHsgcGVyc2lzdGVudEF0dHJpYnV0ZXNbbW9kZWxOYW1lXSA9IFtdOyB9XG4gICAgICAgIHZhciBhdHRycyA9IHBlcnNpc3RlbnRBdHRyaWJ1dGVzW21vZGVsTmFtZV07XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICB2YXIgbmV3QXR0cnMgPSBMYXp5KGF0dHJpYnV0ZXMpLmRpZmZlcmVuY2UoYXR0cnMpLnRvQXJyYXkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBuZXdBdHRycyA9IGF0dHJzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdBdHRycy5sZW5ndGgpe1xuICAgICAgICAgICAgaWYgKG1vZGVsTmFtZSBpbiBtb2RlbENhY2hlKXtcbiAgICAgICAgICAgICAgICBhZGRQcm9wZXJ0eShtb2RlbENhY2hlW21vZGVsTmFtZV0sIG5ld0F0dHJzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzKXtcbiAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShhdHRycyxuZXdBdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHRoaXMub24oJ25ldy1tb2RlbCcsIGZ1bmN0aW9uKG1vZGVsKXtcbiAgICAgICAgaWYgKG1vZGVsLm1vZGVsTmFtZSBpbiBidWlsZGVySGFuZGxlcnMpe1xuICAgICAgICAgICAgYnVpbGRlckhhbmRsZXJzW21vZGVsLm1vZGVsTmFtZV0uaGFuZGxlKG1vZGVsQ2FjaGVbbW9kZWwubW9kZWxOYW1lXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vZGVsLm1vZGVsTmFtZSBpbiBwZXJzaXN0ZW50QXR0cmlidXRlcyl7XG4gICAgICAgICAgICBXMlBSRVNPVVJDRS5hZGRQZXJzaXN0ZW50QXR0cmlidXRlcyhtb2RlbC5tb2RlbE5hbWUpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLnF1ZXJ5ID0gZnVuY3Rpb24obW9kZWxOYW1lLCBmaWx0ZXIsIHRvZ2V0aGVyLCBjYWxsQmFjayl7XG4gICAgICAgIHZhciB0aHMgPSB0aGlzO1xuICAgICAgICB0aGlzLmRlc2NyaWJlKG1vZGVsTmFtZSxmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgICAgICAvLyBhcnJheWZpeSBhbGwgZmlsdGVyIHZhbHVlc1xuICAgICAgICAgICAgZmlsdGVyID0gTGF6eShmaWx0ZXIpLm1hcChmdW5jdGlvbih2LGspeyByZXR1cm4gW2ssQXJyYXkuaXNBcnJheSh2KT92Olt2XV19KS50b09iamVjdCgpO1xuICAgICAgICAgICAgdmFyIGZpbHRlckZ1bmN0aW9uID0gdXRpbHMubWFrZUZpbHRlcihtb2RlbCwgZmlsdGVyKTtcbiAgICAgICAgICAgIHZhciBpZHggPSBnZXRJbmRleChtb2RlbE5hbWUpO1xuICAgICAgICAgICAgdGhzLmZldGNoKG1vZGVsTmFtZSxmaWx0ZXIsdG9nZXRoZXIsIGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgIGNhbGxCYWNrKGlkeC5maWx0ZXIoZmlsdGVyRnVuY3Rpb24pLnZhbHVlcygpLnRvQXJyYXkoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICB9O1xuICAgIFxuICAgIHRoaXMuZGVsZXRlID0gZnVuY3Rpb24obW9kZWxOYW1lLCBpZHMsIGNhbGxCYWNrKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHBvc3QobW9kZWxOYW1lICsgJy5kZWxldGUnLCB7IGlkIDogaWRzfSwgY2FsbEJhY2spO1xuICAgIH07XG5cbiAgICB0aGlzLmNvbm5lY3QgPSBmdW5jdGlvbiAoY2FsbEJhY2spIHtcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGlvbi5pc0xvZ2dlZEluKSB7XG4gICAgICAgICAgICBjYWxsQmFjaygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0aW9uLmNvbm5lY3QoY2FsbEJhY2spO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuZnVuY3Rpb24gcmVXaGVlbE9STShlbmRQb2ludCwgbG9naW5GdW5jKXtcbiAgICB0aGlzLiRvcm0gPSBuZXcgYmFzZU9STShuZXcgdXRpbHMucmVXaGVlbENvbm5lY3Rpb24oZW5kUG9pbnQsIGxvZ2luRnVuYyksdGhpcyk7XG4gICAgdGhpcy5vbiA9IHRoaXMuJG9ybS5vbi5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy5lbWl0ID0gdGhpcy4kb3JtLmVtaXQuYmluZCh0aGlzLiRvcm0pO1xuICAgIHRoaXMudW5iaW5kID0gdGhpcy4kb3JtLnVuYmluZC5iaW5kKHRoaXMuJG9ybSk7XG4gICAgdGhpcy5vbmNlID0gdGhpcy4kb3JtLm9uY2U7XG4gICAgdGhpcy5hZGRNb2RlbEhhbmRsZXIgPSB0aGlzLiRvcm0uYWRkTW9kZWxIYW5kbGVyLmJpbmQodGhpcy4kb3JtKTtcbiAgICB0aGlzLmFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzID0gdGhpcy4kb3JtLmFkZFBlcnNpc3RlbnRBdHRyaWJ1dGVzLmJpbmQodGhpcy4kb3JtKTtcbiAgICB0aGlzLnV0aWxzID0gdXRpbHM7XG4gICAgdGhpcy5sb2dvdXQgPSB0aGlzLiRvcm0uY29ubmVjdGlvbi5sb2dvdXQuYmluZCh0aGlzLiRvcm0uY29ubmVjdGlvbik7XG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbigpe1xuICAgIHZhciBjb25uZWN0aW9uID0gdGhpcy4kb3JtLmNvbm5lY3Rpb247XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihjYWxsQmFjayxyZWplY3Qpe1xuICAgICAgICBjb25uZWN0aW9uLmNvbm5lY3QoY2FsbEJhY2spO1xuICAgIH0pKTtcbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKGFjY2VwdCxyZWplY3Qpe1xuICAgICAgICB0aGlzLiRvcm0uY29ubmVjdGlvbi5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQsIGFjY2VwdCk7ICAgIFxuICAgIH0pLmJpbmQodGhpcykpO1xuICAgIFxufTtcblxucmVXaGVlbE9STS5wcm90b3R5cGUubG9nb3V0ID0gZnVuY3Rpb24odXJsKXtcbiAgICByZXR1cm4gdGhpcy4kb3JtLmNvbm5lY3Rpb24ubG9nb3V0KCk7XG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmdldE1vZGVsID0gZnVuY3Rpb24obW9kZWxOYW1lKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHNlbGYuJG9ybS5jb25uZWN0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgc2VsZi4kb3JtLmRlc2NyaWJlKG1vZGVsTmFtZSxhY2NlcHQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihtb2RlbE5hbWUsIGlkcyl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBzaW5nbGUgPSBmYWxzZTtcbiAgICB2YXIgbW9kTmFtZSA9IG1vZGVsTmFtZTtcbiAgICB2YXIgZmlsdGVyO1xuICAgIGlmICh0eXBlb2YgaWRzID09PSAnbnVtYmVyJykge1xuICAgICAgICBzaW5nbGUgPSB0cnVlO1xuICAgICAgICBmaWx0ZXIgPSB7IGlkIDogW2lkc119O1xuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShpZHMpKXtcbiAgICAgICAgZmlsdGVyID0geyBpZCA6IGlkcyB9O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGlkcyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgZmlsdGVyID0gaWRzO1xuICAgIH0gZWxzZSBpZiAoaWRzID09PSBudWxsKSB7XG4gICAgICAgIGZpbHRlciA9IHt9O1xuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3Qpe1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICBzZWxmLiRvcm0uY29ubmVjdChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5xdWVyeShtb2RlbE5hbWUsIGZpbHRlciwgbnVsbCwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2luZ2xlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQoZGF0YS5sZW5ndGggPyBkYXRhWzBdIDogbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxuLypcbnJlV2hlZWxPUk0ucHJvdG90eXBlLnF1ZXJ5ID0gZnVuY3Rpb24gKG1vZGVsTmFtZSwgZmlsdGVyLCByZWxhdGVkKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCwgcmVqZWN0KXtcbiAgICAgICAgdmFyIHRvZ2V0aGVyID0gbnVsbDtcbiAgICAgICAgaWYgKHJlbGF0ZWQgJiYgKHJlbGF0ZWQuY29uc3RydWN0b3IgPT09IEFycmF5KSAmJiAocmVsYXRlZC5sZW5ndGgpKXtcbiAgICAgICAgICAgIHRvZ2V0aGVyID0gcmVsYXRlZDtcbiAgICAgICAgfSBlbHNlIGlmIChyZWxhdGVkICYmIChyZWxhdGVkLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpICYmIChyZWxhdGVkLmxlbmd0aCkpe1xuICAgICAgICAgICAgdG9nZXRoZXIgPSByZWxhdGVkLnNwbGl0KCcsJyk7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgc2VsZi4kb3JtLmNvbm5lY3QoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBzZWxmLiRvcm0ucXVlcnkobW9kZWxOYW1lLCBmaWx0ZXIsIHRvZ2V0aGVyLCBhY2NlcHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICB9XG4gICAgfSlcbn07XG4qL1xuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAobW9kZWxOYW1lLCBpZHMpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3Qpe1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICBzZWxmLiRvcm0uY29ubmVjdChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHNlbGYuJG9ybS5kZWxldGUobW9kZWxOYW1lLCBpZHMsIGFjY2VwdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KVxufTtcblxucmVXaGVlbE9STS5wcm90b3R5cGUuZ2V0TG9nZ2VkVXNlciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBpZiAodGhpcy4kb3JtLmNvbm5lY3Rpb24uY2FjaGVkU3RhdHVzLnVzZXJfaWQpXG4gICAgICAgIHJldHVybiB0aGlzLmdldCgnYXV0aF91c2VyJyx0aGlzLiRvcm0uY29ubmVjdGlvbi5jYWNoZWRTdGF0dXMudXNlcl9pZCk7XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQsIHJlamVjdCkge1xuICAgICAgICAgICAgc2VsZi5vbmNlKCdsb2dnZWQtaW4nLGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmdldCgnYXV0aF91c2VyJywgdXNlcikudGhlbihhY2NlcHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUuJHNlbmRUb0VuZHBvaW50ID0gZnVuY3Rpb24gKHVybCwgZGF0YSl7XG4gICAgcmV0dXJuIHRoaXMuJG9ybS4kcG9zdCh1cmwsIGRhdGEpO1xufVxuXG5yZVdoZWVsT1JNLnByb3RvdHlwZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCl7XG4gICAgcmV0dXJuIHRoaXMuJG9ybS5jb25uZWN0aW9uLmxvZ2luKHVzZXJuYW1lLHBhc3N3b3JkKTtcbn1cblxucmVXaGVlbE9STS5wcm90b3R5cGUuZ2V0UmVzb3VyY2VzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIG9ybSA9IHRoaXMuJG9ybTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3QpIHtcbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBvcm0uY29ubmVjdGlvbjtcbiAgICAgICAgdXRpbHMueGRyKGNvbm5lY3Rpb24uZW5kUG9pbnQgKyAnYXBpL3Jlc291cmNlcycsbnVsbCkudGhlbihmdW5jdGlvbih4aHIpe1xuICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZURhdGEpIHtcbiAgICAgICAgICAgICAgICBhY2NlcHQoeGhyLnJlc3BvbnNlRGF0YS5zb3J0KCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWplY3QoeGhyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG5cbnJlV2hlZWxPUk0ucHJvdG90eXBlLmdldENvbGxlY3Rpb24gPSBmdW5jdGlvbihtb2RlbE5hbWUsIGZpbHRlck9ySWRzKSB7XG4gICAgcmV0dXJuIG5ldyBDb2xsZWN0aW9uKG9ybS4kb3JtLCBmaWx0ZXJPcklkcyB8fCB7fSk7ICBcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBjYWNoZWRLZXlJZHggPSAwO1xuXG52YXIgbnVsbFN0cmluZyA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gJyd9O1xuXG5mdW5jdGlvbiBtb2NrT2JqZWN0KCl7XG4gICAgcmV0dXJuIG5ldyBQcm94eSh7fSwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKHRhcmdldCwgbmFtZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBuYW1lICA9PT0gJ3N0cmluZycpe1xuICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAndG9TdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsU3RyaW5nO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1dGlscy5tb2NrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFtuYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59XG5cbi8qXG52YXIgJFBPU1QgPSBmdW5jdGlvbih1cmwsIGRhdGEsIGNhbGxCYWNrLCBlcnJvckJhY2ssaGVhZGVycyl7XG4gICAgdmFyIG9wdHMgPSB7XG4gICAgICAgIGFjY2VwdHMgOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIHVybCA6IHVybCxcbiAgICAgICAgZGF0YSA6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgICAgICBkYXRhVHlwZSA6ICdqc29uJyxcbiAgICAgICAgc3VjY2VzcyA6IGNhbGxCYWNrLFxuICAgICAgICBlcnJvciA6IGVycm9yQmFjayxcbiAgICAgICAgbWV0aG9kIDogJ1BPU1QnLFxuICAgICAgICBjb250ZW50VHlwZSA6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgIH07XG4gICAgaWYgKGhlYWRlcnMpe1xuICAgICAgICBvcHRzLmhlYWRlcnMgPSBoZWFkZXJzO1xuICAgICAgICBvcHRzLmNyb3NzRG9tYWluID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuICQuYWpheChvcHRzKTtcbn1cblxuXG5mdW5jdGlvbiByZVdoZWVsQ29ubmVjdGlvbihlbmRQb2ludCwgZ2V0TG9naW4pe1xuICAgIC8vIG1haW4gXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuZ2V0TG9naW4gPSBnZXRMb2dpbjtcbiAgICB0aGlzLmV2ZW50cyA9IG5ldyBOYW1lZEV2ZW50TWFuYWdlcigpXG4gICAgdGhpcy4kUE9TVCA9ICRQT1NULmJpbmQodGhpcyk7XG4gICAgdGhpcy5vcHRpb25zID0ge2VuZFBvaW50IDogZW5kUG9pbnR9O1xuICAgIHRoaXMub24gPSB0aGlzLmV2ZW50cy5vbi5iaW5kKHRoaXMpO1xufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLnVwZGF0ZVN0YXR1cyA9IGZ1bmN0aW9uKHN0YXR1cywgY2FsbEJhY2ssIGVycm9yKSB7XG4gICAgaWYgKHN0YXR1cykge1xuICAgICAgICB2YXIgaXNMb2dnZWQgPSAoc3RhdHVzLnVzZXJfaWQgJiYgIXRoaXMub3B0aW9ucy51c2VyX2lkICk7XG4gICAgICAgIGZvciAodmFyIHggaW4gc3RhdHVzKXsgdGhpcy5vcHRpb25zW3hdID0gc3RhdHVzW3hdOyB9XG4gICAgICAgIGxvY2FsU3RvcmFnZS5sYXN0UldUU3RhdHVzID0gSlNPTi5zdHJpbmdpZnkoc3RhdHVzKTtcbiAgICAgICAgaWYgKGlzTG9nZ2VkKSB7XG4gICAgICAgICAgICB0aGlzLmV2ZW50cy5lbWl0KCdsb2dpbicsIHRoaXMub3B0aW9ucy51c2VyX2lkKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXRoaXMub3B0aW9ucy51c2VyX2lkICYmIHRoaXMuZ2V0TG9naW4pe1xuICAgICAgICB2YXIgbG9nSW5mbyA9IHRoaXMuZ2V0TG9naW4oZXJyb3IpO1xuICAgICAgICBpZiAobG9nSW5mby5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KXtcbiAgICAgICAgICAgIHRoaXMubG9naW4obG9nSW5mby51c2VybmFtZSwgbG9nSW5mby5wYXNzd29yZClcbiAgICAgICAgICAgIC50aGVuKChmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzKHN0YXR1cywgY2FsbEJhY2spO1xuICAgICAgICAgICAgfSkuYmluZCh0aGlzKSk7XG4gICAgICAgIH0gZWxzZSBpZiAobG9nSW5mby5jb25zdHJ1Y3RvciA9PT0gUHJvbWlzZSkge1xuICAgICAgICAgICAgbG9nSW5mby50aGVuKChmdW5jdGlvbihvYmope1xuICAgICAgICAgICAgICAgIHZhciB4ID0gdGhpcy5sb2dpbihvYmoudXNlcm5hbWUsb2JqLnBhc3N3b3JkKTtcbiAgICAgICAgICAgICAgICB2YXIgbWFuYWdlRXJyb3IgPSAoZnVuY3Rpb24oYmFkKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0dXMobnVsbCxjYWxsQmFjayxiYWQuZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxCYWNrKXtcbiAgICAgICAgICAgICAgICAgICAgeC50aGVuKGNhbGxCYWNrLG1hbmFnZUVycm9yKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB4LnRoZW4obnVsbCwgbWFuYWdlRXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2sodGhpcy5vcHRpb25zKTtcbiAgICB9ICAgIFxufVxuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuc3RhdHVzID0gZnVuY3Rpb24oY2FsbEJhY2ssIGZvcmNlKXtcbiAgICBpZiAoKCdsYXN0UldUU3RhdHVzJyBpbiBsb2NhbFN0b3JhZ2UpICYmICFmb3JjZSkge1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICB2YXIgc3RhdHVzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UubGFzdFJXVFN0YXR1cyk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1cyhzdGF0dXMsY2FsbEJhY2spO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXR1cyhjYWxsQmFjaywgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhbGxCYWNrICYmIGNhbGxCYWNrKHN0YXR1cyk7XG4gICAgfVxuICAgIGlmICh0aGlzLl9zdGF0dXNfY2FsbGluZyl7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNlbGYuc3RhdHVzKGNhbGxCYWNrKTtcbiAgICAgICAgfSw1MCk7XG4gICAgfVxuICAgIGlmICh0aGlzLm9wdGlvbnMgJiYgdGhpcy5vcHRpb25zLnRpbWVzdGFtcCl7XG4gICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKHRoaXMub3B0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fc3RhdHVzX2NhbGxpbmcgPSB0cnVlO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLiRwb3N0KCdhcGkvc3RhdHVzJyxudWxsLGZ1bmN0aW9uKHN0YXR1cyl7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UubGFzdFJXVFN0YXR1cyA9IEpTT04uc3RyaW5naWZ5KHN0YXR1cyk7XG4gICAgICAgICAgICBzZWxmLl9zdGF0dXNfY2FsbGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVTdGF0dXMoc3RhdHVzLGNhbGxCYWNrKTtcbiAgICAgICAgfSk7ICAgICAgICBcbiAgICB9XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUuJHBvc3QgPSBmdW5jdGlvbih1cmwsIGRhdGEsY2FsbEJhY2spe1xuICAgIHZhciB0aHMgPSB0aGlzO1xuICAgIGlmICh0aGlzLm9wdGlvbnMgJiYgdGhpcy5vcHRpb25zLnRva2VuKXtcbiAgICAgICAgaWYgKCFkYXRhKXtcbiAgICAgICAgICAgIGRhdGEgPSB7fTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAodGhpcy5vcHRpb25zLnRva2VuKXtcbiAgICAgICAgdmFyIGhlYWRlcnMgPSB7IFxuICAgICAgICAgICAgdG9rZW4gOiB0aGlzLm9wdGlvbnMudG9rZW4sXG4gICAgICAgICAgICBhcHBsaWNhdGlvbiA6IHRoaXMub3B0aW9ucy5hcHBsaWNhdGlvblxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBoZWFkZXJzID0gbnVsbDtcbiAgICB9XG5cbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKGFjY2VwdCxyZWplY3Qpe1xuICAgICAgICB1dGlscy54ZHIodGhzLm9wdGlvbnMuZW5kUG9pbnQgKyB1cmwsIGRhdGEsIHRocy5vcHRpb25zLmFwcGxpY2F0aW9uLCB0aHMub3B0aW9ucy50b2tlbilcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdodHRwLXJlc3BvbnNlJywgeGhyLnJlc3BvbnNlVGV4dCwgeGhyLnN0YXR1cywgdXJsLCBkYXRhKTtcbiAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2h0dHAtcmVzcG9uc2UtJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZVRleHQsIHVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZURhdGEpe1xuICAgICAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2h0dHAtcmVzcG9uc2UtJyArIHhoci5zdGF0dXMgKyAnLWpzb24nLCB4aHIucmVzcG9uc2VEYXRhLCB1cmwsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY2FsbEJhY2spIHsgY2FsbEJhY2soIHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCApfTtcbiAgICAgICAgICAgICAgICBhY2NlcHQoeGhyLnJlc3BvbnNlRGF0YSB8fCB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHhocikge1xuICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VEYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1qc29uJywgeGhyLnJlc3BvbnNlRGF0YSwgeGhyLnN0YXR1cywgdXJsLCBkYXRhLCB4aHIpO1xuICAgICAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2Vycm9yLWpzb24tJyArIHhoci5zdGF0dXMsIHhoci5yZXNwb25zZURhdGEsdXJsLCBkYXRhLCB4aHIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB0aHMuZXZlbnRzLmVtaXQoJ2Vycm9yLWh0dHAnLHhoci5yZXNwb25zZVRleHQsIHhoci5zdGF0dXMsdXJsLGRhdGEseGhyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhzLmV2ZW50cy5lbWl0KCdlcnJvci1odHRwLScgKyB4aHIuc3RhdHVzLCB4aHIucmVzcG9uc2VUZXh0LHVybCxkYXRhLHhocik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlamVjdCh4aHIucmVzcG9uc2VEYXRhIHx8IHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIHJldHVybiBwcm9taXNlO1xufTtcblxucmVXaGVlbENvbm5lY3Rpb24ucHJvdG90eXBlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcbiAgICB2YXIgdXJsID0gdGhpcy5vcHRpb25zLmVuZFBvaW50ICsgJ2FwaS9sb2dpbic7XG4gICAgdmFyIGNvbm5lY3Rpb24gPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhY2NlcHQscmVqZWN0KXtcbiAgICAgICAgdXRpbHMueGRyKHVybCx7IHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQgOiBwYXNzd29yZH0sIG51bGwsY29ubmVjdGlvbi5vcHRpb25zLnRva2VuLCB0cnVlKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oeGhyKXtcbiAgICAgICAgICAgICAgICBjb25uZWN0aW9uLnVwZGF0ZVN0YXR1cyh4aHIucmVzcG9uc2VEYXRhKTtcbiAgICAgICAgICAgICAgICBhY2NlcHQoc3RhdHVzKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHhocil7XG4gICAgICAgICAgICAgICAgcmVqZWN0KHhoci5yZXNwb25zZURhdGEgfHwgeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5cbnJlV2hlZWxDb25uZWN0aW9uLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24oY2FsbEJhY2spe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgd3Njb25uZWN0ID0gZnVuY3Rpb24oc2VsZil7XG4gICAgICAgIHNlbGYud3NDb25uZWN0aW9uID0gbmV3IHV0aWxzLndzQ29ubmVjdChzZWxmLm9wdGlvbnMpO1xuICAgICAgICBzZWxmLndzQ29ubmVjdGlvbi5vbkNvbm5lY3QoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNlbGYuZXZlbnRzLmVtaXQoJ3dzLWNvbm5lY3RlZCcsIHNlbGYud3NDb25uZWN0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYud3NDb25uZWN0aW9uLm9uRGlzY29ubmVjdChmdW5jdGlvbigpeyBcbiAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMgJiYgc2VsZi5vcHRpb25zLnJlYWx0aW1lRW5kUG9pbnQpe1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgd3Njb25uZWN0KHNlbGYpOyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9LDEwMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzKChmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICBpZiAoJ3Rva2VuJyBpbiBzZWxmLm9wdGlvbnMpe1xuICAgICAgICAgICAgY2FsbEJhY2sgJiYgY2FsbEJhY2soc3RhdHVzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb25uZWN0aW5nIHRvICcgKyBzZWxmLm9wdGlvbnMuZW5kUG9pbnQpO1xuICAgICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy51c2VybmFtZSAmJiBzZWxmLm9wdGlvbnMucGFzc3dvcmQpe1xuICAgICAgICAgICAgICAgIHNlbGYubG9naW4oXG4gICAgICAgICAgICAgICAgICAgIHNlbGYub3B0aW9ucy51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5vcHRpb25zLnBhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxCYWNrICYmIGNhbGxCYWNrKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlbmV3aW5nIGNvbm5lY3Rpb24nKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLm9wdGlvbnMudG9rZW4gJiYgc2VsZi5vcHRpb25zLnJlYWx0aW1lRW5kUG9pbnQgJiYgKCFzZWxmLndzQ29ubmVjdGlvbikpe1xuICAgICAgICAgICAgd3Njb25uZWN0KHNlbGYpO1xuICAgICAgICB9XG4gICAgfSkuYmluZCh0aGlzKSk7XG59O1xuXG5yZVdoZWVsQ29ubmVjdGlvbi5wcm90b3R5cGUubG9nT3V0ID0gZnVuY3Rpb24odXJsLCBjYWxsQmFjayl7XG4gICAgcmV0dXJuIHRoaXMuJHBvc3QoJ2FwaS9sb2dvdXQnLHt9LChmdW5jdGlvbihzdGF0dXMpIHtcbiAgICAgICAgaWYgKCdsYXN0UldUU3RhdHVzJyBpbiBsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2UubGFzdFJXVFN0YXR1cztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9wdGlvbnMgPSB7ZW5kUG9pbnQ6IHRoaXMub3B0aW9ucy5lbmRQb2ludH07XG4gICAgICAgIGlmICh0aGlzLndzQ29ubmVjdGlvbikgeyBcbiAgICAgICAgICAgIHRoaXMud3NDb25uZWN0aW9uLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLndzQ29ubmVjdGlvbiA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybCkgeyBsb2NhdGlvbiA9IHVybDsgfVxuICAgICAgICBjYWxsQmFjayAmJiBjYWxsQmFjaygpO1xuICAgIH0pLmJpbmQodGhpcykpO1xufVxuKi9cbnZhciB1dGlscyA9IHtcbiAgICByZW5hbWVGdW5jdGlvbiA6IGZ1bmN0aW9uIChuYW1lLCBmbikge1xuICAgICAgICByZXR1cm4gKG5ldyBGdW5jdGlvbihcInJldHVybiBmdW5jdGlvbiAoY2FsbCkgeyByZXR1cm4gZnVuY3Rpb24gXCIgKyBuYW1lICtcbiAgICAgICAgICAgIFwiICgpIHsgcmV0dXJuIGNhbGwodGhpcywgYXJndW1lbnRzKSB9OyB9O1wiKSgpKShGdW5jdGlvbi5hcHBseS5iaW5kKGZuKSk7XG4gICAgfSxcbiAgICBjYWNoZWQgOiBmdW5jdGlvbihmdW5jLCBrZXkpe1xuICAgICAgICBpZiAoIWtleSl7ICAgIFxuICAgICAgICAgICAga2V5ID0gJ18nICsgY2FjaGVkS2V5SWR4Kys7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gd3JhcHBlcigpe1xuICAgICAgICAgICAgaWYgKCF0aGlzW2tleV0pe1xuICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IGZ1bmMuY2FsbCh0aGlzLFthcmd1bWVudHNdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzW2tleV07XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB3cmFwcGVyO1xuICAgIH0sXG4vLyAgICAkUE9TVCA6ICRQT1NULFxuLy8gICAgcmVXaGVlbENvbm5lY3Rpb246IHJlV2hlZWxDb25uZWN0aW9uLFxuICAgIGxvZzogZnVuY3Rpb24oKXsgXG4gICAgICAgIGNvbnNvbGUubG9nKGFyZ3VtZW50cyk7XG4gICAgfSxcblxuICAgIHhkcjogZnVuY3Rpb24gKHVybCwgZGF0YSwgYXBwbGljYXRpb24sdG9rZW4sIGZvcm1FbmNvZGUpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1ha2UgYW4gSFRUUCBSZXF1ZXN0IGFuZCByZXR1cm4gaXRzIHByb21pc2UuXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYWNjZXB0LCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciByZXE7XG4gICAgICAgICAgICBpZiAoIWRhdGEpIHsgZGF0YSA9IHt9O31cblxuICAgICAgICAgICAgaWYoWE1MSHR0cFJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICByZXEgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICByZXEub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXEucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBKU09OLnBhcnNlKHJlcS5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoYSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlRGF0YSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSB7cmVzcG9uc2VEYXRhOiByZXNwb25zZURhdGEsIHJlc3BvbnNlVGV4dDogcmVxLnJlc3BvbnNlVGV4dCxzdGF0dXM6IHJlcS5zdGF0dXMsIHJlcXVlc3Q6IHJlcX07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVxLnN0YXR1cyA+PSAyMDAgJiYgcmVxLnN0YXR1cyA8IDQwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VwdChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmKFhEb21haW5SZXF1ZXN0KXtcbiAgICAgICAgICAgICAgICByZXEgPSBuZXcgWERvbWFpblJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICByZXEub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjY2VwdChyZXEucmVzcG9uc2VUZXh0LHJlcS5zdGF0dXNUZXh0LCByZXEpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ0NPUlMgbm90IHN1cHBvcnRlZCcpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVxLm9wZW4oJ1BPU1QnLCB1cmwsIHRydWUpO1xuICAgICAgICAgICAgcmVxLm9uZXJyb3IgPSByZWplY3Q7XG4gICAgICAgICAgICByZXEuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgICAgICAgaWYgKHRva2VuKSB7IGRhdGEuX190b2tlbl9fID0gdG9rZW4gfVxuICAgICAgICAgICAgaWYgKCFmb3JtRW5jb2RlKXtcbiAgICAgICAgICAgICAgICByZXEuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywndGV4dC9wbGFpbicpO1xuICAgICAgICAgICAgICAgIGRhdGEgPSBMYXp5KGRhdGEpLnNpemUoKT9KU09OLnN0cmluZ2lmeShkYXRhKTonJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpO1xuICAgICAgICAgICAgICAgIGRhdGEgPSBMYXp5KGRhdGEpLm1hcChmdW5jdGlvbih2LGspe1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGsgKyAnPScgKyBlbmNvZGVVUkkodi50b1N0cmluZygpKTsgIFxuICAgICAgICAgICAgICAgIH0pLnRvQXJyYXkoKS5qb2luKCcmJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXEuc2VuZChkYXRhKTtcbiAgICAvLyAgICAgICAgcmVxLnNlbmQobnVsbCk7XG4gICAgICAgIH0pXG4gICAgfSxcbiAgICBcbiAgICBjYXBpdGFsaXplIDogZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgcmV0dXJuIHNbMF0udG9VcHBlckNhc2UoKSArIHMuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcbiAgICB9LFxuXG4gICAgaGFzaCA6IGZ1bmN0aW9uKHN0cil7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIYXNoZWQgZnVuY3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIHN0ciA9IHN0ci50b1N0cmluZygpO1xuICAgICAgICB2YXIgcmV0ID0gMTtcbiAgICAgICAgZm9yICh2YXIgeCA9IDA7eDxzdHIubGVuZ3RoO3grKyl7XG4gICAgICAgICAgICByZXQgKj0gKDEgKyBzdHIuY2hhckNvZGVBdCh4KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChyZXQgJSAzNDk1ODM3NDk1NykudG9TdHJpbmcoKTtcbiAgICB9LFxuXG4gICAgbWFrZUZpbHRlciA6IGZ1bmN0aW9uIChtb2RlbCwgZmlsdGVyLCB1bmlmaWVyLCBkb250VHJhbnNsYXRlRmlsdGVyKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYWtlIGZpbHRlciBmb3IgQXJyYXkuZmlsdGVyIGZ1bmN0aW9uIGFzIGFuIGFuZCBvZiBvclxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCF1bmlmaWVyKSB7IHVuaWZpZXIgPSAnICYmICc7fVxuICAgICAgICBpZiAoTGF6eShmaWx0ZXIpLnNpemUoKSA9PT0gMCl7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oeCl7IHJldHVybiB0cnVlIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNvdXJjZSA9IExhenkoZmlsdGVyKS5tYXAoZnVuY3Rpb24odmFscywgZmllbGQpe1xuICAgICAgICAgICAgaWYgKCF2YWxzKSB7IHZhbHMgPSBbbnVsbF19XG4gICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFscykpe1xuICAgICAgICAgICAgICAgIHZhbHMgPSBbdmFsc107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWRvbnRUcmFuc2xhdGVGaWx0ZXIgJiYgKG1vZGVsLmZpZWxkc1tmaWVsZF0udHlwZSA9PT0gJ3JlZmVyZW5jZScpKSB7XG4gICAgICAgICAgICAgICAgZmllbGQgPSAnXycgKyBmaWVsZDtcbiAgICAgICAgICAgICAgICB2YWxzID0gTGF6eSh2YWxzKS5tYXAoZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4ICYmICh4LmNvbnN0cnVjdG9yICE9PSBOdW1iZXIpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4LmlkO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geDtcbiAgICAgICAgICAgICAgICB9KS50b0FycmF5KCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1vZGVsLmZpZWxkc1tmaWVsZF0udHlwZSA9PT0gJ3N0cmluZycpe1xuICAgICAgICAgICAgICAgIHZhbHMgPSB2YWxzLm1hcChKU09OLnN0cmluZ2lmeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJygnICsgIExhenkodmFscykubWFwKGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgIGlmICgheCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdtYWtlRmlsdGVyIHggaXMgbnVsbCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZih4ID09PSBvcm0udXRpbHMubW9jaykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdtYWtlRmlsdGVyIHdpdGggTW9jayBPYmplY3QnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICcoeC4nICsgZmllbGQgKyAnID09PSAnICsgeCArICcpJztcbiAgICAgICAgICAgIH0pLmpvaW4oJyB8fCAnKSAgKycpJztcbiAgICAgICAgfSkudG9BcnJheSgpLmpvaW4odW5pZmllcik7XG4gICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oXCJ4XCIsIFwicmV0dXJuIFwiICsgc291cmNlKTtcbiAgICB9LFxuXG4gICAgc2FtZUFzIDogZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlZXAgZXF1YWxcbiAgICAgICAgICovXG4gICAgICAgIGZvciAodmFyIGsgaW4geCkge1xuICAgICAgICAgICAgaWYgKHlba10gIT0geFtrXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIFxuICAgIHBsdXJhbGl6ZSA6IGZ1bmN0aW9uKHN0ciwgbW9kZWwpe1xuICAgICAgICAvKipcbiAgICAgICAgICogTGV4aWNhbGx5IHJldHVybnMgZW5nbGlzaCBwbHVyYWwgZm9ybVxuICAgICAgICAgKi9cbiAgICAgICAgcmV0dXJuIHN0ciArICdzJztcbiAgICB9LFxuXG4gICAgYmVmb3JlQ2FsbCA6IGZ1bmN0aW9uKGZ1bmMsIGJlZm9yZSl7XG4gICAgICAgIHZhciBkZWNvcmF0b3IgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgYmVmb3JlKCkudGhlbihmdW5jKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZGVjb3JhdG9yO1xuICAgIH0sXG5cbiAgICBjbGVhblN0b3JhZ2UgOiBmdW5jdGlvbigpe1xuICAgICAgICAvKipcbiAgICAgICAgICogQ2xlYW4gbG9jYWxTdG9yYWdlIG9iamVjdFxuICAgICAgICAgKi9cbiAgICAgICAgTGF6eShsb2NhbFN0b3JhZ2UpLmtleXMoKS5lYWNoKGZ1bmN0aW9uKGspe1xuICAgICAgICAgICAgZGVsZXRlIGxvY2FsU3RvcmFnZVtrXTtcbiAgICAgICAgfSlcbiAgICB9LFxuXG4gICAgY2xlYW5EZXNjcmlwdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIExhenkobG9jYWxTdG9yYWdlKVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbih2LCBuKSB7IHJldHVybiBMYXp5KG4pLnN0YXJ0c1dpdGgoJ2Rlc2NyaXB0aW9uOicpfSlcbiAgICAgICAgICAgIC5rZXlzKClcbiAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uKG4pIHsgZGVsZXRlIGxvY2FsU3RvcmFnZVtuXSB9KTtcbiAgICB9LFxuICAgIFxuICAgIHJldmVyc2UgOiBmdW5jdGlvbiAoY2hyLCBzdHIpIHtcbiAgICAgICAgcmV0dXJuIHN0ci5zcGxpdChjaHIpLnJldmVyc2UoKS5qb2luKGNocik7XG4gICAgfSxcbiAgICBwZXJtdXRhdGlvbnM6IGZ1bmN0aW9uKGFycil7XG4gICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgeCA9IGFyci5sZW5ndGgtMTsgeCA+PSAwO3gtLSl7XG4gICAgICAgICAgICBmb3IgKHZhciB5ID0gYXJyLmxlbmd0aC0xOyB5ID49IDA7IHktLSl7XG4gICAgICAgICAgICAgICAgaWYgKHggIT09IHkpXG4gICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKFthcnJbeF0sIGFyclt5XV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfSxcblxuICAgIHdhaXRGb3I6IGZ1bmN0aW9uKGZ1bmMsIGNhbGxCYWNrKSB7XG4gICAgICAgIHZhciB3YWl0ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChmdW5jKCkpIHtcbiAgICAgICAgICAgICAgICBjYWxsQmFjaygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHdhaXRlciw1MDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNldFRpbWVvdXQod2FpdGVyLCA1MDApO1xuICAgIH0sXG5cbiAgICBib29sOiBCb29sZWFuLFxuXG4gICAgbm9vcCA6IGZ1bmN0aW9uKCl7fSxcblxuICAgIHR6T2Zmc2V0OiBuZXcgRGF0ZSgpLmdldFRpbWV6b25lT2Zmc2V0KCkgKiA2MDAwMCxcblxuICAgIHRyYW5zRmllbGRUeXBlOiB7XG4gICAgICAgIGRhdGU6IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIG5ldyBEYXRlKHggKiAxMDAwICsgdXRpbHMudHpPZmZzZXQgKSB9LFxuICAgICAgICBkYXRldGltZTogZnVuY3Rpb24oeCkgeyByZXR1cm4gbmV3IERhdGUoeCAqIDEwMDAgKyB1dGlscy50ek9mZnNldCApIH0sXG4gICAgICAgIHN0cmluZzogZnVuY3Rpb24oeCkgeyByZXR1cm4geC50b1N0cmluZygpOyB9LFxuICAgICAgICB0ZXh0OiBmdW5jdGlvbih4KSB7IHJldHVybiB4LnRvU3RyaW5nKCk7IH0sXG4gICAgICAgIGludGVnZXI6IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHBhcnNlSW50KHgpOyB9LFxuICAgICAgICBmbG9hdDogZnVuY3Rpb24oeCkgeyByZXR1cm4gcGFyc2VGbG9hdCh4KTsgfVxuICAgIH0sIFxuICAgIG1vY2sgOiBtb2NrT2JqZWN0KClcbn07XG5cblxuIl19
